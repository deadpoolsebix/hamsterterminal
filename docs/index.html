<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Hamster Terminal - Bloomberg Clean</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --orange: #ff8c00;
      --burgundy: #800020;
      --black: #000000;
      --panel: #0a0a0a;
      --border: #1a1a1a;
      --green: #00ff41;
      --red: #ff0033;
      --yellow: #ffff00;
      --cyan: #00d4ff;
      --gray: #bdbdbd;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Roboto Mono', monospace;
      background: var(--black);
      color: #ffffff;
      line-height: 1.4;
      padding-bottom: 40px;
    }

    /* BLOOMBERG HEADER */
    .header {
      background: var(--orange);
      color: #000000;
      padding: 14px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-weight: 700;
      letter-spacing: 1px;
      font-size: 1.1em;
    }
    .header-time { font-size: 1em; font-weight: 600; }

    /* NAV WRAPPER + HAMBURGER */
    .nav-wrapper { border-bottom: 1px solid var(--border); }
    .hamburger-btn {
      display: none;
      align-items: center;
      gap: 10px;
      padding: 10px 24px;
      width: 100%;
      background: #0d0d0d;
      border: 1px solid var(--border);
      border-left: 2px solid #1a1a1a;
      color: #ffffff;
      cursor: pointer;
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    .hamburger-btn span {
      display: block;
      width: 20px;
      height: 2px;
      background: #ffffff;
      transition: transform 0.2s ease, opacity 0.2s ease;
    }
    .hamburger-icon { display: grid; gap: 4px; }
    .hamburger-label { font-size: 0.9em; color: var(--gray); }
    .hamburger-btn.open .line1 { transform: translateY(6px) rotate(45deg); }
    .hamburger-btn.open .line2 { opacity: 0; }
    .hamburger-btn.open .line3 { transform: translateY(-6px) rotate(-45deg); }

    /* ANALYTICS HAMBURGER */
    .analytics-btn {
      display: none;
      align-items: center;
      gap: 10px;
      padding: 10px 24px;
      width: 100%;
      background: #0d0d0d;
      border: 1px solid var(--border);
      border-left: 2px solid #1a1a1a;
      color: #ffffff;
      cursor: pointer;
      font-weight: 700;
      letter-spacing: 0.5px;
      margin-top: 8px;
      position: relative;
    }
    .analytics-icon { display: grid; gap: 4px; }
    .analytics-icon span { width: 20px; height: 2px; background: #ffffff; transition: transform 0.2s ease, opacity 0.2s ease; }
    .analytics-btn.open .line1 { transform: translateY(6px) rotate(45deg); }
    .analytics-btn.open .line2 { opacity: 0; }
    .analytics-btn.open .line3 { transform: translateY(-6px) rotate(-45deg); }

    /* ANALYTICS PANEL */
    .analytics-panel {
      display: none;
      background: #0a0a0a;
      border: 1px solid var(--border);
      border-top: none;
      padding: 12px;
      max-height: 500px;
      overflow-y: auto;
    }
    .analytics-panel.open { display: block; }
    .radar-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .radar-card { background: #0d0d0d; border: 1px solid var(--border); border-left: 2px solid #1a1a1a; padding: 10px; }
    .radar-title { color: #ffffff; font-weight: 700; font-size: 0.9em; margin-bottom: 6px; }
    .radar-data { color: var(--gray); font-size: 0.85em; line-height: 1.5; }
    .radar-hot { color: var(--red); font-weight: 700; }
    .radar-cool { color: var(--green); font-weight: 700; }
    .radar-neutral { color: var(--cyan); font-weight: 700; }
    .hamburger-extra {
      background: #0d0d0d;
      border: 1px solid var(--border);
      border-top: none;
      padding: 10px 24px;
      display: grid;
      gap: 8px;
    }
    .pill-row { display: flex; flex-wrap: wrap; gap: 8px; }
    .pill {
      padding: 6px 10px;
      border: 1px solid var(--border);
      background: #111;
      color: #ffffff;
      font-weight: 700;
      font-size: 0.85em;
      letter-spacing: 0.3px;
    }
    .pill-hot { border-color: var(--red); color: var(--red); }
    .pill-cool { border-color: var(--cyan); color: var(--cyan); }
    .pill-neutral { border-color: var(--gray); color: var(--gray); }
    .live-comment { color: var(--gray); font-size: 0.9em; line-height: 1.5; }
    .tactic-note { color: #ffffff; font-size: 0.92em; font-weight: 700; }

    /* BURGUNDY MENU BAR */
    .menu-bar {
      display: flex;
      gap: 8px;
      padding: 10px 24px;
      background: var(--burgundy);
      border-bottom: 1px solid var(--border);
      flex-wrap: wrap;
    }
    .menu-item {
      background: transparent;
      border: 1px solid transparent;
      color: #ffffff;
      padding: 8px 14px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.2s, border-color 0.2s;
      font-size: 0.95em;
    }
    .menu-item.active { background: #b0303c; border-color: #d44a5c; }
    .menu-item:hover { opacity: 0.9; }

    /* NEWS TICKER BAR (TOP HEADER) - MARKET TICKER */
    .news-ticker-bar {
      width: 100%;
      height: 96px; /* 20% larger than Sniper ticker */
      background: #000000;
      border-top: 1px solid #333333;
      border-bottom: 1px solid #333333;
      overflow: hidden;
      position: relative;
      display: flex;
      align-items: center;
    }
    .news-ticker-content {
      display: flex;
      align-items: center;
      white-space: nowrap;
      animation: ticker-scroll 45s linear infinite;
      gap: 72px;
      padding: 0 48px;
    }
    .news-ticker-item {
      display: flex;
      align-items: center;
      gap: 20px;
      font-size: 1.08em;
      font-weight: 700;
      letter-spacing: 1px;
    }
    .news-ticker-label {
      color: #ffffff;
      font-size: 2.64em;
      text-shadow: none;
    }
    .news-ticker-text {
      color: #cccccc;
      min-width: 192px;
      font-size: 1em;
    }
    .news-ticker-time {
      min-width: 144px;
      font-size: 1.02em;
      color: #999999;
    }
    .news-ticker-time.up {
      color: #aaaaaa;
    }
    .news-ticker-time.down {
      color: #888888;
    }

    /* TICKER BAR (BELOW RADAR, ABOVE BURGUNDY MENU) */
    .ticker-bar {
      width: 100%;
      height: 80px; /* 2x size (100% increase from 40px) */
      background: #000000;
      border-top: 1px solid #333333;
      border-bottom: 1px solid #333333;
      overflow: hidden;
      position: relative;
      display: flex;
      align-items: center;
    }
    .ticker-content {
      display: flex;
      align-items: center;
      white-space: nowrap;
      animation: ticker-scroll 45s linear infinite;
      gap: 60px; /* 2x spacing */
      padding: 0 40px; /* 2x padding */
    }
    .ticker-item {
      display: flex;
      align-items: center;
      gap: 16px; /* 2x gap */
      font-size: 0.9em;
      font-weight: 700;
      letter-spacing: 1px;
    }
    .ticker-symbol {
      color: #ffffff;
      font-size: 2.2em; /* Large headers only */
      text-shadow: none;
    }
    .ticker-price {
      color: #cccccc;
      min-width: 160px; /* 2x width */
    }
    .ticker-change {
      min-width: 120px; /* 2x width */
      font-size: 0.85em;
      color: #999999;
    }
    .ticker-change.up {
      color: #aaaaaa;
    }
    .ticker-change.down {
      color: #888888;
    }
    @keyframes ticker-scroll {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }

    /* DROP-DOWN PANELS UNDER MENU */
    .menu-panels { padding: 0 24px 10px 24px; }
    .menu-panel {
      display: none;
      background: var(--panel);
      border: 1px solid var(--border);
      border-left: 2px solid #1a1a1a;
      padding: 14px;
      color: #ffffff;
    }
    .menu-panel.active { display: block; }
    .panel-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 12px; }
    .panel-card { background: #0d0d0d; border: 1px solid var(--border); padding: 12px; }
    .panel-title { font-weight: 700; margin-bottom: 6px; letter-spacing: 0.5px; font-size: 0.95em; }
    .panel-text { color: var(--gray); font-size: 0.9em; line-height: 1.5; }
    .panel-text-strong { color: #f5f5f5; font-size: 0.96em; line-height: 1.6; }
    .panel-text-xl { color: #ffffff; font-size: 1.05em; line-height: 1.7; font-weight: 600; letter-spacing: 0.3px; }
    .panel-bullets { margin: 4px 0 0 16px; padding: 0; list-style: square; color: #f5f5f5; font-size: 0.96em; line-height: 1.6; }
    .panel-bullets li { margin-bottom: 4px; }
    .text-buy { color: var(--green); font-weight: 700; }
    .text-sell { color: var(--red); font-weight: 700; }
    .signal-tag { display: inline-block; padding: 4px 8px; border: 1px solid var(--border); background: #111; color: #fff; font-weight: 700; font-size: 0.8em; letter-spacing: 0.5px; margin-right: 6px; }
    .sparkline { width: 100%; height: 80px; background: #0a0a0a; border: 1px solid var(--border); padding: 6px; }
    .sparkline svg { width: 100%; height: 100%; }
    .mini-label { color: var(--gray); font-size: 0.8em; margin-top: 6px; }
    .mini-sparkline { width: 100%; height: 52px; background: #0a0a0a; border: 1px solid var(--border); margin: 6px 0; padding: 4px; }
    .mini-sparkline svg { width: 100%; height: 100%; }
    .cta-btn {
      display: inline-block;
      padding: 6px 12px;
      margin-top: 8px;
      background: var(--orange);
      color: #000000;
      border: 1px solid var(--orange);
      font-weight: 700;
      cursor: pointer;
      font-size: 0.85em;
      letter-spacing: 0.3px;
    }

    /* COLLAPSE BEHAVIOR */
    .nav-wrapper.collapsed .menu-bar,
    .nav-wrapper.collapsed .menu-panels {
      display: none;
    }
    @media (max-width: 1100px) {
      .hamburger-btn { display: flex; }
      .menu-bar { flex-wrap: wrap; }
    }
    @media (min-width: 1101px) {
      .hamburger-btn { display: none; }
    }

    /* SECTION HEADER WITH SENTIMENT */
    .section-header-wrapper {
      display: grid;
      grid-template-columns: 1.5fr 1fr;
      gap: 14px;
      padding: 14px 24px 2px 24px;
      margin-bottom: 0;
    }
    .section-header {
      background: var(--panel);
      padding: 10px 15px;
      border-left: 2px solid #1a1a1a;
    }
    .section-title {
      font-size: 0.95em;
      font-weight: 700;
      color: #ffffff;
    }
    .section-subtitle {
      font-size: 0.8em;
      color: #333333;
      margin-top: 3px;
    }
    .section-sentiment {
      background: var(--panel);
      padding: 10px 15px;
      border-left: 2px solid #1a1a1a;
    }
    .section-sentiment h3 {
      font-size: 1.05em;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 8px;
      letter-spacing: 0.8px;
      text-transform: uppercase;
    }
    .sentiment-stat {
      display: flex;
      justify-content: space-between;
      font-size: 0.9em;
      color: var(--gray);
      margin-bottom: 4px;
      line-height: 1.5;
    }
    .sentiment-stat span:last-child {
      color: #ffffff;
      font-weight: 600;
    }

    /* PSYCHOLOGY HEADER (monochrome) */
    .psych-title { color: #ffffff; font-weight: 700; font-size: 1.05em; letter-spacing: 0.8px; margin-bottom: 10px; text-transform: uppercase; }
    .psych-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .psych-card { border: 1px solid var(--border); padding: 10px; background: var(--panel); border-left: 2px solid #1a1a1a; }
    .psych-head { color: #ffffff; font-weight: 700; margin-bottom: 6px; font-size: 0.95em; }
    .psych-percent { color: #ffffff; font-weight: 700; }
    .psych-list { list-style: none; padding-left: 0; }
    .psych-list li { color: var(--gray); font-size: 0.9em; margin: 3px 0; line-height: 1.5; }
    .psych-note { color: var(--gray); font-size: 0.9em; margin-top: 12px; line-height: 1.5; }

    /* METRICS GRID (4 boxes like Bloomberg) */
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px;
      padding: 14px 24px;
      margin-bottom: 0;
    }
    .metric-box {
      background: var(--panel);
      border: 1px solid var(--border);
      border-left: 2px solid #1a1a1a;
      padding: 15px;
    }
    .metric-label {
      font-size: 0.9em;
      color: var(--gray);
      margin-bottom: 8px;
      font-weight: 600;
      letter-spacing: 0.3px;
    }
    .metric-value {
      font-size: 2em;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 5px;
      letter-spacing: -0.5px;
    }
    .metric-change {
      font-size: 1em;
      font-weight: 600;
      color: #ffffff;
    }
    .metric-change.down { color: #ffffff; }

    /* TICKER */
    .ticker-wrapper {
      padding: 0 24px 17px 24px;
    }
    .ticker {
      background: var(--panel);
      border: 1px solid var(--border);
      padding: 14px;
      overflow: hidden;
      margin-bottom: 17px;
      font-size: 1.4em;
      line-height: 1.3;
    }
    .ticker-track {
      display: inline-flex;
      gap: 30px;
      white-space: nowrap;
      animation: ticker 28s linear infinite;
    }
    .ticker-label {
      color: #ffffff;
      font-weight: 700;
    }
    @keyframes ticker {
      0% { transform: translateX(40%); }
      100% { transform: translateX(-120%); }
    }

    /* NEWS */
    .news {
      background: var(--panel);
      border: 1px solid var(--border);
      padding: 12px;
    }
    .news h4 {
      color: #ffffff;
      margin-bottom: 10px;
      font-size: 1.15em;
      font-weight: 700;
      letter-spacing: 0.8px;
      text-transform: uppercase;
    }
    .news-item {
      font-size: 1em;
      margin-bottom: 7px;
      padding: 5px 0;
      border-bottom: 1px solid #1a1a1a;
      line-height: 1.6;
    }
    .news-item:last-child {
      border-bottom: none;
    }

    /* BREAKING NEWS */
    .breaking-news {
      background: var(--panel);
      border: 1px solid var(--border);
      padding: 12px;
    }
    .news-breaking-wrapper {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      padding: 0 24px 12px 24px;
    }
    .breaking-news h4 {
      color: #ffffff;
      margin-bottom: 12px;
      font-size: 1.15em;
      font-weight: 700;
      letter-spacing: 1.5px;
      text-transform: uppercase;
    }
    .breaking-item {
      display: grid;
      grid-template-columns: 0.8fr 1fr 1.2fr 0.7fr;
      gap: 10px;
      padding: 10px 8px;
      border-bottom: 1px solid #1a1a1a;
      font-size: 0.95em;
      align-items: center;
      line-height: 1.5;
    }
    .breaking-item:last-child {
      border-bottom: none;
    }
    .breaking-status {
      font-weight: 700;
      text-transform: uppercase;
      font-size: 0.85em;
      letter-spacing: 0.5px;
    }
    .breaking-category {
      font-weight: 700;
      color: var(--gray);
      font-size: 0.9em;
    }
    .breaking-source {
      color: var(--gray);
      font-size: 0.85em;
    }
    .breaking-headline {
      color: #ffffff;
      font-weight: 600;
      font-size: 1em;
    }
    .breaking-time {
      color: var(--gray);
      text-align: right;
      font-size: 0.8em;
    }
    .breaking-red { color: var(--red); }
    .breaking-green { color: var(--green); }

    /* BTC/ETH CARDS */
    .top-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px;
      padding: 14px 24px;
    }
    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      padding: 14px;
    }
    .card h3 {
      color: #ffffff;
      font-size: 1em;
      margin-bottom: 6px;
    }
    .price {
      font-size: 2.4em;
      font-weight: 700;
      color: var(--yellow);
    }
    .change {
      font-weight: 700;
      color: var(--green);
    }
    .stat-row {
      display: flex;
      justify-content: space-between;
      font-size: 0.9em;
      color: var(--gray);
      margin-top: 4px;
    }
    .stat-row span:last-child {
      color: #ffffff;
      font-weight: 700;
    }

    /* CHART STYLES */
    /* TIMEFRAME SELECTOR */
    .timeframe-selector {
      display: flex;
      gap: 6px;
      margin-bottom: 14px;
      flex-wrap: wrap;
    }
    .timeframe-btn {
      background: #1a1a1a;
      border: 1px solid var(--border);
      color: var(--gray);
      padding: 6px 12px;
      cursor: pointer;
      font-size: 0.85em;
      font-weight: 600;
      font-family: 'Roboto Mono', monospace;
      transition: all 0.2s;
      letter-spacing: 0.5px;
    }
    .timeframe-btn:hover {
      background: #2a2a2a;
      border-color: var(--orange);
      color: #ffffff;
    }
    .timeframe-btn.active {
      background: var(--orange);
      border-color: var(--orange);
      color: #000000;
      font-weight: 700;
    }

    .chart-box {
      background: var(--panel);
      border: 1px solid var(--border);
      height: 400px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 0;
      overflow: hidden;
    }
    .chart-svg {
      width: 100%;
      height: 100%;
    }
    .chart-grid {
      stroke: #1a1a1a;
      stroke-width: 0.5;
    }
    .chart-axis {
      stroke: #333333;
      stroke-width: 1;
    }
    .chart-price-line {
      stroke: var(--yellow);
      stroke-width: 2;
      fill: none;
    }
    .chart-ema {
      stroke: var(--cyan);
      stroke-width: 1.5;
      fill: none;
      stroke-dasharray: 3,3;
    }
    .chart-ema50 {
      stroke: var(--gray);
      stroke-width: 1.2;
      fill: none;
      stroke-dasharray: 4,4;
    }
    .chart-support {
      stroke: var(--green);
      stroke-width: 1;
      stroke-dasharray: 5,5;
    }
    .chart-resistance {
      stroke: var(--red);
      stroke-width: 1;
      stroke-dasharray: 5,5;
    }
    .chart-liquidity {
      fill: rgba(0, 255, 0, 0.1);
    }
    .chart-buy-signal {
      fill: var(--green);
    }
    .chart-sell-signal {
      fill: var(--red);
    }
    .chart-label {
      font-size: 10px;
      fill: #888888;
      font-weight: bold;
    }
    .chart-value {
      font-size: 11px;
      fill: #ffffff;
      font-weight: bold;
    }
    .session-module {
      background: var(--panel);
      border: 1px solid var(--border);
      border-left: 2px solid #1a1a1a;
      padding: 14px 16px 16px 16px;
      margin-bottom: 18px;
    }
    .session-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    .session-title {
      color: #ffffff;
      font-weight: 700;
      font-size: 0.95em;
      text-transform: uppercase;
      letter-spacing: 0.6px;
    }
    .session-timer {
      color: var(--yellow);
      font-weight: 700;
      font-size: 0.85em;
      letter-spacing: 0.4px;
    }
    .session-svg {
      width: 100%;
      height: 160px;
      background: #050505;
      border: 1px solid #101010;
    }
    .killzone-rect {
      fill-opacity: 0.18;
      stroke-width: 1;
      stroke-dasharray: 4,4;
    }
    .killzone-london {
      fill: rgba(0, 212, 255, 0.16);
      stroke: var(--cyan);
    }
    .killzone-ny {
      fill: rgba(255, 0, 51, 0.16);
      stroke: var(--red);
    }
    .killzone-asia {
      fill: rgba(255, 196, 0, 0.16);
      stroke: var(--yellow);
    }
    .killzone-block {
      transition: transform 0.3s ease;
    }
    .killzone-block.killzone-active {
      transform: scaleY(1.02);
    }
    .killzone-block.killzone-active .killzone-rect {
      stroke-width: 2;
      filter: drop-shadow(0 0 6px rgba(255, 196, 0, 0.35));
    }
    .killzone-block.killzone-upcoming .killzone-rect {
      stroke-dasharray: 6,4;
      opacity: 0.9;
    }
    .session-axis {
      stroke: #1a1a1a;
      stroke-width: 0.5;
    }
    .session-bubble {
      fill: rgba(255, 140, 0, 0.12);
      stroke: var(--orange);
      stroke-width: 1;
    }
    .session-bubble-tail {
      fill: rgba(255, 140, 0, 0.12);
      stroke: var(--orange);
      stroke-width: 1;
    }
    .session-bubble-text {
      font-size: 9px;
      fill: var(--orange);
      font-weight: 600;
    }
    .session-sniper-line {
      stroke: var(--green);
      stroke-width: 1.2;
      stroke-dasharray: 5,3;
    }
    .session-footer {
      display: grid;
      grid-template-columns: 1.1fr 0.9fr;
      gap: 12px;
      margin-top: 14px;
    }
    .session-signal-box,
    .session-push-box {
      background: #0d0d0d;
      border: 1px solid #1a1a1a;
      padding: 10px 12px;
    }
    .session-label {
      color: #ffffff;
      font-weight: 700;
      font-size: 0.85em;
      letter-spacing: 0.4px;
      text-transform: uppercase;
      margin-bottom: 6px;
      display: block;
    }
    .session-signal-box span {
      display: block;
      color: var(--gray);
      font-size: 0.82em;
      line-height: 1.5;
    }
    .session-push-box {
      color: var(--gray);
      font-size: 0.83em;
      line-height: 1.5;
    }
    .genius-commentary {
      background: #0d0d0d;
      border: 1px solid var(--border);
      border-left: 2px solid var(--orange);
      padding: 12px 16px;
      margin-bottom: 20px;
    }
    .genius-commentary-title {
      color: #ffffff;
      font-weight: 700;
      font-size: 0.9em;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      margin-bottom: 6px;
    }
    .genius-commentary-text {
      color: var(--gray);
      font-size: 0.85em;
      line-height: 1.6;
    }
    .transfers {
      background: var(--panel);
      border: 1px solid var(--border);
      padding: 12px;
    }
    .transfer-row {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #161616;
      font-size: 0.92em;
    }
    .transfer-row:last-child {
      border-bottom: none;
    }
    .pos { color: #ffffff; font-weight: 700; }
    .neg { color: #ffffff; font-weight: 700; }

    /* TAB CONTENT STYLES */
    .tab-content {
      display: none;
      padding: 14px 24px;
      background: var(--panel);
      border-top: 1px solid var(--border);
      color: #ffffff;
    }
    .tab-content.active {
      display: block;
    }
    .tab-content h2 { color: #ffffff; }
    .trend-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 14px;
      margin-bottom: 20px;
    }
    .trend-card { background: #ffffff; border: 1px solid #e5e5e5; padding: 12px; }
    .trend-card h4 { color: #000000; font-size: 0.9em; margin-bottom: 8px; font-weight: 700; }
    .trend-card p { font-size: 0.85em; color: #333333; margin: 4px 0; }
    .trend-value { color: #111111; font-weight: 700; font-size: 1em; }
    .trend-up { color: #111111; }
    .trend-down { color: #111111; }
    .trend-neutral { color: #111111; }

    /* Trend Analysis dark variant with white text */
    #trend-analysis h2 { color: #ffffff !important; }
    #trend-analysis .trend-card { background: var(--panel); border: 1px solid var(--border); border-left: 2px solid #1a1a1a; }
    #trend-analysis .trend-card h4 { color: #ffffff; }
    #trend-analysis .trend-card p { color: #dddddd; }
    #trend-analysis .trend-value { color: #ffffff; }
    #trend-analysis .trend-up, 
    #trend-analysis .trend-down, 
    #trend-analysis .trend-neutral { color: #ffffff; }
    
    /* CORRELATION TABLE (dark) */
    .corr-wrapper { background: var(--panel); border: 1px solid var(--border); padding: 14px; }
    .corr-controls { display: flex; gap: 8px; align-items: center; margin-bottom: 12px; }
    .corr-select, .corr-btn { background: #0e0e0e; border: 1px solid var(--border); color: #ffffff; padding: 6px 10px; font-family: 'Roboto Mono', monospace; font-size: 0.85em; }
    .corr-btn.active { background: var(--orange); color: #000000; border-color: var(--orange); font-weight: 700; }
    .corr-grid { width: 100%; border-collapse: collapse; }
    .corr-grid th, .corr-grid td { border: 1px solid #161616; padding: 6px 8px; text-align: center; font-size: 0.85em; }
    .corr-grid th { background: #0f0f0f; color: #ffffff; font-weight: 700; }
    .corr-asset { text-align: left; color: #ffffff; font-weight: 700; }
    .corr-cell { color: #ffffff; }
    .heat-pos-high { background: rgba(0,255,65,0.12); }
    .heat-pos-mid { background: rgba(0,255,65,0.08); }
    .heat-pos-low { background: rgba(0,255,65,0.04); }
    .heat-neg-high { background: rgba(255,0,51,0.12); }
    .heat-neg-mid { background: rgba(255,0,51,0.08); }
    .heat-neg-low { background: rgba(255,0,51,0.04); }
    .corr-summary { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 12px; }
    .corr-card { background: #0d0d0d; border: 1px solid var(--border); padding: 10px; }
    .corr-card h4 { color: #ffffff; font-size: 0.9em; margin-bottom: 6px; }
    .corr-card p { color: #dddddd; font-size: 0.85em; }

    /* MULTI-TF ANALYSIS (dark) */
    .tf-wrapper { background: var(--panel); border: 1px solid var(--border); padding: 14px; }
    .tf-guide { background: #0e0e0e; border: 1px solid var(--border); padding: 12px; margin-bottom: 14px; color: #ffffff; }
    .tf-guide h3 { color: #ffffff; font-size: 1em; margin-bottom: 8px; }
    .tf-guide ul { list-style: none; padding-left: 0; }
    .tf-guide li { color: #dddddd; font-size: 0.85em; margin: 4px 0; }
    .tf-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
    .tf-card { background: #0d0d0d; border: 1px solid var(--border); padding: 10px; color: #ffffff; }
    .tf-title { color: #ffffff; font-weight: 700; font-size: 0.95em; margin-bottom: 6px; display: flex; justify-content: space-between; }
    .tf-status { font-weight: 700; color: #ffffff; }
    .tf-bull { color: var(--green); }
    .tf-bear { color: var(--red); }
    .tf-neutral { color: var(--yellow); }
    .tf-sideways { color: var(--cyan); }
    .tf-konsol { color: var(--yellow); }
    .tf-row { display: flex; justify-content: space-between; color: #dddddd; font-size: 0.85em; }
    .tf-row span:last-child { color: #ffffff; font-weight: 700; }
    @media (max-width: 1200px) { .tf-grid { grid-template-columns: 1fr; } }

    @media (max-width: 1200px) {
      .metrics-grid { grid-template-columns: repeat(2, 1fr); }
      .top-grid { grid-template-columns: repeat(2, 1fr); }
      .middle-section { grid-template-columns: 1fr; }
      .trend-grid { grid-template-columns: 1fr; }
    }

    /* LEFT TOOLS DRAWER */
    .tools-handle {
      position: fixed;
      left: 0;
      top: 140px;
      width: 32px;
      height: 120px;
      background: linear-gradient(90deg, var(--orange), #cc7722);
      color: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      border-right: 3px solid #a85b00;
      border-bottom: 2px solid #a85b00;
      border-top: 2px solid #a85b00;
      z-index: 101;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 2px 4px 12px rgba(255, 165, 0, 0.4);
    }
    .tools-handle:hover {
      width: 40px;
      box-shadow: 4px 8px 20px rgba(255, 165, 0, 0.6);
      background: linear-gradient(90deg, #ff9500, var(--orange));
    }
    .tools-handle span {
      writing-mode: vertical-rl;
      font-weight: 900;
      letter-spacing: 2px;
      font-size: 0.85em;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }
    .tools-drawer {
      position: fixed;
      left: 0;
      top: 0;
      height: 100vh;
      width: 320px;
      background: linear-gradient(180deg, #0a0a0a 0%, #0d0d0d 100%);
      border-right: 3px solid var(--orange);
      transform: translateX(-100%);
      transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      z-index: 100;
      padding: 16px;
      overflow-y: auto;
      box-shadow: 4px 0 20px rgba(255, 165, 0, 0.2);
    }
    .tools-drawer.open {
      transform: translateX(0);
      box-shadow: 8px 0 40px rgba(255, 165, 0, 0.3);
    }
    .tools-header {
      color: var(--orange);
      font-weight: 900;
      margin-bottom: 16px;
      font-size: 1.1em;
      padding-bottom: 10px;
      border-bottom: 2px solid var(--orange);
      letter-spacing: 1px;
    }
    .tools-section {
      background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
      border: 2px solid var(--orange);
      padding: 12px;
      margin-bottom: 12px;
      border-radius: 4px;
      transition: all 0.2s ease;
    }
    .tools-section:hover {
      border-color: #ff9500;
      box-shadow: 0 0 12px rgba(255, 165, 0, 0.2);
    }
    .tools-title {
      color: var(--orange);
      font-weight: 900;
      font-size: 0.95em;
      margin-bottom: 8px;
      letter-spacing: 0.5px;
    }
    .tools-list { color: #eee; font-size: 0.9em; line-height: 1.8; }
    .tools-list div { padding: 4px 0; display: flex; align-items: center; }
    .tools-list.small { font-size: 0.85em; }
    .tools-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
    .tools-grid label { color: #ddd; font-size: 0.85em; display: grid; gap: 4px; font-weight: 600; }
    .tools-grid input {
      background: #111;
      color: var(--orange);
      border: 2px solid var(--border);
      padding: 8px;
      font-weight: 600;
      transition: all 0.2s ease;
    }
    .tools-grid input:focus {
      border-color: var(--orange);
      box-shadow: 0 0 8px rgba(255, 165, 0, 0.3);
      outline: none;
    }
    .tools-btn {
      padding: 8px 12px;
      background: linear-gradient(90deg, var(--orange), #ff9500);
      color: #000;
      border: 2px solid #a85b00;
      font-weight: 900;
      cursor: pointer;
      border-radius: 3px;
      transition: all 0.2s ease;
      grid-column: 1 / -1;
      letter-spacing: 0.5px;
    }
    .tools-btn:hover {
      background: linear-gradient(90deg, #ff9500, #ffaa00);
      box-shadow: 0 0 12px rgba(255, 165, 0, 0.4);
      transform: scale(1.02);
    }
    .tools-note {
      color: #aaa;
      font-size: 0.85em;
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px solid var(--border);
      font-weight: 600;
    }
    .tools-footer {
      color: #666;
      font-size: 0.8em;
      text-align: center;
      margin-top: 20px;
      padding-top: 12px;
      border-top: 1px solid var(--border);
      font-style: italic;
    }

    /* SIDEBAR MARKET INFO */
    .sidebar {
      position: fixed;
      right: 0;
      top: 0;
      width: 280px;
      height: 100vh;
      background: #0a0a0a;
      border-left: 2px solid var(--border);
      overflow-y: auto;
      padding: 14px;
      z-index: 100;
      display: none;
    }
    .sidebar-title { color: #ffffff; font-weight: 700; font-size: 1em; margin-bottom: 12px; letter-spacing: 0.5px; }
    .sidebar-item { background: #0d0d0d; border: 1px solid var(--border); padding: 10px; margin-bottom: 8px; }
    .sidebar-label { color: var(--gray); font-size: 0.85em; }
    .sidebar-value { color: #ffffff; font-weight: 700; font-size: 0.95em; }
    .sidebar-ticker { color: #ffffff; font-size: 0.9em; line-height: 1.4; }
    .ticker-up { color: var(--green); }
    .ticker-down { color: var(--red); }

    /* HAMBURGER & ANALYTICS BUTTONS CONTAINER */
    .hamburger-container {
      display: flex;
      gap: 8px;
      align-items: center;
      padding: 10px 24px;
      background: #0d0d0d;
      border-bottom: 1px solid var(--border);
    }

    /* HAMBURGER MENU BUTTON */
    .hamburger-menu {
      display: flex;
      flex-direction: column;
      gap: 5px;
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 6px;
      width: 40px;
      height: 40px;
      align-items: center;
      justify-content: center;
    }

    .hamburger-menu .bar {
      width: 24px;
      height: 2.5px;
      background: #ffffff;
      transition: all 0.3s ease;
      display: block;
    }

    .hamburger-menu.open .bar:nth-child(1) {
      transform: translateY(7.5px) rotate(45deg);
    }

    .hamburger-menu.open .bar:nth-child(2) {
      opacity: 0;
    }

    .hamburger-menu.open .bar:nth-child(3) {
      transform: translateY(-7.5px) rotate(-45deg);
    }

    /* ANALYTICS BUTTON */
    .analytics-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      background: transparent;
      border: 1px solid var(--border);
      color: #ffffff;
      cursor: pointer;
      padding: 8px 14px;
      font-size: 0.95em;
      font-weight: 600;
      border-radius: 0;
      transition: all 0.2s;
      font-family: 'Roboto Mono', monospace;
    }

    .analytics-btn:hover {
      border-color: var(--orange);
      background: #0a0a0a;
    }

    .analytics-btn.open {
      background: #1a1a1a;
      border-color: var(--orange);
      color: var(--orange);
    }

    .analytics-icon {
      font-size: 1.1em;
    }

    /* ===== ANALYTICS PANEL (BOTTOM EXPANDABLE) ===== */
    .analytics-panel {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease;
      background: #0a0a0a;
      border-bottom: 1px solid var(--border);
    }

    .analytics-panel.open {
      max-height: 2000px;
    }

    .radar-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 14px;
      padding: 14px 24px;
    }

    .radar-card {
      background: #0d0d0d;
      border: 1px solid var(--border);
      border-left: 2px solid #1a1a1a;
      padding: 12px;
    }

    .radar-title {
      color: #ffffff;
      font-weight: 700;
      font-size: 0.95em;
      margin-bottom: 8px;
      letter-spacing: 0.5px;
    }

    .radar-data {
      color: #dddddd;
      font-size: 0.9em;
      line-height: 1.6;
    }

    .radar-data div {
      display: flex;
      justify-content: space-between;
      margin-bottom: 4px;
    }

    .radar-cool {
      color: var(--green);
      font-weight: 600;
    }

    .radar-hot {
      color: var(--red);
      font-weight: 600;
    }

    .radar-neutral {
      color: var(--yellow);
      font-weight: 600;
    }

    @media (max-width: 1000px) {
      .radar-grid {
        grid-template-columns: 1fr;
      }
    }

    /* ===== SIDE DRAWER - ADVANCED ANALYTICS ===== */
    .analytics-drawer {
      position: fixed;
      right: -450px;
      top: 0;
      width: 450px;
      height: 100vh;
      background: linear-gradient(135deg, #0a0a0a 0%, #0f0f0f 100%);
      border-left: 2px solid var(--orange);
      overflow-y: auto;
      z-index: 200;
      transition: right 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      box-shadow: -10px 0 40px rgba(255, 140, 0, 0.15);
    }

    .analytics-drawer.open {
      right: 0;
    }

    .analytics-drawer::-webkit-scrollbar {
      width: 8px;
    }

    .analytics-drawer::-webkit-scrollbar-track {
      background: #0a0a0a;
    }

    .analytics-drawer::-webkit-scrollbar-thumb {
      background: var(--orange);
      border-radius: 4px;
    }

    .drawer-header {
      background: linear-gradient(90deg, var(--burgundy), #1a0015);
      padding: 14px 18px;
      border-bottom: 2px solid var(--orange);
      position: sticky;
      top: 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 10;
    }

    .drawer-header h2 {
      color: #ffffff;
      font-size: 1.1em;
      font-weight: 700;
      letter-spacing: 1px;
      margin: 0;
    }

    .close-drawer {
      background: transparent;
      border: none;
      color: #ffffff;
      font-size: 1.4em;
      cursor: pointer;
      padding: 0;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: color 0.2s;
    }

    .close-drawer:hover {
      color: var(--orange);
    }

    .drawer-tabs {
      display: flex;
      gap: 0;
      padding: 0 18px;
      margin-top: 12px;
      border-bottom: 1px solid var(--border);
    }

    .drawer-tab {
      background: transparent;
      border: none;
      color: var(--gray);
      padding: 10px 14px;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.85em;
      border-bottom: 2px solid transparent;
      transition: all 0.2s;
      font-family: 'Roboto Mono', monospace;
    }

    .drawer-tab.active {
      color: var(--orange);
      border-bottom-color: var(--orange);
    }

    .drawer-tab:hover {
      color: #ffffff;
    }

    .drawer-content {
      padding: 18px;
    }

    /* HEATMAP STYLES */
    .heatmap-container {
      background: #0d0d0d;
      border: 1px solid var(--border);
      padding: 12px;
      margin-bottom: 14px;
      border-left: 2px solid var(--orange);
    }

    .heatmap-title {
      color: #ffffff;
      font-weight: 700;
      font-size: 0.9em;
      margin-bottom: 10px;
      letter-spacing: 0.5px;
    }

    .heatmap-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 4px;
      margin-bottom: 8px;
    }

    .heatmap-cell {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75em;
      font-weight: 600;
      color: #ffffff;
      border-radius: 2px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .heatmap-cell:hover {
      transform: scale(1.1);
      box-shadow: 0 0 12px rgba(255, 140, 0, 0.5);
    }

    .heat-high-pos { background: rgba(0, 255, 65, 0.8); }
    .heat-mid-pos { background: rgba(0, 255, 65, 0.4); }
    .heat-neutral { background: rgba(100, 100, 100, 0.4); }
    .heat-mid-neg { background: rgba(255, 0, 51, 0.4); }
    .heat-high-neg { background: rgba(255, 0, 51, 0.8); }

    /* OPTION ROWS */
    .option-row {
      background: #0d0d0d;
      border: 1px solid var(--border);
      padding: 10px;
      margin-bottom: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-left: 2px solid var(--orange);
    }

    .option-label {
      color: #ffffff;
      font-weight: 600;
      font-size: 0.9em;
    }

    .option-value {
      color: var(--orange);
      font-weight: 700;
      font-size: 0.9em;
    }

    /* UNUSUAL ITEMS */
    .unusual-item {
      background: #0d0d0d;
      border: 1px solid var(--border);
      padding: 12px;
      margin-bottom: 10px;
      border-left: 3px solid var(--orange);
    }

    .unusual-header {
      color: #ffffff;
      font-weight: 700;
      font-size: 0.9em;
      margin-bottom: 6px;
    }

    .unusual-value {
      color: var(--orange);
      font-weight: 700;
      font-size: 0.95em;
      margin-bottom: 4px;
    }

    .unusual-note {
      color: #999999;
      font-size: 0.8em;
      font-style: italic;
    }

    /* HAMBURGER EXTRA - Quick Pills */
    .hamburger-extra {
      background: #0d0d0d;
      border-top: 1px solid var(--border);
      padding: 12px 24px;
      border-bottom: 1px solid var(--border);
    }

    .pill-row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    .pill {
      display: inline-block;
      padding: 6px 10px;
      font-size: 0.8em;
      font-weight: 600;
      border-radius: 2px;
      letter-spacing: 0.3px;
    }

    .pill-hot {
      background: rgba(255, 0, 51, 0.15);
      color: var(--red);
    }

    .pill-cool {
      background: rgba(0, 255, 65, 0.15);
      color: var(--green);
    }

    .pill-neutral {
      background: rgba(255, 255, 0, 0.15);
      color: var(--yellow);
    }

    .live-comment {
      color: #ffffff;
      font-size: 0.9em;
      line-height: 1.5;
      margin-bottom: 8px;
      padding: 8px;
      background: #0a0a0a;
      border-left: 2px solid var(--orange);
    }

    .tactic-note {
      color: var(--cyan);
      font-size: 0.85em;
      line-height: 1.5;
      padding: 8px;
      background: rgba(0, 212, 255, 0.05);
      border-left: 2px solid var(--cyan);
    }

    /* HAMSTER TERMINAL HEADER BAR */
    .hamster-header {
      width: auto;
      height: auto;
      background: none;
      border: none;
      display: flex;
      align-items: center;
      padding: 0 12px;
      font-size: 0.95em;
      color: var(--yellow);
      font-weight: 700;
      letter-spacing: 1px;
      white-space: nowrap;
      flex-shrink: 0;
    }
    .hamster-header-icon {
      font-size: 1.4em;
      margin-right: 10px;
    }
    .hamster-header-text {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      color: #ffffff;
      font-weight: 700;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    .hamster-header-market {
      color: #ffffff;
      letter-spacing: 1.2px;
      display: inline-flex;
      gap: 6px;
      align-items: center;
    }
    .hamster-header-crypto {
      color: var(--yellow);
      font-weight: 700;
    }
  </style>
</head>
<body>

  <!-- LEFT TOOLS DRAWER HANDLE -->
  <div class="tools-handle" id="toolsHandle"><span>TOOLS</span></div>

  <!-- LEFT TOOLS DRAWER -->
  <aside class="tools-drawer" id="toolsDrawer" aria-hidden="true">
    <div class="tools-header">üõ† Bloomberg Tools</div>
    <div class="tools-section">
      <div class="tools-title">Watchlist</div>
      <div class="tools-list" id="toolsWatchlist">
        <div>BTCUSD ‚Ä¢ Live</div>
        <div>ETHUSD ‚Ä¢ Live</div>
        <div>AAPL ‚Ä¢ Live</div>
        <div>MSFT ‚Ä¢ Live</div>
        <div>NVDA ‚Ä¢ Live</div>
      </div>
    </div>
    <div class="tools-section">
      <div class="tools-title">Quick Calc</div>
      <div class="tools-grid">
        <label>Risk %<input type="number" id="calcRisk" value="1.0" step="0.1"></label>
        <label>Entry<input type="number" id="calcEntry" value="95000"></label>
        <label>SL<input type="number" id="calcSL" value="94000"></label>
        <label>Acc Size<input type="number" id="calcSize" value="10000"></label>
        <button id="calcRun" class="tools-btn">Calc</button>
      </div>
      <div class="tools-note" id="calcResult">Position: -- | Qty: --</div>
    </div>
    <div class="tools-section">
      <div class="tools-title">Hotkeys</div>
      <div class="tools-list small">
        <div>[G] Genius Panel</div>
        <div>[R] Radar Toggle</div>
        <div>[H] Heatmaps Drawer</div>
        <div>[F] Flow Drawer</div>
      </div>
    </div>
    <div class="tools-footer">Swipe from left edge to open</div>
  </aside>



  <div class="nav-wrapper" id="navWrapper">
    <!-- HAMBURGER + ANALYTICS BUTTONS CONTAINER -->
    <div class="hamburger-container">
      <button class="hamburger-menu" id="hamburgerMenu" title="Toggle Menu">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
      </button>
      <button class="analytics-btn" id="analyticsBtn" title="Toggle Radar Panel (Bottom)">
        <span>RADAR</span>
      </button>
      <!-- HAMSTER TERMINAL LABEL -->
      <div class="hamster-header" style="margin: 0 8px; width: auto; height: auto; background: none; border: none; padding: 0 12px;">
        <span class="hamster-header-icon" aria-hidden="true">üêπ</span>
        <span class="hamster-header-text">
          <span class="hamster-header-market">
            <span>BTC USD</span>
            <span class="hamster-header-crypto">Crypto</span>
          </span>
          <span>|</span>
          <span>Hamster Terminal</span>
        </span>
      </div>
      <button class="analytics-btn" id="drawerBtn" style="margin-left: 4px;" title="Advanced Analytics (Side)">
        <span>ADVANCED</span>
      </button>
    </div>

    <!-- BLOOMBERG NEWS TICKER (TOP) -->
    <div class="news-ticker-bar">
      <div class="news-ticker-content" id="newsTickerContent" aria-live="polite">
        <div class="news-ticker-item">
          <span class="news-ticker-label">LADOWANIE</span>
          <span class="news-ticker-text">Pobieram naglowki z API...</span>
          <span class="news-ticker-time">--</span>
        </div>
      </div>
    </div>

    <!-- BURGUNDY MENU BAR -->
    <div class="menu-bar">
      <button class="menu-item" data-tab="dashboard">Dashboard</button>
      <button class="menu-item" data-tab="trend-analysis">Trend Analysis</button>
      <button class="menu-item" data-tab="kpi-correlation">KPI Correlation</button>
      <button class="menu-item" data-tab="multi-tf-analysis">IMEFRAME ZONE ‚Ä¢ MULTI-TF ANALYSIS</button>
      <button class="menu-item active" data-tab="hamster-genius">Hamster Genius</button>
      <button class="menu-item" data-tab="onchain-flows">On-chain & Flows</button>
      <button class="menu-item" data-tab="risk-positioning">Risk & Positioning</button>
      <button class="menu-item" data-tab="execution-playbook">Execution Playbook</button>
      <button class="menu-item" data-tab="alerts-journal">Alerts & Journal</button>
    </div>

    <!-- ANALYTICS RADAR PANEL (BOTTOM EXPANDABLE) -->
    <div class="analytics-panel" id="analyticsPanel">
      <div style="background: rgba(255, 255, 0, 0.15); border: 1px solid var(--yellow); padding: 10px 24px; margin: 10px 24px 0 24px; color: var(--yellow); font-weight: 700; font-size: 0.9em; letter-spacing: 1px;">
        üìç PO POSTU
      </div>
      <div class="radar-grid">
        <div class="radar-card">
          <div class="radar-title">üéØ FVG RADAR</div>
          <div class="radar-data">
            <div>1H: <span class="radar-cool" data-update="fvg-1h">95.0k‚Äì95.4k</span> (BUY)</div>
            <div>4H: <span class="radar-hot">97.3k‚Äì97.6k</span> (SELL)</div>
            <div>D1: <span class="radar-cool">92.8k‚Äì93.6k</span> (DEMAND)</div>
            <div style="margin-top: 6px; font-size: 0.8em; color: #999;">Live</div>
          </div>
        </div>

        <div class="radar-card">
          <div class="radar-title">üìä EQL / EQH LEVELS</div>
          <div class="radar-data">
            <div>EQL: <span class="radar-cool" data-update="eql">94,200</span> (Support)</div>
            <div>EQH: <span class="radar-hot" data-update="eqh">97,800</span> (Resistance)</div>
            <div>Range: $3,600</div>
            <div style="margin-top: 6px; font-size: 0.8em; color: #999;">Live</div>
          </div>
        </div>

        <div class="radar-card">
          <div class="radar-title">üí∞ PREMIUM / DISCOUNT</div>
          <div class="radar-data">
            <div>Spot vs Perps: <span class="radar-cool">+0.15%</span></div>
            <div>Spot vs Futures: <span class="radar-cool">+0.08%</span></div>
            <div>Funding: <span class="radar-neutral">+0.0082%</span></div>
            <div style="margin-top: 6px; font-size: 0.8em; color: #999;">Live</div>
          </div>
        </div>

        <div class="radar-card">
          <div class="radar-title">üîÑ INTERNAL / EXTERNAL</div>
          <div class="radar-data">
            <div>Internal Flow: <span class="radar-cool">+$180M</span></div>
            <div>External Flow: <span class="radar-cool">-$3.2k BTC</span></div>
            <div>Net Inflow: <span class="radar-cool">+$220M</span></div>
            <div style="margin-top: 6px; font-size: 0.8em; color: #999;">Live</div>
          </div>
        </div>

        <div class="radar-card" style="grid-column: span 2;">
          <div class="radar-title">‚õìÔ∏è BLOCKCHAIN METRICS</div>
          <div class="radar-data">
            <div>Mempool: <span class="radar-hot">82% full</span> (Fees: 32 sat/vB)</div>
            <div>L2 Bridges: <span class="radar-cool">+$65M ‚Üí Arbitrum</span></div>
            <div>Whale Outflow: <span class="radar-cool">-1.1k BTC</span> ‚Üí cold storage (BULLISH)</div>
            <div>UTXO Age: <span class="radar-cool">Majority > 6mo</span> (Long-term holders)</div>
            <div style="margin-top: 6px; font-size: 0.8em; color: #999;">On-chain sentiment: BULLISH üü¢</div>
          </div>
        </div>

        <div class="radar-card">
          <div class="radar-title">üî• LIQUIDATION CLUSTERS</div>
          <div class="radar-data">
            <div>Short Liq: <span class="radar-hot" data-update="liq-short">$18M</span> @ 97.4k</div>
            <div>Long Liq: <span class="radar-hot" data-update="liq-long">$42M</span> @ 94.8k</div>
            <div>Total 24h: <span class="radar-hot">$110M</span></div>
            <div style="margin-top: 6px; font-size: 0.8em; color: #999;">Live</div>
          </div>
        </div>

        <div class="radar-card">
          <div class="radar-title">‚ö° VOLATILITY INDEX</div>
          <div class="radar-data">
            <div>1H: <span class="radar-neutral">2.3%</span> (Normal)</div>
            <div>4H: <span class="radar-neutral">1.8%</span> (Calm)</div>
            <div>24H: <span class="radar-hot">3.2%</span> (Elevated)</div>
            <div style="margin-top: 6px; font-size: 0.8em; color: #999;">Live</div>
          </div>
        </div>

        <div class="radar-card">
          <div class="radar-title">üì° SIGNAL STRENGTH</div>
          <div class="radar-data">
            <div>Bullish: <span class="radar-cool" data-update="bullish">58%</span> (DOMINANT)</div>
            <div>Bearish: <span class="radar-hot" data-update="bearish">42%</span> (RESISTANCE)</div>
            <div>Stalemate: <span class="radar-neutral">SCALP ZONE</span></div>
            <div style="margin-top: 6px; font-size: 0.8em; color: #999;">Live</div>
          </div>
        </div>
      </div>
    </div>

    <!-- SIDE DRAWER - ADVANCED ANALYTICS OPTIONS -->
    <div class="analytics-drawer" id="analyticsDrawer">
      <div class="drawer-header">
        <h2>üìä ADVANCED ANALYTICS</h2>
        <button class="close-drawer" id="closeDrawer">‚úï</button>
      </div>

      <div class="drawer-tabs">
        <button class="drawer-tab active" data-tab="heatmaps">HEATMAPS</button>
        <button class="drawer-tab" data-tab="flow">FLOW ANALYSIS</button>
        <button class="drawer-tab" data-tab="unusual">UNUSUAL</button>
      </div>

      <div class="drawer-content" id="heatmapsContent">
        <!-- CORRELATION HEATMAP -->
        <div class="heatmap-container">
          <div class="heatmap-title">üìà CORRELATION MATRIX</div>
          <div class="heatmap-grid">
            <div class="heatmap-cell heat-high-pos" title="BTC‚ÜîETH: 0.86">0.86</div>
            <div class="heatmap-cell heat-mid-pos" title="BTC‚ÜîAAPL: 0.42">0.42</div>
            <div class="heatmap-cell heat-neutral" title="BTC‚ÜîDXY: -0.48">-0.48</div>
            <div class="heatmap-cell heat-mid-neg" title="BTC‚ÜîVIX: -0.35">-0.35</div>
            <div class="heatmap-cell heat-high-pos" title="BTC‚ÜîNASDAQ: 0.62">0.62</div>
          </div>
          <div style="color: var(--gray); font-size: 0.8em;">Pearson correlation (24h)</div>
        </div>

        <!-- LIQUIDATION HEATMAP -->
        <div class="heatmap-container">
          <div class="heatmap-title">üî• LIQUIDATION ZONES (BY LEVEL)</div>
          <div class="heatmap-grid">
            <div class="heatmap-cell heat-high-neg" title="98.2k - EXTREME">DANGER</div>
            <div class="heatmap-cell heat-mid-neg" title="97.4k - HIGH">HIGH</div>
            <div class="heatmap-cell heat-neutral" title="96.0k - MID">MID</div>
            <div class="heatmap-cell heat-mid-pos" title="94.8k - MID">MID</div>
            <div class="heatmap-cell heat-high-pos" title="93.5k - SUPPORT">SAFE</div>
          </div>
          <div style="color: var(--gray); font-size: 0.8em;">Top liq zones (24h)</div>
        </div>

        <!-- VOLUME PROFILE -->
        <div class="heatmap-container">
          <div class="heatmap-title">üìä VOLUME PROFILE (POC)</div>
          <div class="heatmap-grid">
            <div class="heatmap-cell heat-mid-pos">5.2%</div>
            <div class="heatmap-cell heat-high-pos">8.7%</div>
            <div class="heatmap-cell heat-high-pos">9.1%</div>
            <div class="heatmap-cell heat-mid-pos">6.3%</div>
            <div class="heatmap-cell heat-neutral">4.1%</div>
          </div>
          <div style="color: var(--gray); font-size: 0.8em;">POC at $96,200</div>
        </div>

        <!-- MARKET MICROSTRUCTURE -->
        <div class="heatmap-container">
          <div class="heatmap-title">‚ö° MARKET MICROSTRUCTURE</div>
          <div class="heatmap-grid">
            <div class="heatmap-cell heat-high-pos">0.12</div>
            <div class="heatmap-cell heat-mid-pos">1.34</div>
            <div class="heatmap-cell heat-neutral">¬±0.08%</div>
            <div class="heatmap-cell heat-mid-pos">STRONG</div>
            <div class="heatmap-cell heat-high-pos">POSITIVE</div>
          </div>
          <div style="color: var(--gray); font-size: 0.8em;">Bid/Ask ‚Ä¢ Imbalance ‚Ä¢ VWAP ‚Ä¢ Momentum ‚Ä¢ OrderFlow</div>
        </div>
      </div>

      <div class="drawer-content" id="flowContent" style="display: none;">
        <div class="option-row">
          <div class="option-label">üêã WHALE ACCUMULATION</div>
          <div class="option-value" data-update="whale">+2.3k BTC</div>
        </div>

        <div class="option-row">
          <div class="option-label">üí± EXCHANGE INFLOWS</div>
          <div class="option-value" data-update="exchange">-$120M OUT</div>
        </div>

        <div class="option-row">
          <div class="option-label">üì¶ DARK POOL FLOW</div>
          <div class="option-value" data-update="dark-pool">$680M ‚Üë</div>
        </div>

        <div class="option-row">
          <div class="option-label">üîÑ ORDER FLOW IMBALANCE</div>
          <div class="option-value">+58% BUYERS</div>
        </div>

        <div class="option-row">
          <div class="option-label">‚öñÔ∏è LONG/SHORT RATIO</div>
          <div class="option-value" data-update="long-short">1.18 BULL</div>
        </div>

        <div class="option-row">
          <div class="option-label">üîì OPEN INTEREST</div>
          <div class="option-value">$14.2B (+3.2%)</div>
        </div>

        <div class="option-row">
          <div class="option-label">üìà SKEW INDEX</div>
          <div class="option-value">-0.12 NEUTRAL</div>
        </div>

        <div class="option-row">
          <div class="option-label">‚ö†Ô∏è CASCADE RISK</div>
          <div class="option-value">MEDIUM (2.5%)</div>
        </div>
      </div>

      <div class="drawer-content" id="unusualContent" style="display: none;">
        <div class="unusual-item">
          <div class="unusual-header">üö® UNUSUAL OPTION FLOW</div>
          <div class="unusual-value">$120M BTC CALL SKEW</div>
          <div class="unusual-note">Expiry: 24-Jan | Sentiment: BULLISH</div>
        </div>

        <div class="unusual-item">
          <div class="unusual-header">üéØ PERPETUAL FUNDING SPIKE</div>
          <div class="unusual-value">+0.025% (4HR HIGH)</div>
          <div class="unusual-note">Longs getting expensive</div>
        </div>

        <div class="unusual-item">
          <div class="unusual-header">‚ö° VOLUME SPIKE ZONES</div>
          <div class="unusual-value">95.8k & 97.2k</div>
          <div class="unusual-note">Breakout levels locked</div>
        </div>

        <div class="unusual-item">
          <div class="unusual-header">üîÆ WHALE ALERT ACTIVE</div>
          <div class="unusual-value">$50M TRANSFER ‚Üí EXCHANGE</div>
          <div class="unusual-note">Possible liquidation prep</div>
        </div>

        <div class="unusual-item">
          <div class="unusual-header">üí´ STALE CANDLE WATCH</div>
          <div class="unusual-value">LOW VOLATILITY BREWING</div>
          <div class="unusual-note">Accumulation zone forming</div>
        </div>

        <div class="unusual-item">
          <div class="unusual-header">üåä WAVE COUNT SETUP</div>
          <div class="unusual-value">POTENTIAL IMPULSE 5 INCOMING</div>
          <div class="unusual-note">Fibonacci targets: $98.2k</div>
        </div>
      </div>
    </div>

    <!-- MARKET TICKER BAR (SNIPER SECTION) -->
    <div class="ticker-wrapper">
      <div class="ticker">
        <div class="ticker-track" id="sniperTickerTrack">
          <span class="ticker-label">CRYPTO</span>
          <span class="ticker-item">
            <span class="ticker-symbol">BTC</span>
            <span class="ticker-price" id="ticker-btc">--</span>
            <span class="ticker-change" id="ticker-btc-change">--</span>
          </span>
          <span class="ticker-item">
            <span class="ticker-symbol">ETH</span>
            <span class="ticker-price" id="ticker-eth">--</span>
            <span class="ticker-change" id="ticker-eth-change">--</span>
          </span>
          <span class="ticker-label">INDEKSY</span>
          <span class="ticker-item">
            <span class="ticker-symbol">NASDAQ</span>
            <span class="ticker-price" id="ticker-nasdaq">--</span>
            <span class="ticker-change" id="ticker-nasdaq-change">--</span>
          </span>
          <span class="ticker-item">
            <span class="ticker-symbol">S&amp;P 500</span>
            <span class="ticker-price" id="ticker-sp500">--</span>
            <span class="ticker-change" id="ticker-sp500-change">--</span>
          </span>
          <span class="ticker-item">
            <span class="ticker-symbol">DAX</span>
            <span class="ticker-price" id="ticker-dax">--</span>
            <span class="ticker-change" id="ticker-dax-change">--</span>
          </span>
        </div>
      </div>
    </div>

    <!-- QUICK PILLS UNDER HAMBURGER -->
    <div class="hamburger-extra">
      <div class="pill-row">
        <span class="pill pill-hot">Sniper Shot: 95.2k ‚Üí 97.4k</span>
        <span class="pill pill-cool">Live Commentary: ON</span>
        <span class="pill pill-neutral">Tactic: Liquidity Sweep</span>
      </div>
      <div class="live-comment">Komentarz live: ≈õwieca 5m domyka nad 95.8k, wolumen przyspiesza +18%. Utrzymaj long, podnie≈õ SL pod 95.1k.</div>
      <div class="tactic-note">Nietypowa taktyka: "Ghost Ladder" ‚Äî rozstaw ukryte limit buy w FVG 95.0k‚Äì95.4k, TP kaskadowo 97.0k / 97.4k, alert na spike delta.</div>
    </div>

    <!-- DROPDOWN PANELS UNDER MENU (extra data on click) -->
    <div class="menu-panels">
    <div class="menu-panel" id="panel-dashboard">
      <div class="panel-grid">
        <div class="panel-card">
          <div class="panel-title">RADAR SNAJPERSKI ‚Ä¢ BTC</div>
          <div class="panel-text">Poziomy natychmiast: <strong style="color: var(--green);">95.0k‚Äì95.4k BUY</strong> | <strong style="color: var(--red);">97.3k‚Äì97.6k SELL</strong>. Invalidation: wybicie 97.8k.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">SZYBKIE SYGNA≈ÅY</div>
          <div style="margin-bottom: 6px;">
            <span class="signal-tag">LONG bias</span>
            <span class="signal-tag">Scalp ON</span>
            <span class="signal-tag">R:R 1:2.5</span>
          </div>
          <div class="panel-text">Wej≈õcie przy FVG $95.2k, TP $97.4k, SL $94.2k. Aktualizuj co 15m.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">MINI WYKRES ‚Ä¢ BTC</div>
          <div class="sparkline">
            <svg viewBox="0 0 200 80" preserveAspectRatio="xMidYMid meet">
              <polyline points="5,60 35,50 65,40 95,45 125,35 155,42 185,38" fill="none" stroke="var(--yellow)" stroke-width="2" />
              <circle cx="65" cy="40" r="4" fill="var(--green)" />
              <text x="55" y="28" font-size="8" fill="var(--green)">BUY</text>
              <circle cx="155" cy="42" r="4" fill="var(--red)" />
              <text x="145" y="30" font-size="8" fill="var(--red)">SELL</text>
            </svg>
          </div>
          <div class="mini-label">Overlay dla g≈Ç√≥wnego wykresu + sygna≈Çy live.</div>
        </div>
      </div>
    </div>

    <div class="menu-panel" id="panel-trend-analysis">
      <div class="panel-grid">
        <div class="panel-card">
          <div class="panel-title">SZYBKI TREND</div>
          <div class="panel-text">1H: konsolidacja; 4H: lekkie wybicie g√≥ra; 1D: byczy kana≈Ç. Wybij 97.4k = przyspieszenie.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">CO SPRAWDZIƒÜ</div>
          <div class="panel-text">Powt√≥rz test EMA50, reakcjƒô na FVG $95.2k, obronƒô buy walli. Przyspieszenie wolumenu > +20% = wej≈õcie.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">NASTƒòPNE KROKI</div>
          <div class="panel-text">Ustaw alert na 97.4k i 94.8k. Je≈õli RSI 1H < 42 przy 95k ‚Üí odpu≈õƒá longi, szukaj reentry przy 94.2k.</div>
        </div>
      </div>
    </div>

    <div class="menu-panel" id="panel-kpi-correlation">
      <div class="panel-grid">
        <div class="panel-card">
          <div class="panel-title">MAKRO CHECK</div>
          <div class="panel-text">DXY -0.48 korelacji: spadki dolara pomagajƒÖ longom BTC. VIX nisko ‚Üí rynek ryzyka sprzyja.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">ETF/INFLOWS</div>
          <div class="panel-text">Nap≈Çywy ETF +$220M ‚Üí wspiera trend wzrostowy. Watch: je≈õli dzienny dop≈Çyw < +$50M, zdejmij d≈∫wigniƒô.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">POMYS≈Å</div>
          <div class="panel-text">Dodaj heatmapƒô cross-asset (BTC vs SPX vs Gold) + auto-highlight gdy korelacja zmienia znak.</div>
        </div>
      </div>
    </div>

    <div class="menu-panel" id="panel-multi-tf-analysis">
      <div class="panel-grid">
        <div class="panel-card">
          <div class="panel-title">SCALP PLAN</div>
          <div class="panel-text">1m/5m bull, 15m/30m neutral: graj mean-revert do EMA, target +0.35% per trade.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">SWING PLAN</div>
          <div class="panel-text">4h neutral, 1d bear ‚Üí trzymaj po≈Çowƒô pozycji hedge (short perps) przy 97.4k, zdejmij gdy 98k wybite.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">RADAR SNAJPERSKI BTC</div>
          <div class="panel-text">Alerty: 95.2k (buy), 94.2k (re-entry), 97.8k (short invalidation). Dodaj auto-liniƒô na wykresie.</div>
        </div>
      </div>
    </div>

    <div class="menu-panel active" id="panel-hamster-genius">
      <div class="panel-grid">
        <div class="panel-card" style="grid-column: span 2;">
          <div class="panel-title">LIVE COMMENTARY OVERLAY</div>
          <div class="panel-text panel-text-strong">Overlay na wykresie: "Buy wall trzyma 95.2k, brak poda≈ºy na ask; przenie≈õ SL pod 95.1k". Update co 30s; plan push-notyfikacji na mobile.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">SYGNA≈ÅY LIVE</div>
          <div class="panel-text">‚Ä¢ BUY: 95.2k (potwierdzony FVG + wolumen)
            <br>‚Ä¢ SELL: 97.4k (liquidity sweep)
            <br>‚Ä¢ ALERT: funding > 0.012% ‚Üí zmniejsz long.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">GENIUS ROADMAP</div>
          <div class="panel-text">Rozbuduj Genius do trybu live-bias: automatyczne playbooki MTF, audio callouts przy zmianie sentymentu i pamiƒôƒá kontekstu, by komentarz adaptowa≈Ç wcze≈õniejsze alerty.</div>
        </div>
        <div class="panel-card" style="grid-column: span 3; grid-row: span 2;">
          <div class="panel-title">HAMSTER GENIUS ‚Ä¢ WYKRES + KOMENTARZ</div>
          <div class="sparkline" style="height: 180px;">
            <svg viewBox="0 0 620 160" preserveAspectRatio="xMidYMid meet">
              <polyline points="30,125 150,90 250,70 330,78 420,55 510,68 590,52" fill="none" stroke="var(--yellow)" stroke-width="3" />
              <circle cx="250" cy="70" r="8" fill="var(--green)" />
              <text x="216" y="40" font-size="12" fill="var(--green)">LONG 95.2k</text>
              <circle cx="510" cy="68" r="8" fill="var(--red)" />
              <text x="474" y="48" font-size="12" fill="var(--red)">TAKE PROFIT 97.4k</text>
            </svg>
          </div>
          <div class="panel-text panel-text-xl">
            <div><span class="text-buy">LONG 95.2k</span></div>
            <div><span class="text-sell">TAKE PROFIT 97.4k</span></div>
            <div>Komentarz: momentum ro≈õnie po obronie buy walli. Ryzyko: wybicie 94.8k = stop.</div>
          </div>
          <div class="panel-text" id="geniusLiveBias" style="margin-top: 10px; color: var(--gray); font-size: 0.95em; line-height: 1.6;">
            ≈Åadowanie danych live-bias...
          </div>
          <div class="panel-text" style="margin-top: 12px; display: flex; flex-wrap: wrap; gap: 8px; align-items: center;">
            <label for="geniusAudioLang" style="color: var(--gray); font-size: 0.85em;">Audio jƒôzyk:</label>
            <select id="geniusAudioLang" style="background: #0a0a0a; color: #ffffff; border: 1px solid var(--border); padding: 4px 8px;">
              <option value="pl">PL</option>
              <option value="en">EN</option>
              <option value="de">DE</option>
              <option value="sk">SK</option>
            </select>
            <button id="geniusAudioPlay" class="tools-btn" style="padding: 6px 12px;">‚ñ∂ Odtw√≥rz koment</button>
            <span id="geniusAudioStatus" style="color: var(--gray); font-size: 0.8em;">Gotowe</span>
          </div>
        </div>
        <div class="panel-card">
          <div class="panel-title">SNIPER SHOT ‚Ä¢ PLAY</div>
          <div class="panel-text"><strong>Poziomy natychmiast:</strong> <span class="text-buy">95.0k‚Äì95.4k BUY</span> | <span class="text-sell">97.3k‚Äì97.6k SELL</span><br><span class="text-sell">SELL.</span> Invalidation: wybicie 97.8k.<br>Setup: Long FVG 95.0k‚Äì95.4k, TP1 96.8k, TP2 97.4k, SL 94.8k. Timer ≈õwiecy: 5m; je≈õli delta < 0 przy dotkniƒôciu FVG ‚Üí odpu≈õƒá.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">NIETYPOWE TAKTYKI</div>
          <div class="panel-text">1) Fade na sweep short√≥w w killzone NY; 2) Ladder TP na mikrolotach co 120$; 3) Je≈ºeli funding skacze &gt;0.018% ‚Üí prze≈ÇƒÖcz 25% pozycji w hedge perps.</div>
        </div>
      </div>
    </div>

    <div class="menu-panel" id="panel-onchain-flows">
      <div class="panel-grid">
        <div class="panel-card">
          <div class="panel-title">STABLECOIN FLOWS</div>
          <div class="panel-text">Net inflow +$180M (24h). Zastrzyk p≈Çynno≈õci wspiera popyt spot.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">ETF SPOT BTC</div>
          <div class="panel-text">Nap≈Çyw dzienny +$220M, 5d ≈õrednia +$140M. Je≈õli < +$50M ‚Üí ostro≈ºniej z long.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">EXCHANGE FLOWS</div>
          <div class="panel-text">Net outflow -3.2k BTC (24h) ‚Üí presja spadku poda≈ºy na spot.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">DU≈ªE LIKWIDACJE</div>
          <div class="mini-sparkline">
            <svg viewBox="0 0 220 60">
              <polyline points="5,50 45,28 85,36 125,24 165,30 205,18" fill="none" stroke="var(--red)" stroke-width="2" />
              <circle cx="45" cy="28" r="4" fill="var(--red)" />
              <circle cx="165" cy="30" r="4" fill="var(--red)" />
            </svg>
          </div>
          <div class="panel-text">1h: $18M short liq @97.4k; 4h: $42M long liq @94.8k; 24h: $110M g≈Ç√≥wnie perps. Graj pod czyszczenie short√≥w.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">FVG / IMBALANCE MAP</div>
          <div class="panel-text">1H: FVG 95.0k‚Äì95.4k (long refill); 4H: 97.3k‚Äì97.6k (short fade); D1: 92.8k‚Äì93.6k (demand). Dodaj alert na ponowne dotkniƒôcie.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">BLOCKCHAIN HEAT</div>
          <div class="panel-text">Mempool: 82% full; Fees: 32 sat/vB (wysokie); L2 mosty: +$65M ‚Üí Arbitrum; Whale outflow: -1.1k BTC z Binance ‚Üí cold storage.</div>
        </div>
      </div>
    </div>

    <div class="menu-panel" id="panel-risk-positioning">
      <div class="panel-grid">
        <div class="panel-card">
          <div class="panel-title">FUNDING / SKEW</div>
          <div class="panel-text">Funding +0.008%: zdrowe. Skew lekko dodatni ‚Üí lekka przewaga long√≥w.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">OI / D≈πWIGNIA</div>
          <div class="panel-text">Open Interest $12.4B, wzrost +3% d/d. Brak przegrzania, ale ≈õled≈∫ przy wybiciu 97.4k.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">LIQUIDATION MAP</div>
          <div class="panel-text">Clustery: 97.4k (short liq), 94.8k (long liq). Graj w kierunku czyszczenia short√≥w.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">POZYCJE / RYZYKO</div>
          <div class="panel-text">Wska≈∫nik long/short: 1.28; Delta perps vs spot: +0.9%; Heat: funding + OI + skew w zielonym ‚Üí mo≈ºna utrzymaƒá longi, ale hedgowaƒá 25% przy spike funding.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">KILLZONE + SESJE</div>
          <div class="panel-text">LON 8:00-11:00: szukaj sweepu low; NY 14:30-16:30: kontynuacja; Asia: mean reversion. Dostosuj SL pod zmienno≈õƒá sesyjnƒÖ.</div>
        </div>
      </div>
    </div>

    <div class="menu-panel" id="panel-execution-playbook">
      <div class="panel-grid">
        <div class="panel-card">
          <div class="panel-title">SCALP PLAN</div>
          <div class="panel-text">Wej≈õcie: 95.2k FVG. TP: 97.4k. SL: 94.2k. Wielko≈õƒá: 0.35x equity.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">INTRADAY PLAN</div>
          <div class="panel-text">Kup retrace do 95.8‚Äì96.2k je≈õli RSI 1H>45. TP1 97.4k, TP2 99k. Trailing pod EMA20 1H.</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">SWING PLAN</div>
          <div class="panel-text">Po wybiciu 98k hold do 105k, hedge 25% na perps przy spadku poni≈ºej 96k.</div>
        </div>
      </div>
    </div>

    <div class="menu-panel" id="panel-alerts-journal">
      <div class="panel-grid">
        <div class="panel-card">
          <div class="panel-title">ALERTY</div>
          <div class="panel-text">‚Ä¢ Alert: 97.4k SELL sweep
            <br>‚Ä¢ Alert: Funding > 0.012%
            <br>‚Ä¢ Alert: Net inflow ETF < +$50M</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">CHECKLIST</div>
          <div class="panel-text">[ ] Trend 1H zgodny z 4H
            <br>[ ] Funding OK
            <br>[ ] Poziomy: 95.2k/97.4k ustawione
            <br>[ ] Wielko≈õƒá pozycji ‚â§ plan</div>
        </div>
        <div class="panel-card">
          <div class="panel-title">NOTATKI</div>
          <div class="panel-text">Dodaj kr√≥tkie wnioski po trade: co zagra≈Ço, co poprawiƒá.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- SECTION HEADER WITH SENTIMENT & STATS -->
  <div class="section-header-wrapper">
    <div class="section-header">
      <div class="psych-title">STAN PSYCHOLOGICZNY ‚Ä¢ BULLS vs BEARS</div>
      <div class="psych-grid">
        <div class="psych-card">
          <div class="psych-head">BULLS <span class="psych-percent">(58%)</span></div>
          <ul class="psych-list">
            <li>Nastr√≥j: Optymistyczny</li>
            <li>Target: $98,500‚Äì$99,200</li>
            <li>Akcja: Akumulacja + hold</li>
            <li>Fear: Manipulation at $96,850</li>
            <li>Oczekiwanie: Break & Rally</li>
          </ul>
        </div>
        <div class="psych-card">
          <div class="psych-head">BEARS <span class="psych-percent">(42%)</span></div>
          <ul class="psych-list">
            <li>Nastr√≥j: Ostro≈ºny</li>
            <li>Target: $93,500‚Äì$94,800</li>
            <li>Akcja: Shorty + wait</li>
            <li>Fear: Squeeze shorts</li>
            <li>Oczekiwanie: Pullback soon</li>
          </ul>
        </div>
      </div>
      <div class="psych-note">MARKET REALITY: Dominacja BULLS, BEARS kontrolujƒÖ support. Stalemate = SCALP OPPORTUNITY! ‚Ä¢ Data: <span id="current-date">2026-01-19</span></div>
    </div>

    <div class="section-sentiment">
      <h3>SENTYMENT & STATS</h3>
      <div class="sentiment-stat">
        <span>Fear & Greed</span>
        <span>62 (Greed)</span>
      </div>
      <div class="sentiment-stat">
        <span>Funding Rate</span>
        <span>+0.0082%</span>
      </div>
      <div class="sentiment-stat">
        <span>Open Interest</span>
        <span>$12.4B</span>
      </div>
      <div class="sentiment-stat">
        <span>Dominacja BTC</span>
        <span>51.3%</span>
      </div>
      <div class="sentiment-stat">
        <span>Liquidations 24h</span>
        <span>$84M</span>
      </div>
    </div>
  </div>

  <!-- METRICS GRID (4 boxes) -->
  <div class="metrics-grid">
    <div class="metric-box">
      <div class="metric-label">CURRENT PRICE</div>
      <div class="metric-value">$98,432.50</div>
      <div class="metric-change">‚ñ≤ +2,345.80 (+2.44%)</div>
    </div>

    <div class="metric-box">
      <div class="metric-label">24H VOLUME</div>
      <div class="metric-value">$2.4B</div>
      <div class="metric-change">‚ñ≤ +12.5%</div>
    </div>

    <div class="metric-box">
      <div class="metric-label">MARKET CAP</div>
      <div class="metric-value">$1.94T</div>
      <div class="metric-change">‚ñ≤ +1.87%</div>
    </div>

    <div class="metric-box">
      <div class="metric-label">P&L TODAY</div>
      <div class="metric-value">+$842.50</div>
      <div class="metric-change">‚ñ≤ +16.85% ROI</div>
    </div>
  </div>

  <!-- LIVE NEWS + BREAKING NEWS SIDE BY SIDE -->
  <div class="news-breaking-wrapper">
    <div class="news">
      <h4>LIVE NEWS</h4>
      <div class="news-item">BTC testuje 96k, byki broniƒÖ FVG na 95.2k</div>
      <div class="news-item">ETF spot BTC: nap≈Çywy netto +$220M dzisiaj</div>
      <div class="news-item">Fed: rynek wycenia 2 ciƒôcia st√≥p w tym roku</div>
      <div class="news-item">USDT: depegging risk ~0.9985, watch closely</div>
      <div class="news-item">Whale accumulation zones: $94k-$95k active</div>
    </div>

    <!-- BREAKING NEWS -->
    <div class="breaking-news">
      <h4>BREAKING NEWS</h4>
      <div class="breaking-item">
        <div class="breaking-status breaking-red">RED HIGH</div>
        <div class="breaking-category">CRYPTO</div>
        <div>
          <div class="breaking-headline">Bitcoin Surges Past $95,000</div>
          <div class="breaking-source">Bloomberg</div>
        </div>
        <div class="breaking-time">5m temu</div>
      </div>
      <div class="breaking-item">
        <div class="breaking-status breaking-green">GREEN LOW</div>
        <div class="breaking-category">STOCKS</div>
        <div>
          <div class="breaking-headline">Apple Beats Q4 Earnings - Stock Soars</div>
          <div class="breaking-source">Reuters</div>
        </div>
        <div class="breaking-time">10m temu</div>
      </div>
      <div class="breaking-item">
        <div class="breaking-status breaking-green">GREEN LOW</div>
        <div class="breaking-category">ECONOMY</div>
        <div>
          <div class="breaking-headline">Fed Signals Patience on Rate Cuts</div>
          <div class="breaking-source">Financial Times</div>
        </div>
        <div class="breaking-time">15m temu</div>
      </div>
    </div>
  </div>

  <!-- GENIUS AI (ABOVE CHART) -->
  <div style="padding: 0 24px 15px 24px;">
    <div style="background: var(--panel); border: 1px solid var(--border); border-left: 2px solid #1a1a1a; padding: 15px;">
      <div style="color: #ffffff; font-weight: 700; margin-bottom: 15px; font-size: 1.1em; letter-spacing: 0.5px; text-transform: uppercase;">GENIUS AI ANALYSIS</div>

      <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 13px;">
        <div style="background: #0d0d0d; padding: 13px; border-left: 2px solid #333;">
          <div style="color: #ffffff; font-weight: 700; font-size: 0.89em; margin-bottom: 6px; text-transform: uppercase;">BUY SIGNAL</div>
          <div style="color: var(--gray); font-size: 0.89em; line-height: 1.5;">Strong momentum + RSI bounce from 48. Target: $97.4k</div>
        </div>

        <div style="background: #0d0d0d; padding: 13px; border-left: 2px solid #333;">
          <div style="color: #ffffff; font-weight: 700; font-size: 0.89em; margin-bottom: 6px; text-transform: uppercase;">LIQUIDITY ALERT</div>
          <div style="color: var(--gray); font-size: 0.89em; line-height: 1.5;">Major buy wall detected at $94.8k. Support confirmed.</div>
        </div>

        <div style="background: #0d0d0d; padding: 13px; border-left: 2px solid #333;">
          <div style="color: #ffffff; font-weight: 700; font-size: 0.89em; margin-bottom: 6px; text-transform: uppercase;">FVG ANALYSIS</div>
          <div style="color: var(--gray); font-size: 0.89em; line-height: 1.5;">Fair Value Gap detected. Expect retest at $95.2k zone.</div>
        </div>

        <div style="background: #0d0d0d; padding: 13px; border-left: 2px solid #333;">
          <div style="color: #ffffff; font-weight: 700; font-size: 0.89em; margin-bottom: 6px; text-transform: uppercase;">RISK WARNING</div>
          <div style="color: var(--gray); font-size: 0.89em; line-height: 1.5;">Resistance at $97.4k strong. Watch for rejection signals.</div>
        </div>
      </div>

      <div style="margin-top: 13px; padding-top: 13px; border-top: 1px solid #1a1a1a; text-align: right;">
        <span style="color: var(--gray); font-size: 0.84em;">AI Confidence: </span>
        <span style="color: #ffffff; font-weight: 700; font-size: 0.89em;">87%</span>
      </div>
    </div>
  </div>


  <!-- CHART + TRANSFERS -->
  <div style="display: grid; grid-template-columns: 1.7fr 1fr; gap: 14px; padding: 14px 24px;">
    <div>
      <!-- TIMEFRAME SELECTOR -->
      <div class="timeframe-selector">
        <button class="timeframe-btn" data-timeframe="1m">1M</button>
        <button class="timeframe-btn" data-timeframe="5m">5M</button>
        <button class="timeframe-btn" data-timeframe="15m">15M</button>
        <button class="timeframe-btn" data-timeframe="1h">1H</button>
        <button class="timeframe-btn" data-timeframe="4h">4H</button>
        <button class="timeframe-btn" data-timeframe="1d" class="active">1D</button>
        <button class="timeframe-btn" data-timeframe="1w">1W</button>
        <button class="timeframe-btn" data-timeframe="1M">1M</button>
        <button class="timeframe-btn" data-timeframe="3M">3M</button>
      </div>
      <div class="chart-box">
      <svg class="chart-svg" viewBox="0 0 800 350" preserveAspectRatio="xMidYMid meet">
        <!-- GRID -->
        <g class="chart-grid">
          <line x1="60" y1="50" x2="60" y2="300" stroke="#1a1a1a" stroke-width="1"/>
          <line x1="60" y1="300" x2="780" y2="300" stroke="#1a1a1a" stroke-width="1"/>
          <line x1="60" y1="50" x2="780" y2="50" stroke="#1a1a1a" stroke-width="1"/>
          <line x1="780" y1="50" x2="780" y2="300" stroke="#1a1a1a" stroke-width="1"/>
          
          <!-- HORIZONTAL GRID LINES -->
          <line x1="60" y1="100" x2="780" y2="100" stroke="#0a0a0a" stroke-width="0.5" opacity="0.5"/>
          <line x1="60" y1="150" x2="780" y2="150" stroke="#0a0a0a" stroke-width="0.5" opacity="0.5"/>
          <line x1="60" y1="200" x2="780" y2="200" stroke="#0a0a0a" stroke-width="0.5" opacity="0.5"/>
          <line x1="60" y1="250" x2="780" y2="250" stroke="#0a0a0a" stroke-width="0.5" opacity="0.5"/>
        </g>

        <!-- FAIR VALUE GAPS (FVG) -->
        <rect x="150" y="170" width="40" height="20" fill="rgba(0, 212, 255, 0.08)" stroke="var(--cyan)" stroke-width="0.5" stroke-dasharray="2,2" opacity="0.6"/>
        <text x="152" y="180" class="chart-label" fill="var(--cyan)" font-size="8">FVG‚Üë</text>
        
        <rect x="430" y="135" width="40" height="15" fill="rgba(255, 0, 51, 0.08)" stroke="var(--red)" stroke-width="0.5" stroke-dasharray="2,2" opacity="0.6"/>
        <text x="432" y="142" class="chart-label" fill="var(--red)" font-size="8">FVG‚Üì</text>

        <!-- LIQUIDITY GRAB ZONES -->
        <rect x="60" y="80" width="720" height="30" class="chart-liquidity" stroke="var(--green)" stroke-width="1" stroke-dasharray="3,3"/>
        <text x="65" y="92" class="chart-label" fill="var(--green)">BUY ZONE: $94.8k-$95.1k</text>
        
        <rect x="60" y="240" width="720" height="30" class="chart-liquidity" stroke="var(--red)" stroke-width="1" stroke-dasharray="3,3" fill="rgba(255, 0, 51, 0.1)"/>
        <text x="65" y="252" class="chart-label" fill="var(--red)">SELL ZONE: $96.0k-$96.3k</text>

        <!-- SUPPORT RESISTANCE LINES -->
        <line x1="60" y1="240" x2="780" y2="240" class="chart-support" stroke-width="2"/>
        <text x="680" y="235" class="chart-value" fill="var(--green)">SUPPORT $94.8k</text>
        
        <line x1="60" y1="80" x2="780" y2="80" class="chart-resistance" stroke-width="2"/>
        <text x="680" y="75" class="chart-value" fill="var(--red)">RESISTANCE $97.4k</text>

        <!-- PRICE LINE (MAIN) -->
        <polyline points="80,200 150,180 220,160 290,170 360,150 430,140 500,145 570,135 640,145 710,155 780,150" 
                  class="chart-price-line"/>

        <!-- EMA LINE 20 -->
        <polyline points="80,210 150,195 220,180 290,190 360,170 430,160 500,165 570,155 640,165 710,175 780,170" 
                  class="chart-ema" stroke="var(--cyan)"/>
        <text x="750" y="145" class="chart-label" fill="var(--cyan)">EMA 20</text>

        <!-- EMA LINE 50 -->
        <polyline points="80,220 150,205 220,195 290,200 360,185 430,175 500,180 570,170 640,180 710,190 780,185" 
                  class="chart-ema50" stroke="var(--gray)" stroke-width="1.2"/>
        <text x="750" y="160" class="chart-label" fill="var(--gray)">EMA 50</text>

        <!-- BUY SIGNALS (Large Liquidations) -->
        <circle cx="290" cy="170" r="6" class="chart-buy-signal" stroke="var(--green)" stroke-width="2"/>
        <text x="290" y="155" class="chart-label" fill="var(--green)" text-anchor="middle">BUY</text>
        <line x1="290" y1="175" x2="290" y2="300" stroke="var(--green)" stroke-width="1" stroke-dasharray="2,2" opacity="0.5"/>
        <text x="285" y="310" class="chart-label" fill="var(--green)" font-size="8">$84M Liq</text>

        <!-- SELL SIGNALS (Large Liquidations) -->
        <circle cx="640" cy="145" r="6" class="chart-sell-signal" stroke="var(--red)" stroke-width="2"/>
        <text x="640" y="130" class="chart-label" fill="var(--red)" text-anchor="middle">SELL</text>
        <line x1="640" y1="150" x2="640" y2="300" stroke="var(--red)" stroke-width="1" stroke-dasharray="2,2" opacity="0.5"/>
        <text x="635" y="310" class="chart-label" fill="var(--red)" font-size="8">$96M Liq</text>

        <!-- AXIS LABELS -->
        <text x="30" y="55" class="chart-label" fill="#888888" font-size="10">$97.4k</text>
        <text x="30" y="165" class="chart-label" fill="#888888" font-size="10">$96.0k</text>
        <text x="30" y="275" class="chart-label" fill="#888888" font-size="10">$94.8k</text>

        <!-- TIME LABELS -->
        <text x="80" y="320" class="chart-label" fill="#888888" font-size="10">1h</text>
        <text x="290" y="320" class="chart-label" fill="#888888" font-size="10">4h</text>
        <text x="500" y="320" class="chart-label" fill="#888888" font-size="10">1d</text>
        <text x="710" y="320" class="chart-label" fill="#888888" font-size="10">NOW</text>

        <!-- LEGEND -->
        <line x1="70" y1="15" x2="90" y2="15" stroke="var(--yellow)" stroke-width="2"/>
        <text x="100" y="20" class="chart-label" fill="var(--yellow)" font-size="9">PRICE</text>

        <line x1="200" y1="15" x2="220" y2="15" stroke="var(--cyan)" stroke-width="1.5" stroke-dasharray="3,3"/>
        <text x="230" y="20" class="chart-label" fill="var(--cyan)" font-size="9">EMA 20</text>

        <line x1="330" y1="15" x2="350" y2="15" stroke="var(--gray)" stroke-width="1.2" stroke-dasharray="3,3"/>
        <text x="360" y="20" class="chart-label" fill="var(--gray)" font-size="9">EMA 50</text>

        <rect x="450" y="10" width="8" height="8" fill="rgba(0, 212, 255, 0.2)" stroke="var(--cyan)" stroke-width="0.5"/>
        <text x="465" y="20" class="chart-label" fill="var(--cyan)" font-size="9">FVG</text>

        <circle cx="560" cy="15" r="3" fill="var(--green)"/>
        <text x="570" y="20" class="chart-label" fill="var(--green)" font-size="9">BUY (Liq)</text>

        <circle cx="690" cy="15" r="3" fill="var(--red)"/>
        <text x="700" y="20" class="chart-label" fill="var(--red)" font-size="9">SELL (Liq)</text>
      </svg>
    </div>

    <!-- RSI INDICATOR -->
    <div style="background: var(--panel); border: 1px solid var(--border); border-top: none; padding: 12px; height: 120px; margin-bottom: 20px;">
      <svg class="chart-svg" viewBox="0 0 800 100" preserveAspectRatio="xMidYMid meet" style="width: 100%; height: 100%;">
        <!-- RSI BACKGROUND ZONES -->
        <rect x="60" y="10" width="720" height="20" fill="rgba(255, 0, 51, 0.08)"/>
        <text x="65" y="25" class="chart-label" fill="var(--red)" font-size="10">OVERBOUGHT (70)</text>

        <rect x="60" y="70" width="720" height="20" fill="rgba(0, 255, 65, 0.08)"/>
        <text x="65" y="85" class="chart-label" fill="var(--green)" font-size="10">OVERSOLD (30)</text>

        <!-- RSI MIDLINE (50) -->
        <line x1="60" y1="45" x2="780" y2="45" stroke="#333333" stroke-width="1" stroke-dasharray="2,2" opacity="0.5"/>
        <text x="790" y="50" class="chart-label" fill="#666666" font-size="9">50</text>

        <!-- RSI LINE (wavy curve) -->
        <polyline points="80,35 150,38 220,42 290,40 360,48 430,52 500,50 570,58 640,62 710,58 780,55" 
                  stroke="var(--orange)" stroke-width="2" fill="none"/>

        <!-- RSI GRID LINES -->
        <line x1="60" y1="10" x2="780" y2="10" stroke="#1a1a1a" stroke-width="0.5"/>
        <line x1="60" y1="30" x2="780" y2="30" stroke="#0a0a0a" stroke-width="0.5" opacity="0.3"/>
        <line x1="60" y1="60" x2="780" y2="60" stroke="#0a0a0a" stroke-width="0.5" opacity="0.3"/>
        <line x1="60" y1="90" x2="780" y2="90" stroke="#1a1a1a" stroke-width="0.5"/>

        <!-- AXIS LABELS -->
        <text x="30" y="15" class="chart-label" fill="#888888" font-size="10">100</text>
        <text x="35" y="50" class="chart-label" fill="#888888" font-size="10">50</text>
        <text x="30" y="95" class="chart-label" fill="#888888" font-size="10">0</text>

        <!-- RSI VALUES -->
        <circle cx="290" cy="40" r="3" fill="var(--orange)"/>
        <text x="295" y="35" class="chart-label" fill="var(--orange)" font-size="9">RSI: 48</text>

        <circle cx="640" cy="62" r="3" fill="var(--orange)"/>
        <text x="645" y="57" class="chart-label" fill="var(--orange)" font-size="9">RSI: 62</text>
      </svg>
    </div>

    <!-- SESSION KILLZONE + SNIPER OVERLAY -->
    <div class="session-module">
      <div class="session-header">
        <span class="session-title" id="sessionTitle">Nak≈Çadka Killzone Sesji</span>
        <span class="session-timer" id="sessionTimer">≈öwieca zamyka siƒô za 02:14</span>
      </div>
      <svg class="session-svg" viewBox="0 0 860 160" preserveAspectRatio="xMidYMid meet">
        <!-- TIME AXIS -->
        <line x1="60" y1="130" x2="820" y2="130" class="session-axis"/>
        <line x1="60" y1="40" x2="820" y2="40" class="session-axis" opacity="0.3"/>
        <line x1="60" y1="85" x2="820" y2="85" class="session-axis" opacity="0.3"/>

        <!-- AUTO KILLZONES -->
        <g class="killzone-block" data-zone="asia">
          <rect id="killzoneRect-asia" x="80" y="45" width="150" height="70" class="killzone-rect killzone-asia"/>
          <text id="killzoneLabel-asia" data-role="label" x="90" y="60" class="chart-label" fill="var(--yellow)" font-size="10">Killzone Azja</text>
          <text id="killzoneTime-asia" data-role="time" x="90" y="78" class="chart-label" fill="var(--yellow)" font-size="9">01:00 - 05:00 UTC</text>
        </g>

        <g class="killzone-block" data-zone="london_open">
          <rect id="killzoneRect-london_open" x="250" y="45" width="210" height="70" class="killzone-rect killzone-london"/>
          <text id="killzoneLabel-london_open" data-role="label" x="260" y="60" class="chart-label" fill="var(--cyan)" font-size="10">Killzone Londyn</text>
          <text id="killzoneTime-london_open" data-role="time" x="260" y="78" class="chart-label" fill="var(--cyan)" font-size="9">07:30 - 10:30 UTC</text>
        </g>

        <g class="killzone-block" data-zone="ny_am">
          <rect id="killzoneRect-ny_am" x="500" y="45" width="220" height="70" class="killzone-rect killzone-ny"/>
          <text id="killzoneLabel-ny_am" data-role="label" x="510" y="60" class="chart-label" fill="var(--red)" font-size="10">Killzone Nowy Jork</text>
          <text id="killzoneTime-ny_am" data-role="time" x="510" y="78" class="chart-label" fill="var(--red)" font-size="9">12:30 - 16:00 UTC</text>
        </g>

        <g class="killzone-block" data-zone="ny_pm">
          <rect id="killzoneRect-ny_pm" x="740" y="45" width="110" height="70" class="killzone-rect killzone-ny" opacity="0.65"/>
          <text id="killzoneLabel-ny_pm" data-role="label" x="750" y="60" class="chart-label" fill="var(--red)" font-size="10">NY PM Fixing</text>
          <text id="killzoneTime-ny_pm" data-role="time" x="750" y="78" class="chart-label" fill="var(--red)" font-size="9">18:30 - 21:00 UTC</text>
        </g>

        <!-- PRICE PATH INSIDE KILLZONES -->
        <polyline points="80,105 140,96 200,88 260,92 320,86 380,82 440,84 500,78 560,82 620,90 680,96 740,100 800,94" stroke="var(--yellow)" stroke-width="2" fill="none"/>
        <circle cx="600" cy="82" r="4" fill="var(--yellow)" stroke="#000000" stroke-width="0.5"/>
        <text x="612" y="78" class="chart-label" fill="var(--yellow)" font-size="9">Impuls NY</text>

        <!-- AI PUSH NOTIFICATION -->
        <rect id="aiAlertBubble" x="600" y="15" width="220" height="58" rx="8" class="session-bubble"/>
        <polygon points="710,73 692,73 710,95" class="session-bubble-tail"/>
        <text id="aiAlertTitle" x="610" y="32" class="session-bubble-text">ALERT AI</text>
        <text id="aiAlertLine1" x="610" y="48" class="session-bubble-text" font-size="8.5">Momentum zgrywa siƒô z killzone NY.</text>
        <text id="aiAlertLine2" x="610" y="61" class="session-bubble-text" font-size="8.5">Oczekuj wybicia w ciƒÖgu 5 min.</text>

        <!-- SNIPER SIGNAL LEVELS -->
        <line x1="60" y1="110" x2="820" y2="110" class="session-sniper-line"/>
        <circle cx="600" cy="110" r="5" fill="var(--green)" stroke="#0a0a0a" stroke-width="1"/>
        <text id="sniperEntryLabel" x="612" y="105" class="chart-label" fill="var(--green)" font-size="10">Wej≈õcie Sniper 95 280</text>
        <text id="sniperTargetsLabel" x="612" y="120" class="chart-label" fill="#bbbbbb" font-size="9">Cele 96 400 / 97 400</text>
        <text id="sniperTimerLabel" x="760" y="26" class="chart-label" fill="#bbbbbb" font-size="9">Timer: 02:14</text>

        <!-- SESSION TIME MARKERS -->
        <text x="90" y="145" class="chart-label" fill="#666666" font-size="9">Sesja Azja</text>
        <text x="270" y="145" class="chart-label" fill="#666666" font-size="9">Otwarcie Londyn</text>
        <text x="520" y="145" class="chart-label" fill="#666666" font-size="9">Przed otwarciem NY</text>
        <text x="720" y="145" class="chart-label" fill="#666666" font-size="9">Fixing NY PM</text>
      </svg>

      <div class="session-footer">
        <div class="session-signal-box">
          <span class="session-label" id="sessionCurrentLabel">Sniper BTC</span>
          <span id="sniperEntryLine">Wej≈õcie: 95 280 ‚Ä¢ TP1: 96 400 ‚Ä¢ TP2: 97 400</span>
          <span id="sniperStopLine">Stop: 94 750 ‚Ä¢ Ryzyko na trade: 0.75%</span>
          <span id="sessionRecommendation" style="display: block; margin-top: 4px; color: var(--gray); font-size: 0.85em;">Rekomendacja: Pilnuj momentum NY.</span>
        </div>
        <div class="session-push-box">
          <span class="session-label" style="margin-bottom: 6px;">Powiadomienie Push</span>
          <div id="aiPushNote">Notatka AI: "Sweep p≈Çynno≈õci pokrywa siƒô z killzone NY. Przygotuj schodkowe wej≈õcia teraz." Powiadomienia wys≈Çane na desktop i mobile.</div>
          <div id="sessionUpcomingNote" style="margin-top: 6px; color: var(--gray); font-size: 0.85em;">Nastƒôpna killzone za 45 min.</div>
        </div>
      </div>
    </div>

    <div class="genius-commentary">
      <div class="genius-commentary-title">Komentarz Genius AI</div>
      <div class="genius-commentary-text">Killzony ustawione automatycznie; okno NY pokrywa siƒô z longiem Sniper, wiƒôc bias pozostaje wzrostowy, a RSI sch≈Çadza siƒô. Utrzymaj schodkowe TP na 96.4k i 97.4k, alert push ju≈º wys≈Çany.</div>
    </div>
    </div>
    
    <!-- LARGE TRANSFERS (BLOOMBERG STYLE) -->
    <div style="background: var(--panel); border: 1px solid var(--border); border-left: 2px solid #1a1a1a; padding: 12px;">
      <div style="color: #ffffff; font-weight: 700; margin-bottom: 12px; font-size: 1.05em; letter-spacing: 0.5px;">LARGE TRANSFERS</div>
      
      <div class="transfer-row" style="padding: 10px 0; border-bottom: 1px solid #1a1a1a;">
        <div>
          <div style="color: #ffffff; font-weight: 600; font-size: 0.9em;">BUY 1,250 BTC</div>
          <div style="color: var(--gray); font-size: 0.75em; margin-top: 2px;">Institutional Flow</div>
        </div>
        <div style="text-align: right;">
          <div class="pos" style="font-size: 0.95em;">$98,450</div>
          <div style="color: var(--gray); font-size: 0.75em; margin-top: 2px;">2m ago</div>
        </div>
      </div>
      
      <div class="transfer-row" style="padding: 10px 0; border-bottom: 1px solid #1a1a1a;">
        <div>
          <div style="color: #ffffff; font-weight: 600; font-size: 0.9em;">SELL 890 BTC</div>
          <div style="color: var(--gray); font-size: 0.75em; margin-top: 2px;">Whale Exit</div>
        </div>
        <div style="text-align: right;">
          <div class="neg" style="font-size: 0.95em;">$98,420</div>
          <div style="color: var(--gray); font-size: 0.75em; margin-top: 2px;">5m ago</div>
        </div>
      </div>
      
      <div class="transfer-row" style="padding: 10px 0; border-bottom: 1px solid #1a1a1a;">
        <div>
          <div style="color: #ffffff; font-weight: 600; font-size: 0.9em;">BUY 2,100 BTC</div>
          <div style="color: var(--gray); font-size: 0.75em; margin-top: 2px;">Exchange Accumulation</div>
        </div>
        <div style="text-align: right;">
          <div class="pos" style="font-size: 0.95em;">$98,435</div>
          <div style="color: var(--gray); font-size: 0.75em; margin-top: 2px;">8m ago</div>
        </div>
      </div>
      
      <div class="transfer-row" style="padding: 10px 0;">
        <div>
          <div style="color: #ffffff; font-weight: 600; font-size: 0.9em;">ICEBERG 3,200 BTC</div>
          <div style="color: var(--gray); font-size: 0.75em; margin-top: 2px;">Hidden Order Detected</div>
        </div>
        <div style="text-align: right;">
          <div style="color: var(--cyan); font-weight: 700; font-size: 0.95em;">$98,300</div>
          <div style="color: var(--gray); font-size: 0.75em; margin-top: 2px;">12m ago</div>
        </div>
      </div>
      
      <div style="margin-top: 12px; padding-top: 10px; border-top: 1px solid #1a1a1a;">
        <div style="color: var(--gray); font-size: 0.75em;">Total Volume: <span style="color: #ffffff; font-weight: 700;">7,440 BTC</span></div>
      </div>
    </div>
  </div>

  <!-- DASHBOARD TAB CONTENT (dodatkowe info) -->
  <div id="dashboard" class="tab-content">
    <h2>Dashboard ‚Ä¢ szybki podglƒÖd</h2>
    <p style="color: var(--gray);">Widok g≈Ç√≥wny jest nad menu, a tu masz notatki akcji: Radar Snajperski BTC, szybkie sygna≈Çy i mini-wykres z panelu menu.</p>
  </div>

  <!-- ON-CHAIN & FLOWS TAB -->
  <div id="onchain-flows" class="tab-content">
    <h2>On-chain & Flows</h2>
    <div class="trend-grid" style="grid-template-columns: repeat(3, 1fr);">
      <div class="trend-card">
        <h4>Stablecoin Netflow</h4>
        <p>24h: <span class="trend-up">+$180M</span></p>
        <p>Bias: popyt spot ‚Üë</p>
        <p>Watch: odwr√≥t &lt; +$50M</p>
        <div class="mini-sparkline">
          <svg viewBox="0 0 120 40" preserveAspectRatio="xMidYMid meet">
            <polyline points="5,30 25,24 45,18 65,22 85,15 105,20" fill="none" stroke="var(--green)" stroke-width="2" />
          </svg>
        </div>
      </div>
      <div class="trend-card">
        <h4>ETF Spot BTC</h4>
        <p>Dzienny nap≈Çyw: <span class="trend-up">+$220M</span></p>
        <p>5d avg: +$140M</p>
        <p>Ryzyko: <span class="trend-down">spadek &lt; +$50M</span></p>
        <div class="mini-sparkline">
          <svg viewBox="0 0 120 40" preserveAspectRatio="xMidYMid meet">
            <polyline points="5,25 25,26 45,24 65,22 85,20 105,18" fill="none" stroke="var(--yellow)" stroke-width="2" />
          </svg>
        </div>
      </div>
      <div class="trend-card">
        <h4>Exchange Flows</h4>
        <p>Net outflow: <span class="trend-up">-3.2k BTC</span></p>
        <p>Presja poda≈ºy maleje</p>
        <p>Alert: du≈ºy inflow = risk-off</p>
        <div class="mini-sparkline">
          <svg viewBox="0 0 120 40" preserveAspectRatio="xMidYMid meet">
            <polyline points="5,18 25,20 45,24 65,28 85,26 105,30" fill="none" stroke="var(--cyan)" stroke-width="2" />
          </svg>
        </div>
      </div>
    </div>
  </div>

  <!-- RISK & POSITIONING TAB -->
  <div id="risk-positioning" class="tab-content">
    <h2>Risk & Positioning</h2>
    <div class="trend-grid" style="grid-template-columns: repeat(3, 1fr);">
      <div class="trend-card">
        <h4>Funding / Skew</h4>
        <p>Funding: <span class="trend-up">+0.008%</span></p>
        <p>Skew: lekko long</p>
        <p>Alert: &gt;0.012% redukuj</p>
        <div class="mini-sparkline">
          <svg viewBox="0 0 120 40" preserveAspectRatio="xMidYMid meet">
            <polyline points="5,24 25,22 45,20 65,21 85,19 105,18" fill="none" stroke="var(--orange)" stroke-width="2" />
          </svg>
        </div>
      </div>
      <div class="trend-card">
        <h4>Open Interest</h4>
        <p>OI: $12.4B</p>
        <p>d/d: <span class="trend-up">+3%</span></p>
        <p>Brak przegrzania</p>
        <div class="mini-sparkline">
          <svg viewBox="0 0 120 40" preserveAspectRatio="xMidYMid meet">
            <polyline points="5,28 25,26 45,24 65,22 85,20 105,19" fill="none" stroke="var(--green)" stroke-width="2" />
          </svg>
        </div>
      </div>
      <div class="trend-card">
        <h4>Liquidation Map</h4>
        <p>Short liq: 97.4k</p>
        <p>Long liq: 94.8k</p>
        <p>Scenariusz: graj pod sweep short√≥w</p>
        <div class="mini-sparkline">
          <svg viewBox="0 0 120 40" preserveAspectRatio="xMidYMid meet">
            <polyline points="5,30 25,18 45,20 65,16 85,22 105,14" fill="none" stroke="var(--red)" stroke-width="2" />
          </svg>
        </div>
      </div>
    </div>
  </div>

  <!-- EXECUTION PLAYBOOK TAB -->
  <div id="execution-playbook" class="tab-content">
    <h2>Execution Playbook</h2>
    <div class="trend-grid" style="grid-template-columns: repeat(3, 1fr);">
      <div class="trend-card">
        <h4>Scalp</h4>
        <p>Entry: 95.2k (FVG)</p>
        <p>TP: 97.4k</p>
        <p>SL: 94.2k ‚Ä¢ size 0.35x</p>
        <button class="cta-btn">Ustaw alert</button>
      </div>
      <div class="trend-card">
        <h4>Intraday</h4>
        <p>Buy: 95.8‚Äì96.2k je≈õli RSI1H&gt;45</p>
        <p>TP1 97.4k, TP2 99k</p>
        <p>Trailing: EMA20 1H</p>
        <button class="cta-btn">Dodaj do playbooka</button>
      </div>
      <div class="trend-card">
        <h4>Swing</h4>
        <p>Po wybiciu 98k ‚Üí hold do 105k</p>
        <p>Hedge 25% je≈õli &lt;96k</p>
        <p>Rewizja codziennie 21:00 UTC</p>
        <button class="cta-btn">Wy≈õlij alert</button>
      </div>
    </div>
  </div>

  <!-- ALERTS & JOURNAL TAB -->
  <div id="alerts-journal" class="tab-content">
    <h2>Alerts & Journal</h2>
    <div class="trend-grid" style="grid-template-columns: repeat(3, 1fr);">
      <div class="trend-card">
        <h4>Alerty aktywne</h4>
        <p>‚Ä¢ 97.4k SELL sweep</p>
        <p>‚Ä¢ Funding &gt; 0.012%</p>
        <p>‚Ä¢ ETF inflow &lt; +$50M</p>
        <button class="cta-btn">ZarzƒÖdzaj alertami</button>
      <div class="trend-card">
        <h4>Checklist</h4>
        <p>[ ] Trend 1H zgodny z 4H</p>
        <p>[ ] Funding OK</p>
        <p>[ ] Poziomy 95.2k/97.4k ustawione</p>
      </div>
        <button class="cta-btn">Odhacz</button>
        <h4>Notatki</h4>
        <p>Zapisz po trade: co zadzia≈Ça≈Ço, co poprawiƒá, decyzje emocjonalne vs plan.</p>
      </div>
    </div>
        <button class="cta-btn">Dodaj notatkƒô</button>

  <!-- TREND ANALYSIS TAB -->
  <div id="trend-analysis" class="tab-content">
    <h2 style="color: #ffffff; margin-bottom: 14px; font-size: 1.2em; font-weight: 700; letter-spacing: 0.5px;">TREND ANALYSIS - Bitcoin</h2>
    
    <!-- MAIN TREND INDICATORS -->
    <div class="trend-grid">
      <div class="trend-card">
        <h4>MAIN TREND</h4>
        <p>Direction: <span class="trend-up">UPTREND</span></p>
        <p>Strength: <span class="trend-value">STRONG</span></p>
        <p>Status: Price above EMA 50</p>
      </div>

      <div class="trend-card">
        <h4>KEY LEVELS</h4>
        <p>Resistance: <span class="trend-value">$97,400</span></p>
        <p>Support: <span class="trend-value">$94,800</span></p>
        <p>Range: $2,600</p>
      </div>

      <div class="trend-card">
        <h4>MOMENTUM</h4>
        <p>RSI 14: <span class="trend-up">62.3</span> (Bullish)</p>
        <p>MACD: <span class="trend-up">Positive Divergence</span></p>
        <p>Volume: Above Average</p>
      </div>

      <div class="trend-card">
        <h4>SIGNAL QUALITY</h4>
        <p>Last BUY Signal: <span class="trend-up">Valid (84M Liq)</span></p>
        <p>Last SELL Signal: <span class="trend-down">Valid (96M Liq)</span></p>
        <p>Signal Accuracy: 78%</p>
      </div>

      <div class="trend-card">
        <h4>LIQUIDITY ZONES</h4>
        <p>Buy Zone: $94.8k - $95.1k</p>
        <p>Sell Zone: $96.0k - $96.3k</p>
        <p>Strength: <span class="trend-up">DEEP</span></p>
      </div>

      <div class="trend-card">
        <h4>RISK/REWARD</h4>
        <p>Risk/Reward: <span class="trend-value">1:2.5</span></p>
        <p>Stop Loss: $94,200</p>
        <p>Take Profit: $99,500</p>
      </div>

      <div class="trend-card">
        <h4>MARKET STRUCTURE</h4>
        <p>Higher Highs: <span class="trend-up">YES</span></p>
        <p>Higher Lows: <span class="trend-up">YES</span></p>
        <p>Trend Quality: <span class="trend-up">STRUCTURAL</span></p>
      </div>

      <div class="trend-card">
        <h4>TIME FRAME STATUS</h4>
        <p>1D: <span class="trend-up">UPTREND</span></p>
        <p>4H: <span class="trend-up">UPTREND</span></p>
        <p>1H: <span class="trend-neutral">CONSOLIDATING</span></p>
      </div>

      <div class="trend-card">
        <h4>NEXT TARGET</h4>
        <p>Short Term: $97,400</p>
        <p>Medium Term: $100,000</p>
        <p>Long Term: $105,000+</p>
      </div>
    </div>

    <!-- DETAILED TECHNICAL SUMMARY -->
    <div style="background: var(--panel); border: 1px solid var(--border); border-left: 2px solid #1a1a1a; padding: 14px; margin-bottom: 14px;">
      <h3 style="color: #ffffff; margin-bottom: 10px; font-weight: 700;">TECHNICAL SUMMARY</h3>
      <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 14px;">
        <div>
          <p style="color: var(--gray); margin-bottom: 8px;"><strong>BULLISH FACTORS:</strong></p>
          <ul style="list-style: none; padding-left: 0; color: var(--green); font-size: 0.9em; line-height: 1.6;">
            <li>‚úì Price above all major moving averages</li>
            <li>‚úì Higher highs and higher lows pattern</li>
            <li>‚úì RSI approaching 65 (strong momentum)</li>
            <li>‚úì Volume increasing on up moves</li>
            <li>‚úì Support holding at $94.8k level</li>
          </ul>
        </div>
        <div>
          <p style="color: var(--gray); margin-bottom: 8px;"><strong>BEARISH FACTORS:</strong></p>
          <ul style="list-style: none; padding-left: 0; color: var(--red); font-size: 0.9em; line-height: 1.6;">
            <li>! RSI above 70 (potential overbought)</li>
            <li>! Resistance at $97.4k creating cap</li>
            <li>! Large liquidations detected</li>
            <li>! Fear & Greed at 62 (moderate)</li>
            <li>! Watch for pullback to $95.5k</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- ACTION PLAN -->
    <div style="background: var(--panel); border: 1px solid var(--border); border-left: 2px solid #1a1a1a; padding: 14px;">
      <h3 style="color: #ffffff; margin-bottom: 10px; font-weight: 700;">TRADER ACTION PLAN</h3>
      <p style="color: var(--gray); margin-bottom: 8px; font-size: 0.9em;"><strong>Current Strategy:</strong> <span style="color: var(--green);">LONG BIAS</span></p>
      <ul style="list-style: none; padding-left: 0; font-size: 0.9em; line-height: 1.6;">
        <li style="color: #ffffff; margin: 6px 0;"><strong>Entry:</strong> Pullback to $95.8k - $96.2k with BUY signal</li>
        <li style="color: #ffffff; margin: 6px 0;"><strong>Stop Loss:</strong> $94,200 (break of support)</li>
        <li style="color: #ffffff; margin: 6px 0;"><strong>Take Profit 1:</strong> $97,400 (resistance break)</li>
        <li style="color: #ffffff; margin: 6px 0;"><strong>Take Profit 2:</strong> $100,000 (psychological level)</li>
        <li style="color: #ffffff; margin: 6px 0;"><strong>Watch:</strong> Large liquidation zones - reduce size if RSI > 75</li>
      </ul>
    </div>
  </div>

  <!-- KPI CORRELATION TAB (PLACEHOLDER) -->
  <div id="kpi-correlation" class="tab-content">
    <h2 style="color: #ffffff; margin-bottom: 14px; font-size: 1.2em; font-weight: 700; letter-spacing: 0.5px;">KPI CORRELATION ANALYSIS</h2>
    
    <div class="corr-wrapper">
      <div class="corr-controls">
        <span style="color: var(--gray);">Timeframe:</span>
        <button class="corr-btn active" data-corrtf="1D">1D</button>
        <button class="corr-btn" data-corrtf="1W">1W</button>
        <button class="corr-btn" data-corrtf="1M">1M</button>
        <button class="corr-btn" data-corrtf="3M">3M</button>
        <span style="margin-left: auto; color: var(--gray);">Method: Pearson</span>
      </div>

      <table class="corr-grid">
        <thead>
          <tr>
            <th>ASSET</th>
            <th>BTC</th>
            <th>ETH</th>
            <th>SOL</th>
            <th>NASDAQ</th>
            <th>GOLD</th>
            <th>DXY</th>
            <th>VIX</th>
            <th>OI</th>
            <th>FUNDING</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="corr-asset">BTC</td>
            <td class="corr-cell heat-pos-high">1.00</td>
            <td class="corr-cell heat-pos-high">0.86</td>
            <td class="corr-cell heat-pos-mid">0.64</td>
            <td class="corr-cell heat-pos-low">0.38</td>
            <td class="corr-cell heat-pos-low">0.22</td>
            <td class="corr-cell heat-neg-mid">-0.48</td>
            <td class="corr-cell heat-neg-low">-0.35</td>
            <td class="corr-cell heat-pos-mid">0.57</td>
            <td class="corr-cell heat-pos-low">0.19</td>
          </tr>
          <tr>
            <td class="corr-asset">ETH</td>
            <td class="corr-cell heat-pos-high">0.86</td>
            <td class="corr-cell heat-pos-high">1.00</td>
            <td class="corr-cell heat-pos-mid">0.68</td>
            <td class="corr-cell heat-pos-low">0.35</td>
            <td class="corr-cell heat-pos-low">0.18</td>
            <td class="corr-cell heat-neg-mid">-0.42</td>
            <td class="corr-cell heat-neg-low">-0.31</td>
            <td class="corr-cell heat-pos-mid">0.51</td>
            <td class="corr-cell heat-pos-low">0.16</td>
          </tr>
          <tr>
            <td class="corr-asset">SOL</td>
            <td class="corr-cell heat-pos-mid">0.64</td>
            <td class="corr-cell heat-pos-mid">0.68</td>
            <td class="corr-cell heat-pos-high">1.00</td>
            <td class="corr-cell heat-pos-low">0.29</td>
            <td class="corr-cell heat-pos-low">0.12</td>
            <td class="corr-cell heat-neg-low">-0.22</td>
            <td class="corr-cell heat-neg-low">-0.18</td>
            <td class="corr-cell heat-pos-low">0.28</td>
            <td class="corr-cell heat-pos-low">0.10</td>
          </tr>
          <tr>
            <td class="corr-asset">NASDAQ</td>
            <td class="corr-cell heat-pos-low">0.62</td>
            <td class="corr-cell heat-pos-low">0.59</td>
            <td class="corr-cell heat-pos-low">0.33</td>
            <td class="corr-cell heat-pos-high">1.00</td>
            <td class="corr-cell heat-pos-low">0.21</td>
            <td class="corr-cell heat-neg-mid">-0.40</td>
            <td class="corr-cell heat-neg-low">-0.28</td>
            <td class="corr-cell heat-pos-low">0.30</td>
            <td class="corr-cell heat-pos-low">0.08</td>
          </tr>
          <tr>
            <td class="corr-asset">GOLD</td>
            <td class="corr-cell heat-pos-low">0.22</td>
            <td class="corr-cell heat-pos-low">0.18</td>
            <td class="corr-cell heat-pos-low">0.12</td>
            <td class="corr-cell heat-pos-low">0.21</td>
            <td class="corr-cell heat-pos-high">1.00</td>
            <td class="corr-cell heat-neg-low">-0.26</td>
            <td class="corr-cell heat-neg-low">-0.19</td>
            <td class="corr-cell heat-pos-low">0.12</td>
            <td class="corr-cell heat-pos-low">0.05</td>
          </tr>
          <tr>
            <td class="corr-asset">DXY</td>
            <td class="corr-cell heat-neg-mid">-0.48</td>
            <td class="corr-cell heat-neg-mid">-0.42</td>
            <td class="corr-cell heat-neg-low">-0.22</td>
            <td class="corr-cell heat-neg-mid">-0.40</td>
            <td class="corr-cell heat-neg-low">-0.26</td>
            <td class="corr-cell heat-pos-high">1.00</td>
            <td class="corr-cell heat-pos-low">0.28</td>
            <td class="corr-cell heat-neg-low">-0.18</td>
            <td class="corr-cell heat-neg-low">-0.12</td>
          </tr>
          <tr>
            <td class="corr-asset">VIX</td>
            <td class="corr-cell heat-neg-low">-0.35</td>
            <td class="corr-cell heat-neg-low">-0.31</td>
            <td class="corr-cell heat-neg-low">-0.18</td>
            <td class="corr-cell heat-neg-low">-0.28</td>
            <td class="corr-cell heat-neg-low">-0.19</td>
            <td class="corr-cell heat-pos-low">0.28</td>
            <td class="corr-cell heat-pos-high">1.00</td>
            <td class="corr-cell heat-neg-low">-0.15</td>
            <td class="corr-cell heat-neg-low">-0.11</td>
          </tr>
          <tr>
            <td class="corr-asset">OI</td>
            <td class="corr-cell heat-pos-mid">0.57</td>
            <td class="corr-cell heat-pos-mid">0.51</td>
            <td class="corr-cell heat-pos-low">0.28</td>
            <td class="corr-cell heat-pos-low">0.30</td>
            <td class="corr-cell heat-pos-low">0.12</td>
            <td class="corr-cell heat-neg-low">-0.18</td>
            <td class="corr-cell heat-neg-low">-0.15</td>
            <td class="corr-cell heat-pos-high">1.00</td>
            <td class="corr-cell heat-pos-low">0.22</td>
          </tr>
          <tr>
            <td class="corr-asset">FUNDING</td>
            <td class="corr-cell heat-pos-low">0.19</td>
            <td class="corr-cell heat-pos-low">0.16</td>
            <td class="corr-cell heat-pos-low">0.10</td>
            <td class="corr-cell heat-pos-low">0.08</td>
            <td class="corr-cell heat-pos-low">0.05</td>
            <td class="corr-cell heat-neg-low">-0.12</td>
            <td class="corr-cell heat-neg-low">-0.11</td>
            <td class="corr-cell heat-pos-low">0.22</td>
            <td class="corr-cell heat-pos-high">1.00</td>
          </tr>
        </tbody>
      </table>

      <div class="corr-summary">
        <div class="corr-card">
          <h4>Top Positive</h4>
          <p>BTC‚ÄìETH: <span style="color: var(--green); font-weight:700;">0.86</span></p>
          <p>BTC‚ÄìNASDAQ: <span style="color: var(--green); font-weight:700;">0.62</span></p>
        </div>
        <div class="corr-card">
          <h4>Top Negative</h4>
          <p>BTC‚ÄìDXY: <span style="color: var(--red); font-weight:700;">-0.48</span></p>
          <p>BTC‚ÄìVIX: <span style="color: var(--red); font-weight:700;">-0.35</span></p>
        </div>
        <div class="corr-card">
          <h4>Methodology</h4>
          <p>Pearson correlation over selected timeframe. Values are demo.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- MULTI-TF ANALYSIS TAB -->
  <div id="multi-tf-analysis" class="tab-content">
    <h2 style="color: #ffffff; margin-bottom: 14px; font-size: 1.2em;">IMEFRAME ZONE ‚Ä¢ MULTI-TF ANALYSIS</h2>
    <div class="tf-wrapper">
      <div class="tf-guide">
        <h3>JAK CZYTAƒÜ WARTO≈öCI:</h3>
        <ul>
          <li>RSI: Relative Strength Index (0-100, przekupienie >70, wyprzedanie <30)</li>
          <li>MACD: Momentum ‚Ä¢ ‚Üë+ (wzrost), ‚Üì- (spadek), ‚Üí0 (neutralny)</li>
          <li>K%D: Stochastic Oscillator ‚Ä¢ K/D (szybka/wolna linia)</li>
          <li>EMA: Kierunek ≈õredniej ‚Ä¢ ‚Üë (w g√≥rƒô), ‚Üì (w d√≥≈Ç), ‚Üí (p≈Çasko)</li>
          <li>BB: Bollinger Bands ‚Ä¢ Upper/Mid/Lower (pozycja ceny)</li>
          <li>Vol: Volume ‚Ä¢ ‚ÜëHIGH, ‚ÜíMED, ‚ÜìLOW (poziom wolumenu)</li>
          <li>1m ‚Ä¢ 5m ‚Ä¢ 15m ‚Ä¢ 30m ‚Ä¢ 1h ‚Ä¢ 4h ‚Ä¢ 1d ‚Ä¢ 1M ‚Ä¢ 3M ‚Ä¢ 1Y</li>
        </ul>
      </div>
      <div class="tf-grid">
        <!-- 1m -->
        <div class="tf-card">
          <div class="tf-title">1m <span class="tf-status tf-bull">BULL</span></div>
          <div class="tf-row"><span>RSI</span><span>58</span></div>
          <div class="tf-row"><span>MACD</span><span>‚Üë+</span></div>
          <div class="tf-row"><span>K%D</span><span>72/68</span></div>
          <div class="tf-row"><span>EMA</span><span>‚Üë</span></div>
          <div class="tf-row"><span>BB</span><span>Upper</span></div>
          <div class="tf-row"><span>Vol</span><span>‚ÜëHIGH</span></div>
        </div>
        <!-- 5m -->
        <div class="tf-card">
          <div class="tf-title">5m <span class="tf-status tf-bull">BULL</span></div>
          <div class="tf-row"><span>RSI</span><span>54</span></div>
          <div class="tf-row"><span>MACD</span><span>‚Üë+</span></div>
          <div class="tf-row"><span>K%D</span><span>65/60</span></div>
          <div class="tf-row"><span>EMA</span><span>‚Üë</span></div>
          <div class="tf-row"><span>BB</span><span>Mid</span></div>
          <div class="tf-row"><span>Vol</span><span>‚ÜíMED</span></div>
        </div>
        <!-- 15m -->
        <div class="tf-card">
          <div class="tf-title">15m <span class="tf-status tf-bull">BULL</span></div>
          <div class="tf-row"><span>RSI</span><span>56</span></div>
          <div class="tf-row"><span>MACD</span><span>‚Üë+</span></div>
          <div class="tf-row"><span>K%D</span><span>58/52</span></div>
          <div class="tf-row"><span>EMA</span><span>‚Üë</span></div>
          <div class="tf-row"><span>BB</span><span>Mid</span></div>
          <div class="tf-row"><span>Vol</span><span>‚ÜíMED</span></div>
        </div>
        <!-- 30m -->
        <div class="tf-card">
          <div class="tf-title">30m <span class="tf-status tf-neutral">‚Üí NEUTRAL</span></div>
          <div class="tf-row"><span>RSI</span><span>51</span></div>
          <div class="tf-row"><span>MACD</span><span>‚Üí0</span></div>
          <div class="tf-row"><span>K%D</span><span>48/50</span></div>
          <div class="tf-row"><span>EMA</span><span>‚Üí</span></div>
          <div class="tf-row"><span>BB</span><span>Mid</span></div>
          <div class="tf-row"><span>Vol</span><span>‚ÜíMED</span></div>
        </div>
        <!-- 1h -->
        <div class="tf-card">
          <div class="tf-title">1h <span class="tf-status tf-sideways">‚Üî SIDEWAYS</span></div>
          <div class="tf-row"><span>RSI</span><span>47</span></div>
          <div class="tf-row"><span>MACD</span><span>‚Üí0</span></div>
          <div class="tf-row"><span>K%D</span><span>44/45</span></div>
          <div class="tf-row"><span>EMA</span><span>‚Üí</span></div>
          <div class="tf-row"><span>BB</span><span>Lower</span></div>
          <div class="tf-row"><span>Vol</span><span>‚ÜìLOW</span></div>
        </div>
        <!-- 4h -->
        <div class="tf-card">
          <div class="tf-title">4h <span class="tf-status tf-neutral">‚Üí NEUTRAL</span></div>
          <div class="tf-row"><span>RSI</span><span>48</span></div>
          <div class="tf-row"><span>MACD</span><span>‚Üì-</span></div>
          <div class="tf-row"><span>K%D</span><span>40/42</span></div>
          <div class="tf-row"><span>EMA</span><span>‚Üì</span></div>
          <div class="tf-row"><span>BB</span><span>Lower</span></div>
          <div class="tf-row"><span>Vol</span><span>‚ÜìLOW</span></div>
        </div>
        <!-- 1d -->
        <div class="tf-card">
          <div class="tf-title">1d <span class="tf-status tf-bear">‚úó BEAR</span></div>
          <div class="tf-row"><span>RSI</span><span>42</span></div>
          <div class="tf-row"><span>MACD</span><span>‚Üì-</span></div>
          <div class="tf-row"><span>K%D</span><span>35/38</span></div>
          <div class="tf-row"><span>EMA</span><span>‚Üì</span></div>
          <div class="tf-row"><span>BB</span><span>Lower</span></div>
          <div class="tf-row"><span>Vol</span><span>‚ÜíMED</span></div>
        </div>
        <!-- 1M -->
        <div class="tf-card">
          <div class="tf-title">1M <span class="tf-status tf-bull">BULL</span></div>
          <div class="tf-row"><span>RSI</span><span>62</span></div>
          <div class="tf-row"><span>MACD</span><span>‚Üë+</span></div>
          <div class="tf-row"><span>K%D</span><span>78/75</span></div>
          <div class="tf-row"><span>EMA</span><span>‚Üë</span></div>
          <div class="tf-row"><span>BB</span><span>Upper</span></div>
          <div class="tf-row"><span>Vol</span><span>‚ÜëHIGH</span></div>
        </div>
        <!-- 3M -->
        <div class="tf-card">
          <div class="tf-title">3M <span class="tf-status tf-bull">BULL</span></div>
          <div class="tf-row"><span>RSI</span><span>68</span></div>
          <div class="tf-row"><span>MACD</span><span>‚Üë++</span></div>
          <div class="tf-row"><span>K%D</span><span>85/82</span></div>
          <div class="tf-row"><span>EMA</span><span>‚Üë‚Üë</span></div>
          <div class="tf-row"><span>BB</span><span>Upper</span></div>
          <div class="tf-row"><span>Vol</span><span>‚ÜëHIGH</span></div>
        </div>
        <!-- 1Y -->
        <div class="tf-card">
          <div class="tf-title">1Y <span class="tf-status tf-konsol">‚óà KONSOL.</span></div>
          <div class="tf-row"><span>RSI</span><span>55</span></div>
          <div class="tf-row"><span>MACD</span><span>‚Üí0</span></div>
          <div class="tf-row"><span>K%D</span><span>52/55</span></div>
          <div class="tf-row"><span>EMA</span><span>‚Üí</span></div>
          <div class="tf-row"><span>BB</span><span>Mid</span></div>
          <div class="tf-row"><span>Vol</span><span>‚ÜìLOW</span></div>
        </div>
      </div>
    </div>

    <div style="background: var(--panel); border: 1px solid var(--border); border-left: 2px solid #1a1a1a; padding: 14px; margin-top: 14px;">
      <h3 style="color: #ffffff; margin-bottom: 8px;">üìç ENTRY ZONE CALCULATOR ‚Ä¢ DOPRECYZUJ WEJ≈öCIE</h3>
      <p style="color: var(--gray);">Live sna</p>
    </div>
  </div>

    <!-- HAMSTER GENIUS TAB (podglƒÖd sygna≈Ç√≥w) -->
    <div id="hamster-genius" class="tab-content active">
      <h2 style="margin-bottom: 12px;">Hamster Genius ‚Ä¢ sygna≈Çy + live commentary</h2>
      <div style="display: grid; grid-template-columns: 1.5fr 1fr; gap: 16px;">
        <div style="background: var(--panel); border: 1px solid var(--border); padding: 12px;">
          <div class="sparkline" style="margin-bottom: 10px;">
            <svg viewBox="0 0 360 120" preserveAspectRatio="xMidYMid meet">
              <polyline points="10,95 60,70 110,55 160,60 210,45 260,54 310,48 350,50" fill="none" stroke="var(--yellow)" stroke-width="2" />
              <circle cx="110" cy="55" r="5" fill="var(--green)" />
              <text x="92" y="38" font-size="10" fill="var(--green)">LONG 95.2k</text>
              <circle cx="260" cy="54" r="5" fill="var(--red)" />
              <text x="240" y="36" font-size="10" fill="var(--red)">TAKE PROFIT 97.4k</text>
            </svg>
          </div>
          <div id="liveCommentary" style="color: #f0f0f0; font-size: 1.05em; line-height: 1.75; min-height: 110px; letter-spacing: 0.3px; background: rgba(0, 212, 255, 0.06); border-left: 3px solid var(--cyan); padding: 14px 16px; border-radius: 4px;">
            <p style="color: var(--cyan);">Genius inicjalizuje... (≈ÇƒÖczy siƒô z API)</p>
          </div>
          <div id="geniusQuantPanel" style="margin-top: 12px; padding: 12px; border-radius: 4px; background: rgba(0, 212, 255, 0.05); border: 1px solid rgba(0, 212, 255, 0.25); color: #cce8ff; font-size: 0.85em; line-height: 1.5;">
            Quant engine inicjalizuje‚Ä¶ oczekiwanie na odpowied≈∫ API.
          </div>
        </div>
        <div style="background: #0d0d0d; border: 1px solid var(--border); padding: 12px;">
          <div style="font-weight: 700; color: #ffffff; margin-bottom: 8px;">Aktywne sygna≈Çy</div>
          <ul style="list-style: none; padding-left: 0; color: #ffffff; line-height: 1.6;">
            <li id="signalStatus">‚Ä¢ Sygna≈Ç: Oczekiwanie...</li>
            <li id="strengthStatus">‚Ä¢ Si≈Ça: Medium</li>
            <li id="btcPriceStatus">‚Ä¢ BTC: Aktualizowanie...</li>
            <li id="changeStatus">‚Ä¢ 24H: Aktualizowanie...</li>
          </ul>
          <p style="color: var(--gray); font-size: 0.9em; margin-top: 8px;">Live update co 10s; push notyfikacje na mobile przy zmianach sygna≈Çu.</p>
        </div>
      </div>
    </div>

  <script>
    // Clock updater
    const clockEl = document.getElementById('clock');
    const dateEl = document.getElementById('current-date');
    
    function updateTime() {
      const now = new Date();
      const utc = now.toISOString().split('T')[1].slice(0,8);
      clockEl.textContent = `${utc} UTC`;
      
      const dateStr = now.toISOString().split('T')[0];
      dateEl.textContent = dateStr;
    }
    
    setInterval(updateTime, 1000);
    updateTime();

    const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
    const API_BASE = isLocalhost ? 'http://localhost:5000' : window.location.origin;
    console.log(`üîå API mode: ${isLocalhost ? 'LOCALHOST' : 'PRODUCTION'} | base=${API_BASE}`);

    const killzoneClassMap = {
      london_open: 'killzone-london',
      ny_am: 'killzone-ny',
      ny_pm: 'killzone-ny',
      asia: 'killzone-asia'
    };

    const SESSION_AXIS_WIDTH = 760;

    const priorityColorMap = {
      high: 'var(--cyan)',
      medium: 'var(--yellow)',
      low: 'var(--gray)'
    };

    function restartAnimation(element) {
      if (!element) return;
      element.style.animation = 'none';
      void element.offsetWidth;
      element.style.animation = '';
    }

    function formatUsd(value, decimals = 0) {
      if (value === null || value === undefined || Number.isNaN(Number(value))) return '--';
      return Number(value).toLocaleString('en-US', {
        minimumFractionDigits: decimals,
        maximumFractionDigits: decimals
      });
    }

    function formatNumber(value, decimals = 2) {
      if (value === null || value === undefined || Number.isNaN(Number(value))) return '--';
      return Number(value).toLocaleString('en-US', {
        minimumFractionDigits: decimals,
        maximumFractionDigits: decimals
      });
    }

    function formatTickerChange(value, decimals = 2) {
      if (value === null || value === undefined || Number.isNaN(Number(value))) return '';
      const numeric = Number(value);
      const cls = numeric >= 0 ? 'up' : 'down';
      const sign = numeric >= 0 ? '+' : '';
      return `<span class="ticker-change ${cls}">${sign}${numeric.toFixed(decimals)}%</span>`;
    }

    let latestGeniusCommentary = '';
    let geniusAudioHandle = null;

    const geniusSignalEmoji = {
      BULL: 'üöÄ',
      BEAR: 'üò±',
      NEUTRAL: 'ü§î'
    };

    function safeNumberText(value, decimals = 2, fallback = '--') {
      if (typeof value !== 'number' || !Number.isFinite(value)) {
        return fallback;
      }
      return value.toFixed(decimals);
    }

    function formatStrengthLabel(strength) {
      if (!strength) return '--';
      const text = typeof strength === 'string' ? strength : String(strength);
      return text.trim().length ? text.toUpperCase() : '--';
    }

    function renderQuantPanel(report) {
      const panel = document.getElementById('geniusQuantPanel');
      if (!panel) return;

      if (!report || report.error) {
        panel.innerHTML = '<div style="color:#ff8888; font-size:0.82em;">‚ö†Ô∏è Quant engine offline ‚Äì oczekiwanie na backend.</div>';
        return;
      }

      const insights = report.insights || {};
      const perf = insights.performance || {};
      const risk = insights.risk || {};
      const ffn = insights.ffn || {};
      const options = insights.options || {};
      const warnings = Array.isArray(report.warnings) ? report.warnings : [];

      const optionKeys = Object.keys(options);
      const firstOption = optionKeys.length ? options[optionKeys[0]] : null;
      let optionPrice = null;
      if (firstOption && typeof firstOption === 'object') {
        const candidates = [
          firstOption.call_price,
          firstOption.price,
          firstOption.binomial_price,
          firstOption.value,
          firstOption.delta_call
        ];
        optionPrice = candidates.find(val => typeof val === 'number' && Number.isFinite(val)) ?? null;
      }

      const timestamp = typeof report.generated_at === 'number' && report.generated_at > 0
        ? new Date(report.generated_at * 1000).toLocaleTimeString()
        : new Date().toLocaleTimeString();

      const warningText = warnings.length
        ? `<div style="margin-top:8px; color:#ffaa55;">‚ö†Ô∏è ${warnings.slice(0, 2).join(' ‚Ä¢ ')}</div>`
        : '';

      panel.innerHTML = `
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
          <span style="color:var(--cyan); font-weight:700;">Quant Insights</span>
          <span style="color:var(--gray); font-size:0.75em;">${timestamp}</span>
        </div>
        <div style="display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:8px; font-size:0.82em; color:#ffffff;">
          <div style="background:rgba(0,255,65,0.08); border:1px solid rgba(0,255,65,0.25); padding:6px; border-radius:4px;">
            <div style="color:#9fff9f; font-weight:700;">œÉ 1d</div>
            <div>${safeNumberText(perf.daily_volatility, 3)}</div>
          </div>
          <div style="background:rgba(255,204,0,0.08); border:1px solid rgba(255,204,0,0.25); padding:6px; border-radius:4px;">
            <div style="color:#ffcc66; font-weight:700;">VaR 95%</div>
            <div>${safeNumberText(risk.value_at_risk, 4)}</div>
          </div>
          <div style="background:rgba(187,134,252,0.08); border:1px solid rgba(187,134,252,0.25); padding:6px; border-radius:4px;">
            <div style="color:#bb86fc; font-weight:700;">Sharpe*</div>
            <div>${safeNumberText(perf.sharpe_like, 2)}</div>
          </div>
        </div>
        <div style="display:flex; flex-wrap:wrap; gap:6px; margin-top:8px; font-size:0.78em;">
          ${typeof ffn.cagr === 'number' ? `<span style="background:rgba(0,212,255,0.08); border:1px solid rgba(0,212,255,0.25); padding:4px 6px; border-radius:3px; color:#00d4ff;">FFN CAGR ${(ffn.cagr * 100).toFixed(2)}%</span>` : ''}
          ${optionPrice !== null ? `<span style='background:rgba(255,0,51,0.1); border:1px solid rgba(255,0,51,0.25); padding:4px 6px; border-radius:3px; color:#ff6688;'>Option ${optionPrice.toFixed(2)}</span>` : ''}
          ${typeof perf.sortino_like === 'number' ? `<span style="background:rgba(0,255,65,0.1); border:1px solid rgba(0,255,65,0.25); padding:4px 6px; border-radius:3px; color:#7dff7d;">Sortino ${safeNumberText(perf.sortino_like, 2)}</span>` : ''}
        </div>
        ${warningText}
      `;
    }

    function applyGeniusPayload(payload) {
      if (!payload || typeof payload !== 'object') {
        renderQuantPanel(null);
        renderLiveBias(null);
        const commentEl = document.getElementById('liveCommentary');
        if (commentEl) {
          commentEl.innerHTML = '<p style="margin: 0; color: var(--gray);">Genius w trybie offline ‚Äî u≈ºyj danych demonstracyjnych.</p>';
        }
        latestGeniusCommentary = '';
        const signalEl = document.getElementById('signalStatus');
        if (signalEl) signalEl.textContent = '‚Ä¢ Sygna≈Ç: --';
        const strengthEl = document.getElementById('strengthStatus');
        if (strengthEl) strengthEl.textContent = '‚Ä¢ Si≈Ça: --';
        const btcEl = document.getElementById('btcPriceStatus');
        if (btcEl) btcEl.textContent = '‚Ä¢ BTC: --';
        const changeEl = document.getElementById('changeStatus');
        if (changeEl) changeEl.textContent = '‚Ä¢ 24H: --';
        return;
      }

      const commentary = payload.commentary || 'Brak komentarza z silnika Genius.';
      const commentEl = document.getElementById('liveCommentary');
      if (commentEl) {
        commentEl.innerHTML = `<p style="margin: 0;">${commentary}</p>`;
      }

      latestGeniusCommentary = commentary;

      const signal = (payload.signal || 'NEUTRAL').toUpperCase();
      const strength = formatStrengthLabel(payload.strength);
      const strengthScore = typeof payload.strength_score === 'number' && Number.isFinite(payload.strength_score)
        ? ` (${Math.round(payload.strength_score * 100)}%)`
        : '';

      const signalEl = document.getElementById('signalStatus');
      if (signalEl) {
        const emoji = geniusSignalEmoji[signal] || '‚Ä¢';
        signalEl.textContent = `‚Ä¢ Sygna≈Ç: ${emoji} ${signal}`;
      }

      const strengthEl = document.getElementById('strengthStatus');
      if (strengthEl) {
        strengthEl.textContent = `‚Ä¢ Si≈Ça: ${strength}${strengthScore}`;
      }

      const btcEl = document.getElementById('btcPriceStatus');
      if (btcEl) {
        const btcText = formatNumber(payload.btc_price, 0);
        btcEl.textContent = `‚Ä¢ BTC: $${btcText}`;
      }

      const changeEl = document.getElementById('changeStatus');
      if (changeEl) {
        if (typeof payload.change_24h === 'number' && Number.isFinite(payload.change_24h)) {
          const sign = payload.change_24h >= 0 ? '+' : '';
          changeEl.textContent = `‚Ä¢ 24H: ${sign}${payload.change_24h.toFixed(2)}%`;
        } else {
          changeEl.textContent = '‚Ä¢ 24H: --';
        }
      }

      renderLiveBias(payload.liveBias);
      renderQuantPanel(payload.quant);
    }

    function renderLiveBias(liveBias) {
      const container = document.getElementById('geniusLiveBias');
      if (!container) return;
      if (!liveBias || typeof liveBias !== 'object') {
        container.textContent = 'Brak aktualnych danych live-bias.';
        return;
      }

      const mtfFocus = (liveBias.mtfFocus || [])
        .map(item => {
          if (!item) return '';
          const tag = typeof item === 'string' ? item : (item.label || item.note || '');
          return tag ? `<span style="background: rgba(0,212,255,0.08); border: 1px solid rgba(0,212,255,0.25); padding: 2px 6px; margin-right: 6px; border-radius: 4px; color: var(--cyan); font-size: 0.82em;">${tag}</span>` : '';
        })
        .filter(Boolean)
        .join(' ');

      const contextNotes = (liveBias.recentContext || [])
        .map(item => {
          if (!item) return '';
          const note = typeof item === 'string' ? item : (item.note || item.label || '');
          return note ? `<li style="margin-left: 16px; font-size: 0.82em;">${note}</li>` : '';
        })
        .filter(Boolean)
        .join('');

      container.innerHTML = `
        <div style="color:#ffffff; font-weight:700; margin-bottom:4px;">Bias: ${liveBias.primaryBias?.toUpperCase() || 'N/A'} ‚Ä¢ Playbook: ${liveBias.playbook || '--'}</div>
        <div style="margin-bottom:6px;">MTF Focus: ${mtfFocus || '‚Äî'}</div>
        <div>Sentiment: ${liveBias.sentimentShift || '--'} ‚Ä¢ Wolumen: ${liveBias.volumeNote || '--'}</div>
        <div style="margin-top:4px;">Callout: ${liveBias.sessionCallout || '--'}</div>
        ${contextNotes ? `<div style="margin-top:6px; color:#ffffff; font-size:0.85em;">Ostatnie notatki:<ul style="margin-top:4px;">${contextNotes}</ul></div>` : ''}
      `;
    }

    function formatMinutesToText(minutes) {
      if (minutes === null || minutes === undefined || Number.isNaN(Number(minutes))) return '--';
      const total = Math.max(0, Math.round(Number(minutes)));
      const hours = Math.floor(total / 60);
      const mins = total % 60;
      if (hours > 0) {
        return `${hours}h ${mins}m`;
      }
      return `${mins}m`;
    }

    function minutesToPosition(minute) {
      if (minute === null || minute === undefined || Number.isNaN(Number(minute))) return 60;
      const clamped = Math.max(0, Math.min(1440, Number(minute)));
      return 60 + (clamped / 1440) * SESSION_AXIS_WIDTH;
    }

    function applyKillzoneRect(rectEl, labelEl, timeEl, zoneMeta, overlayMeta) {
      if (!rectEl || !labelEl || !timeEl) return;
      if (!zoneMeta || !overlayMeta) {
        rectEl.setAttribute('width', 0);
        labelEl.textContent = 'Brak danych';
        labelEl.setAttribute('fill', 'var(--gray)');
        timeEl.textContent = '--';
        timeEl.setAttribute('fill', 'var(--gray)');
        return;
      }

      const startX = minutesToPosition(overlayMeta.startMinute);
      const endX = minutesToPosition(overlayMeta.endMinute);
      const width = Math.max(20, endX - startX);
      rectEl.setAttribute('x', startX.toFixed(1));
      rectEl.setAttribute('width', width.toFixed(1));

      const rectClass = `killzone-rect ${killzoneClassMap[zoneMeta.name] || 'killzone-london'}`;
      rectEl.setAttribute('class', rectClass);

      const color = priorityColorMap[zoneMeta.priority] || 'var(--gray)';
      labelEl.textContent = zoneMeta.label || 'Killzone';
      labelEl.setAttribute('fill', color);
      labelEl.setAttribute('x', (startX + 10).toFixed(1));

      timeEl.textContent = `${overlayMeta.startTime} - ${overlayMeta.endTime} UTC`;
      timeEl.setAttribute('fill', color);
      timeEl.setAttribute('x', (startX + 10).toFixed(1));
    }

    function splitAiNote(note) {
      if (!note || typeof note !== 'string') {
        return ['Brak notatki', ''];
      }
      const parts = note.split(/\.|\|/).map(str => str.trim()).filter(Boolean);
      if (!parts.length) {
        return [note, ''];
      }
      const first = parts[0];
      const second = parts.slice(1).join('. ');
      return [first, second];
    }

    function buildTickerSegment(segment) {
      if (!segment || !segment.entries || !segment.entries.length) return '';
      const items = segment.entries
        .filter(Boolean)
        .map(entry => {
          if (entry.text) {
            return entry.text;
          }
          const decimals = entry.decimals ?? 2;
          const currencySymbol = entry.currencySymbol !== undefined ? entry.currencySymbol : '$';
          const priceText = entry.price !== undefined ? `${currencySymbol}${formatNumber(entry.price, decimals)}` : '';
          const changeSpan = entry.change !== undefined ? formatTickerChange(entry.change, entry.changeDecimals ?? 2) : '';
          return `${entry.symbol || ''} ${entry.prefix || ''}${priceText}${entry.suffix || ''}${changeSpan ? ` ${changeSpan}` : ''}`.trim();
        })
        .filter(Boolean);
      if (!items.length) return '';
      return `<span class="ticker-label">${segment.label}</span> ${items.join(' ‚Ä¢ ')}`;
    }

    function renderSniperTicker(data) {
      const track = document.getElementById('sniperTickerTrack');
      if (!track) return;

      const segments = [];
      const cryptoEntries = [];
      if (typeof data.btcPrice === 'number') {
        cryptoEntries.push({ symbol: 'BTC', price: data.btcPrice, change: data.btcChange24h });
      }
      if (typeof data.ethPrice === 'number') {
        cryptoEntries.push({ symbol: 'ETH', price: data.ethPrice, change: data.ethChange24h });
      }
      if (cryptoEntries.length) {
        segments.push({ label: 'CRYPTO', entries: cryptoEntries });
      }

      const stockEntries = [];
      const stocks = data.stocks || {};
      const stocksChange = data.stocksChange || {};
      Object.keys(stocks).forEach(symbol => {
        stockEntries.push({
          symbol,
          price: stocks[symbol],
          change: stocksChange[symbol],
          decimals: 2
        });
      });
      if (stockEntries.length) {
        segments.push({ label: 'AKCJE', entries: stockEntries });
      }

      const indexEntries = [];
      const indices = data.indices || {};
      const indicesChange = data.indicesChange || {};
      if (typeof indices.NASDAQ === 'number') {
        indexEntries.push({
          symbol: 'NASDAQ',
          price: indices.NASDAQ,
          change: indicesChange.NASDAQ,
          decimals: 0,
          currencySymbol: '',
          suffix: ' pkt',
          changeDecimals: 2
        });
      }
      if (typeof indices.SP500 === 'number') {
        indexEntries.push({
          symbol: 'S&P 500',
          price: indices.SP500,
          change: indicesChange.SP500,
          decimals: 0,
          currencySymbol: '',
          suffix: ' pkt',
          changeDecimals: 2
        });
      }
      if (typeof indices.DAX === 'number') {
        indexEntries.push({
          symbol: 'DAX',
          price: indices.DAX,
          change: indicesChange.DAX,
          decimals: 0,
          currencySymbol: '',
          suffix: ' pkt',
          changeDecimals: 2
        });
      }
      if (indexEntries.length) {
        segments.push({ label: 'INDEKSY', entries: indexEntries });
      }

      const sentimentEntries = [];
      if (typeof data.fearGreed === 'number') {
        sentimentEntries.push({ text: `Fear&Greed ${data.fearGreed}` });
      }
      if (typeof data.btcVolume === 'number' && data.btcVolume > 0) {
        const billions = data.btcVolume / 1e9;
        sentimentEntries.push({ text: `Wolumen $${billions.toFixed(2)}B` });
      }
      if (sentimentEntries.length) {
        segments.push({ label: 'SENTYMENT', entries: sentimentEntries });
      }

      const combined = segments
        .map(segment => buildTickerSegment(segment))
        .filter(Boolean)
        .join(' ');

      track.innerHTML = combined ? `${combined} ${combined}` : '<span class="ticker-label">INFO</span> Brak danych z API';
      restartAnimation(track);
    }

    function renderNewsTicker(headlines) {
      const newsContent = document.getElementById('newsTickerContent');
      if (!newsContent || !Array.isArray(headlines)) return;

      const items = headlines.map(item => {
        const label = item.category || 'NEWS';
        const text = item.headline || '';
        const time = item.timeAgo || '--';
        const changeClass = item.sentiment === 'bearish' ? 'down' : item.sentiment === 'bullish' ? 'up' : '';
        return `
          <div class="news-ticker-item">
            <span class="news-ticker-label">${label}</span>
            <span class="news-ticker-text">${text}</span>
            <span class="news-ticker-time ${changeClass}">${time}</span>
          </div>
        `;
      });

      newsContent.innerHTML = items.length ? `${items.join('')} ${items.join('')}` : `
        <div class="news-ticker-item">
          <span class="news-ticker-label">INFO</span>
          <span class="news-ticker-text">Brak naglowkow</span>
          <span class="news-ticker-time">--</span>
        </div>`;

      restartAnimation(newsContent);
    }

    async function updateNewsTicker() {
      try {
        const response = await fetch(`${API_BASE}/api/news/headlines`);
        if (!response.ok) return;
        const data = await response.json();
        if (data.ok) {
          renderNewsTicker(data.headlines || []);
        }
      } catch (err) {
        console.log('News API offline, pozostaje tryb demo');
      }
    }

    // HAMSTER GENIUS - Fetch live commentary from backend
    async function updateGeniusCommentary() {
      try {
        const response = await fetch(`${API_BASE}/api/genius/commentary?symbol=BTCUSDT`, { cache: 'no-store' });
        if (response.ok) {
          const payload = await response.json();
          if (payload && payload.ok) {
            applyGeniusPayload(payload);
            return;
          }
          console.warn('Genius API responded without ok flag', payload);
        } else {
          console.warn('Genius API HTTP error', response.status);
        }
      } catch (err) {
        console.log('Genius API offline, fallback in use.', err);
      }

      applyGeniusPayload(null);
    }

    // Update Genius commentary every 10 seconds
    setInterval(updateGeniusCommentary, 10000);
    updateGeniusCommentary(); // Initial call

    // TICKER BAR - Update live market data
    async function updateTickerBar() {
      try {
        const response = await fetch(`${API_BASE}/api/binance/summary`);
        if (!response.ok) return;
        const data = await response.json();
        if (data.ok) {
          renderSniperTicker(data);
        }
      } catch (err) {
        console.log('Ticker API not ready yet. Using static values.');
      }
    }

    // Update ticker every 5 seconds
    setInterval(updateTickerBar, 5000);
    updateTickerBar(); // Initial call

    // Update news ticker every 45 seconds
    setInterval(updateNewsTicker, 45000);
    updateNewsTicker();

    // UPDATE SIDEBAR with live data
    async function updateSidebar() {
      try {
        const response = await fetch(`${API_BASE}/api/binance/summary`);
        if (response.ok) {
          const data = await response.json();
          if (data.ok) {
            const btcEl = document.getElementById('sidebarBTC');
            if (btcEl) {
              btcEl.textContent = `$${data.btcPrice?.toLocaleString(undefined, {maximumFractionDigits: 2}) || '0'}`;
            }
            
            const changeColor = data.btcChange24h >= 0 ? 'color: var(--green)' : 'color: var(--red)';
            const changeEl = document.getElementById('sidebarBTCChange');
            if (changeEl) {
              changeEl.style.cssText = changeColor;
              changeEl.textContent = `${data.btcChange24h >= 0 ? '+' : ''}${data.btcChange24h?.toFixed(2) || '0'}%`;
            }
            
            const ethEl = document.getElementById('sidebarETH');
            if (ethEl) {
              ethEl.textContent = `$${data.ethPrice?.toLocaleString(undefined, {maximumFractionDigits: 2}) || '0'}`;
            }
            
            // Fear & Greed
            const fgValue = typeof data.fearGreed === 'number' ? data.fearGreed : data.fear_greed;
            const fg = fgValue !== undefined ? fgValue : '--';
            const fgNumeric = typeof fg === 'number' ? fg : null;
            const fgColor = fgNumeric !== null
              ? (fgNumeric > 70 ? 'color: var(--red)' : (fgNumeric < 30 ? 'color: var(--green)' : 'color: var(--yellow)'))
              : 'color: var(--yellow)';
            const fgEl = document.getElementById('sidebarFG');
            if (fgEl) {
              fgEl.style.cssText = fgColor;
              if (fgNumeric !== null) {
                fgEl.textContent = `${fgNumeric} ${fgNumeric > 70 ? 'üò±' : (fgNumeric < 30 ? 'üò®' : 'üòê')}`;
              } else {
                fgEl.textContent = `${fg}`;
              }
            }
            
            // Stocks
            let stocksHtml = '';
            if (data.stocks) {
              for (const [sym, price] of Object.entries(data.stocks)) {
                const change = data.stocksChange ? data.stocksChange[sym] : undefined;
                const changeNumber = typeof change === 'number' ? change : null;
                const changeColor = changeNumber !== null ? (changeNumber >= 0 ? 'var(--green)' : 'var(--red)') : 'var(--gray)';
                const changeText = changeNumber !== null ? `${changeNumber >= 0 ? '+' : ''}${changeNumber.toFixed(2)}%` : '--';
                const formattedPrice = price?.toLocaleString(undefined, {maximumFractionDigits: 2}) || '0';
                stocksHtml += `<div><strong>${sym}:</strong> $${formattedPrice} <span style="color:${changeColor}; margin-left:4px;">${changeText}</span></div>`;
                  // Update market pulse bar
                  const stockId = `stock${sym}`;
                  const stockEl = document.getElementById(stockId);
                  if (stockEl) {
                    stockEl.textContent = `$${formattedPrice}`;
                    stockEl.style.color = changeNumber !== null ? (changeNumber >= 0 ? 'var(--green)' : 'var(--red)') : 'var(--gray)';
                  }
              }
            }
            const stocksContainer = document.getElementById('sidebarStocks');
            if (stocksContainer) {
              stocksContainer.innerHTML = stocksHtml;
            }
          }
        }
      } catch (err) {
        // Offline mode - just show loading
      }
    }

    // Update sidebar every 15 seconds
    setInterval(updateSidebar, 15000);
    updateSidebar(); // Initial call

    // ===== LIVE ANALYTICS DATA UPDATE (EVERY 10 SECONDS) =====
    async function updateAnalyticsData() {
      try {
        const response = await fetch(`${API_BASE}/api/analytics`);
        if (response.ok) {
          const data = await response.json();
          if (data.ok) {
            // Update radar cards with live data
            const radar = data.radar;
            const btc = data.btc_price;
            
            // FVG ZONES
            const fvg1h = document.querySelector('[data-radar="fvg-1h"]') || createRadarDataElement('fvg-1h');
            if (fvg1h) {
              fvg1h.textContent = `1H: $${radar.fvg['1h'].low?.toLocaleString(undefined, {maximumFractionDigits: 0}) || 'N/A'}‚Äì$${radar.fvg['1h'].high?.toLocaleString(undefined, {maximumFractionDigits: 0}) || 'N/A'} (${radar.fvg['1h'].type})`;
            }

            // EQL/EQH
            document.querySelectorAll('[data-update="eql"]').forEach(el => {
              el.textContent = `$${radar.eql_eqh.eql?.toLocaleString(undefined, {maximumFractionDigits: 0}) || 'N/A'}`;
            });
            document.querySelectorAll('[data-update="eqh"]').forEach(el => {
              el.textContent = `$${radar.eql_eqh.eqh?.toLocaleString(undefined, {maximumFractionDigits: 0}) || 'N/A'}`;
            });

            // Liquidations
            document.querySelectorAll('[data-update="liq-long"]').forEach(el => {
              el.textContent = `$${radar.liquidations.long_count?.toLocaleString(undefined, {maximumFractionDigits: 0}) || 'N/A'}M`;
            });
            document.querySelectorAll('[data-update="liq-short"]').forEach(el => {
              el.textContent = `$${radar.liquidations.short_count?.toLocaleString(undefined, {maximumFractionDigits: 0}) || 'N/A'}M`;
            });

            // Signal strength
            document.querySelectorAll('[data-update="bullish"]').forEach(el => {
              el.textContent = `${radar.signal_strength.bullish?.toFixed(0) || '0'}%`;
            });
            document.querySelectorAll('[data-update="bearish"]').forEach(el => {
              el.textContent = `${radar.signal_strength.bearish?.toFixed(0) || '0'}%`;
            });

            // Flow data
            const flow = data.flow;
            document.querySelectorAll('[data-update="whale"]').forEach(el => {
              el.textContent = `+${flow.whale_accumulation?.toLocaleString() || '0'} BTC`;
            });
            document.querySelectorAll('[data-update="exchange"]').forEach(el => {
              el.textContent = `$${flow.exchange_inflows?.toLocaleString() || '0'}M`;
            });
            document.querySelectorAll('[data-update="dark-pool"]').forEach(el => {
              el.textContent = `$${flow.dark_pool_flow?.toLocaleString() || '0'}M`;
            });
            document.querySelectorAll('[data-update="long-short"]').forEach(el => {
              el.textContent = `${flow.long_short_ratio?.toFixed(2) || '0'} BULL`;
            });
          }
        }
      } catch (err) {
        console.log('Analytics API not ready yet - demo mode active');
      }
    }

    // Update analytics data every 10 seconds
    setInterval(updateAnalyticsData, 10000);
    updateAnalyticsData(); // Initial call

    // Update killzone overlay every 20 seconds
    setInterval(updateKillzoneOverlay, 20000);
    updateKillzoneOverlay();

    async function playGeniusAudio(lang) {
      const statusEl = document.getElementById('geniusAudioStatus');
      if (statusEl) {
        statusEl.textContent = 'Generujƒô audio...';
      }
      try {
        const url = new URL(`${API_BASE}/api/genius/audio`);
        if (lang) {
          url.searchParams.set('lang', lang);
        }
        const response = await fetch(url.toString());
        if (!response.ok) throw new Error('B≈ÇƒÖd API audio');
        const data = await response.json();
        if (!data.ok || !data.audioBase64) throw new Error(data.error || 'Brak audio');
        const audioSrc = `data:${data.mimeType || 'audio/mpeg'};base64,${data.audioBase64}`;
        if (geniusAudioHandle) {
          geniusAudioHandle.pause();
        }
        geniusAudioHandle = new Audio(audioSrc);
        await geniusAudioHandle.play();
        if (statusEl) {
          statusEl.textContent = `Odtwarzanie (${data.language?.toUpperCase() || '??'})`;
        }
        geniusAudioHandle.onended = () => {
          if (statusEl) statusEl.textContent = 'Gotowe';
        };
      } catch (err) {
        console.log('Audio TTS error', err);
        if (statusEl) {
          statusEl.textContent = 'B≈ÇƒÖd audio, spr√≥buj ponownie';
        }
      }
    }

    async function updateKillzoneOverlay() {
      try {
        const response = await fetch(`${API_BASE}/api/killzones/overview`);
        if (!response.ok) return;
        const data = await response.json();
        if (!data.ok) return;

        const overlayMap = {};
        (data.overlays || []).forEach(item => {
          overlayMap[item.name] = item;
        });

        const current = data.current || {};
        const upcoming = data.upcoming || null;

        const killzoneBlocks = document.querySelectorAll('.killzone-block');
        killzoneBlocks.forEach(block => {
          const zoneName = block.getAttribute('data-zone');
          const rectEl = block.querySelector('.killzone-rect');
          const labelEl = block.querySelector('[data-role="label"]');
          const timeEl = block.querySelector('[data-role="time"]');
          const zoneMeta = overlayMap[zoneName];
          applyKillzoneRect(rectEl, labelEl, timeEl, zoneMeta, zoneMeta);
          block.classList.remove('killzone-active', 'killzone-upcoming');
          if (current && current.name === zoneName) {
            block.classList.add('killzone-active');
          }
          if (upcoming && upcoming.name === zoneName) {
            block.classList.add('killzone-upcoming');
          }
        });

        const timerText = data.sessionClock?.timerText || '--:--';
        const sessionTimerEl = document.getElementById('sessionTimer');
        if (sessionTimerEl) {
          sessionTimerEl.textContent = `≈öwieca zamyka siƒô za ${timerText}`;
        }

        const sessionTitleEl = document.getElementById('sessionTitle');
        if (sessionTitleEl) {
          sessionTitleEl.textContent = current.label ? `Nak≈Çadka Killzone ‚Ä¢ ${current.label}` : 'Nak≈Çadka Killzone Sesji';
        }

        const sniperTimerLabel = document.getElementById('sniperTimerLabel');
        if (sniperTimerLabel) {
          sniperTimerLabel.textContent = `Timer: ${timerText}`;
        }

        const sniper = data.sniper || {};
        const entry = sniper.entry !== undefined && sniper.entry !== null ? `$${formatUsd(sniper.entry)}` : '--';
        const tp1 = sniper.targets && sniper.targets[0] !== undefined ? `$${formatUsd(sniper.targets[0])}` : '--';
        const tp2 = sniper.targets && sniper.targets[1] !== undefined ? `$${formatUsd(sniper.targets[1])}` : '--';
        const stop = sniper.stop !== undefined && sniper.stop !== null ? `$${formatUsd(sniper.stop)}` : '--';

        const sniperEntryLabel = document.getElementById('sniperEntryLabel');
        if (sniperEntryLabel) {
          sniperEntryLabel.textContent = entry !== '--' ? `Wej≈õcie Sniper ${entry}` : 'Wej≈õcie Sniper --';
        }

        const sniperTargetsLabel = document.getElementById('sniperTargetsLabel');
        if (sniperTargetsLabel) {
          sniperTargetsLabel.textContent = (tp1 !== '--' || tp2 !== '--') ? `Cele ${tp1} / ${tp2}` : 'Cele --';
        }

        const sessionLabel = document.getElementById('sessionCurrentLabel');
        if (sessionLabel) {
          const biasLabel = sniper.bias ? sniper.bias.toUpperCase() : 'NEUTRAL';
          sessionLabel.textContent = `Sniper BTC ‚Ä¢ ${biasLabel}`;
        }

        const sniperEntryLine = document.getElementById('sniperEntryLine');
        if (sniperEntryLine) {
          sniperEntryLine.textContent = `Wej≈õcie: ${entry} ‚Ä¢ TP1: ${tp1} ‚Ä¢ TP2: ${tp2}`;
        }

        const sniperStopLine = document.getElementById('sniperStopLine');
        if (sniperStopLine) {
          const biasReadable = sniper.bias === 'bearish' ? 'Bearish' : sniper.bias === 'bullish' ? 'Bullish' : 'Neutral';
          sniperStopLine.textContent = `Stop: ${stop} ‚Ä¢ Bias: ${biasReadable}`;
        }

        const sessionRecommendation = document.getElementById('sessionRecommendation');
        if (sessionRecommendation) {
          sessionRecommendation.textContent = `Rekomendacja: ${current.recommendation || 'Monitoruj rynek.'}`;
        }

        const aiPushNote = document.getElementById('aiPushNote');
        if (aiPushNote) {
          aiPushNote.textContent = `Notatka AI: ${data.aiNote || 'Brak informacji.'}`;
        }

        const sessionUpcomingNote = document.getElementById('sessionUpcomingNote');
        if (sessionUpcomingNote) {
          if (upcoming && typeof upcoming.minutesUntilStart === 'number') {
            sessionUpcomingNote.textContent = `Nastƒôpna killzone (${upcoming.label}) za ${formatMinutesToText(upcoming.minutesUntilStart)}`;
          } else {
            sessionUpcomingNote.textContent = 'Brak kolejnej killzone dzi≈õ.';
          }
        }

        const [alertLine1, alertLine2] = splitAiNote(data.aiNote);
        const aiAlertLine1 = document.getElementById('aiAlertLine1');
        const aiAlertLine2 = document.getElementById('aiAlertLine2');
        if (aiAlertLine1) aiAlertLine1.textContent = alertLine1;
        if (aiAlertLine2) aiAlertLine2.textContent = alertLine2 || 'Monitoruj Sniper i RSI.';

      } catch (err) {
        console.log('Killzone API offline, tryb statyczny');
      }
    }

    const geniusAudioBtn = document.getElementById('geniusAudioPlay');
    const geniusAudioLang = document.getElementById('geniusAudioLang');
    if (geniusAudioBtn) {
      geniusAudioBtn.addEventListener('click', () => {
        const lang = geniusAudioLang ? geniusAudioLang.value : 'pl';
        playGeniusAudio(lang);
      });
    }

    // ===== NEW: HAMBURGER MENU TOGGLE =====
    const hamburgerMenu = document.getElementById('hamburgerMenu');
    const menuBar = document.querySelector('.menu-bar');
    const hamburgerExtra = document.querySelector('.hamburger-extra');

    if (hamburgerMenu) {
      hamburgerMenu.addEventListener('click', () => {
        hamburgerMenu.classList.toggle('open');
        if (menuBar) menuBar.style.display = menuBar.style.display === 'none' ? 'flex' : 'none';
        if (hamburgerExtra) hamburgerExtra.style.display = hamburgerExtra.style.display === 'none' ? 'block' : 'none';
      });
    }

    // ===== ANALYTICS BOTTOM PANEL TOGGLE (RADAR) =====
    const analyticsBtn = document.getElementById('analyticsBtn');
    const analyticsPanel = document.getElementById('analyticsPanel');

    if (analyticsBtn && analyticsPanel) {
      analyticsBtn.addEventListener('click', () => {
        analyticsBtn.classList.toggle('open');
        analyticsPanel.classList.toggle('open');
        // Close drawer if open
        if (analyticsDrawer.classList.contains('open')) {
          analyticsDrawer.classList.remove('open');
          drawerBtn.classList.remove('open');
        }
      });
    }

    // ===== ANALYTICS SIDE DRAWER TOGGLE (ADVANCED OPTIONS) =====
    const drawerBtn = document.getElementById('drawerBtn');
    const analyticsDrawer = document.getElementById('analyticsDrawer');
    const closeDrawer = document.getElementById('closeDrawer');

    if (drawerBtn && analyticsDrawer) {
      drawerBtn.addEventListener('click', () => {
        drawerBtn.classList.toggle('open');
        analyticsDrawer.classList.toggle('open');
        // Close bottom panel if open
        if (analyticsPanel.classList.contains('open')) {
          analyticsPanel.classList.remove('open');
          analyticsBtn.classList.remove('open');
        }
      });
    }

    if (closeDrawer && analyticsDrawer) {
      closeDrawer.addEventListener('click', () => {
        analyticsDrawer.classList.remove('open');
        drawerBtn.classList.remove('open');
      });
    }

    // ===== DRAWER TABS SWITCHER =====
    const drawerTabs = document.querySelectorAll('.drawer-tab');
    const heatmapsContent = document.getElementById('heatmapsContent');
    const flowContent = document.getElementById('flowContent');
    const unusualContent = document.getElementById('unusualContent');

    drawerTabs.forEach(tab => {
      tab.addEventListener('click', () => {
        // Remove active from all tabs
        drawerTabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');

        // Hide all content
        heatmapsContent.style.display = 'none';
        flowContent.style.display = 'none';
        unusualContent.style.display = 'none';

        // Show selected
        const tabName = tab.dataset.tab;
        if (tabName === 'heatmaps') heatmapsContent.style.display = 'block';
        if (tabName === 'flow') flowContent.style.display = 'block';
        if (tabName === 'unusual') unusualContent.style.display = 'block';
      });
    });

    // Hamburger toggle for menu
    const navWrapper = document.getElementById('navWrapper');
    const hamburgerBtn = document.getElementById('hamburgerToggle');
    let navUserToggled = false;

    function collapseForWidth() {
      if (navUserToggled) return;
      if (window.innerWidth < 1100) {
        navWrapper?.classList.add('collapsed');
      } else {
        navWrapper?.classList.remove('collapsed');
      }
    }

    if (hamburgerBtn && navWrapper) {
      hamburgerBtn.addEventListener('click', () => {
        navWrapper.classList.toggle('collapsed');
        hamburgerBtn.classList.toggle('open');
        navUserToggled = true;
      });
    }

    collapseForWidth();
    window.addEventListener('resize', collapseForWidth);

    // Timeframe selector
    document.querySelectorAll('.timeframe-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        // Remove active class from all buttons
        document.querySelectorAll('.timeframe-btn').forEach(b => b.classList.remove('active'));
        // Add active class to clicked button
        this.classList.add('active');
        
        const timeframe = this.getAttribute('data-timeframe');
        console.log(`Switched to timeframe: ${timeframe}`);
        // Here you would reload chart data based on selected timeframe
        // Example: loadChartData(timeframe);
      });
    });
    
    // Set initial active button (1D is already marked as active in HTML)
    const initialActive = document.querySelector('.timeframe-btn.active');
    if (initialActive) {
      initialActive.classList.add('active');
    }

    // TAB FUNCTIONALITY (toggle open/close + scroll to top)
    let currentTab = null;
    function hideAllTabs() {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
      document.querySelectorAll('.menu-panel').forEach(panel => panel.classList.remove('active'));
    }

    function showTab(tabName, clickedBtn) {
      const selectedTab = document.getElementById(tabName);
      const isAlreadyActive = selectedTab?.classList.contains('active');

      if (isAlreadyActive) {
        hideAllTabs();
        currentTab = null;
        return;
      }

      hideAllTabs();
      if (selectedTab) selectedTab.classList.add('active');
      if (clickedBtn) clickedBtn.classList.add('active');
      const menuPanel = document.getElementById(`panel-${tabName}`);
      if (menuPanel) menuPanel.classList.add('active');
      currentTab = tabName;
      
      // Scroll to very top
      window.scrollTo({ top: 0, behavior: 'smooth' });
      // Force scroll after short delay
      setTimeout(() => window.scrollTo(0, 0), 100);
    }

    // Attach click handlers to menu items with data-tab attribute
    document.querySelectorAll('[data-tab]').forEach(btn => {
      btn.addEventListener('click', function(e) {
        e.preventDefault();
        const tabName = this.getAttribute('data-tab');
        showTab(tabName, this);
      });
    });

    // Init default panel
    const defaultBtn = document.querySelector('.menu-item.active');
    if (defaultBtn) {
      showTab(defaultBtn.getAttribute('data-tab'), defaultBtn);
    }

    // Correlation timeframe buttons
    document.querySelectorAll('.corr-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.corr-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        console.log('Correlation timeframe:', this.getAttribute('data-corrtf'));
      });
    });

    // ===== LEFT TOOLS DRAWER INTERACTIONS =====
    const toolsDrawer = document.getElementById('toolsDrawer');
    const toolsHandle = document.getElementById('toolsHandle');
    const drawerWidth = 320; // must match CSS width
    let dragging = false;
    let startX = 0;

    function openToolsDrawer() {
      toolsDrawer?.classList.add('open');
      toolsDrawer?.setAttribute('aria-hidden', 'false');
    }
    function closeToolsDrawer() {
      toolsDrawer?.classList.remove('open');
      toolsDrawer?.setAttribute('aria-hidden', 'true');
      toolsDrawer?.style.transform = '';
    }
    function toggleToolsDrawer() {
      if (!toolsDrawer) return;
      if (toolsDrawer.classList.contains('open')) closeToolsDrawer(); else openToolsDrawer();
    }

    // Click on handle toggles
    toolsHandle?.addEventListener('click', toggleToolsDrawer);

    // Mouse drag from handle
    toolsHandle?.addEventListener('mousedown', (e) => {
      dragging = true; startX = e.clientX; toolsDrawer.style.transition = 'none';
      document.body.style.userSelect = 'none';
    });
    window.addEventListener('mousemove', (e) => {
      if (!dragging || !toolsDrawer) return;
      const dx = e.clientX - startX;
      const clamped = Math.max(0, Math.min(drawerWidth, dx));
      toolsDrawer.style.transform = `translateX(${-drawerWidth + clamped}px)`;
    });
    window.addEventListener('mouseup', (e) => {
      if (!dragging || !toolsDrawer) return;
      dragging = false; toolsDrawer.style.transition = '';
      document.body.style.userSelect = '';
      const dx = e.clientX - startX;
      if (dx > drawerWidth * 0.35) openToolsDrawer(); else closeToolsDrawer();
    });

    // Touch swipe from left edge
    window.addEventListener('touchstart', (e) => {
      const t = e.touches[0];
      if (t.clientX < 20) { dragging = true; startX = t.clientX; toolsDrawer && (toolsDrawer.style.transition = 'none'); }
    }, { passive: true });
    window.addEventListener('touchmove', (e) => {
      if (!dragging || !toolsDrawer) return;
      const t = e.touches[0];
      const dx = t.clientX - startX;
      const clamped = Math.max(0, Math.min(drawerWidth, dx));
      toolsDrawer.style.transform = `translateX(${-drawerWidth + clamped}px)`;
    }, { passive: true });
    window.addEventListener('touchend', (e) => {
      if (!dragging || !toolsDrawer) return;
      dragging = false; toolsDrawer.style.transition = '';
      const dx = (e.changedTouches[0]?.clientX || startX) - startX;
      if (dx > drawerWidth * 0.35) openToolsDrawer(); else closeToolsDrawer();
    });

    // Quick calc action
    const calcRun = document.getElementById('calcRun');
    calcRun?.addEventListener('click', () => {
      const r = parseFloat(document.getElementById('calcRisk').value) || 1.0;
      const eP = parseFloat(document.getElementById('calcEntry').value) || 0;
      const sL = parseFloat(document.getElementById('calcSL').value) || 0;
      const acc = parseFloat(document.getElementById('calcSize').value) || 0;
      const riskAmt = acc * (r / 100.0);
      const perUnitRisk = Math.abs(eP - sL);
      const qty = perUnitRisk > 0 ? (riskAmt / perUnitRisk) : 0;
      document.getElementById('calcResult').textContent = `Position: ${riskAmt.toFixed(2)} | Qty: ${qty.toFixed(6)}`;
    });
  </script>
</body>
</html>
