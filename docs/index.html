<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Hamster Terminal - Bloomberg Clean with API</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --orange: #ff8c00;
      --burgundy: #800020;
      --black: #000000;
      --panel: #0a0a0a;
      --border: #1a1a1a;
      --green: #00ff41;
      --red: #ff0033;
      --yellow: #ffff00;
      --cyan: #00d4ff;
      --gray: #bdbdbd;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Roboto Mono', monospace;
      background: var(--black);
      color: #ffffff;
      line-height: 1.4;
      padding-bottom: 40px;
    }

    /* THEME SWITCHER */
    .theme-switcher {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 999;
      background: rgba(10, 10, 10, 0.95);
      border: 1px solid #1a1a1a;
      border-radius: 4px;
      padding: 8px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .switcher-group {
      display: flex;
      flex-direction: row;
      gap: 3px;
    }
    .theme-btn, .page-btn {
      background: #0d0d0d;
      border: 1px solid #333;
      color: #ffffff;
      padding: 6px 10px;
      margin: 0;
      cursor: pointer;
      font-size: 0.75em;
      font-weight: 600;
      border-radius: 3px;
      transition: all 0.2s;
    }
    .theme-btn:hover, .page-btn:hover { background: #1a1a1a; border-color: #666; }
    .theme-btn.active, .page-btn.active { background: var(--orange); color: #000000; border-color: var(--orange); }
    .switcher-label {
      color: #666;
      font-size: 0.7em;
      text-transform: uppercase;
      padding: 2px 5px;
      font-weight: 700;
      letter-spacing: 0.5px;
    }

    /* BLOOMBERG HEADER */
    .header {
      background: var(--orange);
      color: #000000;
      padding: 14px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-weight: 700;
      letter-spacing: 1px;
      font-size: 1.1em;
    }
    .header-left { display: flex; gap: 20px; align-items: center; }
    .header-time { font-size: 1em; font-weight: 600; }
    .api-status {
      font-size: 0.85em;
      padding: 4px 8px;
      background: rgba(0,0,0,0.1);
      border-radius: 3px;
    }
    .api-status.live { color: #00ff41; }
    .api-status.loading { color: #ffff00; }
    .api-status.error { color: #ff0033; }

    /* BURGUNDY MENU BAR */
    .menu-bar {
      display: flex;
      gap: 8px;
      padding: 10px 24px;
      background: var(--burgundy);
      border-bottom: 1px solid var(--border);
    }
    .menu-item {
      background: transparent;
      border: 1px solid transparent;
      color: #ffffff;
      padding: 8px 14px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.2s, border-color 0.2s;
      font-size: 0.95em;
    }
    .menu-item.active { background: #b0303c; border-color: #d44a5c; }
    .menu-item:hover { opacity: 0.9; }

    /* SECTION HEADER WITH SENTIMENT */
    .section-header-wrapper {
      display: grid;
      grid-template-columns: 1.5fr 1fr;
      gap: 14px;
      padding: 14px 24px 2px 24px;
      margin-bottom: 0;
    }
    .section-header {
      background: var(--panel);
      padding: 10px 15px;
      border-left: 2px solid #1a1a1a;
    }
    .section-title {
      font-size: 0.95em;
      font-weight: 700;
      color: #ffffff;
    }
    .section-subtitle {
      font-size: 0.8em;
      color: #333333;
      margin-top: 3px;
    }
    .section-sentiment {
      background: var(--panel);
      padding: 10px 15px;
      border-left: 2px solid #1a1a1a;
    }
    .section-sentiment h3 {
      font-size: 1.05em;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 8px;
      letter-spacing: 0.8px;
      text-transform: uppercase;
    }
    .sentiment-stat {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      font-size: 1em;
      font-weight: 600;
    }
    .stat-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 4px 0;
    }
    .stat-label { color: #ffffff; }
    .stat-value { color: #ffffff; font-size: 1.1em; }

    /* TICKER */
    .ticker-container {
      background: var(--panel);
      border: 1px solid var(--border);
      padding: 8px 0;
      overflow: hidden;
      margin: 0 24px 14px 24px;
    }
    .ticker {
      display: flex;
      animation: ticker 30s linear infinite;
      gap: 40px;
      padding: 0 24px;
    }
    .ticker-item {
      white-space: nowrap;
      font-size: 0.9em;
    }
    .ticker-label {
      color: #ffffff;
      font-weight: 700;
    }
    @keyframes ticker {
      0% { transform: translateX(40%); }
      100% { transform: translateX(-120%); }
    }

    /* NEWS */
    .news {
      background: var(--panel);
      border: 1px solid var(--border);
      padding: 12px;
    }
    .news h4 {
      color: #ffffff;
      margin-bottom: 10px;
      font-size: 1.15em;
      font-weight: 700;
      letter-spacing: 0.8px;
      text-transform: uppercase;
    }
    .news-item {
      font-size: 1em;
      margin-bottom: 7px;
      padding: 5px 0;
      border-bottom: 1px solid #1a1a1a;
      line-height: 1.6;
    }
    .news-item:last-child { border-bottom: none; }

    /* BREAKING NEWS */
    .breaking-news {
      background: var(--panel);
      border: 1px solid var(--border);
      padding: 12px;
    }
    .news-breaking-wrapper {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      padding: 0 24px 12px 24px;
    }
    .breaking-news h4 {
      color: #ffffff;
      margin-bottom: 12px;
      font-size: 1.15em;
      font-weight: 700;
      letter-spacing: 1.5px;
      text-transform: uppercase;
    }
    .breaking-item {
      display: grid;
      grid-template-columns: 0.8fr 1fr 1.2fr 0.7fr;
      gap: 10px;
      padding: 10px 8px;
      border-bottom: 1px solid #1a1a1a;
      font-size: 0.95em;
      align-items: center;
      line-height: 1.5;
    }
    .breaking-item:last-child { border-bottom: none; }
    .breaking-status {
      font-weight: 700;
      text-transform: uppercase;
      font-size: 0.85em;
      letter-spacing: 0.5px;
    }
    .breaking-category {
      font-weight: 700;
      color: var(--gray);
      font-size: 0.9em;
    }
    .breaking-source {
      color: var(--gray);
      font-size: 0.85em;
    }
    .breaking-headline {
      color: #ffffff;
      font-weight: 600;
      font-size: 1em;
    }
    .breaking-time {
      color: var(--gray);
      text-align: right;
      font-size: 0.8em;
    }

    /* BTC/ETH CARDS */
    .top-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px;
      padding: 14px 24px;
    }
    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      padding: 14px;
    }
    .card h3 {
      color: #ffffff;
      font-size: 1em;
      margin-bottom: 6px;
    }
    .price {
      font-size: 2.4em;
      font-weight: 700;
      color: #ffffff;
    }
    .change {
      font-weight: 700;
      color: #ffffff;
    }
    .stat-row {
      display: flex;
      justify-content: space-between;
      font-size: 0.9em;
      color: var(--gray);
      margin-top: 8px;
    }

    /* MAIN GRID */
    .main-grid {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 14px;
      padding: 14px 24px;
    }
    .chart-panel {
      background: var(--panel);
      border: 1px solid var(--border);
      border-left: 2px solid #1a1a1a;
      padding: 14px;
    }
    .transfers-panel {
      background: var(--panel);
      border: 1px solid var(--border);
      border-left: 2px solid #1a1a1a;
      padding: 14px;
    }

    /* GENIUS AI */
    .genius-ai {
      background: var(--panel);
      border: 1px solid var(--border);
      border-left: 2px solid #1a1a1a;
      padding: 14px;
      margin: 0 24px 14px 24px;
    }
    .genius-ai-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
    }
    .genius-card {
      background: #0d0d0d;
      padding: 12px;
      border-left: 2px solid #333;
      border-radius: 3px;
    }
    .genius-card-title {
      color: #ffffff;
      font-weight: 700;
      font-size: 0.85em;
      margin-bottom: 6px;
      text-transform: uppercase;
    }
    .genius-card-content {
      color: var(--gray);
      font-size: 0.85em;
      line-height: 1.5;
    }

    /* TABS */
    .tab-content { display: none; }
    .tab-content.active { display: block; }

    /* VISUAL DARK PAGE */
    #visual-dark-page { scrollbar-width: thin; scrollbar-color: #333 #0a0a0a; }
    #visual-dark-page::-webkit-scrollbar { width: 6px; }
    #visual-dark-page::-webkit-scrollbar-track { background: #0a0a0a; }
    #visual-dark-page::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }

    /* RESPONSIVE */
    @media (max-width: 1200px) {
      .top-grid { grid-template-columns: repeat(2, 1fr); }
      .main-grid { grid-template-columns: 1fr; }
      .genius-ai-grid { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 768px) {
      .top-grid { grid-template-columns: 1fr; }
      .genius-ai-grid { grid-template-columns: 1fr; }
      .header { flex-direction: column; gap: 10px; align-items: flex-start; }
      .theme-switcher { position: static; margin: 10px; }
      .switcher-group { flex-direction: column; }
      #visual-dark-page { padding: 10px; }
    }
  </style>
</head>
<body>

  <!-- THEME & PAGE SWITCHER -->
  <div class="theme-switcher">
    <div class="switcher-label">MODES</div>
    <div class="switcher-group">
      <button class="page-btn active" onclick="switchPage('bloomberg')">Bloomberg</button>
      <button class="page-btn" onclick="switchPage('detailed')">Detailed Mode</button>
    </div>
  </div>

  <!-- HEADER -->
  <div class="header">
    <div class="header-left">
      <div>HAMSTER TERMINAL | BTC USD Crypto</div>
      <div class="api-status loading" id="api-status">Loading API...</div>
    </div>
    <div class="header-time">
      <span id="clock">00:00:00 UTC</span>
    </div>
  </div>

  <!-- MENU -->
  <div class="menu-bar">
    <button class="menu-item active" onclick="switchTab('dashboard')">Dashboard</button>
    <button class="menu-item" onclick="switchTab('trend-analysis')">Trend Analysis</button>
    <button class="menu-item" onclick="switchTab('kpi-correlation')">KPI Correlation</button>
    <button class="menu-item" onclick="switchTab('multi-tf-analysis')">Multi-TF Analysis</button>
  </div>

  <!-- PSYCHOLOGY SECTION -->
  <div class="section-header-wrapper">
    <div class="section-header">
      <div class="section-title">MARKET STATUS</div>
      <div class="section-subtitle">Real-time market sentiment analysis</div>
    </div>
    <div class="section-sentiment">
      <h3>BULLS vs BEARS</h3>
      <div class="sentiment-stat">
        <div class="stat-item">
          <span class="stat-label">BULLS:</span>
          <span class="stat-value" id="bulls-percent">58%</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">BEARS:</span>
          <span class="stat-value" id="bears-percent">42%</span>
        </div>
      </div>
    </div>
  </div>

  <!-- METRICS -->
  <div class="top-grid">
    <div class="card">
      <h3>CURRENT PRICE</h3>
      <div class="price" id="btc-price">$0.00</div>
      <div class="stat-row">
        <span>24H Change</span>
        <span class="change" id="btc-change">+0.00%</span>
      </div>
    </div>
    <div class="card">
      <h3>24H VOLUME</h3>
      <div class="price" id="btc-volume">$0.0B</div>
      <div class="stat-row">
        <span>Circulating</span>
        <span>21M BTC</span>
      </div>
    </div>
    <div class="card">
      <h3>MARKET CAP</h3>
      <div class="price" id="market-cap">$0.0T</div>
      <div class="stat-row">
        <span>BTC Dominance</span>
        <span id="btc-dom">42%</span>
      </div>
    </div>
    <div class="card">
      <h3>FEAR & GREED</h3>
      <div class="price" id="fear-greed">--</div>
      <div class="stat-row">
        <span>Market Sentiment</span>
        <span id="fng-label">--</span>
      </div>
    </div>
  </div>

  <!-- TICKER -->
  <div class="ticker-container">
    <div class="ticker">
      <div class="ticker-item">
        <span class="ticker-label">BTC/USD:</span> <span id="ticker-btc">$0</span>
      </div>
      <div class="ticker-item">
        <span class="ticker-label">ETH/USD:</span> <span id="ticker-eth">$0</span>
      </div>
      <div class="ticker-item">
        <span class="ticker-label">SPY:</span> <span id="ticker-spy">$0</span>
      </div>
      <div class="ticker-item">
        <span class="ticker-label">GOLD:</span> <span id="ticker-gold">$0</span>
      </div>
      <div class="ticker-item">
        <span class="ticker-label">EUR/USD:</span> <span id="ticker-eur">$0</span>
      </div>
    </div>
  </div>

  <!-- NEWS SECTIONS -->
  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 14px; padding: 0 24px 14px 24px;">
    <div class="news">
      <h4>LIVE NEWS</h4>
      <div class="news-item">BTC consolidating around $98.5k support level</div>
      <div class="news-item">Ethereum breaking above $3.8k resistance</div>
      <div class="news-item">Fed policy meeting scheduled for next week</div>
      <div class="news-item">AI stocks rallying on earnings beat</div>
      <div class="news-item">Crypto market volume increasing steadily</div>
    </div>
    <div class="news">
      <h4>MARKET ALERTS</h4>
      <div class="news-item">Major liquidation zone at $97.2k identified</div>
      <div class="news-item">Bitcoin funding rates elevated - caution advised</div>
      <div class="news-item">Large transfer detected: 1,250 BTC moved</div>
      <div class="news-item">DXY approaching key resistance level</div>
      <div class="news-item">Gold futures gaining on market uncertainty</div>
    </div>
  </div>

  <!-- CHART & TRANSFERS -->
  <div class="main-grid">
    <div class="chart-panel">
      <div style="color: #ffffff; font-weight: 700; margin-bottom: 12px; font-size: 1.05em;">PRICE CHART - 1H TIMEFRAME</div>
      <svg width="100%" height="300" viewBox="0 0 800 300" style="background: #050505; border-radius: 4px;">
        <defs>
          <linearGradient id="chartGrad" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" style="stop-color:#ff8c00;stop-opacity:0.2" />
            <stop offset="100%" style="stop-color:#ff8c00;stop-opacity:0.01" />
          </linearGradient>
        </defs>
        <!-- Grid -->
        <line x1="50" y1="20" x2="50" y2="280" stroke="#1a1a1a" stroke-width="1"/>
        <line x1="50" y1="280" x2="750" y2="280" stroke="#1a1a1a" stroke-width="1"/>
        <!-- Candles -->
        <rect x="70" y="80" width="8" height="100" fill="#ff8c00" opacity="0.8"/>
        <line x1="74" y1="70" x2="74" y2="190" stroke="#ff8c00" stroke-width="1"/>
        <rect x="90" y="85" width="8" height="95" fill="#ff8c00" opacity="0.7"/>
        <line x1="94" y1="75" x2="94" y2="185" stroke="#ff8c00" stroke-width="1"/>
        <rect x="110" y="90" width="8" height="85" fill="#ff8c00" opacity="0.6"/>
        <rect x="130" y="100" width="8" height="75" fill="#00ff41" opacity="0.6"/>
        <line x1="134" y1="85" x2="134" y2="180" stroke="#00ff41" stroke-width="1"/>
        <!-- EMA lines -->
        <polyline points="70,150 90,145 110,140 130,135 150,132 170,128 190,125 210,123 230,122 250,125 270,130" stroke="#00d4ff" stroke-width="2" fill="none" opacity="0.8"/>
        <!-- Price label -->
        <text x="600" y="30" fill="#ffffff" font-size="14">$98,432.50</text>
      </svg>
    </div>
    <div class="transfers-panel">
      <div style="color: #ffffff; font-weight: 700; margin-bottom: 12px; font-size: 1.05em;">LARGE TRANSFERS</div>
      <div style="color: #ffffff; margin-bottom: 8px; padding: 8px; background: #0d0d0d; border-left: 2px solid #333;">
        <div style="font-weight: 700;">1,250 BTC</div>
        <div style="color: var(--gray); font-size: 0.85em;">SELL • Whale Activity</div>
        <div style="color: var(--gray); font-size: 0.8em; margin-top: 4px;">19:32 UTC</div>
      </div>
      <div style="color: #ffffff; margin-bottom: 8px; padding: 8px; background: #0d0d0d; border-left: 2px solid #333;">
        <div style="font-weight: 700;">890 BTC</div>
        <div style="color: var(--gray); font-size: 0.85em;">BUY • Accumulation Signal</div>
        <div style="color: var(--gray); font-size: 0.8em; margin-top: 4px;">19:28 UTC</div>
      </div>
      <div style="color: #ffffff; padding: 8px; background: #0d0d0d; border-left: 2px solid #333;">
        <div style="font-weight: 700;">2,100 BTC</div>
        <div style="color: var(--gray); font-size: 0.85em;">SELL • Major Outflow</div>
        <div style="color: var(--gray); font-size: 0.8em; margin-top: 4px;">19:15 UTC</div>
      </div>
    </div>
  </div>

  <!-- GENIUS AI -->
  <div class="genius-ai">
    <div style="color: #ffffff; font-weight: 700; margin-bottom: 14px; font-size: 1.05em; text-transform: uppercase;">GENIUS AI ANALYSIS</div>
    <div class="genius-ai-grid">
      <div class="genius-card">
        <div class="genius-card-title">BUY SIGNAL</div>
        <div class="genius-card-content">Strong momentum + RSI bounce from 48. Target: $97.4k</div>
      </div>
      <div class="genius-card">
        <div class="genius-card-title">LIQUIDITY ALERT</div>
        <div class="genius-card-content">Major buy wall detected at $94.8k. Support confirmed.</div>
      </div>
      <div class="genius-card">
        <div class="genius-card-title">FVG ANALYSIS</div>
        <div class="genius-card-content">Fair Value Gap at $96.5k. Potential pullback zone.</div>
      </div>
      <div class="genius-card">
        <div class="genius-card-title">RISK WARNING</div>
        <div class="genius-card-content">Liquidation cascade possible above $99.2k. Set stops.</div>
      </div>
    </div>
  </div>

  <!-- TAB CONTENT - TREND ANALYSIS -->
  <div id="trend-analysis" class="tab-content">
    <div style="padding: 0 24px;">
      <h2 style="color: #ffffff; margin-bottom: 14px; font-size: 1.2em; font-weight: 700;">TREND ANALYSIS - Bitcoin</h2>
      <div style="background: var(--panel); border: 1px solid var(--border); border-left: 2px solid #1a1a1a; padding: 14px;">
        <h3 style="color: #ffffff; margin-bottom: 10px; font-weight: 700;">TECHNICAL SUMMARY</h3>
        <ul style="list-style: none; padding-left: 0; color: #ffffff; font-size: 0.9em; line-height: 1.6;">
          <li>RSI: 55 (Neutral) • Momentum: Increasing</li>
          <li>MACD: Positive crossover confirmed</li>
          <li>Moving Averages: Golden cross on 1H</li>
          <li>Volume: Above average, confirming uptrend</li>
        </ul>
        <h3 style="color: #ffffff; margin-bottom: 10px; font-weight: 700; margin-top: 12px;">TRADER ACTION PLAN</h3>
        <p style="color: var(--gray); margin-bottom: 8px; font-size: 0.9em;"><strong>Current Strategy:</strong> <span style="color: #ffffff;">LONG BIAS</span></p>
        <ul style="list-style: none; padding-left: 0; color: #ffffff; font-size: 0.9em; line-height: 1.6;">
          <li>Entry Zone: $98,000 - $98,500 (Support)</li>
          <li>Stop Loss: $96,500 (Major support break)</li>
          <li>Take Profit 1: $99,500 (Resistance)</li>
          <li>Take Profit 2: $100,000 (Psychological level)</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- TAB CONTENT - KPI CORRELATION -->
  <div id="kpi-correlation" class="tab-content">
    <div style="padding: 0 24px;">
      <h2 style="color: #ffffff; margin-bottom: 14px; font-size: 1.2em; font-weight: 700;">KPI CORRELATION ANALYSIS</h2>
      <div style="background: var(--panel); border: 1px solid var(--border); border-left: 2px solid #1a1a1a; padding: 14px; font-size: 0.9em; color: #ffffff;">
        <p>BTC–ETH: <span style="color: #ffffff; font-weight:700;" id="corr-btc-eth">0.86</span></p>
        <p>BTC–NASDAQ: <span style="color: #ffffff; font-weight:700;" id="corr-btc-nasdaq">0.62</span></p>
        <p>BTC–GOLD: <span style="color: #ffffff; font-weight:700;">-0.15</span></p>
        <p>ETH–NASDAQ: <span style="color: #ffffff; font-weight:700;">0.71</span></p>
      </div>
    </div>
  </div>

  <!-- TAB CONTENT - MULTI-TF ANALYSIS -->
  <div id="multi-tf-analysis" class="tab-content">
    <div style="padding: 0 24px;">
      <h2 style="color: #ffffff; margin-bottom: 14px; font-size: 1.2em;">MULTI-TIMEFRAME ANALYSIS</h2>
      <div style="background: var(--panel); border: 1px solid var(--border); border-left: 2px solid #1a1a1a; padding: 14px; font-size: 0.9em; color: #ffffff;">
        <div>1H: Bullish bias, RSI 55, MACD +</div>
        <div>4H: Strong uptrend, EMA bullish alignment</div>
        <div>1D: Long-term support at $95k, resistance at $100k</div>
        <div style="margin-top: 12px; color: var(--gray); font-size: 0.85em;">All timeframes aligned for upside move</div>
      </div>
    </div>
  </div>

  <!-- DETAILED MODE (iframe poprzednia wersja) -->
  <iframe id="detailed-mode-page" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100vh; border: none; z-index: 1000;" src="demo_bloomberg_tabs_clean.html"></iframe>

  <script>
    // ========== API CONFIGURATION ==========
    const API_BASE = window.location.hostname === 'localhost' 
      ? 'http://localhost:5000'
      : 'https://api.hamsterterminal.com';

    let apiConnected = false;
    let lastDataUpdate = Date.now();
    let currentPage = 'dashboard';

    // ========== CLOCK ==========
    function updateTime() {
      const now = new Date();
      const utc = now.toISOString().split('T')[1].slice(0,8);
      document.getElementById('clock').textContent = `${utc} UTC`;
    }
    setInterval(updateTime, 1000);

    // ========== API DATA FETCHER ==========
    async function fetchApiData() {
      try {
        const response = await fetch(`${API_BASE}/api/binance/summary`, {
          cache: 'no-store',
          headers: { 'Accept': 'application/json' }
        });
        
        if (!response.ok) throw new Error(`HTTP ${response.status}`);
        
        const data = await response.json();
        
        // Update UI with real data
        updateDashboardWithData(data);
        setApiStatus('live', '✓ Live Data');
        apiConnected = true;
        lastDataUpdate = Date.now();
        
      } catch (error) {
        console.log('API error:', error);
        setApiStatus('error', '✗ Mock Data');
        apiConnected = false;
      }
    }

    function updateDashboardWithData(data) {
      // BTC Price
      if (data.btcPrice) {
        document.getElementById('btc-price').textContent = `$${data.btcPrice.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
        document.getElementById('ticker-btc').textContent = `$${data.btcPrice.toLocaleString('en-US', { minimumFractionDigits: 0 })}`;
      }
      
      // BTC Change
      if (data.btcChange24h !== undefined) {
        const changePercent = data.btcChange24h.toFixed(2);
        document.getElementById('btc-change').textContent = `${changePercent > 0 ? '+' : ''}${changePercent}%`;
      }
      
      // Volume
      if (data.btcVolume) {
        const volumeB = (data.btcVolume / 1e9).toFixed(1);
        document.getElementById('btc-volume').textContent = `$${volumeB}B`;
      }
      
      // Market Cap
      if (data.btcMarketCap) {
        const marketCapT = (data.btcMarketCap / 1e12).toFixed(2);
        document.getElementById('market-cap').textContent = `$${marketCapT}T`;
      }
      
      // Fear & Greed
      if (data.fear_greed !== undefined) {
        const fng = data.fear_greed;
        document.getElementById('fear-greed').textContent = fng;
        const label = fng < 25 ? 'EXTREME FEAR' : fng < 45 ? 'FEAR' : fng < 55 ? 'NEUTRAL' : fng < 75 ? 'GREED' : 'EXTREME GREED';
        document.getElementById('fng-label').textContent = label;
      }
      
      // ETH Price
      if (data.ethPrice) {
        document.getElementById('ticker-eth').textContent = `$${data.ethPrice.toLocaleString('en-US', { minimumFractionDigits: 0 })}`;
      }

      // Derived simple tickers (placeholder spreads for non-crypto assets)
      const spy = data.btcPrice ? (data.btcPrice / 50).toFixed(2) : '500.00';
      const gold = data.btcPrice ? (data.btcPrice / 50).toFixed(1) : '2000.0';
      const eurusd = data.btcPrice ? (1.05 + (data.btcChange24h || 0) * 0.0001).toFixed(4) : '1.0850';
      document.getElementById('ticker-spy').textContent = `$${spy}`;
      document.getElementById('ticker-gold').textContent = `$${gold}`;
      document.getElementById('ticker-eur').textContent = eurusd;

      // LIVE NEWS (auto-generated from data)
      const newsLeft = document.querySelector('.news:nth-of-type(1)');
      if (newsLeft) {
        const price = data.btcPrice ? `$${data.btcPrice.toLocaleString('en-US', { minimumFractionDigits: 0 })}` : 'BTC';
        const changeTxt = data.btcChange24h !== undefined ? `${data.btcChange24h > 0 ? '▲' : '▼'} ${Math.abs(data.btcChange24h).toFixed(2)}%` : '';
        const volTxt = data.btcVolume ? `24h vol ${(data.btcVolume / 1e9).toFixed(1)}B` : '24h vol --';
        newsLeft.innerHTML = `
          <h4>LIVE NEWS</h4>
          <div class="news-item">BTC trades at ${price} ${changeTxt}</div>
          <div class="news-item">ETH prints ${document.getElementById('ticker-eth').textContent || '$--'} intraday</div>
          <div class="news-item">${volTxt} on majors</div>
          <div class="news-item">Fear & Greed: ${data.fear_greed ?? '--'}</div>
          <div class="news-item">API status: ${apiConnected ? 'Live' : 'Mock'} data</div>
        `;
      }

      // MARKET ALERTS (simple auto content)
      const newsRight = document.querySelector('.news:nth-of-type(2)');
      if (newsRight) {
        const mc = data.btcMarketCap ? `$${(data.btcMarketCap / 1e12).toFixed(2)}T` : '$--';
        const fngLabel = data.fear_greed !== undefined
          ? (data.fear_greed < 25 ? 'Extreme Fear' : data.fear_greed < 45 ? 'Fear' : data.fear_greed < 55 ? 'Neutral' : data.fear_greed < 75 ? 'Greed' : 'Extreme Greed')
          : '--';
        newsRight.innerHTML = `
          <h4>MARKET ALERTS</h4>
          <div class="news-item">Market Cap: ${mc}</div>
          <div class="news-item">Sentiment: ${fngLabel}</div>
          <div class="news-item">Liquidity watch: BTC support $94k–$96k</div>
          <div class="news-item">Volatility check: keep stops dynamic</div>
          <div class="news-item">Data refreshed: ${new Date().toUTCString().slice(17,25)} UTC</div>
        `;
      }

      // GENIUS AI CARDS (lite dynamic text)
      const geniusCards = document.querySelectorAll('.genius-card-content');
      if (geniusCards.length >= 4) {
        const priceStr = data.btcPrice ? `$${data.btcPrice.toLocaleString('en-US', { minimumFractionDigits: 0 })}` : 'BTC';
        geniusCards[0].textContent = `Momentum tracking: ${priceStr} with change ${(data.btcChange24h ?? 0).toFixed(2)}%.`;
        geniusCards[1].textContent = data.btcVolume ? `Liquidity: ${(data.btcVolume / 1e9).toFixed(1)}B 24h volume, watch walls at $95k/$97k.` : 'Liquidity steady, monitoring orderbook levels.';
        geniusCards[2].textContent = data.fear_greed !== undefined ? `Sentiment gauge: ${data.fear_greed} F&G — ${document.getElementById('fng-label').textContent}.` : 'Sentiment neutral baseline.';
        geniusCards[3].textContent = data.btcMarketCap ? `Risk: Market cap ${ (data.btcMarketCap / 1e12).toFixed(2)}T, adjust size to volatility.` : 'Risk: size positions based on volatility bands.';
      }
      
      // Sentiment (random for demo)
      const bulls = Math.floor(40 + Math.random() * 30);
      const bears = 100 - bulls;
      document.getElementById('bulls-percent').textContent = `${bulls}%`;
      document.getElementById('bears-percent').textContent = `${bears}%`;
    }

    function setApiStatus(status, text) {
      const el = document.getElementById('api-status');
      el.textContent = text;
      el.className = `api-status ${status}`;
    }

    // ========== PAGE SWITCHER ==========
    function switchPage(page) {
      currentPage = page;
      
      // Update button states
      document.querySelectorAll('.page-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      // Get all dashboard elements
      const header = document.querySelector('.header');
      const menuBar = document.querySelector('.menu-bar');
      const sectionHeaderWrapper = document.querySelector('.section-header-wrapper');
      const tickerContainer = document.querySelector('.ticker-container');
      const newsBreakingWrapper = document.querySelector('.news-breaking-wrapper');
      const topGrid = document.querySelector('.top-grid');
      const mainGrid = document.querySelector('.main-grid');
      const geniusAi = document.querySelector('.genius-ai');
      const tabContents = document.querySelectorAll('.tab-content');
      const detailedModePage = document.getElementById('detailed-mode-page');
      
      if (page === 'detailed') {
        // Hide Bloomberg
        if (header) header.style.display = 'none';
        if (menuBar) menuBar.style.display = 'none';
        if (sectionHeaderWrapper) sectionHeaderWrapper.style.display = 'none';
        if (tickerContainer) tickerContainer.style.display = 'none';
        if (newsBreakingWrapper) newsBreakingWrapper.style.display = 'none';
        if (topGrid) topGrid.style.display = 'none';
        if (mainGrid) mainGrid.style.display = 'none';
        if (geniusAi) geniusAi.style.display = 'none';
        tabContents.forEach(el => el.style.display = 'none');
        // Show Detailed Mode
        detailedModePage.style.display = 'block';
      } else {
        // Show Bloomberg
        if (header) header.style.display = '';
        if (menuBar) menuBar.style.display = '';
        if (sectionHeaderWrapper) sectionHeaderWrapper.style.display = '';
        if (tickerContainer) tickerContainer.style.display = '';
        if (newsBreakingWrapper) newsBreakingWrapper.style.display = '';
        if (topGrid) topGrid.style.display = '';
        if (mainGrid) mainGrid.style.display = '';
        if (geniusAi) geniusAi.style.display = '';
        document.querySelector('.tab-content.active')?.style ? (document.querySelector('.tab-content.active').style.display = 'block') : null;
        // Hide Detailed Mode
        detailedModePage.style.display = 'none';
      }
    }

    // ========== THEME SWITCHER ==========
    function switchTheme(theme) {
      document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      let style = `
        body { background: var(--black); color: #ffffff; }
        .header { background: var(--orange); }
        .menu-bar { background: var(--burgundy); }
      `;
      
      if (theme === 'professional') {
        style += `
          body { background: #1a1a2e; }
          .header { background: #0f3460; }
          .menu-bar { background: #16213e; }
        `;
      } else if (theme === 'dark') {
        style += `
          body { background: #1a1a1a; }
          .header { background: #2d2d2d; }
          .menu-bar { background: #1a1a1a; }
        `;
      }
      
      let styleEl = document.getElementById('dynamic-style');
      if (!styleEl) {
        styleEl = document.createElement('style');
        styleEl.id = 'dynamic-style';
        document.head.appendChild(styleEl);
      }
      styleEl.textContent = style;
    }

    // ========== TAB SWITCHER ==========
    function switchTab(tab) {
      document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
      document.querySelectorAll('.menu-item').forEach(el => el.classList.remove('active'));
      
      if (tab === 'dashboard') {
        document.querySelector('[onclick="switchTab(\'dashboard\')"]').classList.add('active');
      } else {
        document.getElementById(tab).classList.add('active');
        document.querySelector(`[onclick="switchTab('${tab}')"]`).classList.add('active');
      }
    }

    // ========== INIT ==========
    function init() {
      updateTime();
      fetchApiData();
      setInterval(fetchApiData, 10000); // Update every 10 seconds
    }

    window.addEventListener('DOMContentLoaded', init);
  </script>

</body>
</html>
