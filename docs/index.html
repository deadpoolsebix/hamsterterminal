
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Hamster Terminal - Trading Dashboard Pro | hamsterterminal.com</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;400;700&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto Mono', monospace;
            background: #0a0a0a;
            color: #e0e0e0;
            overflow-x: hidden;
        }
        
        .terminal-header {
            background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* ===== THEME SWITCHER ===== */
        .theme-switcher {
            display: flex;
            align-items: center;
            gap: 15px;
            font-family: 'Roboto Mono', monospace;
        }
        
        .theme-btn {
            background: linear-gradient(135deg, #00d4ff, #0088cc);
            border: 2px solid #00d4ff;
            color: #000;
            font-size: 1.2em;
            padding: 8px 16px;
            cursor: pointer;
            font-weight: 900;
            border-radius: 4px;
            transition: all 0.2s;
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.4);
        }
        
        .theme-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 25px rgba(0, 212, 255, 0.6);
        }
        
        .theme-name {
            font-size: 0.9em;
            color: #00d4ff;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            min-width: 150px;
            text-align: center;
        }
        
        /* ===== BLOOMBERG TERMINAL THEME ===== */
        body.theme-bloomberg {
            background: #000000;
            color: #ff6600;
        }
        body.theme-bloomberg .terminal-header {
            background: #000000;
            border-bottom: 2px solid #ff6600;
        }
        body.theme-bloomberg .terminal-title {
            color: #ff6600;
        }
        body.theme-bloomberg .metric-card {
            background: #000000;
            border: 1px solid #ff6600;
        }
        body.theme-bloomberg .metrics-panel {
            background: #000000;
        }
        
        /* ===== RETRO CRT (GREEN PHOSPHOR) THEME ===== */
        body.theme-retro-crt {
            background: #000000;
            color: #00ff41;
        }
        body.theme-retro-crt * {
            text-shadow: 0 0 5px #00ff41;
        }
        body.theme-retro-crt .terminal-header {
            background: #000000;
            border-bottom: 2px solid #00ff41;
        }
        body.theme-retro-crt .terminal-title {
            color: #00ff41;
            text-shadow: 0 0 10px #00ff41;
        }
        body.theme-retro-crt .metric-card {
            background: #001a00;
            border: 1px solid #00ff41;
        }
        body.theme-retro-crt .metrics-panel {
            background: #000000;
        }
        body.theme-retro-crt::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 255, 65, 0.05),
                rgba(0, 255, 65, 0.05) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 9999;
        }
        
        /* ===== AMBER TERMINAL THEME ===== */
        body.theme-amber {
            background: #000000;
            color: #ffaa00;
        }
        body.theme-amber .terminal-header {
            background: #000000;
            border-bottom: 2px solid #ffaa00;
        }
        body.theme-amber .terminal-title {
            color: #ffaa00;
        }
        body.theme-amber .metric-card {
            background: #1a0a00;
            border: 1px solid #ffaa00;
        }
        body.theme-amber .metrics-panel {
            background: #000000;
        }
        
        /* ===== DOS/MATRIX THEME ===== */
        body.theme-dos {
            background: #000000;
            color: #33ff33;
        }
        body.theme-dos .terminal-header {
            background: #000000;
            border-bottom: 2px solid #33ff33;
        }
        body.theme-dos .terminal-title {
            color: #33ff33;
        }
        body.theme-dos .metric-card {
            background: #001100;
            border: 1px solid #33ff33;
        }
        body.theme-dos .metrics-panel {
            background: #000000;
        }
        
        .terminal-title {
            font-size: 1.8em;
            font-weight: 800;
            color: #00d4ff;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-family: 'Roboto Mono', monospace;
        }
        
        .terminal-time {
            font-family: 'Roboto Mono', monospace;
            font-size: 0.9em;
            color: #fff;
            animation: none !important;
            transition: none !important;
        }
        
        #clock-time, #clock-zone {
            animation: none !important;
            transition: none !important;
        }
        
        /* CLOCK & TIME ELEMENTS - NO TRANSITIONS/ANIMATIONS */
        #terminal-clock, #terminal-clock * {
            animation: none !important;
            transition: none !important;
        }
        
        .metrics-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            padding: 20px 30px;
            background: #0f0f0f;
        }
        
        .metric-card {
            background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
        }
        
        /* BTC ONE-PANEL: DISABLE TRANSITION */
        .metrics-panel > .metric-card[style*="grid-column: 1 / -1"] {
            transition: none !important;
        }
        
        .metric-card:hover {
            transform: translateY(-2px);
            border-color: #00d4ff;
            box-shadow: 0 5px 15px rgba(0,212,255,0.2);
        }
        
        }
        
        .sentiment-fill {
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0px;
            padding: 0px;
        }
        
        .chart-container {
            background: #0a0a0a;
            border: none;
            border-radius: 0px;
            padding: 0px;
        }
        
        .timeframe-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 0px;
            flex-wrap: wrap;
        }
        
        .timeframe-btn {
            padding: 8px 16px;
            background: #1a1a1a;
            border: 2px solid #333;
            color: #fff;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }
        
        .timeframe-btn:hover {
            border-color: #00d4ff;
            color: #00d4ff;
        }
        
        .timeframe-btn.active {
            background: #00d4ff;
            border-color: #00d4ff;
            color: #0a0a0a;
            box-shadow: 0 0 15px rgba(0,212,255,0.5);
        }
        
        .news-panel {
            background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            max-height: 1400px;
            overflow-y: auto;
        }
        
        .news-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #00d4ff;
        }
        
        .news-header h3 {
            color: #00d4ff;
            font-size: 1.2em;
            font-weight: 700;
        }
        
        .news-feed {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .news-item {
            background: #0f0f0f;
            border-left: 3px solid #00d4ff;
            padding: 12px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        .news-item:hover {
            background: #1a1a1a;
            transform: translateX(5px);
        }
        
        .news-meta {
            display: flex;
            gap: 10px;
            margin-bottom: 8px;
            font-size: 0.75em;
        }
        
        .news-time {
            color: #fff;
        }
        
        .news-source {
            color: #00d4ff;
            font-weight: 600;
        }
        
        .news-impact {
            margin-left: auto;
            font-weight: 700;
        }
        
        .news-headline {
            color: #e0e0e0;
            font-size: 0.9em;
            line-height: 1.4;
        }
        
        /* Order Book Styles */
        .orderbook-container {
            font-family: 'Roboto Mono', monospace;
            font-size: 0.85em;
        }
        
        .orderbook-row {
            display: flex;
            justify-content: space-between;
            padding: 4px 8px;
            position: relative;
            transition: all 0.2s ease;
        }
        
        .orderbook-row:hover {
            background: #1a1a1a;
        }
        
        .ob-bar {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            opacity: 0.2;
            transition: width 0.3s ease;
        }
        
        .orderbook-row.bid .ob-bar {
            background: #00ff41;
        }
        
        .orderbook-row.ask .ob-bar {
            background: #ff0033;
        }
        
        .orderbook-row.bid .ob-price {
            color: #00ff41;
        }
        
        .orderbook-row.ask .ob-price {
            color: #ff0033;
        }
        
        .ob-amount {
            color: #fff;
            z-index: 1;
        }
        
        .ob-price {
            font-weight: 600;
            z-index: 1;
        }
        
        .orderbook-current-price {
            text-align: center;
            padding: 12px;
            margin: 8px 0;
            background: linear-gradient(90deg, transparent, #00d4ff22, transparent);
            border-top: 1px solid #00d4ff;
            border-bottom: 1px solid #00d4ff;
        }
        
        /* Trades Feed */
        .trades-feed {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .trade-item {
            background: #0f0f0f;
            padding: 10px;
            border-radius: 4px;
            border-left: 3px solid #ffaa00;
            transition: all 0.2s ease;
        }
        
        .trade-item:hover {
            background: #1a1a1a;
            transform: translateX(3px);
        }
        
        .trade-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.8em;
        }
        
        .trade-time {
            color: #fff;
            font-family: 'Roboto Mono', monospace;
        }
        
        .trade-side {
            font-weight: 700;
        }
        
        .trade-details {
            font-size: 0.9em;
        }
        
        /* Positions Feed */
        .positions-feed {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .position-item {
            background: #0f0f0f;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #333;
            transition: all 0.2s ease;
        }
        
        .position-item:hover {
            background: #1a1a1a;
            border-color: #ff00ff;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            border-top: 1px solid #333;
            color: #fff;
            font-size: 0.85em;
        }
        
        /* AI PORADA - Game Boy Style */
        .ai-porada-card {
            grid-column: span 2;
            background: #000000;
            border: 8px solid #00ffff !important;
            box-shadow: 
                inset 0 0 0 4px #000,
                inset 0 0 0 8px #00ffff,
                inset 0 0 0 12px #000,
                inset 0 0 0 16px #00ffff,
                0 0 30px rgba(0, 255, 255, 0.8),
                0 0 60px rgba(0, 255, 255, 0.5);
            padding: 25px;
        }
        
        .gameboy-screen {
            background: #0a0a14;
            border: 5px solid #00ffff;
            padding: 15px;
            margin-bottom: 15px;
            text-align: center;
            box-shadow: 
                inset 0 0 0 2px #000,
                inset 0 0 0 5px #00ffff,
                inset 0 0 0 7px #ff00ff,
                inset 0 0 15px rgba(0, 255, 255, 0.3);
            border-radius: 8px;
        }
        
        .gameboy-title {
            font-size: 0.9em;
            color: #00ffff;
            text-shadow: 0 0 10px #00ffff, 0 0 20px #ff00ff;
            margin-bottom: 8px;
            animation: glow 2s infinite;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
        }
        
        .btc-display {
            font-size: 1.8em;
            color: #ffff00;
            text-shadow: 0 0 15px #ffff00, 0 0 30px #ffaa00;
            font-weight: 900;
            margin: 10px 0;
            font-family: 'Roboto Mono', monospace;
        }
        
        .signal-display {
            font-size: 1em;
            color: #00ff00;
            text-shadow: 0 0 12px #00ff00;
            animation: pulse 1s infinite;
            margin: 10px 0;
            font-weight: 700;
        }
        
        .led-panel {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }
        
        .led {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #00ffff;
            animation: blink 0.8s infinite;
            box-shadow: 0 0 10px currentColor;
        }
        
        .led.red { background: #ff0033; }
        .led.cyan { background: #00ffff; animation-delay: 0.2s; }
        .led.white { background: #ffffff; animation-delay: 0.4s; }
        .led.green { background: #00ff00; animation-delay: 0.6s; }
        
        .ai-porada-header {
            font-size: 1.1em;
            color: #00ffff;
            margin-bottom: 15px;
            text-shadow: 0 0 10px #00ffff;
            font-weight: 700;
            text-transform: uppercase;
        }
        
        .ai-instruction {
            margin: 10px 0;
            padding: 12px;
            border-left: 4px solid;
            background: rgba(0, 0, 0, 0.5);
            font-size: 0.9em;
            color: #ffffff;
            line-height: 1.6;
        }
        
        .ai-instruction.orange { border-left-color: #ffaa00; }
        .ai-instruction.green { border-left-color: #00ff00; }
        .ai-instruction.red { border-left-color: #ff0033; }
        
        @keyframes glow {
            0%, 100% { text-shadow: 0 0 15px #00ffff; }
            50% { text-shadow: 0 0 30px #00ffff, 0 0 50px #ff00ff; }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.9; }
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        @keyframes ticker-scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        
        /* Key Levels Panel */
        .key-levels-panel {
            background: #0a0a0a;
            border: 2px solid #00d4ff;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
        }
        
        .key-level-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            margin: 5px 0;
            border-left: 3px solid;
            background: rgba(255, 255, 255, 0.02);
        }
        
        .key-level-item.resistance { border-left-color: #ff0033; }
        .key-level-item.support { border-left-color: #00ff00; }
        .key-level-item.current { border-left-color: #ffaa00; background: rgba(255, 170, 0, 0.1); }
        
        .heat-alert {
            background: #ff0033;
            color: #fff;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.7em;
            font-weight: bold;
            animation: pulse 1s infinite;
        }
        
        /* Whale Flow Panel */
        .whale-panel {
            background: linear-gradient(135deg, #1a1a1a, #0a0a0a);
            border: 2px solid #ff00ff;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
        }
        
        .whale-item {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            margin: 5px 0;
            background: rgba(255, 0, 255, 0.05);
            border-radius: 3px;
        }
        
        .whale-amount {
            color: #ff00ff;
            font-weight: bold;
        }
        
        /* Volume Analysis */
        .volume-panel {
            background: #0a0a0a;
            border: 2px solid #00ff00;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
        }
        
        .volume-bar {
            height: 25px;
            display: flex;
            border-radius: 5px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .volume-buy {
            background: #00ff00;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75em;
            font-weight: bold;
            color: #000;
        }
        
        .volume-sell {
            background: #ff0033;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75em;
            font-weight: bold;
            color: #fff;
        }
        
        .dominance-indicator {
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        
        .dominance-indicator.bulls { background: rgba(0, 255, 0, 0.2); color: #00ff00; }
        .dominance-indicator.bears { background: rgba(255, 0, 51, 0.2); color: #ff0033; }
        
        /* Market Regime Extended */
        .regime-details {
            margin-top: 10px;
            font-size: 0.85em;
            color: #fff;
        }
        
        .regime-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
        }
        
        /* Session Clocks & Instruments */
        .session-clock {
            background: #0f0f0f;
            border: 2px solid #00d4ff;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            font-family: 'Roboto Mono', monospace;
        }
        
        .session-name {
            font-size: 0.7em;
            color: #fff;
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        
        .session-time {
            font-size: 1.5em;
            color: #ffff00;
            font-weight: 900;
            text-shadow: 0 0 10px #ffff00;
        }
        
        .session-status {
            font-size: 0.65em;
            color: #00ff41;
            margin-top: 3px;
            animation: pulse 1s infinite;
        }
        
        .instrument-ticker {
            background: #0f0f0f;
            border-left: 3px solid #00d4ff;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 3px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8em;
        }
        
        .ticker-name {
            color: #fff;
            text-transform: uppercase;
            font-weight: 600;
            flex: 1;
        }
        
        .ticker-price {
            color: #ffff00;
            font-weight: 900;
            margin: 0 8px;
        }
        
        .ticker-change {
            font-weight: bold;
            font-size: 0.85em;
        }
        
        .ticker-change.positive {
            color: #00ff41;
        }
        
        .ticker-change.negative {
            color: #ff0033;
        }
        
        .trap-alert {
            background: linear-gradient(135deg, rgba(255,0,0,0.2), rgba(255,165,0,0.2));
            border: 2px solid #ff6600;
            border-radius: 5px;
            padding: 12px;
            margin: 10px 0;
            font-size: 0.8em;
        }
        
        /* Miganie wolne i oddzielne - każdy na swojej animacji */
        @keyframes blinkSlow {
            0% { opacity: 1; box-shadow: 0 0 15px currentColor; }
            50% { opacity: 0.4; box-shadow: 0 0 5px currentColor; }
            100% { opacity: 1; box-shadow: 0 0 15px currentColor; }
        }
        
        .trap-alert {
            border-radius: 5px;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
        }
        
        /* BULL TRAP - solo animation na 4s */
        .trap-alert.trap-1 {
            animation: blinkSlow 4s ease-in-out infinite;
        }
        
        /* BEAR TRAP - solo animation na 4s z delay'em 2s (oddzielnie) */
        .trap-alert.trap-2 {
            animation: blinkSlow 4s ease-in-out infinite 2s;
        }
        
        .trap-label {
            color: #ff6600;
            font-weight: 700;
            margin-bottom: 5px;
            font-size: 0.9em;
        }
        
        .liquidation-item {
            background: #0f0f0f;
            border-left: 4px solid #ff0033;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 3px;
            font-size: 0.8em;
            line-height: 1.5;
        }
        
        .liquidation-price {
            color: #ff0033;
            font-weight: 900;
            font-size: 1.1em;
        }
        
        /* CVD Professional */
        .cvd-panel {
            background: linear-gradient(135deg, #0f0f1f 0%, #0a0a0a 100%);
            border: 2px solid #00d4ff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .cvd-header {
            font-size: 0.9em;
            color: #00d4ff;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 12px;
            border-bottom: 2px solid #00d4ff;
            padding-bottom: 8px;
        }
        
        .cvd-value {
            font-size: 1.8em;
            font-weight: 900;
            margin-bottom: 10px;
            text-shadow: 0 0 15px rgba(0, 212, 255, 0.5);
        }
        
        .cvd-value.positive {
            color: #00ff41;
            text-shadow: 0 0 15px rgba(0, 255, 65, 0.5);
        }
        
        .cvd-value.negative {
            color: #ff0033;
            text-shadow: 0 0 15px rgba(255, 0, 51, 0.5);
        }
        
        .cvd-bar {
            height: 30px;
            background: #0f0f0f;
            border-radius: 5px;
            overflow: hidden;
            display: flex;
            margin-bottom: 10px;
            border: 1px solid #333;
        }
        
        .cvd-buy {
            background: linear-gradient(90deg, #00ff41, #00dd33);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75em;
            font-weight: 900;
            color: #000;
        }
        
        .cvd-sell {
            background: linear-gradient(90deg, #ff0033, #dd0022);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75em;
            font-weight: 900;
            color: #fff;
        }
        
        .cvd-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 0.75em;
        }
        
        .cvd-stat-item {
            background: #0f0f0f;
            padding: 8px;
            border-radius: 4px;
            border-left: 2px solid #00d4ff;
        }
        
        .cvd-stat-label {
            color: #fff;
            margin-bottom: 3px;
        }
        
        .cvd-stat-value {
            color: #ffff00;
            font-weight: 900;
        }
        
        /* SQUEEZE INDICATORS */
        .squeeze-alert {
            background: linear-gradient(135deg, rgba(255,0,255,0.15), rgba(255,100,0,0.15));
            border: 2px solid #ff00ff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .squeeze-alert.short {
            border-color: #ff6600;
            background: linear-gradient(135deg, rgba(255,100,0,0.15), rgba(255,0,0,0.15));
        }
        
        .squeeze-alert.long {
            border-color: #00ffff;
            background: linear-gradient(135deg, rgba(0,255,255,0.15), rgba(0,100,255,0.15));
        }
        
        .squeeze-title {
            font-size: 1em;
            font-weight: 700;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .squeeze-alert.short .squeeze-title {
            color: #ff6600;
        }
        
        .squeeze-alert.long .squeeze-title {
            color: #00ffff;
        }
        
        .squeeze-meter {
            height: 25px;
            background: #0f0f0f;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
            border: 1px solid #333;
            position: relative;
        }
        
        .squeeze-fill {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            font-weight: 900;
            color: #000;
        }
        
        .squeeze-short-fill {
            background: linear-gradient(90deg, #ff6600, #ff3300);
            color: #fff;
        }
        
        .squeeze-long-fill {
            background: linear-gradient(90deg, #00ffff, #00dd88);
            color: #000;
        }
        
        .squeeze-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            font-size: 0.75em;
            margin-top: 10px;
        }
        
        .squeeze-detail-item {
            background: #0f0f0f;
            padding: 8px;
            border-radius: 4px;
            border-left: 2px solid #ff00ff;
        }
        
        .squeeze-detail-label {
            color: #fff;
            margin-bottom: 2px;
        }
        
        .squeeze-detail-value {
            color: #ffff00;
            font-weight: 900;
            font-size: 1.1em;
        }
        
        .cvd-stat-value {
            color: #ffff00;
            font-weight: 900;
        }
        
        /* GAME BOY TERMINAL - PIXEL ART STYLE */
        @keyframes gameboy-blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        .gameboy-display {
            font-size: 2em;
            display: inline-block;
            filter: contrast(1.2) brightness(1.1);
            text-shadow: 2px 2px 0 rgba(0,0,0,0.5);
            animation: gameboy-blink 2s ease-in-out infinite;
        }
        
        .gameboy-container {
            display: inline-block;
            width: 45px;
            height: 45px;
            border: 3px solid #00ff41;
            border-radius: 8px;
            padding: 5px;
            background: linear-gradient(135deg, #1a1a1a, #0a0a0a);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.6), inset 0 0 15px rgba(0,0,0,0.8);
            position: relative;
        }
        
        .gameboy-container::after {
            content: '';
            position: absolute;
            top: 2px;
            right: 2px;
            width: 6px;
            height: 6px;
            background: #ff0033;
            border-radius: 50%;
            animation: blink 0.8s infinite;
        }
        
        
        
        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #0a0a0a;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #00d4ff;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #00ff41;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .metrics-panel {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }

        /* ===== BLOOMBERG TICKER STYLES ===== */
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&display=swap');

        .bloomberg-ticker-wrapper {
            background: linear-gradient(135deg, #0a0a0a 0%, #0f0f0f 100%);
            border: 2px solid #00d4ff;
            border-radius: 8px;
            overflow: hidden;
            padding: 8px 0;
            margin-bottom: 15px;
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3), inset 0 0 10px rgba(0, 0, 0, 0.8);
        }

        .bloomberg-ticker-scroll {
            display: flex;
            animation: scroll-left 34s linear infinite;
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 1.6575em;
            letter-spacing: 0.5px;
        }

        @keyframes scroll-left {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .bloomberg-ticker-group {
            display: flex;
            align-items: center;
            margin: 0 30px;
            white-space: nowrap;
            gap: 15px;
        }

        .ticker-group-label {
            color: #ffaa00;
            font-weight: 700;
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-right: 10px;
            text-shadow: 0 0 10px rgba(255, 170, 0, 0.5);
        }

        .ticker-instrument-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 4px 10px;
            border: 1px solid;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.3);
        }

        .ticker-symbol {
            font-weight: 700;
            font-size: 0.9em;
            text-transform: uppercase;
        }

        .ticker-price {
            color: #ffff00;
            font-weight: 900;
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 8px rgba(255, 255, 0, 0.5);
        }

        .ticker-change {
            font-weight: 700;
            font-size: 0.85em;
            min-width: 55px;
            text-align: right;
        }

        .ticker-change.positive {
            color: #00ff41;
            text-shadow: 0 0 8px rgba(0, 255, 65, 0.5);
        }

        .ticker-change.negative {
            color: #ff0033;
            text-shadow: 0 0 8px rgba(255, 0, 51, 0.5);
        }

        /* ===== BREAKING NEWS STYLES ===== */
        .breaking-news-wrapper {
            background: linear-gradient(135deg, #1a0a0a 0%, #0f0f0f 100%);
            border: 2px solid #ff0033;
            border-radius: 8px;
            overflow: hidden;
            padding: 8px 0;
            margin-bottom: 15px;
            box-shadow: 0 0 20px rgba(255, 0, 51, 0.3), inset 0 0 10px rgba(0, 0, 0, 0.8);
        }

        .breaking-news-label {
            display: inline-block;
            padding: 6px 12px;
            background: #ff0033;
            color: #fff;
            font-weight: 900;
            font-size: 0.75em;
            letter-spacing: 1.5px;
            margin: 0 10px;
            border-radius: 4px;
            text-transform: uppercase;
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 10px rgba(255, 0, 51, 0.8);
            animation: pulse-label 1.5s ease-in-out infinite;
        }

        @keyframes pulse-label {
            0%, 100% { transform: scale(1); box-shadow: 0 0 10px rgba(255, 0, 51, 0.8); }
            50% { transform: scale(1.05); box-shadow: 0 0 20px rgba(255, 0, 51, 1); }
        }

        .breaking-news-scroll {
            display: flex;
            animation: scroll-left 45s linear infinite;
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 1.56em;
            padding: 0 10px;
        }

        .breaking-news-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 6px 15px;
            margin: 0 10px;
            white-space: nowrap;
            border-left: 3px solid #ffaa00;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            flex-shrink: 0;
        }

        .news-importance {
            font-weight: 900;
            font-size: 0.75em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 2px 6px;
            border-radius: 3px;
            min-width: 45px;
        }

        .news-importance.high {
            background: #ff0033;
            color: #fff;
            text-shadow: 0 0 8px rgba(255, 0, 51, 0.8);
        }

        .news-importance.medium {
            background: #ffaa00;
            color: #000;
            text-shadow: 0 0 5px rgba(255, 170, 0, 0.8);
        }

        .news-importance.low {
            background: #00ff41;
            color: #000;
            text-shadow: 0 0 5px rgba(0, 255, 65, 0.8);
        }

        .news-category-tag {
            font-weight: 700;
            font-size: 0.7em;
            text-transform: uppercase;
            padding: 2px 6px;
            border-radius: 3px;
            letter-spacing: 0.5px;
        }

        .news-category-tag.category-crypto {
            background: rgba(139, 69, 255, 0.3);
            color: #b091ff;
        }

        .news-category-tag.category-stocks {
            background: rgba(0, 255, 100, 0.3);
            color: #00ff41;
        }

        .news-category-tag.category-markets {
            background: rgba(0, 212, 255, 0.3);
            color: #00d4ff;
        }

        .news-category-tag.category-economy {
            background: rgba(255, 170, 0, 0.3);
            color: #ffaa00;
        }

        .news-source {
            font-weight: 700;
            color: #00d4ff;
            font-size: 0.8em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .news-headline {
            color: #fff;
            font-weight: 600;
            flex: 1;
            max-width: 400px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .news-time {
            color: #888;
            font-size: 0.75em;
            font-weight: 600;
            min-width: 60px;
            text-align: right;
        }

        .ticker-loading,
        .news-loading {
            color: #999;
            font-size: 0.85em;
            padding: 12px;
            text-align: center;
            font-family: 'JetBrains Mono', monospace;
        }
    </style>
    <script src="genius_hamster_ai.js" defer></script>
</head>
<body>
    <div class="terminal-header" style="padding-top: 25px;">
        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
            <div class="terminal-title" style="font-family: 'Press Start 2P', 'Courier New', monospace; font-weight: 900; letter-spacing: 4px; text-shadow: 3px 3px 0 #ff0033, 6px 6px 0 #00ff41, 0 0 30px rgba(255,0,51,0.8); color: #ffff00; font-size: 1.8em; transform: scaleY(1.1); display: flex; align-items: center; gap: 20px;">
                <span style="animation: spinHamster 2s linear infinite; display: inline-block; font-size: 1.4em;">🐹</span>
                <span style="animation: hamsterPush 3s ease-in-out infinite; display: inline-block; text-shadow: 0 2px 8px rgba(255,255,0,0.4), 0 4px 16px rgba(255,0,51,0.3);">HAMSTER</span> TERMINAL
                <span style="margin-left: 20px; display: inline-flex; align-items: center; gap: 8px; border-left: 2px solid #fff; padding-left: 20px;">
                    <span style="font-size: 1em; font-weight: 900; color: #fff;">Ƀ</span>
                    <button class="theme-btn" onclick="previousTheme()" style="background: transparent; border: 1px solid #fff; color: #fff; padding: 4px 8px; font-weight: 700; font-size: 0.8em; cursor: pointer; border-radius: 3px;">◄</button>
                    <span style="font-size: 0.75em; color: #fff; font-weight: 700; min-width: 70px; text-align: center;" id="current-theme-name">MODERN</span>
                    <button class="theme-btn" onclick="nextTheme()" style="background: transparent; border: 1px solid #fff; color: #fff; padding: 4px 8px; font-weight: 700; font-size: 0.8em; cursor: pointer; border-radius: 3px;">►</button>
                </span>
            </div>
        </div>
        
        <!-- Clock Row Below Title -->
        <div style="display: flex; align-items: center; justify-content: space-between; gap: 15px; padding: 10px 20px; border-top: 1px solid #222;">
            <!-- Timezone Selector with Label -->
            <div style="display: flex; flex-direction: column; align-items: center; gap: 4px;">
                <div style="display: flex; gap: 6px; padding: 6px; background: rgba(0,0,0,0.5); border-radius: 6px; border: 1px solid #00ff41;">
                    <button onclick="changeTimezone('Asia/Tokyo', '🗼 TOKYO')" class="tz-btn" style="background: rgba(255,100,150,0.2); border: 1px solid #ff6496; color: #ff6496; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-weight: 700; font-size: 1.1em; transition: all 0.2s;" title="Tokyo Stock Exchange"><span style="display: inline-block; font-size: 1em;">🐉</span> TYO</button>
                    <button onclick="changeTimezone('Europe/London', '� LONDON')" class="tz-btn" style="background: rgba(0,212,255,0.2); border: 1px solid #00d4ff; color: #00d4ff; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-weight: 700; font-size: 1.1em; transition: all 0.2s;" title="London Stock Exchange"><span style="display: inline-block; font-size: 1em;">🕰</span> LON</button>
                    <button onclick="changeTimezone('America/New_York', '🗽 NY')" class="tz-btn" style="background: rgba(0,255,65,0.2); border: 1px solid #00ff41; color: #00ff41; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-weight: 700; font-size: 1.1em; transition: all 0.2s; min-width: 75px; display: inline-flex; align-items: center; justify-content: center;" title="New York Stock Exchange"><span style="display: inline-block; font-size: 1em; width: 1.2em;">🗽</span> NY</button>
                    <button onclick="changeTimezone('Europe/Zurich', '🧀 ZURICH')" class="tz-btn" style="background: rgba(255,170,0,0.2); border: 1px solid #ffaa00; color: #ffaa00; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-weight: 700; font-size: 1.1em; transition: all 0.2s;" title="Swiss Exchange"><span style="display: inline-block; font-size: 1em;">🧀</span> ZRH</button>
                    <button onclick="changeTimezone('Australia/Sydney', '🦘 SYDNEY')" class="tz-btn" style="background: rgba(138,43,226,0.2); border: 1px solid #8a2be2; color: #8a2be2; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-weight: 700; font-size: 1.1em; transition: all 0.2s;" title="Australian Securities Exchange"><span style="display: inline-block; font-size: 1em;">🦘</span> SYD</button>
                </div>
                <div style="font-size: 0.7em; color: #fff; font-weight: 600; letter-spacing: 1px; text-transform: uppercase; font-family: 'Roboto Mono', monospace;">Timezone</div>
            </div>
            <div class="terminal-time" id="terminal-clock" style="display: flex; flex-direction: column; align-items: center; gap: 5px;">
                <span id="clock-time" data-static-clock="true" style="font-size: 1.3em; font-weight: 900; color: #ffffff; font-family: 'Courier New', monospace; letter-spacing: 2px; animation: none !important;">--:--:--</span>
                <span id="clock-zone" style="color: #ffffff; font-weight: 700; letter-spacing: 1px; font-size: 0.9em; animation: none !important; text-align: center;">� LONDON</span>
                <span id="clock-utc-offset" style="color: #00d4ff; font-weight: 600; font-size: 0.75em; font-family: 'Roboto Mono', monospace;">UTC+0</span>
            </div>
        </div>
        
        <div style="display: flex; align-items: center; gap: 15px;">
            <!-- Language Selector with Label -->
            <div style="display: flex; flex-direction: column; align-items: center; gap: 4px; margin-left: 20px;">
                <div style="display: flex; gap: 8px; padding: 8px; background: rgba(0,212,255,0.1); border-radius: 6px; border: 1px solid #00d4ff;">
                    <button onclick="changeLanguage('PL')" style="background: transparent; border: 2px solid #00ff41; color: #00ff41; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-weight: 700; font-size: 0.9em; transition: all 0.2s;" title="Polski">🇵🇱 PL</button>
                    <button onclick="changeLanguage('EN')" style="background: transparent; border: 2px solid #00d4ff; color: #00d4ff; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-weight: 700; font-size: 0.9em; transition: all 0.2s;" title="English">🇬🇧 EN</button>
                    <button onclick="changeLanguage('DE')" style="background: transparent; border: 2px solid #ffaa00; color: #ffaa00; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-weight: 700; font-size: 0.9em; transition: all 0.2s;" title="Deutsch">🇩🇪 DE</button>
                    <button onclick="changeLanguage('SK')" style="background: transparent; border: 2px solid #00ffcc; color: #00ffcc; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-weight: 700; font-size: 0.9em; transition: all 0.2s;" title="Slovenčina">🇸🇰 SK</button>
                </div>
                <div style="font-size: 0.7em; color: #fff; font-weight: 600; letter-spacing: 1px; text-transform: uppercase; font-family: 'Roboto Mono', monospace;">Language</div>
            </div>
        </div>
    </div>
    <style>
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes spinHamster { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes hamsterPush { 0%, 100% { transform: scaleX(1) scaleY(1); filter: drop-shadow(0 2px 6px rgba(255,255,0,0.2)); } 50% { transform: scaleX(1.06) scaleY(1.03); filter: drop-shadow(0 4px 12px rgba(255,255,0,0.5)); } }
        @keyframes arrowPulse { 
            0%, 100% { transform: translateY(0) scale(1); opacity: 1; } 
            50% { transform: translateY(4px) scale(1.1); opacity: 0.7; } 
        }
        @keyframes buttonPress { 
            0%, 100% { transform: scale(1); } 
            50% { transform: scale(0.98); } 
        }
        @keyframes iconGlow { 
            0%, 100% { filter: drop-shadow(0 0 0px currentColor); } 
            50% { filter: drop-shadow(0 0 8px currentColor); } 
        }
        
        /* FOOTER LOGO STYLE */
        .footer-logo {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            padding: 12px;
            background: #000000;
            border-top: 2px solid #00d4ff;
                margin-top: 0px;
            font-size: 1.5em;
            color: #ffffff;
            text-shadow: 0 0 12px rgba(0, 212, 255, 0.6);
        }
        
        .footer-logo span {
            font-family: 'Roboto Mono', monospace;
            font-weight: 900;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
        }
        
        /* BTC Panel Color Cycling - Slow animation */
        @keyframes btcPanelColorCycle {
            0% { border-color: #00d4ff; box-shadow: 0 0 32px rgba(0, 212, 255, 0.32), 0 0 48px rgba(0, 212, 255, 0.2), 0 0 64px rgba(0, 212, 255, 0.12), inset 0 0 15px rgba(0, 0, 0, 0.8); }
            25% { border-color: #ff00ff; box-shadow: 0 0 32px rgba(255, 0, 255, 0.32), 0 0 48px rgba(255, 0, 255, 0.2), 0 0 64px rgba(255, 0, 255, 0.12), inset 0 0 15px rgba(0, 0, 0, 0.8); }
            50% { border-color: #ffff00; box-shadow: 0 0 32px rgba(255, 255, 0, 0.32), 0 0 48px rgba(255, 255, 0, 0.2), 0 0 64px rgba(255, 255, 0, 0.12), inset 0 0 15px rgba(0, 0, 0, 0.8); }
            75% { border-color: #00ff41; box-shadow: 0 0 32px rgba(0, 255, 65, 0.32), 0 0 48px rgba(0, 255, 65, 0.2), 0 0 64px rgba(0, 255, 65, 0.12), inset 0 0 15px rgba(0, 0, 0, 0.8); }
            100% { border-color: #00d4ff; box-shadow: 0 0 32px rgba(0, 212, 255, 0.32), 0 0 48px rgba(0, 212, 255, 0.2), 0 0 64px rgba(0, 212, 255, 0.12), inset 0 0 15px rgba(0, 0, 0, 0.8); }
        }
        
        /* BTC ONE-PANEL - DISABLE ALL TRANSITIONS/ANIMATIONS ON CHILDREN & CONTENT */
        .metrics-panel > .metric-card[style*="grid-column: 1 / -1"],
        .metrics-panel > .metric-card[style*="grid-column: 1 / -1"] *,
        .metrics-panel > .metric-card[style*="grid-column: 1 / -1"] *:before,
        .metrics-panel > .metric-card[style*="grid-column: 1 / -1"] *:after {
            animation: none !important;
            transition: none !important !important;
            will-change: auto !important;
            backface-visibility: hidden !important;
        }
        
        /* TERMINAL CLOCK - COMPLETE FREEZE (NO UPDATES ANIMATIONS) */
        .terminal-time,
        .terminal-time *,
        .terminal-time *:before,
        .terminal-time *:after,
        #terminal-clock,
        #clock-time,
        #clock-zone {
            animation: none !important;
            transition: none !important !important;
            will-change: auto !important;
            backface-visibility: hidden !important;
        }
        
        /* EXTRA PROTECTION: Prevent any style changes to clock elements */
        #clock-time,
        #clock-zone {
            pointer-events: none !important;
            font-size: 1.3em !important;
            color: #ffffff !important;
            font-weight: 900 !important;
            letter-spacing: 1px !important;
            display: inline !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        /* BTC PANEL TIME DISPLAYS - FORCE VISIBLE */
        #asia-time-panel,
        #zurich-time-panel,
        #london-time-panel,
        #ny-time-panel {
            display: inline !important;
            visibility: visible !important;
            opacity: 1 !important;
            color: #ffff00 !important;
            font-weight: 800 !important;
            pointer-events: none !important;
            animation: none !important;
            transition: none !important;
        }
        
        #asia-status-panel,
        #london-status-panel,
        #ny-status-panel {
            display: inline !important;
            visibility: visible !important;
            opacity: 1 !important;
            font-weight: 800 !important;
            pointer-events: none !important;
            animation: none !important;
            transition: none !important;
        }
    </style>
    
    <!-- ATARI ACTION BUTTONS + BTC COIN -->
    <div style="padding: 12px 30px; display: flex; gap: 12px; flex-wrap: wrap; align-items: center; justify-content: center; background: #0a0a0a;">
        <div style="display: flex; gap: 10px; align-items: center;">
            <button onclick="playBeep(880, 100);" style="background: linear-gradient(135deg, #00ff41, #008f2a); color: #000; font-weight: 900; border: 3px solid #00ff41; padding: 12px 24px; border-radius: 0; text-transform: uppercase; letter-spacing: 2px; box-shadow: 0 0 20px rgba(0,255,65,0.6), inset 0 0 20px rgba(0,255,65,0.2); animation: pulse 1.2s infinite; cursor: pointer; font-size: 1em; transition: all 0.1s; display: inline-flex; align-items: center; gap: 8px;" onmouseover="this.style.boxShadow='0 0 30px rgba(0,255,65,0.8), inset 0 0 30px rgba(0,255,65,0.3)'" onmouseout="this.style.boxShadow='0 0 20px rgba(0,255,65,0.6), inset 0 0 20px rgba(0,255,65,0.2)'">
                <span>▶ BUY</span>
            </button>
            <button onclick="playBeep(440, 100);" style="background: linear-gradient(135deg, #ff0033, #7f001a); color: #fff; font-weight: 900; border: 3px solid #ff0033; padding: 12px 24px; border-radius: 0; text-transform: uppercase; letter-spacing: 2px; box-shadow: 0 0 20px rgba(255,0,51,0.6), inset 0 0 20px rgba(255,0,51,0.2); animation: pulse 1.2s infinite; cursor: pointer; font-size: 1em; transition: all 0.1s;" onmouseover="this.style.boxShadow='0 0 30px rgba(255,0,51,0.8), inset 0 0 30px rgba(255,0,51,0.3)'" onmouseout="this.style.boxShadow='0 0 20px rgba(255,0,51,0.6), inset 0 0 20px rgba(255,0,51,0.2)'">⏹ SELL</button>
            <button onclick="playBeep(320, 80);" style="background: linear-gradient(135deg, #ffaa00, #884400); color: #000; font-weight: 900; border: 3px solid #ffaa00; padding: 12px 24px; border-radius: 0; text-transform: uppercase; letter-spacing: 2px; box-shadow: 0 0 20px rgba(255,170,0,0.6), inset 0 0 20px rgba(255,170,0,0.2); animation: blink 1.4s infinite; cursor: pointer; font-size: 1em; transition: all 0.1s;" onmouseover="this.style.boxShadow='0 0 30px rgba(255,170,0,0.8), inset 0 0 30px rgba(255,170,0,0.3)'" onmouseout="this.style.boxShadow='0 0 20px rgba(255,170,0,0.6), inset 0 0 20px rgba(255,170,0,0.2)'">◄ NOPE</button>
            <span style="font-family: 'Press Start 2P', 'Courier New', monospace; font-size: 0.7em; color: #ffaa00; letter-spacing: 2px; text-shadow: 2px 2px 0 #5a2b00, 0 0 10px rgba(255,170,0,0.7); padding-left: 8px;">NEVER MIND</span>
        </div>
        <!-- Bitcoin Coin only -->
        <div style="margin-left: 20px; display: flex; align-items: center; gap: 20px; height: 50px;">
            <div style="font-size: 3em; animation: btcRotate 3s linear infinite; filter: drop-shadow(0 0 15px rgba(255,200,0,0.9)); color: #ffd700; text-shadow: 2px 2px 0 #ff9900, 4px 4px 0 #ffaa00; font-weight: 900; cursor: pointer;" title="HODL!">₿</div>
        </div>
    </div>

    <!-- LIVE BTC PRICE - MAIN DISPLAY -->
    <div class="panel" style="margin: 15px 30px; padding: 28px; background: linear-gradient(135deg, #0f0f1a 0%, #0a0a0a 100%); border-radius: 12px; position: relative; box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.8);">
        <div style="display: grid; grid-template-columns: 0.6fr 1.4fr; gap: 20px; align-items: start;">
            <!-- Left: BTC Price -->
            <div>
                <div style="font-size: 0.95em; color: #00d4ff; font-weight: 700; letter-spacing: 2px; margin-bottom: 8px;">₿ BTC/USDT <span style="color: #00ff41;">(LIVE)</span></div>
                <div class="metric-value btc-price current-price" style="color: #ffff00; font-size: 3em; font-weight: 900; text-shadow: 0 0 20px rgba(255, 255, 0, 0.7); animation: hamsterPush 3s ease-in-out infinite; display: inline-block; animation-delay: 0s;">$95,501.20</div>
                <div class="metric-change change-24h positive" style="font-size: 1.4em; font-weight: 700; margin-top: 8px;">+2.45%</div>
            </div>
            <!-- Right: Data Grid (larger, compact) -->
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 8px;">
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.85em; margin-bottom: 2px;">24h High</div>
                    <div style="color: #00ff41; font-size: 1.25em; font-weight: 900;">$97,861</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.85em; margin-bottom: 2px;">24h Low</div>
                    <div style="color: #00d4ff; font-size: 1.25em; font-weight: 900;">$94,650</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.85em; margin-bottom: 2px;">Volume 24h</div>
                    <div style="color: #9b59b6; font-size: 1.25em; font-weight: 900;">$18.28B</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.85em; margin-bottom: 2px;">RSI (14)</div>
                    <div style="color: #ffaa00; font-size: 1.25em; font-weight: 900;">41.8</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.85em; margin-bottom: 2px;">Resistance</div>
                    <div style="color: #ff4444; font-size: 1.25em; font-weight: 900;">$98,500</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.85em; margin-bottom: 2px;">Support</div>
                    <div style="color: #00ff41; font-size: 1.25em; font-weight: 900;">$93,200</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.85em; margin-bottom: 2px;">Open Interest</div>
                    <div style="color: #00d4ff; font-size: 1.25em; font-weight: 900;">$12.4B</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.85em; margin-bottom: 2px;">Funding Rate</div>
                    <div style="color: #ffaa00; font-size: 1.25em; font-weight: 900;">+0.0082%</div>
                </div>
            </div>
        </div>
        <div style="font-size: 0.85em; color: #fff; margin-top: 15px;">Data Source: <span style="color: #00d4ff;">Binance API</span> • Updated every 2 seconds</div>
    </div>

    <!-- LIVE ETH PRICE - MAIN DISPLAY (same size as BTC with hamster push effect) -->
    <div class="panel" style="margin: 15px 30px; padding: 28px; background: linear-gradient(135deg, #1a0a1a 0%, #0a0a0a 100%); border-radius: 8px; position: relative; box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.8);">
        <div style="display: grid; grid-template-columns: 0.6fr 1.4fr; gap: 20px; align-items: start;">
            <!-- Left: ETH Price -->
            <div>
                <div style="font-size: 0.95em; color: #00d4ff; font-weight: 700; letter-spacing: 2px; margin-bottom: 8px;">🔷 ETH/USDT <span style="color: #00ff41;">(LIVE)</span></div>
                <div class="metric-value eth-price" style="color: #9b59b6; font-size: 3em; font-weight: 900; text-shadow: 0 0 20px rgba(155, 89, 182, 0.7); animation: hamsterPush 3s ease-in-out infinite; display: inline-block; animation-delay: 1.5s;">$2,845.32</div>
                <div class="eth-change" style="font-size: 1.4em; font-weight: 700; margin-top: 8px; color: #00ff41;">+1.8%</div>
            </div>
            <!-- Right: Data Grid (larger, compact) -->
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 8px;">
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.85em; margin-bottom: 2px;">24h High</div>
                    <div style="color: #00ff41; font-size: 1.25em; font-weight: 900;">$2,920</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.85em; margin-bottom: 2px;">24h Low</div>
                    <div style="color: #00d4ff; font-size: 1.25em; font-weight: 900;">$2,780</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.75em; margin-bottom: 2px;">Volume 24h</div>
                    <div style="color: #9b59b6; font-size: 1.1em; font-weight: 900;">$18.5B</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.75em; margin-bottom: 2px;">CVD 24h</div>
                    <div style="color: #00ff41; font-size: 1.1em; font-weight: 900;">+12.4K</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.75em; margin-bottom: 2px;">Resistance</div>
                    <div style="color: #ff4444; font-size: 1.1em; font-weight: 900;">$2,980</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.75em; margin-bottom: 2px;">Support</div>
                    <div style="color: #00ff41; font-size: 1.1em; font-weight: 900;">$2,720</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.75em; margin-bottom: 2px;">Open Interest</div>
                    <div style="color: #00d4ff; font-size: 1.1em; font-weight: 900;">$8.2B</div>
                </div>
                <div style="line-height: 1.2;">
                    <div style="color: #fff; font-size: 0.75em; margin-bottom: 2px;">Funding Rate</div>
                    <div style="color: #ffaa00; font-size: 1.1em; font-weight: 900;">+0.0065%</div>
                </div>
            </div>
        </div>
        <div style="font-size: 0.75em; color: #fff; margin-top: 15px;">Data Source: <span style="color: #00d4ff;">Binance API</span> • Updated every 2 seconds</div>
    </div>
    <style>
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-15px); } }
        @keyframes contraShoot { 0%, 100% { transform: translateX(0) rotate(0deg); } 20% { transform: translateX(-2px) rotate(-1deg); } 50% { transform: translateX(1px) rotate(0deg); } }
        @keyframes gunRecoil { 0%, 100% { transform: scaleX(1); } 30% { transform: scaleX(0.9); } }
        @keyframes gunFlash { 0%, 100% { opacity: 0; box-shadow: 0 0 0 transparent; } 10% { opacity: 1; box-shadow: 0 0 12px #ffff00; } 20% { opacity: 0.5; box-shadow: 0 0 8px #ff6600; } 30% { opacity: 0; } }
        @keyframes bulletFly1 { 0% { left: 36px; opacity: 1; } 100% { left: 76px; opacity: 0; } }
        @keyframes bulletFly2 { 0% { left: 36px; opacity: 1; } 100% { left: 76px; opacity: 0; } }
        @keyframes bulletFly3 { 0% { left: 36px; opacity: 1; } 100% { left: 76px; opacity: 0; } }
        @keyframes legWalk { 0%, 100% { transform: translateY(0px); } 25% { transform: translateY(-3px); } 50% { transform: translateY(0px); } 75% { transform: translateY(-2px); } }
        @keyframes shootBullet { 0% { width: 0px; opacity: 1; } 100% { width: 50px; opacity: 0; } }
        @keyframes btcRotate { 0% { transform: rotateY(0deg); } 100% { transform: rotateY(360deg); } }
        @keyframes btcPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }
        @keyframes rainbowBorder {
            0% { border-color: #ff0033; box-shadow: 0 0 25px rgba(255, 0, 51, 0.6), inset 0 0 15px rgba(0, 0, 0, 0.8); }
            16% { border-color: #ff6600; box-shadow: 0 0 25px rgba(255, 102, 0, 0.6), inset 0 0 15px rgba(0, 0, 0, 0.8); }
            33% { border-color: #ffaa00; box-shadow: 0 0 25px rgba(255, 170, 0, 0.6), inset 0 0 15px rgba(0, 0, 0, 0.8); }
            50% { border-color: #00ff41; box-shadow: 0 0 25px rgba(0, 255, 65, 0.6), inset 0 0 15px rgba(0, 0, 0, 0.8); }
            66% { border-color: #00d4ff; box-shadow: 0 0 25px rgba(0, 212, 255, 0.6), inset 0 0 15px rgba(0, 0, 0, 0.8); }
            83% { border-color: #8a2be2; box-shadow: 0 0 25px rgba(138, 43, 226, 0.6), inset 0 0 15px rgba(0, 0, 0, 0.8); }
            100% { border-color: #ff0033; box-shadow: 0 0 25px rgba(255, 0, 51, 0.6), inset 0 0 15px rgba(0, 0, 0, 0.8); }
        }
        @keyframes coinSpin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes beerCheers { 0%, 100% { transform: translateY(0px) rotate(0deg); } 25% { transform: translateY(-8px) rotate(5deg); } 50% { transform: translateY(-12px) rotate(-5deg); } 75% { transform: translateY(-8px) rotate(5deg); } }
        @keyframes glitch { 0%, 100% { text-shadow: 0 0 10px rgba(255,170,0,0.8); } 50% { text-shadow: 0 0 20px rgba(255,170,0,1), 3px 0 15px rgba(255,100,0,0.6); } }
    </style>
    <script>
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                osc.connect(gain);
                gain.connect(audioContext.destination);
                osc.frequency.value = freq;
                osc.type = 'sine';
                gain.gain.setValueAtTime(0.1, audioContext.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration / 1000);
                osc.start(audioContext.currentTime);
                osc.stop(audioContext.currentTime + duration / 1000);
            } catch(e) {
                console.log('Audio not available');
            }
        }
    </script>

    <!-- ===== BLOOMBERG TICKER ===== -->
    <div class="bloomberg-ticker-wrapper" id="bloombergTicker" style="margin: 15px 30px; padding: 15px; background: linear-gradient(135deg, #0a0a0a 0%, #0f0f0f 100%); border: 2px solid #333; border-radius: 8px; overflow: hidden;">
        <div class="bloomberg-ticker-scroll">
            <!-- METALE -->
            <div class="bloomberg-ticker-group" style="display: flex; align-items: center; gap: 15px;">
                <span class="ticker-group-label" style="color: #ffff00; font-weight: 900; font-size: 0.9em; text-transform: uppercase; border-right: 2px solid #333; padding-right: 10px;">METALE</span>
                <div class="ticker-instrument-item" id="metal-1" style="border-right: 2px solid #333; padding-right: 15px;">
                    <span class="ticker-symbol" style="color: #ffff00;">XAU/USD</span>
                    <span class="ticker-price" style="margin-left: 8px;">$--</span>
                    <span class="ticker-change" style="margin-left: 8px; color: #00ff41;">--</span>
                </div>
                <div class="ticker-instrument-item" id="metal-2">
                    <span class="ticker-symbol" style="color: #ffff00;">XAG/USD</span>
                    <span class="ticker-price" style="margin-left: 8px;">$--</span>
                    <span class="ticker-change" style="margin-left: 8px; color: #00ff41;">--</span>
                </div>
            </div>
            
            <!-- INDEKSY -->
            <div class="bloomberg-ticker-group" style="display: flex; align-items: center; gap: 15px; margin-left: 30px;">
                <span class="ticker-group-label" style="color: #00d4ff; font-weight: 900; font-size: 0.9em; text-transform: uppercase; border-right: 2px solid #333; padding-right: 10px;">INDEKSY</span>
                <div class="ticker-instrument-item" id="index-1" style="border-right: 2px solid #333; padding-right: 15px;">
                    <span class="ticker-symbol" style="color: #00d4ff;">SPX</span>
                    <span class="ticker-price" style="margin-left: 8px;">--</span>
                    <span class="ticker-change" style="margin-left: 8px; color: #00ff41;">--</span>
                </div>
                <div class="ticker-instrument-item" id="index-2" style="border-right: 2px solid #333; padding-right: 15px;">
                    <span class="ticker-symbol" style="color: #00d4ff;">INDU</span>
                    <span class="ticker-price" style="margin-left: 8px;">--</span>
                    <span class="ticker-change" style="margin-left: 8px; color: #00ff41;">--</span>
                </div>
                <div class="ticker-instrument-item" id="index-3">
                    <span class="ticker-symbol" style="color: #00d4ff;">IXIC</span>
                    <span class="ticker-price" style="margin-left: 8px;">--</span>
                    <span class="ticker-change" style="margin-left: 8px; color: #00ff41;">--</span>
                </div>
            </div>
            
            <!-- MEGA CAPS -->
            <div class="bloomberg-ticker-group" style="display: flex; align-items: center; gap: 15px; margin-left: 30px;">
                <span class="ticker-group-label" style="color: #cccccc; font-weight: 900; font-size: 0.9em; text-transform: uppercase; border-right: 2px solid #333; padding-right: 10px;">MEGA CAPS</span>
                <div class="ticker-instrument-item" id="stock-1" style="border-right: 2px solid #333; padding-right: 15px;">
                    <span class="ticker-symbol" style="color: #cccccc;">AAPL</span>
                    <span class="ticker-price" style="margin-left: 8px;">$--</span>
                    <span class="ticker-change" style="margin-left: 8px; color: #00ff41;">--</span>
                </div>
                <div class="ticker-instrument-item" id="stock-2" style="border-right: 2px solid #333; padding-right: 15px;">
                    <span class="ticker-symbol" style="color: #cccccc;">MSFT</span>
                    <span class="ticker-price" style="margin-left: 8px;">$--</span>
                    <span class="ticker-change" style="margin-left: 8px; color: #00ff41;">--</span>
                </div>
                <div class="ticker-instrument-item" id="stock-3">
                    <span class="ticker-symbol" style="color: #cccccc;">TSLA</span>
                    <span class="ticker-price" style="margin-left: 8px;">$--</span>
                    <span class="ticker-change" style="margin-left: 8px; color: #00ff41;">--</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== BREAKING NEWS ===== -->
    <div class="breaking-news-wrapper" id="breakingNewsWrapper">
        <span class="breaking-news-label">BREAKING NEWS</span>
        <div class="news-loading">Ladowanie wiadomosci...</div>
    </div>

    <!-- FEAR & GREED + FUNDING RATE (kompaktowy rząd nad OSTRZEŻENIE) -->
    <div class="metrics-panel" style="padding-bottom: 5px;">
        <div class="metric-card" style="background: linear-gradient(135deg, #1a1a0a 0%, #0f0f0f 100%); border: 1.2px solid #88ff00; padding: 8px;">
            <div style="text-align: center;">
                <div style="font-size: 0.55em; color: #88ff00; font-weight: 700; margin-bottom: 4px;">😱 FEAR & GREED INDEX</div>
                <div style="font-size: 1.3em; color: #88ff00; font-weight: 800; margin-bottom: 3px;" class="fear-greed-value">62</div>
                <div style="font-size: 0.6em; color: #88ff00; font-weight: 600;">CHCIWOŚĆ</div>
                <div class="sentiment-bar" style="margin: 6px 0; height: 4px; background: #0a0a0a; border-radius: 2px; overflow: hidden;">
                    <div class="sentiment-fill" style="width: 62%; height: 100%; background: #88ff00;"></div>
                </div>
                <div style="font-size: 0.42em; color: #fff;">0 = Strach | 100 = Chciwość</div>
            </div>
        </div>
        
        <div class="metric-card" style="background: linear-gradient(135deg, #0a1a0a 0%, #0f0f0f 100%); border: 1.2px solid #00ff41; padding: 8px;">
            <div style="text-align: center;">
                <div style="font-size: 0.55em; color: #00ff41; font-weight: 700; margin-bottom: 4px;">💸 FUNDING RATE</div>
                <div style="font-size: 1.3em; color: #00ff41; font-weight: 800; margin-bottom: 3px;" class="funding-rate-value">+0.0082%</div>
                <div style="font-size: 0.52em; color: #fff; margin-bottom: 4px;">Następna: za 8h 00min</div>
                <div style="font-size: 0.55em; color: #00ff41; font-weight: 600; margin-bottom: 4px;">Nastrój: Bycze</div>
                <div style="font-size: 0.42em; color: #fff; padding: 4px; background: #0a0a0a; border-radius: 2px;">
                    Dodatni FR = longi płacą shortom (presja kupna)
                </div>
            </div>
        </div>
    </div>

                <div style="font-size: 0.75em; color: #fff; animation: none !important; transition: none !important;">London (08:00) → NY (14:30) → Tokyo (00:00 CET+1)</div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(210px, 1fr)); gap: 12px; animation: none !important; transition: none !important;">
                <!-- Active Session Panel -->
                <div style="background: #0f0f0f; padding: 12px; border-radius: 6px; border-left: 3px solid #00d4ff;">
                    <div style="font-size: 0.85em; color: #00d4ff; font-weight: 700;">Aktywna sesja</div>
                    <div id="active-session-name" style="color: #ffff00; font-weight: 700;">--</div>
                    <div style="font-size: 0.8em; color: #ccc; line-height: 1.5;">
                        Godzina: <span id="active-session-time">--:--</span> <span id="active-session-tz">--</span><br>
                        Volatility: <span id="active-volatility" style="color: #ffaa00;">--</span><br>
                        Likwidność: <span id="active-liquidity" style="color: #00ff41;">--</span>
                    </div>
                </div>
                <!-- 1. London Session (08:00 GMT - first in Europe) -->
                <div style="background: linear-gradient(135deg, #1a0f0a 0%, #0f0f0f 100%); padding: 12px; border-radius: 6px; border-left: 3px solid #00ff41;">
                    <div style="font-size: 0.85em; color: #00ff41; font-weight: 700;">🇬🇧 LONDYN (08:00-16:30 GMT)</div>
                    <div style="color: #ffff00; font-weight: 800;" id="london-time-panel">--:-- GMT</div>
                    <div style="font-size: 0.8em; color: #ccc; line-height: 1.4; margin-top: 6px;">
                        <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                            <span>Czas do startu:</span>
                            <span id="london-countdown" style="color: #00d4ff; font-weight: 700; min-width: 80px; text-align: right;">--</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 3px;">
                            <span>Status:</span>
                            <span id="london-status-panel" style="color: #00ff41; font-weight: 800;">--</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 3px;">
                            <span>Kluczowy poziom:</span>
                            <span id="london-key-level" style="color: #ffaa00;">$95,850</span>
                        </div>
                    </div>
                </div>
                <!-- 2. New York Session (14:30 CET - second) -->
                <div style="background: linear-gradient(135deg, #1a0a0a 0%, #0f0f0f 100%); padding: 12px; border-radius: 6px; border-left: 3px solid #ff00ff;">
                    <div style="font-size: 0.85em; color: #ff00ff; font-weight: 700;">🗽 NOWY JORK (14:30-22:00 CET)</div>
                    <div style="color: #ffff00; font-weight: 800;" id="ny-time-panel">--:-- EST</div>
                    <div style="font-size: 0.8em; color: #ccc; line-height: 1.4; margin-top: 6px;">
                        <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                            <span>Czas do startu:</span>
                            <span id="ny-countdown" style="color: #00d4ff; font-weight: 700; min-width: 80px; text-align: right;">--</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 3px;">
                            <span>Status:</span>
                            <span id="ny-status-panel" style="color: #ff00ff; font-weight: 800;">--</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 3px;">
                            <span>Kluczowy poziom:</span>
                            <span id="ny-key-level" style="color: #ffaa00;">$96,200</span>
                        </div>
                    </div>
                </div>
                <!-- 3. Tokyo Session (00:00 JST = 16:00 CET poprzedniego dnia - last) -->
                <div style="background: linear-gradient(135deg, #1a0a1a 0%, #0f0f0f 100%); padding: 12px; border-radius: 6px; border-left: 3px solid #ffaa00;">
                    <div style="font-size: 0.85em; color: #ffaa00; font-weight: 700;">🐉 TOKIO (00:00-09:00 JST)</div>
                    <div style="color: #ffff00; font-weight: 800;" id="asia-time-panel">--:-- JST</div>
                    <div style="font-size: 0.8em; color: #ccc; line-height: 1.4; margin-top: 6px;">
                        <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                            <span>Czas do startu:</span>
                            <span id="tokyo-countdown" style="color: #00d4ff; font-weight: 700; min-width: 80px; text-align: right;">--</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 3px;">
                            <span>Status:</span>
                            <span id="tokyo-status-panel" style="color: #ffaa00; font-weight: 800;">--</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 3px;">
                            <span>Kluczowy poziom:</span>
                            <span id="tokyo-key-level" style="color: #ffaa00;">$94,500</span>
                        </div>
                    </div>
                </div>
                <!-- CVD & Open Interest -->
                <div style="background: #0f0f0f; padding: 12px; border-radius: 6px; border-left: 3px solid #ff00ff;">
                    <div style="font-size: 0.85em; color: #ff00ff; font-weight: 700;">CVD & OI</div>
                    <div style="display: flex; justify-content: space-between; margin-top: 6px;">
                        <span style="color: #fff;">CVD Spot:</span>
                        <span style="color: #00ff41; font-weight: 900;">+42,850 BTC</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">CVD Perp:</span>
                        <span style="color: #ff0033; font-weight: 900;">-18,420 BTC</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">Open Interest:</span>
                        <span style="color: #00d4ff; font-weight: 900;">$12.4B (+2.3%)</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">Funding:</span>
                        <span style="color: #ffaa00; font-weight: 900;">+0.0082%</span>
                    </div>
                </div>
                <!-- Fair Value Gap -->
                <div style="background: #0f0f0f; padding: 12px; border-radius: 6px; border-left: 3px solid #00ff41;">
                    <div style="font-size: 0.85em; color: #00ff41; font-weight: 700;">FVG (Fair Value Gap)</div>
                    <div style="display: flex; justify-content: space-between; margin-top: 6px;">
                        <span style="color: #fff;">BULLISH:</span>
                        <span style="color: #00ff41; font-weight: 900;">$95,165 - $95,337</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">BEARISH:</span>
                        <span style="color: #ff0033; font-weight: 900;">$95,882 - $96,611</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">Status:</span>
                        <span style="color: #ffaa00; font-weight: 900;">ACTIVE</span>
                    </div>
                </div>
                <!-- Support & Resistance -->
                <div style="background: #0f0f0f; padding: 12px; border-radius: 6px; border-left: 3px solid #ff6600;">
                    <div style="font-size: 0.85em; color: #ff6600; font-weight: 700;">Wsparcie / Opór</div>
                    <div style="display: flex; justify-content: space-between; margin-top: 6px;">
                        <span style="color: #fff;">Resistance:</span>
                        <span style="color: #ff0033; font-weight: 900;">$97,400 (HOT)</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">Current:</span>
                        <span style="color: #ffff00; font-weight: 900;">$95,501</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">Support:</span>
                        <span style="color: #00ff41; font-weight: 900;">$94,800 (STRONG)</span>
                    </div>
                </div>
                <!-- Orderbook & Delta -->
                <div style="background: #0f0f0f; padding: 12px; border-radius: 6px; border-left: 3px solid #ffaa00;">
                    <div style="font-size: 0.85em; color: #ffaa00; font-weight: 700;">Orderbook & Delta</div>
                    <div style="display: flex; justify-content: space-between; margin-top: 6px;">
                        <span style="color: #fff;">Orderbook imbalance:</span>
                        <span style="color: #00ff41; font-weight: 900;">+2.34x BUY</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">Delta 5s:</span>
                        <span style="color: #00ff41; font-weight: 900;">+309 BTC</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">RSI (14):</span>
                        <span style="color: #ffaa00; font-weight: 900;">41.8</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">MACD:</span>
                        <span style="color: #00ff41; font-weight: 900;">106.71</span>
                    </div>
                </div>
                <!-- Sentiment & Regime -->
                <div style="background: #0f0f0f; padding: 12px; border-radius: 6px; border-left: 3px solid #ffaa00;">
                    <div style="font-size: 0.85em; color: #ffaa00; font-weight: 700;">Sentiment & Regime</div>
                    <div style="display: flex; justify-content: space-between; margin-top: 6px;">
                        <span style="color: #fff;">Market Regime:</span>
                        <span style="color: #ffaa00; font-weight: 700;">NEUTRAL</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">Nastroje:</span>
                        <span style="color: #cc0022; font-weight: 700;">LEKKO NIEDŹWIEDZI (-50/100)</span>
                    </div>
                </div>
                <!-- 24h Statistics (MOVED TO END) -->
                <div style="background: #0f0f0f; padding: 12px; border-radius: 6px; border-left: 3px solid #ffaa00;">
                    <div style="font-size: 0.85em; color: #ffaa00; font-weight: 700;">Statystyki 24h</div>
                    <div style="display: flex; justify-content: space-between; margin-top: 6px;">
                        <span style="color: #fff;">High 24h:</span>
                        <span style="color: #ffff00; font-weight: 900;">$97,861</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">Low 24h:</span>
                        <span style="color: #00d4ff; font-weight: 900;">$94,650</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">Wolumen 24h:</span>
                        <span style="color: #9b59b6; font-weight: 900;">$18.28B</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                        <span style="color: #fff;">RSI (14):</span>
                        <span style="color: #ffaa00; font-weight: 900;">41.8 (Neutralny)</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- SESSION CLOCKS & EUROPE FOCUS -->
    <div class="metrics-panel" style="grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 8px; padding: 15px 30px;">
        <!-- KILL ZONE INFO CARDS -->
    </div>
    
    <!-- WHALE FLOW & VOLUME ANALYSIS (moved up) -->
    <div style="padding: 15px 30px; background: #0a0a0a; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
        <!-- WHALE FLOW -->
        <div id="whale-flow-container" style="background: linear-gradient(135deg, #1a001a 0%, #0a0a0a 100%); border: 2px solid #ff00ff; border-radius: 8px; padding: 20px;">
            <div style="font-size: 1em; color: #ff00ff; margin-bottom: 12px; font-weight: 700;">🐋 WHALE FLOW</div>
            <div style="margin-bottom: 8px; padding: 8px; background: rgba(0,255,65,0.1); border-radius: 4px; border-left: 3px solid #00ff41;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: #00ff41; font-weight: 800;">↗ BUY</span>
                    <span style="color: #fff; font-weight: 900; font-size: 1.1em;">1,250 BTC</span>
                    <span style="font-size: 0.75em; color: #fff;">2min</span>
                </div>
            </div>
            <div style="margin-bottom: 8px; padding: 8px; background: rgba(255,0,51,0.1); border-radius: 4px; border-left: 3px solid #ff0033;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: #ff0033; font-weight: 800;">↘ SELL</span>
                    <span style="color: #fff; font-weight: 900; font-size: 1.1em;">890 BTC</span>
                    <span style="font-size: 0.75em; color: #fff;">8min</span>
                </div>
            </div>
            <div style="margin-bottom: 8px; padding: 8px; background: rgba(0,212,255,0.1); border-radius: 4px; border-left: 3px solid #00d4ff;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: #00d4ff; font-weight: 800;">🧊 ICEBERG</span>
                    <span style="color: #fff; font-weight: 900; font-size: 1.1em;">450/3,200 BTC</span>
                    <span style="font-size: 0.75em; color: #fff;">12min</span>
                </div>
                <div style="font-size: 0.7em; color: #00d4ff; margin-top: 4px;">Hidden order: 2,750 BTC remaining</div>
            </div>
            <div style="margin-bottom: 8px; padding: 8px; background: rgba(0,255,65,0.1); border-radius: 4px; border-left: 3px solid #00ff41;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: #00ff41; font-weight: 800;">↗ BUY</span>
                    <span style="color: #fff; font-weight: 900; font-size: 1.1em;">2,100 BTC</span>
                    <span style="font-size: 0.75em; color: #fff;">15min</span>
                </div>
            </div>
            <div style="margin-bottom: 8px; padding: 8px; background: rgba(255,170,0,0.1); border-radius: 4px; border-left: 3px solid #ffaa00;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: #ffaa00; font-weight: 800;">🧊 ICEBERG</span>
                    <span style="color: #fff; font-weight: 900; font-size: 1.1em;">180/1,800 BTC</span>
                    <span style="font-size: 0.75em; color: #fff;">18min</span>
                </div>
                <div style="font-size: 0.7em; color: #ffaa00; margin-top: 4px;">Smart Money: 90% hidden (layered)</div>
            </div>
            <div style="margin-top: 12px; padding-top: 12px; border-top: 2px solid #333; text-align: center;">
                <div style="font-size: 0.8em; color: #fff;">NET FLOW:</div>
                <div style="font-size: 1.3em; color: #00ff41; font-weight: 900;">+2,460 BTC</div>
                <div style="font-size: 0.85em; color: #00ff41; font-weight: 700;">BULLISH</div>
            </div>
        </div>
        
        <!-- VOLUME ANALYSIS -->
        <div id="volume-analysis-container" style="background: linear-gradient(135deg, #001a00 0%, #0a0a0a 100%); border: 2px solid #00ff41; border-radius: 8px; padding: 20px;">
            <div style="font-size: 1em; color: #00ff41; margin-bottom: 12px; font-weight: 700;">📊 VOLUME ANALYSIS</div>
            <div style="margin-bottom: 12px;">
                <div style="display: flex; justify-content: space-between; font-size: 0.8em; margin-bottom: 5px;">
                    <span style="color: #00ff41; font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', sans-serif;">🐂 BULLS</span>
                    <span style="color: #ff0033; font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', sans-serif;">🐻 BEARS</span>
                </div>
                <div style="height: 30px; background: #0f0f0f; border-radius: 5px; overflow: hidden; display: flex;">
                    <div style="width: 62%; background: linear-gradient(90deg, #00ff41, #00aa2a); display: flex; align-items: center; justify-content: center; color: #000; font-weight: 900;">62%</div>
                    <div style="width: 38%; background: linear-gradient(90deg, #7f001a, #ff0033); display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 900;">38%</div>
                </div>
            </div>
            <div style="text-align: center; padding: 10px; background: rgba(0,255,65,0.15); border-radius: 6px; margin-bottom: 10px;">
                <div style="color: #00ff41; font-weight: 900; font-size: 1.1em;">⚡ BULLS DOMINANCE</div>
            </div>
            <div style="text-align: center; font-size: 0.8em; color: #fff; margin-bottom: 12px;">
                Total Volume 24h:<br>
                <span style="color: #00ff41; font-weight: 900; font-size: 1.3em;">$2.4B</span>
            </div>

            <!-- FVG BULLS & BEARS -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 12px; padding-top: 12px; border-top: 1px solid #333;">
                <!-- FVG BULLS -->
                <div style="background: rgba(0,255,65,0.1); padding: 10px; border-radius: 6px; border-left: 3px solid #00ff41;">
                    <div style="color: #00ff41; font-weight: 800; font-size: 0.9em; margin-bottom: 6px;">📈 FVG BULLS</div>
                    <div style="font-size: 0.75em; line-height: 1.6; color: #ccffcc;">
                        <div>Level: <span style="color: #ffff00; font-weight: 900;">95,200</span></div>
                        <div>Gap Size: <span style="color: #00ff41;">$450</span></div>
                        <div>Status: <span style="color: #00ff41;">🟢 ACTIVE</span></div>
                    </div>
                </div>
                <!-- FVG BEARS -->
                <div style="background: rgba(255,0,51,0.1); padding: 10px; border-radius: 6px; border-left: 3px solid #ff0033;">
                    <div style="color: #ff0033; font-weight: 800; font-size: 0.9em; margin-bottom: 6px;">📉 FVG BEARS</div>
                    <div style="font-size: 0.75em; line-height: 1.6; color: #ffcccc;">
                        <div>Level: <span style="color: #ffff00; font-weight: 900;">96,850</span></div>
                        <div>Gap Size: <span style="color: #ff0033;">$380</span></div>
                        <div>Status: <span style="color: #ffaa00;">🟡 FORMING</span></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- LARGE ORDERS / OPEN INTEREST -->
        <div id="large-orders-container" style="background: linear-gradient(135deg, #001a1a 0%, #0a0a0a 100%); border: 2px solid #00d4ff; border-radius: 8px; padding: 20px;">
            <div style="font-size: 1em; color: #00d4ff; margin-bottom: 12px; font-weight: 700;">📈 LARGE ORDERS</div>
            <div style="margin-bottom: 8px; padding: 8px; background: rgba(0,255,65,0.1); border-radius: 4px; border-left: 3px solid #00ff41;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: #00ff41; font-weight: 800;">BID</span>
                    <span style="color: #fff; font-weight: 900;">$96,200</span>
                    <span style="font-size: 0.85em; color: #fff;">450 BTC</span>
                </div>
            </div>
            <div style="margin-bottom: 12px; padding: 8px; background: rgba(255,0,51,0.1); border-radius: 4px; border-left: 3px solid #ff0033;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: #ff0033; font-weight: 800;">ASK</span>
                    <span style="color: #fff; font-weight: 900;">$97,100</span>
                    <span style="font-size: 0.85em; color: #fff;">380 BTC</span>
                </div>
            </div>
            <div style="margin-bottom: 10px; padding: 10px; background: rgba(0,212,255,0.1); border-radius: 4px;">
                <div style="font-size: 0.75em; color: #fff; margin-bottom: 3px;">OPEN INTEREST:</div>
                <div style="color: #ffff00; font-weight: 900; font-size: 1.2em;">$12.4B</div>
                <div style="font-size: 0.75em; color: #00ff41;">+2.3% (24h)</div>
            </div>
            <div style="padding: 10px; background: rgba(0,255,65,0.1); border-radius: 4px;">
                <div style="font-size: 0.75em; color: #fff; margin-bottom: 3px;">FUNDING RATE:</div>
                <div style="color: #00ff41; font-weight: 900; font-size: 1.2em;">+0.0082%</div>
                <div style="font-size: 0.75em; color: #fff;">Longs paying Shorts</div>
            </div>
        </div>
    </div>
    
    <!-- MIDDLE PANEL: CURRENT SESSION + SENTIMENT -->
    <div style="padding: 15px 30px; background: #0a0a0a; display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
        <!-- SENTIMENT + TRAPS -->
        <div style="background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%); border: 1px solid #ff00ff; border-radius: 8px; padding: 20px; grid-column: 1 / -1; grid-row: 1;">
            <div style="color: #ff00ff; font-size: 1.1em; font-weight: 700; margin-bottom: 15px; text-transform: uppercase;">💭 SENTYMENT RYNKOWY</div>
            
            <div style="margin-bottom: 15px;">
                <div style="font-size: 0.8em; color: #fff; margin-bottom: 5px;">Niedźwiedzie / Bycze</div>
                <div style="height: 20px; background: #0f0f0f; border-radius: 5px; overflow: hidden; display: flex;">
                    <div style="width: 42%; background: #ff0033;"></div>
                    <div style="width: 58%; background: #00ff00;"></div>
                </div>
                <div style="font-size: 0.75em; margin-top: 3px; text-align: center; color: #ffaa00;">42% BEARS • 58% BULLS</div>
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 15px;">
                <div class="trap-alert trap-2" style="background: linear-gradient(135deg, rgba(255,170,0,0.15), rgba(255,100,0,0.1)); border: 1px solid #ffaa00; flex: 1; padding: 12px; display: flex; align-items: center; gap: 10px;">
                    <div style="color: #ffaa00; font-size: 1.3em; flex-shrink: 0;">⚠️</div>
                    <div>
                        <div class="trap-label" style="color: #ffaa00; font-size: 0.9em; font-weight: 800; margin-bottom: 2px;">BEAR TRAP MONITOR</div>
                        <div style="font-size: 0.9em; color: #ffaa00; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-weight: 600;">Wsparcie $94,8k mocne. Złamie = SHORT. Delta +</div>
                    </div>
                </div>
                
                <div class="trap-alert trap-1" style="flex: 1; padding: 12px; background: linear-gradient(135deg, rgba(0,212,255,0.15), rgba(0,100,255,0.1)); border: 1px solid #00d4ff; display: flex; align-items: center; gap: 10px;">
                    <div style="color: #00d4ff; font-size: 1.3em; flex-shrink: 0;">⚠️</div>
                    <div>
                        <div class="trap-label" style="color: #00d4ff; font-size: 0.9em; font-weight: 800; margin-bottom: 2px;">BULL TRAP RISK</div>
                        <div style="font-size: 0.9em; color: #00d4ff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-weight: 600;">Cena bliska $97,4k. Pullback do $96,2k. Ostrożnie z LONG!</div>
                    </div>
                </div>
            </div>

            <!-- BULLS vs BEARS PSYCHOLOGY -->
            <div style="margin-top: 15px; padding: 15px; background: linear-gradient(135deg, #1a0a0a 0%, #0f0f0f 100%); border-radius: 8px; border: 2px solid #ff6600;">
                <div style="font-size: 0.9em; color: #ff6600; margin-bottom: 12px; font-weight: 700; text-transform: uppercase;">
                    👥 STAN PSYCHOLOGICZNY • BULLS vs BEARS
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                    <!-- BULLS Psychology -->
                    <div style="background: rgba(0,255,65,0.1); padding: 12px; border-radius: 5px; border-left: 3px solid #00ff41;">
                        <div style="color: #00ff41; font-weight: 700; font-size: 0.9em; margin-bottom: 8px;">🟢 BULLS (58%)</div>
                        <div style="font-size: 0.75em; color: #ccc; line-height: 1.5;">
                            <div>• <strong>Nastrój:</strong> Optymistyczny 💪</div>
                            <div>• <strong>Target:</strong> $98,500-$99,200</div>
                            <div>• <strong>Akcja:</strong> Akumulacja + hold</div>
                            <div>• <strong>Fear:</strong> Manipulation at $96,850</div>
                            <div>• <strong>Oczekiwanie:</strong> Break & Rally</div>
                        </div>
                    </div>
                    
                    <!-- BEARS Psychology -->
                    <div style="background: rgba(255,0,51,0.1); padding: 12px; border-radius: 5px; border-left: 3px solid #ff0033;">
                        <div style="color: #ff0033; font-weight: 700; font-size: 0.9em; margin-bottom: 8px;">🔴 BEARS (42%)</div>
                        <div style="font-size: 0.75em; color: #ccc; line-height: 1.5;">
                            <div>• <strong>Nastrój:</strong> Ostrożny ⚠️</div>
                            <div>• <strong>Target:</strong> $93,500-$94,800</div>
                            <div>• <strong>Akcja:</strong> Shorty + wait</div>
                            <div>• <strong>Fear:</strong> Squeeze shorts</div>
                            <div>• <strong>Oczekiwanie:</strong> Pullback soon</div>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 10px; padding: 10px; background: rgba(255,170,0,0.12); border-left: 3px solid #ffaa00; color: #ffaa00; font-size: 0.95em; font-weight: 700; line-height: 1.7;">
                    ⚡ MARKET REALITY: Dominacja BULLS, ale BEARS kontrolują support levels. Stalemate = SCALP OPPORTUNITY!
                </div>
            </div>
        </div>
        
        <!-- ECONOMIC CALENDAR & KEY EVENTS -->
        <div style="background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%); border: 1px solid #00d4ff; border-radius: 8px; padding: 20px; grid-column: 1; grid-row: 2;">
            <div onclick="toggleMacroCalendar()" style="cursor: pointer; display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; -webkit-user-select: none; user-select: none;">
                <div style="color: #00d4ff; font-size: 1.1em; font-weight: 700; text-transform: uppercase;">📅 ECONOMIC CALENDAR & KEY EVENTS</div>
                <div id="macro-toggle-icon" style="color: #00d4ff; font-size: 1.8em; transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); animation: arrowPulse 2s ease-in-out infinite; text-shadow: 0 0 10px #00d4ff, 0 0 20px #00d4ff; display: inline-block; min-width: 30px; text-align: center; font-weight: bold;">▼</div>
            </div>
            
            <div style="font-size: 0.8em; line-height: 2; color: #ccc; font-family: 'Roboto Mono', monospace;">
                <div style="background: rgba(255,170,0,0.1); padding: 8px; border-radius: 4px; margin-bottom: 8px; border-left: 3px solid #ffaa00;">
                    <div><span style="color: #ffaa00; font-weight: 700;">TODAY 20:00 UTC</span></div>
                    <div style="font-size: 0.75em; color: #ddd;">US Core Inflation (CPI) 📊 <span style="color: #ff6600;">HIGH IMPACT</span></div>
                </div>
                
                <div style="background: rgba(0,212,255,0.1); padding: 8px; border-radius: 4px; margin-bottom: 8px; border-left: 3px solid #00d4ff;">
                    <div><span style="color: #00d4ff; font-weight: 700;">TOMORROW 13:30 UTC</span></div>
                    <div style="font-size: 0.75em; color: #ddd;">Fed Speakers 🎙️ <span style="color: #fff;">MEDIUM IMPACT</span></div>
                </div>

                <div style="background: rgba(0,255,65,0.1); padding: 8px; border-radius: 4px; border-left: 3px solid #00ff41;">
                    <div><span style="color: #00ff41; font-weight: 700;">FRIDAY 10:30 UTC</span></div>
                    <div style="font-size: 0.75em; color: #ddd;">Jobs Report 💼 <span style="color: #ff0033;">CRITICAL</span></div>
                </div>
            </div>

            <div id="macro-calendar-extended" style="display: none; margin-top: 12px; padding-top: 12px; border-top: 1px solid #333;">
                <div style="font-size: 0.85em; color: #ffaa00; font-weight: 700; margin-bottom: 10px;">🗓️ MACRO CALENDAR • THIS WEEK</div>
                <div class="news-feed" style="gap: 10px; font-size: 0.78em; line-height: 1.6; color: #ddd;">
                    <div style="background: rgba(255,170,0,0.07); border-left: 3px solid #ffaa00; padding: 8px; border-radius: 4px; margin-bottom: 8px;">
                        <div style="display: flex; justify-content: space-between; color: #ccc; font-weight: 700;">
                            <span>Pon 08:30 ET</span>
                            <span style="color: #ff0033;">HIGH IMPACT</span>
                        </div>
                        <div style="color: #fff; font-weight: 700;">USA CPI (m/m)</div>
                        <div style="color: #fff;">Prog: 0.2% • Poprz: 0.1% • Rynek patrzy na presję inflacyjną</div>
                    </div>
                    <div style="background: rgba(0,255,65,0.07); border-left: 3px solid #00ff41; padding: 8px; border-radius: 4px; margin-bottom: 8px;">
                        <div style="display: flex; justify-content: space-between; color: #ccc; font-weight: 700;">
                            <span>Wto 10:00 ET</span>
                            <span style="color: #ffaa00;">MEDIUM</span>
                        </div>
                        <div style="color: #fff; font-weight: 700;">USA PPI (m/m)</div>
                        <div style="color: #fff;">Prog: 0.1% • Poprz: -0.1% • Wpływ na oczekiwania inflacyjne</div>
                    </div>
                    <div style="background: rgba(0,212,255,0.07); border-left: 3px solid #00d4ff; padding: 8px; border-radius: 4px; margin-bottom: 8px;">
                        <div style="display: flex; justify-content: space-between; color: #ccc; font-weight: 700;">
                            <span>Śro 14:00 ET</span>
                            <span style="color: #ff0033;">HIGH</span>
                        </div>
                        <div style="color: #fff; font-weight: 700;">FOMC Minutes</div>
                        <div style="color: #fff;">Sygnały dot. ścieżki stóp i bilansu Fed</div>
                    </div>
                    <div style="background: rgba(255,0,51,0.07); border-left: 3px solid #ff0033; padding: 8px; border-radius: 4px; margin-bottom: 8px;">
                        <div style="display: flex; justify-content: space-between; color: #ccc; font-weight: 700;">
                            <span>Czw 08:30 ET</span>
                            <span style="color: #ff0033;">HIGH</span>
                        </div>
                        <div style="color: #fff; font-weight: 700;">USA Initial Jobless Claims</div>
                        <div style="color: #fff;">Prog: 215k • Poprz: 210k • Wrażliwe na sentyment risk-on/off</div>
                    </div>
                    <div style="background: rgba(255,255,0,0.07); border-left: 3px solid #ffff00; padding: 8px; border-radius: 4px; margin-bottom: 8px;">
                        <div style="display: flex; justify-content: space-between; color: #ccc; font-weight: 700;">
                            <span>Pt 10:00 ET</span>
                            <span style="color: #ffaa00;">MEDIUM</span>
                        </div>
                        <div style="color: #fff; font-weight: 700;">UMich Sentiment</div>
                        <div style="color: #fff;">Prog: 72.0 • Poprz: 71.6 • Oczekiwania inflacyjne konsumentów</div>
                    </div>
                    <div style="background: rgba(255,170,0,0.07); border-left: 3px solid #ffaa00; padding: 8px; border-radius: 4px;">
                        <div style="display: flex; justify-content: space-between; color: #ccc; font-weight: 700;">
                            <span>Pt 11:00 ET</span>
                            <span style="color: #ffaa00;">MEDIUM</span>
                        </div>
                        <div style="color: #fff; font-weight: 700;">Fed Speaker</div>
                        <div style="color: #fff;">Wystąpienie nt. ścieżki stóp i QT • możliwe wskazówki dot. cięć w Q2</div>
                    </div>
                </div>
            </div>

            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #333; font-size: 0.75em; color: #fff;">
                💡 Tip: Volatility often increases before/after major economic releases. Plan your trades accordingly!
            </div>
        </div>
            <script>
                function toggleMacroCalendar() {
                    const extended = document.getElementById('macro-calendar-extended');
                    const icon = document.getElementById('macro-toggle-icon');
                    if (!extended || !icon) return;
                    const isHidden = extended.style.display === 'none' || extended.style.display === '';
                    extended.style.display = isHidden ? 'block' : 'none';
                    icon.style.transform = isHidden ? 'rotate(180deg)' : 'rotate(0deg)';
                    icon.style.animation = isHidden ? 'none' : 'arrowPulse 2s ease-in-out infinite';
                }
            </script>

        <!-- WIADOMOŚCI & ALERTY (PL) - COLLAPSIBLE -->
        <div class="news-panel" style="grid-column: 2; grid-row: 2; border: 1px solid white;">
            <div class="news-header" onclick="toggleNews()" style="cursor: pointer; display: flex; justify-content: space-between; align-items: center; -webkit-user-select: none; user-select: none;">
                <h3>📰 WIADOMOŚCI & ALERTY (PL)</h3>
                <div id="news-toggle-icon" style="font-size: 1.8em; color: white; transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); animation: arrowPulse 2s ease-in-out infinite; text-shadow: 0 0 10px white, 0 0 20px white; display: inline-block; min-width: 30px; text-align: center; font-weight: bold;">▼</div>
            </div>
            <div class="news-feed">
        
            <!-- First 3 news items - always visible -->
            <div class="news-item">
                <div class="news-meta">
                    <span class="news-time">2 min temu</span>
                    <span class="news-source">Bloomberg</span>
                    <span class="news-impact" style="color: #00ff41;">PODAZ / BULLISH</span>
                </div>
                <div class="news-headline">Wykryto duży transfer: 5 000 BTC z giełdy na cold wallet</div>
            </div>
            
            <div class="news-item">
                <div class="news-meta">
                    <span class="news-time">15 min temu</span>
                    <span class="news-source">CoinDesk</span>
                    <span class="news-impact" style="color: #00ff41;">BULLISH</span>
                </div>
                <div class="news-headline">Presja zakupowa instytucji rośnie, napływy do ETF sięgają $200M</div>
            </div>
            
            <div class="news-item">
                <div class="news-meta">
                    <span class="news-time">1 h temu</span>
                    <span class="news-source">On-chain</span>
                    <span class="news-impact" style="color: #ffaa00;">NEUTRAL</span>
                </div>
                <div class="news-headline">Poziom wsparcia przy 95 000 USD obroniony, akumulacja wielorybów</div>
            </div>
            
            <!-- Collapsible section for additional news -->
            <div id="news-extended" style="display: none;">
                <div class="news-item">
                    <div class="news-meta">
                        <span class="news-time">2 h temu</span>
                        <span class="news-source">Reuters</span>
                        <span class="news-impact" style="color: #00ff41;">BULLISH</span>
                    </div>
                    <div class="news-headline">Fed sygnalizuje możliwą obniżkę stóp w Q2 2026</div>
                </div>
                
                <div class="news-item">
                    <div class="news-meta">
                        <span class="news-time">3 h temu</span>
                        <span class="news-source">OnChain</span>
                        <span class="news-impact" style="color: #00ff41;">BULLISH</span>
                    </div>
                    <div class="news-headline">Rezerwy giełd spadają do 6-miesięcznego minimum – możliwy szok podaży</div>
                </div>
            </div>
            
            </div>
        </div>

        <script>
            function toggleNews() {
                const extended = document.getElementById('news-extended');
                const icon = document.getElementById('news-toggle-icon');
                if (!extended || !icon) return;
                const isHidden = extended.style.display === 'none' || extended.style.display === '';
                extended.style.display = isHidden ? 'block' : 'none';
                icon.style.transform = isHidden ? 'rotate(180deg)' : 'rotate(0deg)';
                icon.style.animation = isHidden ? 'none' : 'arrowPulse 2s ease-in-out infinite';
            }
        </script>

    </div>
    
    <!-- LIQUIDATIONS & GAPS -->
    <div style="padding: 15px 30px; background: #0a0a0a; display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
        <!-- BIGGEST LIQUIDATIONS -->
        <div style="background: linear-gradient(135deg, #1a001a 0%, #0a0a0a 100%); border: 1px solid #ff0033; border-radius: 8px; padding: 20px;">
            <div style="color: #ff0033; font-size: 1.1em; font-weight: 700; margin-bottom: 15px; text-transform: uppercase;">💥 NAJBLIŻSZE DUŻE LIKWIDACJE</div>
            
            <div class="liquidation-item">
                <div style="display: flex; justify-content: space-between;">
                    <span class="liquidation-price">$97,350</span>
                    <span>SHORT 850 BTC</span>
                </div>
                <div style="font-size: 0.7em; color: #fff; margin-top: 3px;">⏱️ ~5min stąd • HIGH IMPACT</div>
            </div>
            
            <div class="liquidation-item">
                <div style="display: flex; justify-content: space-between;">
                    <span class="liquidation-price">$96,200</span>
                    <span>LONG 1,200 BTC</span>
                </div>
                <div style="font-size: 0.7em; color: #fff; margin-top: 3px;">⏱️ ~12min stąd • CRITICAL</div>
            </div>
            
            <div class="liquidation-item">
                <div style="display: flex; justify-content: space-between;">
                    <span class="liquidation-price">$94,950</span>
                    <span>SHORT 650 BTC</span>
                </div>
                <div style="font-size: 0.7em; color: #fff; margin-top: 3px;">⏱️ ~22min stąd • MEDIUM</div>
            </div>
            
            <div class="liquidation-item" style="border-left-color: #00ff00;">
                <div style="display: flex; justify-content: space-between;">
                    <span style="color: #00ff00; font-weight: 900; font-size: 1.1em;">$93,500</span>
                    <span style="color: #00ff00;">SHORT 450 BTC</span>
                </div>
                <div style="font-size: 0.7em; color: #fff; margin-top: 3px;">⏱️ ~45min stąd • LOW RISK</div>
            </div>
        </div>
        
        <!-- GAPS & OPPORTUNITIES -->
        <div style="background: linear-gradient(135deg, #001a1a 0%, #0a0a0a 100%); border: 1px solid #00ffff; border-radius: 8px; padding: 20px;">
            <div style="color: #00ffff; font-size: 1.1em; font-weight: 700; margin-bottom: 15px; text-transform: uppercase;">📍 MOŻLIWE GAP'I I OKAZJE</div>
            
            <div class="liquidation-item" style="border-left-color: #00d4ff;">
                <div style="display: flex; justify-content: space-between;">
                    <span style="color: #00d4ff; font-weight: 700;">GAP UP</span>
                    <span class="liquidation-price">$98,200 - $98,500</span>
                </div>
                <div style="font-size: 0.7em; color: #00d4ff; margin-top: 3px;">📊 Po przełamaniu oporów. Szansa na RALLY</div>
            </div>
            
            <div class="liquidation-item" style="border-left-color: #ffaa00;">
                <div style="display: flex; justify-content: space-between;">
                    <span style="color: #ffaa00; font-weight: 700;">FAIR VALUE GAP</span>
                    <span style="color: #ffff00; font-weight: bold;">$95,600-$95,800</span>
                </div>
                <div style="font-size: 0.7em; color: #ffaa00; margin-top: 3px;">⚡ Idealne miejsce na SCALP BUY</div>
            </div>
            
            <div class="liquidation-item" style="border-left-color: #ff0033;">
                <div style="display: flex; justify-content: space-between;">
                    <span style="color: #ff0033; font-weight: 700;">GAP DOWN</span>
                    <span class="liquidation-price">$93,200 - $93,800</span>
                </div>
                <div style="font-size: 0.7em; color: #ff0033; margin-top: 3px;">💀 Jeśli ktoś go złamie. ULTIMATE SUPPORT</div>
            </div>
            
            <div class="liquidation-item" style="border-left-color: #00ff41;">
                <div style="display: flex; justify-content: space-between;">
                    <span style="color: #00ff41; font-weight: 700;">OVERNIGHT GAP</span>
                    <span style="color: #00ff41; font-weight: bold;">+$340 (Możliwy)</span>
                </div>
                <div style="font-size: 0.7em; color: #00ff41; margin-top: 3px;">🎯 Jeśli będzie BULLISH news w nocy</div>
            </div>
        </div>
    </div>
    
    <!-- FOOTER WITH LOGO & CLOCK -->
    <div class="footer-logo" id="footer-section">
        <span>🐹</span>
        <span>HAMSTER TRADING</span>
        <span>💎</span>
    </div>
        
    <div class="main-content">
        <div class="chart-container">
            <!-- TIMEFRAME SELECTOR & SMT ANALYSIS -->
            <div class="timeframe-selector" style="display: flex; gap: 10px; margin-bottom: 0px; flex-wrap: wrap; align-items: center;">
                <span style="color: #00ffff; font-weight: 700; font-size: 0.9em; margin-right: 10px;">⏱️ TIMEFRAME:</span>
                <button class="timeframe-btn" onclick="switchTimeframe(event, '1m')" style="padding: 8px 12px; background: #1a1a1a; border: 2px solid #333; color: #fff; cursor: pointer; border-radius: 4px; font-size: 0.85em;">1M</button>
                <button class="timeframe-btn" onclick="switchTimeframe(event, '5m')" style="padding: 8px 12px; background: #1a1a1a; border: 2px solid #333; color: #fff; cursor: pointer; border-radius: 4px; font-size: 0.85em;">5M</button>
                <button class="timeframe-btn" onclick="switchTimeframe(event, '15m')" style="padding: 8px 12px; background: #1a1a1a; border: 2px solid #333; color: #fff; cursor: pointer; border-radius: 4px; font-size: 0.85em;">15M</button>
                <button class="timeframe-btn" onclick="switchTimeframe(event, '30m')" style="padding: 8px 12px; background: #1a1a1a; border: 2px solid #333; color: #fff; cursor: pointer; border-radius: 4px; font-size: 0.85em;">30M</button>
                <button class="timeframe-btn" onclick="switchTimeframe(event, '1h')" style="padding: 8px 12px; background: #00d4ff; border: 2px solid #00d4ff; color: #0a0a0a; cursor: pointer; border-radius: 4px; font-weight: 700; font-size: 0.85em; box-shadow: 0 0 15px rgba(0,212,255,0.5);">1H</button>
                <button class="timeframe-btn" onclick="switchTimeframe(event, '4h')" style="padding: 8px 12px; background: #1a1a1a; border: 2px solid #333; color: #fff; cursor: pointer; border-radius: 4px; font-size: 0.85em;">4H</button>
                <button class="timeframe-btn" onclick="switchTimeframe(event, '1d')" style="padding: 8px 12px; background: #1a1a1a; border: 2px solid #333; color: #fff; cursor: pointer; border-radius: 4px; font-size: 0.85em;">1D</button>
                <button class="timeframe-btn" onclick="switchTimeframe(event, '1w')" style="padding: 8px 12px; background: #1a1a1a; border: 2px solid #333; color: #fff; cursor: pointer; border-radius: 4px; font-size: 0.85em;">1W</button>
                <button class="timeframe-btn" onclick="switchTimeframe(event, '1M')" style="padding: 8px 12px; background: #1a1a1a; border: 2px solid #333; color: #fff; cursor: pointer; border-radius: 4px; font-size: 0.85em;">1MONTH</button>
                <span style="margin-left: 20px; color: #00ff41; font-weight: 700; font-size: 0.9em;">📊 SMART MONEY LEVELS</span>
                <!-- CUSTOM LEGEND -->
                <div style="display: inline-flex; gap: 15px; margin-left: 30px; align-items: center; flex-wrap: wrap;">
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <span style="display: inline-block; width: 0; height: 0; border-left: 6px solid transparent; border-right: 6px solid transparent; border-bottom: 10px solid #00ff41;"></span>
                        <span style="color: #00ff41; font-size: 0.75em; font-weight: 700;">BUY SIGNAL</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <span style="display: inline-block; width: 0; height: 0; border-left: 6px solid transparent; border-right: 6px solid transparent; border-top: 10px solid #ff0033;"></span>
                        <span style="color: #ff0033; font-size: 0.75em; font-weight: 700;">SELL SIGNAL</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <span style="display: inline-block; width: 20px; height: 3px; background: #ffaa00;"></span>
                        <span style="color: #ffaa00; font-size: 0.75em; font-weight: 600;">EMA 10</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <span style="display: inline-block; width: 20px; height: 3px; background: #ff00ff;"></span>
                        <span style="color: #ff00ff; font-size: 0.75em; font-weight: 600;">EMA 20</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <span style="display: inline-block; width: 20px; height: 3px; background: #00d4ff;"></span>
                        <span style="color: #00d4ff; font-size: 0.75em; font-weight: 600;">EMA 30</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <span style="display: inline-block; width: 20px; height: 3px; background: #00ff41;"></span>
                        <span style="color: #00ff41; font-size: 0.75em; font-weight: 600;">EMA 50</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <span id="rsi-indicator" style="display: inline-block; padding: 3px 8px; background: rgba(255, 170, 0, 0.2); border: 1px solid #ffaa00; border-radius: 3px; font-size: 0.7em; font-weight: 700; color: #ffaa00;">RSI: --</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <span style="display: inline-block; width: 15px; height: 15px; background: rgba(0, 255, 65, 0.3); border: 1px solid #00ff41;"></span>
                        <span style="color: #00ff41; font-size: 0.75em; font-weight: 600;">FVG BULL</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <span style="display: inline-block; width: 15px; height: 15px; background: rgba(255, 0, 51, 0.3); border: 1px solid #ff0033;"></span>
                        <span style="color: #ff0033; font-size: 0.75em; font-weight: 600;">FVG BEAR</span>
                    </div>
                </div>
            </div>
            
            <!-- CHART ACTIVE: FVG, Support/Resistance, Liquidity Grab, Large Liquidation Levels + SMT + BUY/SELL Signals -->
            <div id="main-chart" style="height:650px; width:100%; display:block; overflow:visible; background: #0a0a0a;"></div>
            
            <!-- 🐹 AI GENIUS HAMSTER • MARKET COMMENTARY & SIGNALS (Below Chart) -->
            <div style="padding: 15px; background: #0a0a0a; border: 2px solid #bb86fc; border-radius: 8px; margin-top: 15px; margin-bottom: 15px;">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                    <h3 style="color: #bb86fc; font-family: 'Courier New', monospace; text-transform: uppercase; letter-spacing: 1px; margin: 0; font-size: 0.9em;">🐹 AI GENIUS HAMSTER • LIVE ANALYSIS</h3>
                </div>
                <div id="hamster-container" style="display: grid; grid-template-columns: 100px 1fr 80px; gap: 12px; align-items: center; background: #0f0f1a; padding: 12px; border-radius: 6px; border: 2px solid #bb86fc;">
                    <div style="text-align: center; font-size: 3em; animation: hamsterBounce 1.5s ease-in-out infinite;">🐹</div>
                    <div id="hamster-comment" style="color: #9fff9f; font-size: 0.95em; line-height: 1.7; font-family: 'Courier New', 'Courier', monospace; min-height: 50px; text-transform: uppercase; letter-spacing: 0.5px; text-shadow: 0 0 5px rgba(159, 255, 159, 0.5); background: rgba(0, 20, 0, 0.6); padding: 8px; border-radius: 3px; border: 1px solid #00ff41; overflow-y: auto;">🧠 TENSORTRADE AI AKTYWNY | Analizuję wykresy, likwidacje, Wyckoff phases, funding extremes... Małe podpowiedzi już jadą! 🚀</div>
                    <div id="hamster-emotion" style="text-align: center; font-size: 2.4em; animation: hamsterMood 2s ease-in-out infinite;">🤔</div>
                </div>
                
                <!-- Signal Badges -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 6px; margin-top: 10px;">
                    <div id="signal-buy" style="padding: 6px; background: rgba(0,255,65,0.15); border: 1px solid #00ff41; border-radius: 3px; text-align: center; font-size: 0.7em; color: #00ff41; font-weight: 700; cursor: pointer; transition: all 0.3s;">🟢 KUP</div>
                    <div id="signal-sell" style="padding: 6px; background: rgba(255,0,51,0.15); border: 1px solid #ff0033; border-radius: 3px; text-align: center; font-size: 0.7em; color: #ff0033; font-weight: 700; cursor: pointer; transition: all 0.3s;">🔴 SPRZEDAJ</div>
                    <div id="signal-scalp" style="padding: 6px; background: rgba(255,170,0,0.15); border: 1px solid #ffaa00; border-radius: 3px; text-align: center; font-size: 0.7em; color: #ffaa00; font-weight: 700; cursor: pointer; transition: all 0.3s;">⚡ SCALP</div>
                    <div id="signal-bounce" style="padding: 6px; background: rgba(0,212,255,0.15); border: 1px solid #00d4ff; border-radius: 3px; text-align: center; font-size: 0.7em; color: #00d4ff; font-weight: 700; cursor: pointer; transition: all 0.3s;">📈 ODBICIE</div>
                </div>
            </div>
            <script type="text/javascript">
                let currentTimeframe = '1h';
                let chartData = null;
                let chartInitialized = false; // Track if chart was created
                
                const smtData = {
                    '1m': { smt_level: 95550, supply_zone_start: 95600, supply_zone_end: 95750, demand_zone_start: 95400, demand_zone_end: 95500, swing_high: 95800, swing_low: 95300 },
                    '5m': { smt_level: 95560, supply_zone_start: 95650, supply_zone_end: 95850, demand_zone_start: 95350, demand_zone_end: 95450, swing_high: 95900, swing_low: 95200 },
                    '15m': { smt_level: 95580, supply_zone_start: 95700, supply_zone_end: 95950, demand_zone_start: 95300, demand_zone_end: 95400, swing_high: 96000, swing_low: 95100 },
                    '30m': { smt_level: 95600, supply_zone_start: 95800, supply_zone_end: 96100, demand_zone_start: 95250, demand_zone_end: 95350, swing_high: 96200, swing_low: 95000 },
                    '1h': { smt_level: 95600, supply_zone_start: 96000, supply_zone_end: 96300, demand_zone_start: 94800, demand_zone_end: 95100, swing_high: 97100, swing_low: 94800 },
                    '4h': { smt_level: 95800, supply_zone_start: 96800, supply_zone_end: 97200, demand_zone_start: 94200, demand_zone_end: 94600, swing_high: 97500, swing_low: 94000 },
                    '1d': { smt_level: 96000, supply_zone_start: 97500, supply_zone_end: 98000, demand_zone_start: 93500, demand_zone_end: 94000, swing_high: 99000, swing_low: 93000 },
                    '1w': { smt_level: 96500, supply_zone_start: 99000, supply_zone_end: 100000, demand_zone_start: 91500, demand_zone_end: 92500, swing_high: 102000, swing_low: 90000 },
                    '1M': { smt_level: 97000, supply_zone_start: 101000, supply_zone_end: 105000, demand_zone_start: 88000, demand_zone_end: 90000, swing_high: 108000, swing_low: 85000 }
                };
                
                const tfMap = {
                    '1m': '1', '5m': '5', '15m': '15', '30m': '30',
                    '1h': '60', '4h': '240', '1d': 'D', '1w': 'W', '1M': 'M'
                };
                
                // TradingView widget reference
                let tvWidget = null;
                
                function switchTimeframe(event, tf) {
                    try {
                        currentTimeframe = tf;
                        document.querySelectorAll('.timeframe-btn').forEach(btn => {
                            btn.style.background = '#1a1a1a';
                            m', '5m': '5m', '15m': '15m', '30m': '30m',
                    '1h': '1h', '4h': '4h', '1d': '1d', '1w': '1w', '1M': '1M'
                };
                
                function switchTimeframe(event, tf) {
                    try {
                        currentTimeframe = tf;
                        document.querySelectorAll('.timeframe-btn').forEach(btn => {
                            btn.style.background = '#1a1a1a';
                            btn.style.borderColor = '#333';
                            btn.style.color = '#999';
                            btn.style.boxShadow = 'none';
                            btn.style.fontWeight = 'normal';
                        });
                        event.target.style.background = '#00d4ff';
                        event.target.style.borderColor = '#00d4ff';
                        event.target.style.color = '#0a0a0a';
                        event.target.style.boxShadow = '0 0 15px rgba(0,212,255,0.5)';
                        event.target.style.fontWeight = '700';
                        reloadChartData(tf);onst url = `https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=${interval}&limit=${limit}`;
                        
                        const res = await fetch(url);
                        const klines = await res.json();
                        
                        if(!klines || klines.length === 0) {
                            console.error('No data from API');
                            return;
                        }
                        
                        const x = klines.map(k => new Date(k[0]));
                        const open = klines.map(k => parseFloat(k[1]));
                        const high = klines.map(k => parseFloat(k[2]));
                        const low = klines.map(k => parseFloat(k[3]));
                        const close = klines.map(k => parseFloat(k[4]));
                        
                        chartData = { x, open, high, low, close };
                        updateChartWithSMT(tf);
                        
                    } catch(e) {
                        console.error('Chart reload error:', e);
                    }
                }
                
                function updateChartWithSMT(tf) {
                    try {
                        if(!chartData) return;
                        
                        const { x, open, high, low, close } = chartData;
                        const smt = smtData[tf];
                        
                        // EMA helper
                        function computeEMA(values, period) {
                            const k = 2 / (period + 1);
                            const ema = [];
                            let prev;
                            values.forEach((v, idx) => {
                                const price = Number(v);
                                if (idx === 0) {
                                    prev = price;
                                    ema.push(price);
                                } else {
                                    prev = price * k + prev * (1 - k);
                                    ema.push(prev);
                                }
                            });
                            return ema;
                        }

                        const ema10 = computeEMA(close, 10);
                        const ema20 = computeEMA(close, 20);
                        const ema30 = computeEMA(close, 30);
                        const ema50 = computeEMA(close, 50);

                        const trace = {
                            type: 'candlestick',
                            x, open, high, low, close,
                            increasing: {line: {color: '#00ff41'}},
                            decreasing: {line: {color: '#ff0033'}},
                            xaxis: 'x',
                            yaxis: 'y',
                            name: 'BTC/USDT'
                        };

                        const ema10Trace = { type: 'scatter', mode: 'lines', x, y: ema10, line: {color: '#ffaa00', width: 1.5}, name: 'EMA 10', yaxis: 'y' };
                        const ema20Trace = { type: 'scatter', mode: 'lines', x, y: ema20, line: {color: '#00ff41', width: 2}, name: 'EMA 20', yaxis: 'y' };
                        const ema30Trace = { type: 'scatter', mode: 'lines', x, y: ema30, line: {color: '#00c3ff', width: 1.5}, name: 'EMA 30', yaxis: 'y' };
                        const ema50Trace = { type: 'scatter', mode: 'lines', x, y: ema50, line: {color: '#d633ff', width: 1.5}, name: 'EMA 50', yaxis: 'y' };

                        // Enhanced liquidity grab markers - ONLY LARGE GRABS (0.3%+ sweep)
                        const buyMarkers = [];
                        const sellMarkers = [];
                        
                        if (close.length > 10) {
                            // Calculate average price for percentage threshold
                            const avgPrice = close.reduce((a, b) => a + b, 0) / close.length;
                            const minSweepPercent = 0.003; // 0.3% minimum sweep to qualify
                            
                            // Check last 10 candles for SIGNIFICANT liquidity grabs
                            for(let i = close.length - 10; i < close.length; i++) {
                                if (i < 2) continue; // Need at least 2 previous candles
                                
                                // Find lowest low in previous 3 candles
                                let prevLowMin = Math.min(low[i-1], low[i-2]);
                                if (i >= 3) prevLowMin = Math.min(prevLowMin, low[i-3]);
                                
                                // Find highest high in previous 3 candles
                                let prevHighMax = Math.max(high[i-1], high[i-2]);
                                if (i >= 3) prevHighMax = Math.max(prevHighMax, high[i-3]);
                                
                                // BUY signal: Price sweeps BELOW recent lows by 0.3%+, then closes bullish
                                const sweepDownAmount = (prevLowMin - low[i]) / avgPrice;
                                if (sweepDownAmount >= minSweepPercent && 
                                    close[i] > open[i] && 
                                    close[i] > prevLowMin &&
                                    (close[i] - open[i]) / avgPrice >= 0.002) { // Strong bullish close
                                    buyMarkers.push({ x: x[i], y: low[i], text: '🟢 BUY' });
                                }
                                
                                // SELL signal: Price sweeps ABOVE recent highs by 0.3%+, then closes bearish
                                const sweepUpAmount = (high[i] - prevHighMax) / avgPrice;
                                if (sweepUpAmount >= minSweepPercent && 
                                    close[i] < open[i] && 
                                    close[i] < prevHighMax &&
                                    (open[i] - close[i]) / avgPrice >= 0.002) { // Strong bearish close
                                    sellMarkers.push({ x: x[i], y: high[i], text: '🔴 SELL' });
                                }
                            }
                        }

                        const buyTrace = {
                            type: 'scatter', mode: 'markers+text', x: buyMarkers.map(p => p.x), y: buyMarkers.map(p => p.y),
                            text: buyMarkers.map(p => p.text), textposition: 'bottom center', textfont: {size: 11, color: '#00ff41', family: 'Arial Black', weight: 'bold'},
                            marker: {color: '#00ff41', size: 18, symbol: 'triangle-up', line: {color: '#ffffff', width: 3}}, name: 'BUY SIGNAL', yaxis: 'y'
                        };
                        const sellTrace = {
                            type: 'scatter', mode: 'markers+text', x: sellMarkers.map(p => p.x), y: sellMarkers.map(p => p.y),
                            text: sellMarkers.map(p => p.text), textposition: 'top center', textfont: {size: 11, color: '#ff0033', family: 'Arial Black', weight: 'bold'},
                            marker: {color: '#ff0033', size: 18, symbol: 'triangle-down', line: {color: '#ffffff', width: 3}}, name: 'SELL SIGNAL', yaxis: 'y'
                        };
                        
                        // FVG (Fair Value Gap) Detection - detect unfilled price gaps
                        const fvgShapes = [];
                        if (close.length > 5) {
                            for(let i = 2; i < Math.min(close.length, close.length - 1); i++) {
                                // Bullish FVG: candle[i-2].high < candle[i].low (gap up with no overlap)
                                if (high[i-2] < low[i]) {
                                    const gapSize = low[i] - high[i-2];
                                    const avgPrice = (low[i] + high[i-2]) / 2;
                                    // Only show significant gaps (>0.15% of price)
                                    if (gapSize / avgPrice > 0.0015) {
                                        fvgShapes.push({
                                            fillcolor: "rgba(0,255,65,0.25)",
                                            layer: "below",
                                            line: { color: "#00ff41", width: 1, dash: "dot" },
                                            type: "rect",
                                            x0: x[i-1], x1: x[Math.min(i+3, x.length-1)],
                                            xref: "x",
                                            y0: high[i-2], y1: low[i],
                                            yref: "y"
                                        });
                                    }
                                }
                                // Bearish FVG: candle[i-2].low > candle[i].high (gap down with no overlap)
                                if (low[i-2] > high[i]) {
                                    const gapSize = low[i-2] - high[i];
                                    const avgPrice = (low[i-2] + high[i]) / 2;
                                    if (gapSize / avgPrice > 0.0015) {
                                        fvgShapes.push({
                                            fillcolor: "rgba(255,0,51,0.25)",
                                            layer: "below",
                                            line: { color: "#ff0033", width: 1, dash: "dot" },
                                            type: "rect",
                                            x0: x[i-1], x1: x[Math.min(i+3, x.length-1)],
                                            xref: "x",
                                            y0: high[i], y1: low[i-2],
                                            yref: "y"
                                        });
                                    }
                                }
                            }
                        }
                        
                        const smtShapes = [
                            { line: { color: "#00ff41", dash: "solid", width: 3 }, type: "line", x0: 0, x1: 1, xref: "x domain", y0: smt.smt_level, y1: smt.smt_level, yref: "y" },
                            { fillcolor: "rgba(255,0,50,0.12)", layer: "below", line: { width: 0 }, type: "rect", x0: 0, x1: 1, xref: "x domain", y0: smt.supply_zone_start, y1: smt.supply_zone_end, yref: "y" },
                            { fillcolor: "rgba(0,255,100,0.12)", layer: "below", line: { width: 0 }, type: "rect", x0: 0, x1: 1, xref: "x domain", y0: smt.demand_zone_start, y1: smt.demand_zone_end, yref: "y" },
                            { line: { color: "#ffaa00", dash: "dashdot", width: 2 }, type: "line", x0: 0, x1: 1, xref: "x domain", y0: smt.swing_high, y1: smt.swing_high, yref: "y" },
                            { line: { color: "#00d4ff", dash: "dashdot", width: 2 }, type: "line", x0: 0, x1: 1, xref: "x domain", y0: smt.swing_low, y1: smt.swing_low, yref: "y" },
                            // RESISTANCE LEVELS
                            { line: { color: "#ff6b6b", dash: "solid", width: 2 }, type: "line", x0: 0, x1: 1, xref: "x domain", y0: smt.supply_zone_end, y1: smt.supply_zone_end, yref: "y" },
                            // SUPPORT LEVELS
                            { line: { color: "#4ecdc4", dash: "solid", width: 2 }, type: "line", x0: 0, x1: 1, xref: "x domain", y0: smt.demand_zone_start, y1: smt.demand_zone_start, yref: "y" },
                            // PREMIUM ZONE (above SMT level) - żółta
                            { fillcolor: "rgba(255,215,0,0.08)", layer: "below", line: { color: "rgba(255,215,0,0.5)", width: 2, dash: "dash" }, type: "rect", x0: 0, x1: 1, xref: "x domain", y0: smt.smt_level, y1: smt.swing_high + (smt.swing_high - smt.smt_level) * 0.1, yref: "y" },
                            // DISCOUNT ZONE (below SMT level) - niebieska
                            { fillcolor: "rgba(0,150,255,0.08)", layer: "below", line: { color: "rgba(0,150,255,0.5)", width: 2, dash: "dash" }, type: "rect", x0: 0, x1: 1, xref: "x domain", y0: smt.swing_low - (smt.smt_level - smt.swing_low) * 0.1, y1: smt.smt_level, yref: "y" },
                            ...fvgShapes // Add FVG rectangles to shapes
                            { fillcolor: "rgba(0,150,255,0.08)", layer: "below", line: { color: "rgba(0,150,255,0.5)", width: 2, dash: "dash" }, type: "rect", x0: 0, x1: 1, xref: "x domain", y0: smt.swing_low - (smt.smt_level - smt.swing_low) * 0.1, y1: smt.smt_level, yref: "y" }
                        ];
                        
                        const layout = {
                            xaxis: {anchor: 'y', domain: [0, 1], gridcolor: '#1a1a1a', rangeslider: {visible: false}, color: '#ffffff', fixedrange: false},
                            yaxis: {anchor: 'x', domain: [0.50, 1.0], title: {text: 'Price (USD)', font: {color: '#ffffff', size: 12}}, gridcolor: '#1a1a1a', color: '#ffffff', fixedrange: false, scaleanchor: null},
                            xaxis2: {anchor: 'y2', domain: [0, 1], gridcolor: '#1a1a1a', color: '#ffffff', fixedrange: false},
                            yaxis2: {anchor: 'x2', domain: [0.37, 0.48], title: {text: 'RSI (14)', font: {color: '#ffffff', size: 11}}, range: [0, 100], gridcolor: '#1a1a1a', color: '#ffffff', fixedrange: false},
                            xaxis3: {anchor: 'y3', domain: [0, 1], gridcolor: '#1a1a1a', color: '#ffffff', fixedrange: false},
                            yaxis3: {anchor: 'x3', domain: [0.20, 0.35], title: {text: 'MACD', font: {color: '#ffffff', size: 11}}, gridcolor: '#1a1a1a', color: '#ffffff', fixedrange: false},
                            xaxis4: {anchor: 'y4', domain: [0, 1], gridcolor: '#1a1a1a', color: '#ffffff', fixedrange: false},
                            yaxis4: {anchor: 'x4', domain: [0.0, 0.18], title: {text: 'Volume', font: {color: '#ffffff', size: 11}}, gridcolor: '#1a1a1a', color: '#ffffff', fixedrange: false},
                            height: 650,
                            margin: {l: 50, r: 120, t: 0, b: 0},
                            hovermode: 'x unified',
                            dragmode: 'pan',
                            plot_bgcolor: '#0a0a0a',
                            paper_bgcolor: '#0a0a0a',
                            showlegend: false,
                            font: {color: '#ffffff'},
                            shapes: smtShapes,
                            annotations: [
                                // PREMIUM ZONE label
                                {
                                    x: 0.02, xref: 'x domain',
                                    y: smt.swing_high + (smt.swing_high - smt.smt_level) * 0.05, yref: 'y',
                                    text: '🟨 PREMIUM ZONE', showarrow: false,
                                    font: {size: 10, color: '#ffd700', family: 'Arial Black', weight: 'bold'},
                                    bgcolor: 'rgba(0,0,0,0.7)', bordercolor: '#ffd700', borderwidth: 1, borderpad: 4
                                },
                                // DISCOUNT ZONE label
                                {
                                    x: 0.02, xref: 'x domain',
                                    y: smt.swing_low - (smt.smt_level - smt.swing_low) * 0.05, yref: 'y',
                                    text: '🟦 DISCOUNT ZONE', showarrow: false,
                                    font: {size: 10, color: '#0096ff', family: 'Arial Black', weight: 'bold'},
                                    bgcolor: 'rgba(0,0,0,0.7)', bordercolor: '#0096ff', borderwidth: 1, borderpad: 4
                                },
                                // RESISTANCE label
                                {
                                    x: 0.98, xref: 'x domain', xanchor: 'right',
                                    y: smt.supply_zone_end, yref: 'y',
                                    text: 'RESISTANCE 🔴', showarrow: false,
                                    font: {size: 9, color: '#ff6b6b', family: 'Arial', weight: 'bold'},
                                    bgcolor: 'rgba(0,0,0,0.7)', bordercolor: '#ff6b6b', borderwidth: 1, borderpad: 3
                                },
                                // SUPPORT label
                                {
                                    x: 0.98, xref: 'x domain', xanchor: 'right',
                                    y: smt.demand_zone_start, yref: 'y',
                                    text: 'SUPPORT 🟢', showarrow: false,
                                    font: {size: 9, color: '#4ecdc4', family: 'Arial', weight: 'bold'},
                                    bgcolor: 'rgba(0,0,0,0.7)', bordercolor: '#4ecdc4', borderwidth: 1, borderpad: 3
                                }
                            ],
                            modebar: {
                                bgcolor: 'rgba(0,0,0,0.8)',
                                color: '#ffffff',
                                activecolor: '#00d4ff'
                            }
                        };
                        
                        // Use newPlot for first render, react for updates
                        const plotData = [trace, ema10Trace, ema20Trace, ema30Trace, ema50Trace, buyTrace, sellTrace];
                        const config = {
                            scrollZoom: true,
                            responsive: true,
                            displayModeBar: true,
                            displaylogo: false,
                            modeBarButtonsToAdd: [
                                {
                                    name: 'Zoom In Y',
                                    icon: {width: 500, height: 600, path: 'M448 192l-128 0 0-128-64 0 0 128-128 0 0 64 128 0 0 128 64 0 0-128 128 0z'},
                                    click: function(gd) {
                                        const yaxis = gd.layout.yaxis;
                                        const range = yaxis.range || [yaxis.autorange ? gd._fullLayout.yaxis.range[0] : yaxis.range[0], yaxis.autorange ? gd._fullLayout.yaxis.range[1] : yaxis.range[1]];
                                        const mid = (range[0] + range[1]) / 2;
                                        const span = (range[1] - range[0]) * 0.8; // Zoom in by 20%
                                        Plotly.relayout(gd, {'yaxis.range': [mid - span/2, mid + span/2]});
                                    }
                                },
                                {
                                    name: 'Zoom Out Y',
                                    icon: {width: 500, height: 600, path: 'M448 192l-320 0 0 64 320 0z'},
                                    click: function(gd) {
                                        const yaxis = gd.layout.yaxis;
                                        const range = yaxis.range || [gd._fullLayout.yaxis.range[0], gd._fullLayout.yaxis.range[1]];
                                        const mid = (range[0] + range[1]) / 2;
                                        const span = (range[1] - range[0]) * 1.25; // Zoom out by 25%
                                        Plotly.relayout(gd, {'yaxis.range': [mid - span/2, mid + span/2]});
                                    }
                                },
                                {
                                    name: 'Reset Y Axis',
                                    icon: Plotly.Icons.home,
                                    click: function(gd) {
                                        Plotly.relayout(gd, {'yaxis.autorange': true, 'yaxis3.autorange': true, 'yaxis4.autorange': true});
                                    }
                                }
                            ],
                            modeBarButtonsToRemove: ['select2d', 'lasso2d', 'autoScale2d']
                        };
                        if(!chartInitialized) {
                            Plotly.newPlot('main-chart', plotData, layout, config);
                            chartInitialized = true;
                        } else {
                            Plotly.react('main-chart', plotData, layout, config);
                        }
                        
                        // Update RSI indicator display
                        if (window.lastRSI !== undefined) {
                            const rsiIndicator = document.getElementById('rsi-indicator');
                            if (rsiIndicator) {
                                const rsi = window.lastRSI;
                                let rsiColor = '#ffaa00'; // Default yellow
                                if (rsi > 70) rsiColor = '#ff0033'; // Overbought red
                                else if (rsi < 30) rsiColor = '#00ff41'; // Oversold green
                                
                                rsiIndicator.textContent = `RSI: ${rsi.toFixed(1)}`;
                                rsiIndicator.style.color = rsiColor;
                                rsiIndicator.style.borderColor = rsiColor;
                                rsiIndicator.style.background = `rgba(${rsi > 70 ? '255,0,51' : rsi < 30 ? '0,255,65' : '255,170,0'}, 0.2)`;
                            }
                        }
                        
                    } catch(e) {
                        console.error('SMT update error:', e);
                    }
                }
                
                window.PLOTLYENV = window.PLOTLYENV || {};
                
                // TradingView Chart Initialization
                function initializeTradingViewChart() {
                    try {
                        if (typeof TradingView === 'undefined') {
                            console.warn('TradingView not loaded yet, retrying...');
                            setTimeout(initializeTradingViewChart, 100);
                            return;
                        }
                        
                        console.log('🚀 Initializing TradingView Advanced Chart...');
                        
                        new TradingView.widget({
                            "width": "100%",
                            "height": 618,
                            "symbol": "BINANCE:BTCUSDT",
                            "interval": "60",
                            "timezone": "Europe/Warsaw",
                            "theme": "dark",
                            "style": "1",
                            "locale": "pl",
                            "toolbar_bg": "#0a0a0a",
                            "enable_publishing": false,
                            "backgroundColor": "#0a0a0a",
                            "gridColor": "#1a1a1a",
                            "hide_top_toolbar": false,
                            "hide_legend": false,
                            "save_image": false,
                            "container_id": "tradingview_chart",
                            "studies": [
                                "STD;EMA",
                                "STD;RSI",
                                "STD;Volume"
                            ],
                            "show_popup_button": true,
                            "popup_width": "1000",
                            "popup_height": "650",
                            "support_host": "https://www.tradingview.com",
                            "overrides": {
                                "mainSeriesProperties.candleStyle.upColor": "#00ff41",
                                "mainSeriesProperties.candleStyle.downColor": "#ff0033",
                                "mainSeriesProperties.candleStyle.borderUpColor": "#00ff41",
                                "mainSeriesProperties.candleStyle.borderDownColor": "#ff0033",
                                "mainSeriesProperties.candleStyle.wickUpColor": "#00ff41",
                                "mainSeriesProperties.candleStyle.wickDownColor": "#ff0033",
                                "paneProperties.background": "#0a0a0a",
                                "paneProperties.vertGridProperties.color": "#1a1a1a",
                                "paneProperties.horzGridProperties.color": "#1a1a1a",
                                "scalesProperties.textColor": "#ffffff",
                                "scalesProperties.backgroundColor": "#0a0a0a"
                            }
                        });
                        
                        console.log('✅ TradingView Chart loaded successfully!');
                        chartInitialized = true;
                        
                    } catch (e) {
                        console.error('❌ TradingView Chart initialization failed:', e);
                        // Fallback to Plotly
                        console.log('📊 Switching to Plotly fallback chart...');
                        document.getElementById('tradingview-chart-container').style.display = 'none';
                        document.getElementById('main-chart').style.display = 'block';
                        initializePlotlyChart();
                    }
                }
                
                // Plotly Fallback Chart (original code)
                function initializePlotlyChart() {
                    if (!document.getElementById("main-chart")) {
                        console.error('Chart container not found');
                        return;
                    }
                   Wait for DOM and Plotly to be ready
                function initializeChart() {
                    const chartContainer = document.getElementById("main-chart");
                    
                    if (!chartContainer) {
                        console.error('❌ Chart container #main-chart not found in DOM');
                        setTimeout(initializeChart, 100);
                        return;
                    }
                    
                    if (typeof Plotly === 'undefined') {
                        console.warn('⏳ Plotly library not loaded yet, retrying...');
                        setTimeout(initializeChart, 100);
                        return;
                    }
                    
                    console.log('✅ Chart container found, Plotly loaded');
                    console.log('📊 Starting chart initialization...');
                    
                    (async () => {
                        try {
                            await reloadChartData('1h');
                            console.log('✅ Chart initialized successfully with 1h timeframe');
                            
                            // Auto-refresh chart every 60 seconds
                            setInterval(async () => {
                                try {
                                    if(currentTimeframe && chartInitialized) {
                                        await reloadChartData(currentTimeframe);
                                        console.log('🔄 Chart auto-refreshed');
                                    }
                                } catch (e) { 
                                    console.warn('⚠️ Chart refresh failed:', e); 
                                }
                            }, 60000);
                            
                        } catch (e) {
                            console.error('❌ Chart initialization FAILED:', e);
                            console.error('Error details:', e.stack);
                        }
                    })();
                }
                
                // Start initialization when DOM is ready
                if (document.readyState === 'loading') {
                    console.log('⏳ DOM still loading, waiting...');
                    document.addEventListener('DOMContentLoaded', () => {
                        console.log('✅ DOM loaded, initializing chart...');
                        initializeChart();
                    });
                } else {
                    console.log('✅ DOM already loaded, initializing chart immediately...');
                    setTimeout(initialize
                    zt.textContent = 'Weekend - giełda zamknięta';
                } else {
                    zt.textContent = timeRemaining(zurich, 22, 0);
                }
            }

            // Update panel godziny - NEW YORK (zamyka 16:00)
            const nyt = document.getElementById('ny-time-panel');
            const nys = document.getElementById('ny-status-panel');
            const nyCurrentTime = document.getElementById('ny-current-time');
            const nyVolatility = document.getElementById('ny-volatility');

            // Update current local time in New York using Intl
            if (nyCurrentTime) {
                try {
                    const timeStr = new Intl.DateTimeFormat('pl-PL', { hour: '2-digit', minute: '2-digit', timeZone: 'America/New_York' }).format(new Date());
                    nyCurrentTime.textContent = timeStr;
                } catch {}
            }

            // Derive a simple volatility signal from BTC 24h change
            if (nyVolatility) {
                const changeAbs = Math.abs(Number(marketData?.btcChange24h ?? 0));
                const estVol = Math.min(20, (changeAbs * 4)); // scale to a 0-20% band
                const levelHigh = estVol >= 12;
                nyVolatility.textContent = (levelHigh ? 'WYSOKIE' : 'NORMALNE') + ' (±' + estVol.toFixed(1) + '%)';
                nyVolatility.style.color = levelHigh ? '#ff6600' : '#ffaa00';
            }
            
            if (nyt) {
                const isWeekend = ny.weekday === 'Sat' || ny.weekday === 'Sun';
                if (isWeekend) {
                    nyt.textContent = 'Weekend - giełda zamknięta';
                } else {
                    nyt.textContent = timeRemaining(ny, 16, 0);
                }
            }
            if (nys) {
                const openWindow = (ny.weekday !== 'Sat' && ny.weekday !== 'Sun') &&
                    ((ny.hour > 9 || (ny.hour === 9 && ny.minute >= 30)) && ny.hour < 16);
                nys.textContent = openWindow ? 'STATUS: NYSE OPEN ✓' : 'STATUS: NYSE CLOSED';
                nys.style.color = openWindow ? '#00ff41' : '#ff0033';
            }

            // ===== Active Session Panel (dynamic) =====
            const asn = document.getElementById('active-session-name');
            const ast = document.getElementById('active-session-time');
            const astz = document.getElementById('active-session-tz');
            const asvol = document.getElementById('active-volatility');
            const asliq = document.getElementById('active-liquidity');

            if (asn && ast && astz && asvol && asliq) {
                // Determine open windows
                const nyOpen = (ny.weekday !== 'Sat' && ny.weekday !== 'Sun') && ((ny.hour > 9 || (ny.hour === 9 && ny.minute >= 30)) && ny.hour < 16);
                const londonOpen = (london.weekday !== 'Sat' && london.weekday !== 'Sun') && (((london.hour > 8 && london.hour < 16) || (london.hour === 8 && london.minute >= 0) || (london.hour === 16 && london.minute <= 30)));
                const zurichOpen = (zurich.weekday !== 'Sat' && zurich.weekday !== 'Sun') && (zurich.hour >= 6 && zurich.hour < 22);
                const tokyoOpen = (tokyo.weekday !== 'Sat' && tokyo.weekday !== 'Sun') && ((tokyo.hour > 9 && tokyo.hour < 15) || (tokyo.hour === 9) || (tokyo.hour === 15 && tokyo.minute === 0));

                // Precedence: New York > London > Zurich > Tokyo
                let name = 'Brak aktywnej sesji';
                let tz = '--';
                let timeStr = '--:--';
                if (nyOpen) {
                    name = 'NEW YORK'; tz = 'EST';
                    try { timeStr = new Intl.DateTimeFormat('pl-PL', { hour: '2-digit', minute: '2-digit', timeZone: 'America/New_York' }).format(new Date()); } catch {}
                } else if (londonOpen) {
                    name = 'EUROPA - LONDYN'; tz = 'GMT';
                    try { timeStr = new Intl.DateTimeFormat('pl-PL', { hour: '2-digit', minute: '2-digit', timeZone: 'Europe/London' }).format(new Date()); } catch {}
                } else if (zurichOpen) {
                    name = 'EUROPA - ZURICH'; tz = 'CET';
                    try { timeStr = new Intl.DateTimeFormat('pl-PL', { hour: '2-digit', minute: '2-digit', timeZone: 'Europe/Zurich' }).format(new Date()); } catch {}
                } else if (tokyoOpen) {
                    name = 'AZJA - TOKYO'; tz = 'JST';
                    try { timeStr = new Intl.DateTimeFormat('pl-PL', { hour: '2-digit', minute: '2-digit', timeZone: 'Asia/Tokyo' }).format(new Date()); } catch {}
                }

                asn.textContent = name;
                ast.textContent = timeStr;
                astz.textContent = tz;

                // Volatility estimate from BTC change
                const changeAbs = Math.abs(Number(window.marketData?.btcChange24h ?? 0));
                const estVol = Math.min(20, (changeAbs * 4));
                const levelHigh = estVol >= 12;
                asvol.textContent = (levelHigh ? 'WYSOKIE' : 'NORMALNE') + ' (±' + estVol.toFixed(1) + '%)';
                asvol.style.color = levelHigh ? '#ff6600' : '#ffaa00';

                // Liquidity from 24h volume
                const vol24 = Number(window.marketData?.volume24h ?? 0);
                let liqLabel = 'ŚREDNIA';
                let liqColor = '#ffaa00';
                if (vol24 > 30e9) { liqLabel = 'DOSKONAŁA'; liqColor = '#00ff41'; }
                else if (vol24 < 15e9) { liqLabel = 'NISKA'; liqColor = '#ff0033'; }
                asliq.textContent = liqLabel;
                asliq.style.color = liqColor;
            }

            // Update panel godziny - LONDON (zamyka 16:30)
            const lt = document.getElementById('london-time-panel');
            const ls = document.getElementById('london-status-panel');
            const lc = document.getElementById('london-countdown');
            if (lt) {
                const isWeekend = london.weekday === 'Sat' || london.weekday === 'Sun';
                if (isWeekend) {
                    lt.textContent = 'Weekend - giełda zamknięta';
                } else {
                    lt.textContent = timeRemaining(london, 16, 30);
                }
            }
            if (ls) {
                const londonOpen = (london.weekday !== 'Sat' && london.weekday !== 'Sun') &&
                    ((london.hour > 8 && london.hour < 16) ||
                        (london.hour === 8 && london.minute >= 0) ||
                        (london.hour === 16 && london.minute <= 30));
                ls.textContent = londonOpen ? 'OTWARTA ✓' : 'ZAMKNIĘTA';
                ls.style.color = londonOpen ? '#00ff41' : '#ff0033';
            }
            if (lc) {
                // Time until 08:00 GMT if closed
                const now = new Date();
                const londonNow = new Date(now.toLocaleString('en-US', {timeZone: 'Europe/London'}));
                const londonOpen = (london.weekday !== 'Sat' && london.weekday !== 'Sun') &&
                    ((london.hour > 8 && london.hour < 16) || (london.hour === 8 && london.minute >= 0) || (london.hour === 16 && london.minute <= 30));
                
                if (londonOpen) {
                    lc.textContent = 'OTWARTA';
                    lc.style.color = '#00ff41';
                } else {
                    let nextOpen = new Date(londonNow);
                    nextOpen.setHours(8, 0, 0, 0);
                    if (londonNow.getHours() >= 17) nextOpen.setDate(nextOpen.getDate() + 1);
                    while (nextOpen.getDay() === 0 || nextOpen.getDay() === 6) nextOpen.setDate(nextOpen.getDate() + 1);
                    
                    const diff = nextOpen - londonNow;
                    const hours = Math.floor(diff / 3600000);
                    const mins = Math.floor((diff % 3600000) / 60000);
                    lc.textContent = `${hours}h ${mins}m`;
                    lc.style.color = '#00d4ff';
                }
            }

            // Update panel godziny - TOKYO (zamyka 15:00)
            const at = document.getElementById('asia-time-panel');
            const as = document.getElementById('tokyo-status-panel');
            const tc = document.getElementById('tokyo-countdown');
            if (at) {
                const isWeekend = tokyo.weekday === 'Sat' || tokyo.weekday === 'Sun';
                if (isWeekend) {
                    at.textContent = 'Weekend - giełda zamknięta';
                } else {
                    at.textContent = timeRemaining(tokyo, 15, 0);
                }
            }
            if (as) {
                const tokyoOpen = (tokyo.weekday !== 'Sat' && tokyo.weekday !== 'Sun') &&
                    ((tokyo.hour > 9 && tokyo.hour < 15) ||
                        (tokyo.hour === 9 && tokyo.minute >= 0) ||
                        (tokyo.hour === 15 && tokyo.minute === 0));
                as.textContent = tokyoOpen ? 'OTWARTA ✓' : 'ZAMKNIĘTA';
                as.style.color = tokyoOpen ? '#00ff41' : '#ff0033';
            }
            if (tc) {
                // Time until 00:00 JST (midnight) if closed
                const now = new Date();
                const tokyoNow = new Date(now.toLocaleString('en-US', {timeZone: 'Asia/Tokyo'}));
                const tokyoOpen = (tokyo.weekday !== 'Sat' && tokyo.weekday !== 'Sun') &&
                    ((tokyo.hour > 9 && tokyo.hour < 15) || (tokyo.hour === 9 && tokyo.minute >= 0) || (tokyo.hour === 15 && tokyo.minute === 0));
                
                if (tokyoOpen) {
                    tc.textContent = 'OTWARTA';
                    tc.style.color = '#00ff41';
                } else {
                    let nextOpen = new Date(tokyoNow);
                    nextOpen.setHours(0, 0, 0, 0);
                    if (tokyoNow.getHours() >= 15) nextOpen.setDate(nextOpen.getDate() + 1);
                    while (nextOpen.getDay() === 0 || nextOpen.getDay() === 6) nextOpen.setDate(nextOpen.getDate() + 1);
                    
                    const diff = nextOpen - tokyoNow;
                    const hours = Math.floor(diff / 3600000);
                    const mins = Math.floor((diff % 3600000) / 60000);
                    tc.textContent = `${hours}h ${mins}m`;
                    tc.style.color = '#00d4ff';
                }
            }
            
            // Update NY countdown
            const nc = document.getElementById('ny-countdown');
            if (nc) {
                // Time until 09:30 ET if closed
                const now = new Date();
                const nyNow = new Date(now.toLocaleString('en-US', {timeZone: 'America/New_York'}));
                const nyOpen = (ny.weekday !== 'Sat' && ny.weekday !== 'Sun') &&
                    ((ny.hour > 9 || (ny.hour === 9 && ny.minute >= 30)) && ny.hour < 16);
                
                if (nyOpen) {
                    nc.textContent = 'OTWARTA';
                    nc.style.color = '#00ff41';
                } else {
                    let nextOpen = new Date(nyNow);
                    nextOpen.setHours(9, 30, 0, 0);
                    if (nyNow.getHours() >= 16 || (nyNow.getHours() < 9) || (nyNow.getHours() === 9 && nyNow.getMinutes() < 30)) {
                        if (nyNow.getHours() >= 16) nextOpen.setDate(nextOpen.getDate() + 1);
                    }
                    while (nextOpen.getDay() === 0 || nextOpen.getDay() === 6) nextOpen.setDate(nextOpen.getDate() + 1);
                    
                    const diff = nextOpen - nyNow;
                    const hours = Math.floor(diff / 3600000);
                    const mins = Math.floor((diff % 3600000) / 60000);
                    nc.textContent = `${hours}h ${mins}m`;
                    nc.style.color = '#00d4ff';
                }
            }
        }

        // ✓ MOVED: tick() now called after DOMContentLoaded to ensure elements exist in DOM
        // ✓ RE-ENABLED: setInterval for time panels (safe - no DOM flashing)
        setInterval(tick, 5000);  // Updates time panels every 5 seconds
        
        // ✓ Clock updates safely - only specific elements are updated
        
        
        // Timezone cycle function - automatically switch timezones
        window.timezones = [
            { tz: 'Asia/Tokyo', name: '🗼 TOKYO', btn: 0 },
            { tz: 'Europe/London', name: '� LONDON', btn: 1 },
            { tz: 'America/New_York', name: '🗽 NY', btn: 2 },
            { tz: 'Europe/Zurich', name: '🧀 ZURICH', btn: 3 },
            { tz: 'Australia/Sydney', name: '🦘 SYDNEY', btn: 4 }
        ];
        window.currentTimezoneIndex = 0;
        window.autoTimezoneInterval = null;
        
        // Timezone change function
        window.manualTimezoneSelected = false;
        window.changeTimezone = function(timezone, zoneName) {
            window.manualTimezoneSelected = true;
            
            // Stop auto-switching when user manually selects
            if (window.autoTimezoneInterval) {
                clearInterval(window.autoTimezoneInterval);
                window.autoTimezoneInterval = null;
            }
            
            const now = new Date();
            const formatter = new Intl.DateTimeFormat('en-GB', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                timeZone: timezone,
                hour12: false
            });
            
            const clockTime = document.getElementById('clock-time');
            const clockZone = document.getElementById('clock-zone');
            const clockUtcOffset = document.getElementById('clock-utc-offset');
            if (clockTime && clockZone) {
                clockTime.textContent = formatter.format(now);
                clockZone.textContent = zoneName;
                
                // Calculate and display UTC offset
                try {
                    const tzDate = new Date(now.toLocaleString('en-US', { timeZone: timezone }));
                    const utcDate = new Date(now.toLocaleString('en-US', { timeZone: 'UTC' }));
                    const diff = (tzDate - utcDate) / 3600000;
                    const utcOffset = 'UTC' + (diff >= 0 ? '+' : '') + diff;
                    if (clockUtcOffset) {
                        clockUtcOffset.textContent = utcOffset;
                    }
                } catch {}
            }
            
            // Visual feedback - reset all buttons
            document.querySelectorAll('.tz-btn').forEach(btn => {
                btn.style.opacity = '0.6';
                btn.style.boxShadow = 'none';
                btn.style.borderWidth = '1px';
            });
            
            // Highlight selected button
            event.target.style.opacity = '1';
            event.target.style.boxShadow = '0 0 15px currentColor';
            event.target.style.borderWidth = '2px';
            
            // Play beep
            if (window.playBeep) {
                playBeep(660, 80);
            }
            
            // Auto-update this timezone
            if (window.currentTimezoneInterval) {
                clearInterval(window.currentTimezoneInterval);
            }
            window.currentTimezoneInterval = setInterval(() => {
                const nowUpdate = new Date();
                const timeStr = formatter.format(nowUpdate);
                const clockTimeEl = document.getElementById('clock-time');
                if (clockTimeEl) {
                    clockTimeEl.textContent = timeStr;
                }
            }, 5000);
        };
        
        // Auto-cycle through timezones every 2 seconds
        window.startAutoTimezoneSwitch = function() {
            window.autoTimezoneInterval = setInterval(() => {
                const tzInfo = window.timezones[window.currentTimezoneIndex];
                const now = new Date();
                const formatter = new Intl.DateTimeFormat('en-GB', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    timeZone: tzInfo.tz,
                    hour12: false
                });
                
                const clockTime = document.getElementById('clock-time');
                const clockZone = document.getElementById('clock-zone');
                const clockUtcOffset = document.getElementById('clock-utc-offset');
                if (clockTime && clockZone) {
                    const newTime = formatter.format(now);
                    const newZone = tzInfo.name;
                    
                    // Calculate UTC offset
                    let utcOffset = '';
                    try {
                        const offsetMinutes = -new Date().getTimezoneOffset();
                        const tzDate = new Date(now.toLocaleString('en-US', { timeZone: tzInfo.tz }));
                        const utcDate = new Date(now.toLocaleString('en-US', { timeZone: 'UTC' }));
                        const diff = (tzDate - utcDate) / 3600000;
                        utcOffset = 'UTC' + (diff >= 0 ? '+' : '') + diff;
                    } catch {}
                    
                    // Only update if text actually changed - prevent unnecessary DOM updates
                    if (clockTime.textContent !== newTime) {
                        clockTime.textContent = newTime;
                    }
                    if (clockZone.textContent !== newZone) {
                        clockZone.textContent = newZone;
                    }
                    if (clockUtcOffset && clockUtcOffset.textContent !== utcOffset) {
                        clockUtcOffset.textContent = utcOffset;
                    }
                }
                
                // Update button highlights - NO boxShadow, NO borderWidth changes (causes reflow)
                document.querySelectorAll('.tz-btn').forEach((btn, idx) => {
                    if (idx === window.currentTimezoneIndex) {
                        btn.style.opacity = '1';
                        btn.style.filter = 'brightness(1.1) drop-shadow(0 0 10px currentColor)';
                        btn.style.borderColor = 'currentColor';
                    } else {
                        btn.style.opacity = '0.6';
                        btn.style.filter = 'brightness(0.9)';
                        btn.style.borderColor = 'rgba(255,255,255,0.1)';
                    }
                });
                
                // Move to next timezone
                window.currentTimezoneIndex = (window.currentTimezoneIndex + 1) % window.timezones.length;
            }, 2000); // Switch every 2 seconds
        };
        
        // Start auto-cycle on page load
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                window.startAutoTimezoneSwitch();
            });
        } else {
            window.startAutoTimezoneSwitch();
        }
        
        // Export tick function to global scope
        window.tick = tick;
    })();
    </script>
    
    <!-- WYCKOFF METHOD (collapsible) -->
    <div style="padding: 0 30px 10px 30px; background: #0a0a0a;">
        <div style="background: linear-gradient(135deg, #0f1a0f 0%, #0a0a0a 100%); border: 2px solid #00ff88; border-radius: 8px; padding: 15px; cursor: pointer; box-shadow: 0 0 15px rgba(0,255,136,0.15);">
            <div onclick="toggleWyckoff()" style="display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                    <div style="font-size: 1.05em; color: #00ff88; font-weight: 800;">📚 METODA WYCKOFFA</div>
                    <div style="font-size: 0.95em; color: #d0ffe8; font-family: 'Roboto Mono', monospace; font-weight: 600;">Akumulacja, dystrybucja i intencje smart money</div>
                </div>
                <div id="wyckoff-toggle-icon" style="font-size: 1.6em; color: #00ff88; transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); text-shadow: 0 0 10px #00ff88, 0 0 20px #00ff88; display: inline-block; min-width: 28px; text-align: center; font-weight: bold;">▼</div>
            </div>
            <div id="wyckoff-content" style="display: none; margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(0,255,136,0.25);">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 12px;">
                    <div style="background: rgba(0,255,136,0.08); border: 1px solid rgba(0,255,136,0.3); border-radius: 6px; padding: 14px;">
                        <div style="color: #00ff88; font-weight: 800; margin-bottom: 10px; font-size: 1.05em;">🧠 Kim był Richard Wyckoff?</div>
                        <div style="color: #d0ffe8; font-size: 0.9em; line-height: 1.7;">
                            Richard Wyckoff (1873-1934) to legendarny trader i analityk, który ujawnił <strong>jak wielkie pieniądze (smart money) manipulują rynkiem</strong>. Jego metoda opiera się na analizie <strong>podaży i popytu</strong> oraz rozpoznawaniu faz rynku.<br><br>
                            <strong style="color: #ffaa00;">Główna teza:</strong> Rynek porusza się w cyklach: akumulacja (wieloryby kupują) → markup (cena rośnie) → dystrybucja (wieloryby sprzedają) → markdown (cena spada).<br><br>
                            Wyckoff nauczył traderów <strong>czytać intencje instytucji</strong> zamiast ślepo śledzić ceny. Jego zasady działają do dziś na każdym rynku – akcje, forex, crypto.
                        </div>
                    </div>
                    
                    <div style="background: rgba(0,255,136,0.08); border: 1px solid rgba(0,255,136,0.3); border-radius: 6px; padding: 14px;">
                        <div style="color: #00ff88; font-weight: 800; margin-bottom: 10px; font-size: 1.05em;">📊 4 fazy rynku Wyckoffa</div>
                        <div style="color: #d0ffe8; font-size: 0.9em; line-height: 1.7;">
                            <strong style="color: #00ff41;">1. AKUMULACJA (Accumulation):</strong><br>
                            • Cena w konsolidacji po dużym spadku<br>
                            • Wieloryby cicho kupują od spanikowanych<br>
                            • Wolumen rośnie, ale cena nie spada dalej<br>
                            • Fazy: PS (Preliminary Support) → SC (Selling Climax) → AR (Automatic Rally) → ST (Secondary Test) → Spring (pułapka) → Sign of Strength (SOS)<br>
                            <strong>Wejście:</strong> Po Spring lub po SOS + wzrost wolumenu<br><br>
                            <strong style="color: #ffaa00;">2. MARKUP (Wzrost):</strong><br>
                            • Trend wzrostowy, seria HH i HL<br>
                            • Retail dołącza dopiero teraz (FOMO)<br>
                            • Smart money już siedzi z pozycjami z akumulacji<br>
                            <strong>Akcja:</strong> Trzymaj pozycje, trailing SL, piramiduj ostrożnie<br><br>
                            <strong style="color: #ff0033;">3. DYSTRYBUCJA (Distribution):</strong><br>
                            • Cena w konsolidacji po dużym wzroście<br>
                            • Wieloryby sprzedają retailowi na szczytach<br>
                            • Wolumen wysoki, ale cena nie rośnie<br>
                            • Fazy: PSY (Preliminary Supply) → BC (Buying Climax) → AR (Automatic Reaction) → ST (Secondary Test) → UTAD (Upthrust) → Sign of Weakness (SOW)<br>
                            <strong>Wejście SHORT:</strong> Po UTAD lub SOW + spadek wolumenu na wzrostach<br><br>
                            <strong style="color: #ff6600;">4. MARKDOWN (Spadek):</strong><br>
                            • Trend spadkowy, seria LL i LH<br>
                            • Retail panikuje i sprzedaje na dołkach<br>
                            <strong>Akcja:</strong> Shorty lub cash, czekaj na nową akumulację
                        </div>
                    </div>
                    
                    <div style="background: rgba(0,255,136,0.08); border: 1px solid rgba(0,255,136,0.3); border-radius: 6px; padding: 14px;">
                        <div style="color: #00ff88; font-weight: 800; margin-bottom: 10px; font-size: 1.05em;">🎯 Jak Wyckoff grał na rynku?</div>
                        <div style="color: #d0ffe8; font-size: 0.9em; line-height: 1.7;">
                            <strong>1. Szukał akumulacji po panice:</strong><br>
                            Gdy wszyscy sprzedawali (Selling Climax), Wyckoff obserwował wolumen. Jeśli cena przestawała spadać mimo wysokiej sprzedaży → wieloryby kupują. To był sygnał do wejścia.<br><br>
                            <strong>2. Testował poziomy (Spring/UTAD):</strong><br>
                            Wyckoff wiedział, że instytucje <strong>testują rynek</strong> przed dużym ruchem. Spring to fałszywe wybicie w dół (likwidacja stopów), po którym cena eksploduje w górę. UTAD to odwrotność – fałszywe wybicie w górę, po którym następuje spadek.<br><br>
                            <strong>3. Czekał na potwierdzenie siły (SOS/SOW):</strong><br>
                            Nie wchodził ślepo. Czekał na <strong>Sign of Strength</strong> (mocne wybicie z akumulacji z wolumenem) lub <strong>Sign of Weakness</strong> (słabe wzrosty w dystrybucji).<br><br>
                            <strong>4. Analizował cause & effect:</strong><br>
                            Im dłuższa akumulacja, tym silniejszy markup. Im dłuższa dystrybucja, tym głębszy markdown. Wyckoff mierzył "przyczynę" (długość konsolidacji) i przewidywał "skutek" (zasięg ruchu).<br><br>
                            <strong style="color: #ffaa00;">Jego sekret:</strong> Nie próbował wyłapać każdy ruch. Czekał cierpliwie na <strong>high-probability setups</strong> po zakończeniu fazy akumulacji/dystrybucji.
                        </div>
                    </div>
                    
                    <div style="background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.4); border-radius: 6px; padding: 14px;">
                        <div style="color: #00d4ff; font-weight: 800; margin-bottom: 10px; font-size: 1.05em;">💡 Praktyczne wskazówki Wyckoffa</div>
                        <div style="color: #d0ffe8; font-size: 0.9em; line-height: 1.7;">
                            <strong>• Obserwuj wolumen, nie tylko cenę:</strong> Wolumen pokazuje intencje wielorybów. Wysokie kupno przy spadkach = akumulacja. Wysokie sprzedaże przy wzrostach = dystrybucja.<br><br>
                            <strong>• Czytaj wykresy jak historię:</strong> Każda świeca to walka podaży z popytem. Kto wygrał? Jeśli cena zamyka w górnej połowie knota mimo presji sprzedaży → kupujący kontrolują.<br><br>
                            <strong>• Szukaj "pułapek" (Spring, UTAD):</strong> To najlepsze wejścia, bo retailer wyleciał na SL, a ty wchodzisz w kierunku smart money.<br><br>
                            <strong>• Nie wal na oślep w konsolidację:</strong> Poczekaj na wybicie z akumulacji/dystrybucji z wolumenem. To daje edge.<br><br>
                            <strong>• Pamiętaj: rynek się powtarza:</strong> Cykle Wyckoffa działają od 100 lat, bo psychologia tłumu się nie zmienia. Instytucje zawsze będą kupować tanio i sprzedawać drogo.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- JESSE LIVERMORE METHOD (collapsible) -->
    <div style="padding: 0 30px 10px 30px; background: #0a0a0a;">
        <div style="background: linear-gradient(135deg, #1a0a1a 0%, #0a0a0a 100%); border: 2px solid #ff0099; border-radius: 8px; padding: 15px; cursor: pointer; box-shadow: 0 0 15px rgba(255,0,153,0.15);">
            <div onclick="toggleLivermore()" style="display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                    <div style="font-size: 1.05em; color: #ff0099; font-weight: 800;">💰 JESSE LIVERMORE - BOY PLUNGER</div>
                    <div style="font-size: 0.95em; color: #ffd0ee; font-family: 'Roboto Mono', monospace; font-weight: 600;">Tape reading, pivot points i psychologia tłumu</div>
                </div>
                <div id="livermore-toggle-icon" style="font-size: 1.6em; color: #ff0099; transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); text-shadow: 0 0 10px #ff0099, 0 0 20px #ff0099; display: inline-block; min-width: 28px; text-align: center; font-weight: bold;">▼</div>
            </div>
            <div id="livermore-content" style="display: none; margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,0,153,0.25);">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 12px;">
                    <div style="background: rgba(255,0,153,0.08); border: 1px solid rgba(255,0,153,0.3); border-radius: 6px; padding: 14px;">
                        <div style="color: #ff0099; font-weight: 800; margin-bottom: 10px; font-size: 1.05em;">🎩 Kim był Jesse Livermore?</div>
                        <div style="color: #ffd0ee; font-size: 0.9em; line-height: 1.7;">
                            Jesse Livermore (1877-1940) to legenda Wall Street. W wieku 15 lat zaczął tradować w "bucket shops" (nielegalne kasyna giełdowe). <strong>W 1929 roku zarobił $100 milionów ($1.5 miliarda dzisiaj) shortując krach na giełdzie</strong> – stał się znany jako "Boy Plunger" i "The Great Bear of Wall Street".<br><br>
                            Livermore zbudował fortunę 4 razy i 3 razy ją stracił. Jego ostateczne zasady tradingu, spisane w książce <em>"Reminiscences of a Stock Operator"</em>, do dziś są biblią dla spekulantów.<br><br>
                            <strong style="color: #ffaa00;">Jego filozofia:</strong> "Nie pieniądze cię rujnują, ale głupia pycha i brak dyscypliny. Rynek zawsze ma rację – ty musisz się dostosować."
                        </div>
                    </div>
                    
                    <div style="background: rgba(255,0,153,0.08); border: 1px solid rgba(255,0,153,0.3); border-radius: 6px; padding: 14px;">
                        <div style="color: #ff0099; font-weight: 800; margin-bottom: 10px; font-size: 1.05em;">📈 Pivot Points - kluczowe poziomy</div>
                        <div style="color: #ffd0ee; font-size: 0.9em; line-height: 1.7;">
                            Livermore wynalazł koncepcję <strong>Pivot Points</strong> – kluczowych poziomów cen, które decydują o kierunku trendu.<br><br>
                            <strong style="color: #00ff41;">Pivot Points to:</strong><br>
                            • Szczyty (resistance) i dołki (support) poprzednich ruchów<br>
                            • Poziomy, przy których cena "zawahała się" wielokrotnie<br>
                            • Miejsca, gdzie wieloryby składały duże zlecenia<br><br>
                            <strong>Zasada Livermore'a:</strong><br>
                            • Jeśli cena przebije pivot w górę → kupuj (momentum long)<br>
                            • Jeśli cena przebije pivot w dół → sprzedaj/short (momentum bear)<br>
                            • Jeśli cena nie może przebić pivota → odwrócenie trendu<br><br>
                            <strong style="color: #ffaa00;">Nowoczesna wersja:</strong> Dzisiejsze pivot points to often: (High + Low + Close) / 3, ale Livermore używał prostszego podejścia – obserwował gdzie cena "zatrzymuje się" najwięcej razy.
                        </div>
                    </div>
                    
                    <div style="background: rgba(255,0,153,0.08); border: 1px solid rgba(255,0,153,0.3); border-radius: 6px; padding: 14px;">
                        <div style="color: #ff0099; font-weight: 800; margin-bottom: 10px; font-size: 1.05em;">🎯 Jak Livermore tradował?</div>
                        <div style="color: #ffd0ee; font-size: 0.9em; line-height: 1.7;">
                            <strong>1. Tape Reading (czytanie taśmy):</strong><br>
                            W jego czasach nie było wykresów – tylko "ticker tape" z cenami w czasie rzeczywistym. Livermore nauczył się <strong>czytać intencje rynku z przepływu zleceń</strong>. Dzisiaj to odpowiednik order flow i delta/volume analysis.<br><br>
                            <strong>2. Follow the trend ("linia najmniejszego oporu"):</strong><br>
                            Livermore nigdy nie walczył z trendem. Mówił: "Rynek idzie gdzie chce, a ty musisz za nim podążać." Jeśli trend był wzrostowy, kupował tylko przy cofnięciach. Jeśli spadkowy – shortował przy odbitkach.<br><br>
                            <strong>3. Czekał na potwierdzenie:</strong><br>
                            Nie wchodził "za wcześnie". Czekał aż cena <strong>przebije kluczowy pivot</strong> + wolumen potwierdzi. Dopiero wtedy stawiał duże pozycje.<br><br>
                            <strong>4. "Siedź cicho" (sit tight):</strong><br>
                            Jego najbardziej znana zasada: <strong>"It was never my thinking that made big money, it was my sitting."</strong> Największe zyski przychodziły z trzymania wygrywających pozycji przez tygodnie/miesiące, nie z overtradingu.<br><br>
                            <strong>5. Szybkie SL, wolne TP:</strong><br>
                            Jeśli trade szedł przeciw niemu – wychodził natychmiast. Jeśli szedł po jego myśli – trzymał tak długo, jak trend się nie odwrócił. R/R często 1:10 lub więcej.
                        </div>
                    </div>
                    
                    <div style="background: rgba(255,0,153,0.08); border: 1px solid rgba(255,0,153,0.3); border-radius: 6px; padding: 14px;">
                        <div style="color: #ff0099; font-weight: 800; margin-bottom: 10px; font-size: 1.05em;">📉 Krach 1929 – jak zarobił $100M</div>
                        <div style="color: #ffd0ee; font-size: 0.9em; line-height: 1.7;">
                            W 1929 roku Livermore zauważył oznaki <strong>końcowego szczytu</strong> (top):<br>
                            • Wszyscy byli "bullish" – nawet kierowcy taksówek dawali stock tips<br>
                            • Wolumen rósł, ale cena przestała rosnąć (dystrybucja Wyckoffa)<br>
                            • Wielkie "insiders" (JP Morgan, Rockefeller) cicho sprzedawali<br><br>
                            <strong>Jego strategia:</strong><br>
                            1. Otworzył małe pozycje short "testując wody"<br>
                            2. Gdy cena zaczęła spadać – dodawał agresywnie (piramidował shorty)<br>
                            3. Trzymał pozycje przez cały krach (październik 1929)<br>
                            4. Wyszedł dopiero gdy zobaczyż "paniczną kapitulację" (dno)<br><br>
                            <strong style="color: #ffaa00;">Lekcja:</strong> Livermore zarobił więcej niż 99% traderów, bo <strong>miał odwagę iść przeciwko tłumowi</strong> i cierpliwość by trzymać wygrywające pozycje. Większość ludzi stracila fortuny, bo kupowali na szczycie i sprzedawali na dnie.
                        </div>
                    </div>
                    
                    <div style="background: rgba(255,170,0,0.12); border: 1px solid rgba(255,170,0,0.4); border-radius: 6px; padding: 14px;">
                        <div style="color: #ffaa00; font-weight: 800; margin-bottom: 10px; font-size: 1.05em;">💎 Zasady Livermore'a (aktualne do dziś)</div>
                        <div style="color: #ffd0ee; font-size: 0.9em; line-height: 1.7;">
                            <strong>1. "There is nothing new in Wall Street. There can't be because speculation is as old as the hills."</strong><br>
                            → Historia się powtarza. Patterne, cykle, psychologia tłumu – to samo od 100 lat.<br><br>
                            <strong>2. "The big money is not in the buying or selling, but in the waiting."</strong><br>
                            → Największe zyski z długoterminowych trendów, nie z scalpingu.<br><br>
                            <strong>3. "Don't take action with a trade until the market, itself, confirms your opinion."</strong><br>
                            → Czekaj na potwierdzenie (wybicie pivota + wolumen). Nie anticipuj.<br><br>
                            <strong>4. "Never average down. If you buy at 50 and it goes to 45, don't buy more. Wait for 55."</strong><br>
                            → Dodawaj tylko do wygrywających pozycji, nigdy do przegranych.<br><br>
                            <strong>5. "Cut your losses quickly and let your profits run."</strong><br>
                            → Klasyka. SL = twój najlepszy przyjaciel.<br><br>
                            <strong style="color: #ff0033;">Ostrzeżenie:</strong> Livermore stracił fortunę 3 razy, głównie przez overtrading, brak dyscypliny i emocje po rozwodzie. Nawet geniusze padają, jeśli złamią własne zasady. Trading to 80% psychologia, 20% technika.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- LIQUIDATION & FUNDING ALERTS (collapsible) -->
    <div style="padding: 0 30px 10px 30px; background: #0a0a0a;">
        <div style="background: linear-gradient(135deg, #041a1f 0%, #0a0a0a 100%); border: 2px solid #00e1ff; border-radius: 8px; padding: 15px; cursor: pointer; box-shadow: 0 0 15px rgba(0,225,255,0.15);">
            <div onclick="toggleLiqFunding()" style="display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                    <div style="font-size: 1.05em; color: #00e1ff; font-weight: 800;">📡 STREFY LIKWIDACJI + FUNDING ALERTS</div>
                    <div style="font-size: 0.95em; color: #e0ffff; font-family: 'Roboto Mono', monospace; font-weight: 600;">progi funding, bias, klastery likwidacji</div>
                </div>
                <div id="liq-funding-toggle-icon" style="font-size: 1.6em; color: #00e1ff; transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); text-shadow: 0 0 10px #00e1ff, 0 0 20px #00e1ff; display: inline-block; min-width: 28px; text-align: center; font-weight: bold;">▼</div>
            </div>
            <div id="liq-funding-content" style="display: none; margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(0,225,255,0.25);">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 12px;">
                    <div style="background: rgba(0,225,255,0.08); border: 1px solid rgba(0,225,255,0.3); border-radius: 6px; padding: 12px;">
                        <div style="color: #00e1ff; font-weight: 800; margin-bottom: 8px;">Funding → bias</div>
                        <div style="color: #d8faff; font-size: 0.9em; line-height: 1.6;">
                            • &gt; +0.010%: short bias / szukaj short squeeze na szczytach<br>
                            • &lt; -0.010%: long bias / szukaj long squeeze przy dołkach<br>
                            • Skok funding + CVD czerwone = podwójne ostrzeżenie na longi<br>
                            • Funding dodatni + open interest rośnie + cena w bok = ryzyko long squeeze
                        </div>
                        <div style="margin-top: 8px; color: #ffaa00; font-size: 0.85em;">Alert: ustaw trigger, gdy funding przekroczy ±0.012% oraz OI ↑ w 30m</div>
                    </div>
                    <div style="background: rgba(0,225,255,0.08); border: 1px solid rgba(0,225,255,0.3); border-radius: 6px; padding: 12px;">
                        <div style="color: #00e1ff; font-weight: 800; margin-bottom: 8px;">Mapa likwidacji</div>
                        <div style="color: #d8faff; font-size: 0.9em; line-height: 1.6;">
                            • Klaster short: $98.2k / $99.5k → cel na wybicia<br>
                            • Klaster long: $93.8k / $92.1k → cel na spadki<br>
                            • Reguła: jeśli delta zielona + przebicie short klastrów → momentum long<br>
                            • Jeśli wolumen maleje przy dojściu do klastrów → możliwy fakeout / odrzut
                        </div>
                        <div style="margin-top: 8px; color: #ffaa00; font-size: 0.85em;">Tip: po wybiciu klastra obserwuj retest poziomu jako potencjalne wejście</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- IMBALANCE + DYW. (collapsible) -->
    <div style="padding: 0 30px 10px 30px; background: #0a0a0a;">
        <div style="background: linear-gradient(135deg, #1a1200 0%, #0a0a0a 100%); border: 2px solid #ffb347; border-radius: 8px; padding: 15px; cursor: pointer; box-shadow: 0 0 15px rgba(255,179,71,0.15);">
            <div onclick="toggleImbalanceDiv()" style="display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                    <div style="font-size: 1.05em; color: #ffb347; font-weight: 800;">⚖️ IMBALANCE & DYW. W SKRÓCIE</div>
                    <div style="font-size: 0.95em; color: #ffe7c2; font-family: 'Roboto Mono', monospace; font-weight: 600;">dysproporcja bid/ask + momentum vs cena</div>
                </div>
                <div id="imbalance-toggle-icon" style="font-size: 1.6em; color: #ffb347; transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); text-shadow: 0 0 10px #ffb347, 0 0 20px #ffb347; display: inline-block; min-width: 28px; text-align: center; font-weight: bold;">▼</div>
            </div>
            <div id="imbalance-content" style="display: none; margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,179,71,0.25);">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 12px;">
                    <div style="background: rgba(255,179,71,0.08); border: 1px solid rgba(255,179,71,0.35); border-radius: 6px; padding: 12px;">
                        <div style="color: #ffb347; font-weight: 800; margin-bottom: 8px;">Imbalance (orderbook / footprint)</div>
                        <div style="color: #ffe7c2; font-size: 0.9em; line-height: 1.6;">
                            • Bid/Ask &gt; 60/40 → przewaga kupna; &lt; 40/60 → przewaga sprzedaży<br>
                            • Duże bloki na ask + brak wybicia ceny = absorpcja → potencjalny spadek<br>
                            • Delta dodatnia, cena stoi w miejscu → możliwa dystrybucja<br>
                            • Delta ujemna, cena nie spada → możliwa akumulacja
                        </div>
                        <div style="margin-top: 8px; color: #ffaa00; font-size: 0.85em;">Wejście: po wybiciu poziomu, gdy delta potwierdza, a bloki po stronie wybicia znikają</div>
                    </div>
                    <div style="background: rgba(255,179,71,0.08); border: 1px solid rgba(255,179,71,0.35); border-radius: 6px; padding: 12px;">
                        <div style="color: #ffb347; font-weight: 800; margin-bottom: 8px;">Dywergencje (cena vs momentum)</div>
                        <div style="color: #ffe7c2; font-size: 0.9em; line-height: 1.6;">
                            • Bullish: cena ↓, RSI/MACD/Delta ↑ → szukaj long po retest<br>
                            • Bearish: cena ↑, RSI/MACD/Delta ↓ → szukaj short po retest<br>
                            • Volume divergence: cena rośnie, wolumen maleje → ryzyko wyczerpania ruchu<br>
                            • Połączenie: dywergencja + imbalance na ask (duże oferty) = mocny sygnał spadkowy
                        </div>
                        <div style="margin-top: 8px; color: #ffaa00; font-size: 0.85em;">Plan: poczekaj na świecę potwierdzającą i ustaw SL poza ostatni swing (lub nad absorpcją)</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- HOW TO ANALYZE PATTERNS (collapsible) -->
    <div style="padding: 0 30px 10px 30px; background: #0a0a0a;">
        <div style="background: linear-gradient(135deg, #0a1a0a 0%, #0a0a0a 100%); border: 2px solid #d946ef; border-radius: 8px; padding: 15px; cursor: pointer; box-shadow: 0 0 15px rgba(217,70,239,0.15);">
            <div onclick="toggleAnalysisGuide()" style="display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                    <div style="font-size: 1.1em; color: #d946ef; font-weight: 800;">📊 JAK ANALIZOWAĆ PATTERY • PRAKTYCZNY PORADNIK</div>
                    <div style="font-size: 1em; color: #fff; font-family: 'Roboto Mono', monospace; font-weight: 600;">
                        Krok po kroku: rozpoznanie → analiza → akcja
                    </div>
                </div>
                <div id="analysis-toggle-icon" style="font-size: 1.8em; color: #d946ef; transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); text-shadow: 0 0 10px #d946ef, 0 0 20px #d946ef; animation: arrowPulse 2s ease-in-out infinite; display: inline-block; min-width: 30px; text-align: center; font-weight: bold;">▼</div>
            </div>
            <div id="analysis-guide-content" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(0,212,255,0.3);">
                
                <!-- STEP 1: IDENTIFY -->
                <div style="background: rgba(217,70,239,0.08); border-left: 4px solid #d946ef; padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                    <div style="font-size: 0.95em; color: #d946ef; font-weight: 700; margin-bottom: 12px; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">🔍 KROK 1: IDENTYFIKACJA WZORCA</div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 12px;">
                        <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                            <div style="flex: 1;">
                                <div style="color: #d946ef; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">📍 Znajdź pierwsze znaki</div>
                                <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                    <strong>Na co patrzeć:</strong><br>
                                    ✓ Kształt świec - wysoki/niski knot?<br>
                                    ✓ Wielkość korpusu - mały czy duży?<br>
                                    ✓ Wolumen - rośnie czy spada?<br>
                                    ✓ Poziom ceny - przy wsparciu/oporze?<br>
                                    <strong>Uwaga:</strong> Czasami pierwsza świeca wymaga potwierdzenia drugą!
                                </div>
                            </div>
                            <svg width="90" height="80" viewBox="0 0 90 80" style="flex-shrink: 0;">
                                <!-- Linia siatki ceny -->
                                <line x1="10" y1="40" x2="80" y2="40" stroke="#d946ef" stroke-width="0.5" opacity="0.3" stroke-dasharray="2,2"/>
                                <!-- Świeca 1 -->
                                <line x1="25" y1="15" x2="25" y2="65" stroke="#ff0033" stroke-width="1" opacity="0.7"/>
                                <rect x="20" y="30" width="10" height="30" fill="#ff0033" stroke="#ff0033" stroke-width="1"/>
                                <!-- Świeca 2 -->
                                <line x1="50" y1="20" x2="50" y2="60" stroke="#00ff41" stroke-width="1" opacity="0.7"/>
                                <rect x="45" y="28" width="10" height="28" fill="#00ff41" stroke="#00ff41" stroke-width="1"/>
                                <!-- Wskaźnik znaku zapytania -->
                                <text x="70" y="45" font-size="24" fill="#ffaa00" text-anchor="middle">?</text>
                            </svg>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                            <div style="flex: 1;">
                            <div style="color: #d946ef; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🎯 Rozpoznaj kontekst</div>
                                <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                    <strong>Gdzie się pojawia?</strong><br>
                                    ✓ Na dnie = Reversal (odwrócenie)<br>
                                    ✓ Na szczycie = Reversal (odwrócenie)<br>
                                    ✓ W trendzie = Continuation (ciąg dalszy)<br>
                                    ✓ W konsolidacji = Wybicie<br>
                                    <strong>Zasada:</strong> Wzorzec w trencie ≠ na dnie trendu!
                                </div>
                            </div>
                            <svg width="90" height="80" viewBox="0 0 90 80" style="flex-shrink: 0;">
                                <!-- Trend up -->
                                <path d="M 15,65 L 40,50 L 50,40" stroke="#00ff41" stroke-width="2" fill="none" opacity="0.8"/>
                                <!-- Wzorzec - hammer na dnie -->
                                <line x1="55" y1="25" x2="55" y2="65" stroke="#ffaa00" stroke-width="1.5" opacity="0.8"/>
                                <rect x="50" y="60" width="10" height="5" fill="#ffaa00" stroke="#ffaa00" stroke-width="1"/>
                                <!-- Strzałka kontekstu -->
                                <path d="M 60,40 L 75,50" stroke="#d946ef" stroke-width="1.5" fill="none" marker-end="url(#arrowhead)"/>
                                <text x="77" y="35" font-size="12" fill="#d946ef" font-weight="bold">DÓŁ</text>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <!-- STEP 2: CONFIRM -->
                <div style="background: rgba(30,144,255,0.08); border-left: 4px solid #1e90ff; padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                    <div style="font-size: 0.95em; color: #1e90ff; font-weight: 700; margin-bottom: 12px; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">✅ KROK 2: POTWIERDZENIE</div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 12px;">
                        <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                            <div style="flex: 1;">
                                <div style="color: #1e90ff; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">📈 Następna świeca potwierdza</div>
                                <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                    <strong>Bycze potwierdzenie:</strong><br>
                                    ✓ Następna świeca ZIELONA<br>
                                    ✓ Zamknięcie wyżej (lub znacznie wyżej)<br>
                                    ✓ Wolumen rośnie<br>
                                    ✓ RSI wychodzi z oversold<br>
                                    ⚠️ Bez potwierdzenia = False signal!
                                </div>
                            </div>
                            <svg width="90" height="80" viewBox="0 0 90 80" style="flex-shrink: 0;">
                                <!-- Świeca młotka -->
                                <line x1="30" y1="20" x2="30" y2="65" stroke="#ffaa00" stroke-width="1" opacity="0.7"/>
                                <rect x="25" y="60" width="10" height="5" fill="#ffaa00" stroke="#ffaa00" stroke-width="1"/>
                                <!-- Potwierdzenie - następna green -->
                                <line x1="55" y1="35" x2="55" y2="65" stroke="#00ff41" stroke-width="1.5" opacity="0.9"/>
                                <rect x="50" y="38" width="10" height="27" fill="#00ff41" stroke="#00ff41" stroke-width="1.5"/>
                                <!-- Checkmark -->
                                <path d="M 72,45 L 78,51 L 85,38" stroke="#00ff41" stroke-width="2" fill="none" stroke-linecap="round"/>
                            </svg>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                            <div style="flex: 1;">
                                <div style="color: #1e90ff; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">📊 Wskaźniki potwierdzają</div>
                                <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                    <strong>Które sprawdzić:</strong><br>
                                    ✓ <strong>RSI</strong> - poniżej 30 = oversold<br>
                                    ✓ <strong>MACD</strong> - linia sygnału przecięta<br>
                                    ✓ <strong>Bollinger</strong> - cena przy dolnej linii<br>
                                    ✓ <strong>Wolumen</strong> - > średnia 20-dni<br>
                                    <strong>Zasada 2/3:</strong> 2 z 3 wskaźników OK = wejście
                                </div>
                            </div>
                            <svg width="90" height="80" viewBox="0 0 90 80" style="flex-shrink: 0;">
                                <!-- RSI niska -->
                                <path d="M 15,70 L 35,50 L 55,45 L 75,60" stroke="#ff0033" stroke-width="1.5" fill="none" opacity="0.6"/>
                                <text x="80" y="50" font-size="10" fill="#ff0033">RSI</text>
                                <!-- MACD crossover -->
                                <path d="M 15,50 L 45,50" stroke="#ffaa00" stroke-width="1.5" opacity="0.6"/>
                                <path d="M 15,45 L 45,50" stroke="#00d4ff" stroke-width="1.5" opacity="0.6"/>
                                <circle cx="45" cy="50" r="3" fill="#00ff41" opacity="0.7"/>
                                <!-- Potwierdzenie -->
                                <text x="50" y="25" font-size="12" fill="#00ff41" font-weight="bold">✓ OK!</text>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <!-- STEP 3: ENTER -->
                <div style="background: rgba(255,20,147,0.08); border-left: 4px solid #ff1493; padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                    <div style="font-size: 0.95em; color: #ff1493; font-weight: 700; margin-bottom: 12px; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">🎬 KROK 3: WEJŚCIE NA POZYCJĘ</div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 12px;">
                        <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                            <div style="flex: 1;">
                                <div style="color: #ff1493; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">💰 Wejdź inteligentnie</div>
                                <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                    <strong>Gdzie wejść (LONG):</strong><br>
                                    ✓ Na 50% zniesienia poprzedniej czerwonej<br>
                                    ✓ Po przejściu przez opór potwierdzenia<br>
                                    ✓ Na retest wsparcia po wybiciu<br>
                                    ✓ Gdzie jest największe skupienie popytu<br>
                                    <strong>Wielkość:</strong> 2-3% kapitału na pozycję!
                                </div>
                            </div>
                            <svg width="90" height="80" viewBox="0 0 90 80" style="flex-shrink: 0;">
                                <!-- Poprzednia red świeca -->
                                <line x1="20" y1="20" x2="20" y2="60" stroke="#ff0033" stroke-width="1" opacity="0.6"/>
                                <rect x="15" y="35" width="10" height="25" fill="#ff0033" stroke="#ff0033" stroke-width="1" opacity="0.6"/>
                                <!-- Linia 50% -->
                                <line x1="10" y1="45" x2="85" y2="45" stroke="#ffaa00" stroke-width="1" stroke-dasharray="2,2" opacity="0.7"/>
                                <!-- Pozycja wejścia -->
                                <circle cx="45" cy="45" r="4" fill="#00ff41" stroke="#00ff41" stroke-width="2"/>
                                <text x="45" y="65" font-size="10" fill="#00ff41" text-anchor="middle">ENTRY</text>
                            </svg>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                            <div style="flex: 1;">
                                <div style="color: #ff1493; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🛑 Stop Loss zawsze!</div>
                                <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                    <strong>Gdzie ustawić SL:</strong><br>
                                    ✓ <strong>Hammer:</strong> 2% poniżej dolnego knota<br>
                                    ✓ <strong>Engulfing:</strong> Pod całą formacją<br>
                                    ✓ <strong>Breakout:</strong> Poniżej przełamanego poziomu<br>
                                    ✓ <strong>Head & Shoulders:</strong> Nad prawym ramieniem<br>
                                    <strong>Reguła 1:2:</strong> Zysk musi być 2x większy!
                                </div>
                            </div>
                            <svg width="90" height="80" viewBox="0 0 90 80" style="flex-shrink: 0;">
                                <!-- Cena wejścia -->
                                <circle cx="45" cy="35" r="3" fill="#00ff41" stroke="#00ff41" stroke-width="2"/>
                                <line x1="50" y1="35" x2="75" y2="35" stroke="#00ff41" stroke-width="1" stroke-dasharray="2,2" opacity="0.7"/>
                                <!-- Stop Loss -->
                                <circle cx="45" cy="60" r="3" fill="#ff0033" stroke="#ff0033" stroke-width="2"/>
                                <line x1="50" y1="60" x2="75" y2="60" stroke="#ff0033" stroke-width="1" stroke-dasharray="2,2" opacity="0.7"/>
                                <!-- Target (2x) -->
                                <circle cx="45" cy="10" r="3" fill="#00d4ff" stroke="#00d4ff" stroke-width="2"/>
                                <line x1="50" y1="10" x2="75" y2="10" stroke="#00d4ff" stroke-width="1" stroke-dasharray="2,2" opacity="0.7"/>
                                <text x="80" y="38" font-size="9" fill="#00ff41">ENTRY</text>
                                <text x="80" y="63" font-size="9" fill="#ff0033">SL</text>
                                <text x="80" y="15" font-size="9" fill="#00d4ff">TP</text>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <!-- STEP 4: MANAGE -->
                <div style="background: rgba(255,215,0,0.08); border-left: 4px solid #ffd700; padding: 15px; border-radius: 6px;">
                    <div style="font-size: 0.95em; color: #ffd700; font-weight: 700; margin-bottom: 12px; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">⚙️ KROK 4: ZARZĄDZANIE POZYCJĄ</div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 12px;">
                        <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                            <div style="flex: 1;">
                                <div style="color: #ffd700; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🎯 Trailing Stop Loss</div>
                                <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                    <strong>Kiedy zysk rośnie:</strong><br>
                                    ✓ +50% (1:1) → Przenieś SL do entry<br>
                                    ✓ +100% (1:2) → Przenieś SL do +50%<br>
                                    ✓ +150%+ (1:3) → Przenieś SL do +100%<br>
                                    ✓ Pozwól czarom działać!<br>
                                    <strong>Blokada:</strong> Nigdy nie pozwól na powrót poniżej entry!
                                </div>
                            </div>
                            <svg width="90" height="80" viewBox="0 0 90 80" style="flex-shrink: 0;">
                                <!-- Cena rośnie -->
                                <path d="M 20,70 L 35,55 L 50,40 L 65,20" stroke="#00ff41" stroke-width="2" fill="none" opacity="0.8"/>
                                <!-- SL trailing up -->
                                <line x1="20" y1="75" x2="20" y2="72" stroke="#ff0033" stroke-width="2" opacity="0.5"/>
                                <line x1="35" y1="60" x2="35" y2="57" stroke="#ff0033" stroke-width="2" opacity="0.7"/>
                                <line x1="50" y1="45" x2="50" y2="42" stroke="#ff0033" stroke-width="2" opacity="0.8"/>
                                <line x1="65" y1="25" x2="65" y2="22" stroke="#ff0033" stroke-width="2"/>
                                <!-- Zysk text -->
                                <text x="72" y="30" font-size="10" fill="#00ff41" font-weight="bold">+150%</text>
                            </svg>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                            <div style="flex: 1;">
                                <div style="color: #ffd700; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">❌ Kiedy wyjść ZAWSZE</div>
                                <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                    <strong>Red flags - wyjdź TERAZ:</strong><br>
                                    ✓ Divergence na wskaźnikach (cena rośnie, RSI spada)<br>
                                    ✓ Złapanie rezystencji trzeci raz<br>
                                    ✓ Nagły skok wolumenu na czerwoną świecę<br>
                                    ✓ Przebicie SL = brak dyskusji!<br>
                                    <strong>Emocje:</strong> Strach zysku? Zamknij 50%!
                                </div>
                            </div>
                            <svg width="90" height="80" viewBox="0 0 90 80" style="flex-shrink: 0;">
                                <!-- Cena do góry -->
                                <path d="M 20,65 L 45,30" stroke="#00ff41" stroke-width="2" fill="none" opacity="0.8"/>
                                <!-- Spadek - divergence -->
                                <path d="M 45,30 L 65,45" stroke="#ff0033" stroke-width="2" fill="none" opacity="0.9"/>
                                <!-- Divergence marker -->
                                <circle cx="45" cy="30" r="4" fill="#ffaa00" stroke="#ffaa00" stroke-width="2"/>
                                <text x="72" y="35" font-size="9" fill="#ffaa00">DIV!</text>
                                <!-- Exit point -->
                                <text x="25" y="25" font-size="11" fill="#ff0033" font-weight="bold">EXIT!</text>
                            </svg>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
    
    <script>
        function toggleAnalysisGuide() {
            const content = document.getElementById('analysis-guide-content');
            const icon = document.getElementById('analysis-toggle-icon');
            if (content && icon) {
                if (content.style.display === 'none') {
                    content.style.display = 'block';
                    icon.style.transform = 'rotate(180deg)';
                    icon.style.animation = 'none';
                } else {
                    content.style.display = 'none';
                    icon.style.transform = 'rotate(0deg)';
                    icon.style.animation = 'arrowPulse 2s ease-in-out infinite';
                }
            }
        }

        function toggleLiqFunding() {
            const content = document.getElementById('liq-funding-content');
            const icon = document.getElementById('liq-funding-toggle-icon');
            if (content && icon) {
                const isHidden = content.style.display === 'none';
                content.style.display = isHidden ? 'block' : 'none';
                icon.style.transform = isHidden ? 'rotate(180deg)' : 'rotate(0deg)';
            }
        }

        function toggleImbalanceDiv() {
            const content = document.getElementById('imbalance-content');
            const icon = document.getElementById('imbalance-toggle-icon');
            if (content && icon) {
                const isHidden = content.style.display === 'none';
                content.style.display = isHidden ? 'block' : 'none';
                icon.style.transform = isHidden ? 'rotate(180deg)' : 'rotate(0deg)';
            }
        }
    </script>
    
        <!-- TRADING CANDLESTICK • PATTERNS & STRATEGIES (collapsible) -->
        <div style="padding: 0 30px 10px 30px; background: #0a0a0a;">
            <div style="background: linear-gradient(135deg, #1a0f0a 0%, #0a0a0a 100%); border: 2px solid #ffaa00; border-radius: 8px; padding: 15px; cursor: pointer; box-shadow: 0 0 15px rgba(255,170,0,0.15);">
                <div onclick="toggleTradingCandlestick()" style="display: flex; justify-content: space-between; align-items: center;">
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <div style="font-size: 1.1em; color: #ffaa00; font-weight: 800;">🕯️ TRADING CANDLESTICK • PATTERNS & STRATEGIES</div>
                        <div style="font-size: 1em; color: #fff; font-family: 'Roboto Mono', monospace; font-weight: 600;">
                            Wzorce świecowe, strategie i formacje wykresów
                        </div>
                    </div>
                    <div id="candlestick-toggle-icon" style="font-size: 1.8em; color: #ffaa00; transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); text-shadow: 0 0 10px #ffaa00, 0 0 20px #ffaa00; animation: arrowPulse 2s ease-in-out infinite; display: inline-block; min-width: 30px; text-align: center; font-weight: bold;">▼</div>
                </div>
                <div id="trading-candlestick-content" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,170,0,0.3);">
                    
                    <!-- CANDLESTICK PATTERNS -->
                    <div style="margin-bottom: 25px;">
                        <div style="font-size: 1.1em; color: #ffaa00; font-weight: 700; margin-bottom: 15px; font-family: 'Roboto Mono', monospace;">🕯️ WZORCE ŚWIECOWE (CANDLESTICK PATTERNS)</div>
                        
                        <!-- Bullish Patterns -->
                        <div style="background: rgba(0,255,65,0.08); border-left: 4px solid #00ff41; padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                            <div style="font-size: 0.95em; color: #00ff41; font-weight: 700; margin-bottom: 12px; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">📈 WZORCE BYCZE (BULLISH PATTERNS)</div>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 12px;">
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #00ff41; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🔨 HAMMER (Młotek)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Jak rozpoznać:</strong> Mały korpus u góry świecy, długi dolny knot (2-3x dłuższy niż korpus), krótki lub brak górnego knota.<br>
                                            <strong>Znaczenie:</strong> Sprzedający zdominowali początek sesji, ale kupujący odepchnęli cenę do góry. Silny sygnał odwrócenia trendu spadkowego.<br>
                                            <strong>Kiedy działać:</strong> Pojawia się na dnie trendu spadkowego. Potwierdź następną zieloną świecą.
                                        </div>
                                    </div>
                                    <svg width="80" height="100" viewBox="0 0 80 100" style="flex-shrink: 0;">
                                        <!-- Dolny knot -->
                                        <line x1="40" y1="20" x2="40" y2="70" stroke="#00ff41" stroke-width="1" opacity="0.7"/>
                                        <!-- Korpus -->
                                        <rect x="30" y="65" width="20" height="15" fill="#00ff41" stroke="#00ff41" stroke-width="1"/>
                                        <!-- Górny knot mały -->
                                        <line x1="40" y1="65" x2="40" y2="60" stroke="#00ff41" stroke-width="1" opacity="0.7"/>
                                    </svg>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #00ff41; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">⭐ MORNING STAR (Poranna Gwiazda)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Jak rozpoznać:</strong> 3 świece - długa czerwona, mała (doji/młotek), długa zielona.<br>
                                            <strong>Znaczenie:</strong> Trend spadkowy traci momentum (mała środkowa świeca), kupujący przejmują kontrolę (trzecia świeca).<br>
                                            <strong>Kiedy działać:</strong> Po potwierdzeniu trzecią świecą, która zamyka się powyżej środka pierwszej czerwonej świecy.
                                        </div>
                                    </div>
                                    <svg width="100" height="100" viewBox="0 0 100 100" style="flex-shrink: 0;">
                                        <!-- Świeca 1 - Czerwona długa -->
                                        <line x1="20" y1="20" x2="20" y2="70" stroke="#ff0033" stroke-width="1" opacity="0.7"/>
                                        <rect x="12" y="40" width="16" height="30" fill="#ff0033" stroke="#ff0033" stroke-width="1"/>
                                        <!-- Świeca 2 - Mała Doji -->
                                        <line x1="50" y1="50" x2="50" y2="70" stroke="#ffaa00" stroke-width="1" opacity="0.7"/>
                                        <rect x="48" y="58" width="4" height="2" fill="#ffaa00" stroke="#ffaa00" stroke-width="1"/>
                                        <!-- Świeca 3 - Zielona długa -->
                                        <line x1="80" y1="20" x2="80" y2="70" stroke="#00ff41" stroke-width="1" opacity="0.7"/>
                                        <rect x="72" y="25" width="16" height="45" fill="#00ff41" stroke="#00ff41" stroke-width="1"/>
                                    </svg>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #00ff41; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🐂 BULLISH ENGULFING (Bycze Objęcie)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Jak rozpoznać:</strong> Mała czerwona świeca, następnie duża zielona świeca, która całkowicie "pochłania" korpus poprzedniej.<br>
                                            <strong>Znaczenie:</strong> Kupujący zdominowali sprzedających w bardzo silny sposób. Zmiana sentymentu rynkowego.<br>
                                            <strong>Kiedy działać:</strong> Im większa różnica wielkości, tym silniejszy sygnał. Najlepiej przy wsparciu.
                                        </div>
                                    </div>
                                    <svg width="100" height="100" viewBox="0 0 100 100" style="flex-shrink: 0;">
                                        <!-- Świeca 1 - Mała Red -->
                                        <line x1="25" y1="35" x2="25" y2="70" stroke="#ff0033" stroke-width="1" opacity="0.7"/>
                                        <rect x="18" y="50" width="14" height="15" fill="#ff0033" stroke="#ff0033" stroke-width="1"/>
                                        <!-- Świeca 2 - Duża Green -->
                                        <line x1="75" y1="20" x2="75" y2="70" stroke="#00ff41" stroke-width="1" opacity="0.7"/>
                                        <rect x="63" y="30" width="24" height="40" fill="#00ff41" stroke="#00ff41" stroke-width="1"/>
                                    </svg>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #00ff41; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">☁️ PIERCING LINE (Przebijająca Linia)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Jak rozpoznać:</strong> Długa czerwona świeca, następnie zielona otwiera się poniżej minimum czerwonej i zamyka powyżej jej środka.<br>
                                            <strong>Znaczenie:</strong> Kupujący "przebijają" momentum spadkowe i odzyskują ponad 50% strat.<br>
                                            <strong>Kiedy działać:</strong> Silniejsze, gdy zielona zamyka się blisko szczytu czerwonej świecy.
                                        </div>
                                    </div>
                                    <svg width="100" height="100" viewBox="0 0 100 100" style="flex-shrink: 0;">
                                        <!-- Świeca 1 - Long Red -->
                                        <line x1="25" y1="20" x2="25" y2="70" stroke="#ff0033" stroke-width="1" opacity="0.7"/>
                                        <rect x="17" y="35" width="16" height="35" fill="#ff0033" stroke="#ff0033" stroke-width="1"/>
                                        <!-- Świeca 2 - Green piercing -->
                                        <line x1="75" y1="30" x2="75" y2="70" stroke="#00ff41" stroke-width="1" opacity="0.7"/>
                                        <rect x="67" y="42" width="16" height="28" fill="#00ff41" stroke="#00ff41" stroke-width="1"/>
                                    </svg>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #00ff41; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🌅 THREE WHITE SOLDIERS (Trzech Białych Żołnierzy)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Jak rozpoznać:</strong> Trzy kolejne długie zielone świece z małymi knotami, każda otwiera się w korpusie poprzedniej.<br>
                                            <strong>Znaczenie:</strong> Bardzo silny, konsekwentny napływ kupujących przez 3 sesje. Dominacja popytu.<br>
                                            <strong>Kiedy działać:</strong> Po drugiej lub trzeciej świecy. Rzadki wzorzec o wysokiej trafności.
                                        </div>
                                    </div>
                                    <svg width="120" height="100" viewBox="0 0 120 100" style="flex-shrink: 0;">
                                        <!-- Świeca 1 -->
                                        <line x1="20" y1="25" x2="20" y2="70" stroke="#00ff41" stroke-width="1" opacity="0.7"/>
                                        <rect x="12" y="40" width="16" height="30" fill="#00ff41" stroke="#00ff41" stroke-width="1"/>
                                        <!-- Świeca 2 -->
                                        <line x1="50" y1="20" x2="50" y2="70" stroke="#00ff41" stroke-width="1" opacity="0.7"/>
                                        <rect x="42" y="35" width="16" height="35" fill="#00ff41" stroke="#00ff41" stroke-width="1"/>
                                        <!-- Świeca 3 -->
                                        <line x1="80" y1="15" x2="80" y2="70" stroke="#00ff41" stroke-width="1" opacity="0.7"/>
                                        <rect x="72" y="28" width="16" height="42" fill="#00ff41" stroke="#00ff41" stroke-width="1"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bearish Patterns -->
                        <div style="background: rgba(255,0,51,0.08); border-left: 4px solid #ff0033; padding: 15px; border-radius: 6px;">
                            <div style="font-size: 0.95em; color: #ff0033; font-weight: 700; margin-bottom: 12px; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">📉 WZORCE NIEDŹWIEDZIE (BEARISH PATTERNS)</div>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 12px;">
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #ff0033; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🔨 SHOOTING STAR (Spadająca Gwiazda)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Jak rozpoznać:</strong> Mały korpus u dołu świecy, długi górny knot (2-3x dłuższy niż korpus), krótki lub brak dolnego knota.<br>
                                            <strong>Znaczenie:</strong> Kupujący wypchnęli cenę wysoko, ale sprzedający zdominowali i zepchnęli ją w dół. Odrzucenie wyższych poziomów.<br>
                                            <strong>Kiedy działać:</strong> Pojawia się na szczycie trendu wzrostowego. Potwierdź następną czerwoną świecą.
                                        </div>
                                    </div>
                                    <svg width="80" height="100" viewBox="0 0 80 100" style="flex-shrink: 0;">
                                        <!-- Górny knot -->
                                        <line x1="40" y1="20" x2="40" y2="70" stroke="#ff0033" stroke-width="1" opacity="0.7"/>
                                        <!-- Korpus na dole -->
                                        <rect x="30" y="65" width="20" height="15" fill="#ff0033" stroke="#ff0033" stroke-width="1"/>
                                        <!-- Dolny knot mały -->
                                        <line x1="40" y1="80" x2="40" y2="85" stroke="#ff0033" stroke-width="1" opacity="0.7"/>
                                    </svg>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #ff0033; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🌑 EVENING STAR (Wieczorna Gwiazda)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Jak rozpoznać:</strong> 3 świece - długa zielona, mała (doji/shooting star), długa czerwona.<br>
                                            <strong>Znaczenie:</strong> Trend wzrostowy słabnie (mała środkowa świeca), sprzedający przejmują kontrolę (trzecia świeca).<br>
                                            <strong>Kiedy działać:</strong> Gdy trzecia świeca zamyka się poniżej środka pierwszej zielonej świecy. Bardzo wiarygodny wzorzec.
                                        </div>
                                    </div>
                                    <svg width="100" height="100" viewBox="0 0 100 100" style="flex-shrink: 0;">
                                        <!-- Świeca 1 - Zielona długa -->
                                        <line x1="20" y1="20" x2="20" y2="70" stroke="#00ff41" stroke-width="1" opacity="0.7"/>
                                        <rect x="12" y="30" width="16" height="40" fill="#00ff41" stroke="#00ff41" stroke-width="1"/>
                                        <!-- Świeca 2 - Mała Doji -->
                                        <line x1="50" y1="30" x2="50" y2="70" stroke="#ffaa00" stroke-width="1" opacity="0.7"/>
                                        <rect x="48" y="48" width="4" height="2" fill="#ffaa00" stroke="#ffaa00" stroke-width="1"/>
                                        <!-- Świeca 3 - Czerwona długa -->
                                        <line x1="80" y1="20" x2="80" y2="70" stroke="#ff0033" stroke-width="1" opacity="0.7"/>
                                        <rect x="72" y="35" width="16" height="35" fill="#ff0033" stroke="#ff0033" stroke-width="1"/>
                                    </svg>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #ff0033; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🐻 BEARISH ENGULFING (Niedźwiedzie Objęcie)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Jak rozpoznać:</strong> Mała zielona świeca, następnie duża czerwona świeca całkowicie "pochłania" korpus poprzedniej.<br>
                                            <strong>Znaczenie:</strong> Sprzedający zdominowali kupujących. Gwałtowna zmiana z optymizmu na pesymizm.<br>
                                            <strong>Kiedy działać:</strong> Najsilniejsze przy oporze. Im większa czerwona świeca, tym silniejszy sygnał.
                                        </div>
                                    </div>
                                    <svg width="100" height="100" viewBox="0 0 100 100" style="flex-shrink: 0;">
                                        <!-- Świeca 1 - Mała Green -->
                                        <line x1="25" y1="30" x2="25" y2="70" stroke="#00ff41" stroke-width="1" opacity="0.7"/>
                                        <rect x="18" y="50" width="14" height="20" fill="#00ff41" stroke="#00ff41" stroke-width="1"/>
                                        <!-- Świeca 2 - Duża Red -->
                                        <line x1="75" y1="20" x2="75" y2="70" stroke="#ff0033" stroke-width="1" opacity="0.7"/>
                                        <rect x="63" y="25" width="24" height="45" fill="#ff0033" stroke="#ff0033" stroke-width="1"/>
                                    </svg>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #ff0033; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">☁️ DARK CLOUD COVER (Ciemna Chmura)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Jak rozpoznać:</strong> Długa zielona świeca, następnie czerwona otwiera się powyżej szczytu zielonej i zamyka poniżej jej środka.<br>
                                            <strong>Znaczenie:</strong> Gap wzrostowy zostaje odwrócony, sprzedający "przykrywają" ponad 50% wzrostu.<br>
                                            <strong>Kiedy działać:</strong> Gdy zamknięcie jest głębiej niż 50% zielonej świecy. Silniejsze przy oporze.
                                        </div>
                                    </div>
                                    <svg width="100" height="100" viewBox="0 0 100 100" style="flex-shrink: 0;">
                                        <!-- Świeca 1 - Long Green -->
                                        <line x1="25" y1="20" x2="25" y2="70" stroke="#00ff41" stroke-width="1" opacity="0.7"/>
                                        <rect x="17" y="28" width="16" height="42" fill="#00ff41" stroke="#00ff41" stroke-width="1"/>
                                        <!-- Świeca 2 - Red dark cover -->
                                        <line x1="75" y1="22" x2="75" y2="70" stroke="#ff0033" stroke-width="1" opacity="0.7"/>
                                        <rect x="67" y="35" width="16" height="35" fill="#ff0033" stroke="#ff0033" stroke-width="1"/>
                                    </svg>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #ff0033; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🌃 THREE BLACK CROWS (Trzech Czarnych Kruków)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Jak rozpoznać:</strong> Trzy kolejne długie czerwone świece z małymi knotami, każda otwiera się w korpusie poprzedniej.<br>
                                            <strong>Znaczenie:</strong> Bardzo silna, konsekwentna presja sprzedażowa przez 3 sesje. Dominacja podaży.<br>
                                            <strong>Kiedy działać:</strong> Po drugiej lub trzeciej świecy. Jeden z najsilniejszych niedźwiedzich wzorców.
                                        </div>
                                    </div>
                                    <svg width="120" height="100" viewBox="0 0 120 100" style="flex-shrink: 0;">
                                        <!-- Świeca 1 -->
                                        <line x1="20" y1="20" x2="20" y2="70" stroke="#ff0033" stroke-width="1" opacity="0.7"/>
                                        <rect x="12" y="30" width="16" height="40" fill="#ff0033" stroke="#ff0033" stroke-width="1"/>
                                        <!-- Świeca 2 -->
                                        <line x1="50" y1="25" x2="50" y2="70" stroke="#ff0033" stroke-width="1" opacity="0.7"/>
                                        <rect x="42" y="35" width="16" height="35" fill="#ff0033" stroke="#ff0033" stroke-width="1"/>
                                        <!-- Świeca 3 -->
                                        <line x1="80" y1="30" x2="80" y2="70" stroke="#ff0033" stroke-width="1" opacity="0.7"/>
                                        <rect x="72" y="40" width="16" height="30" fill="#ff0033" stroke="#ff0033" stroke-width="1"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- TRADING STRATEGIES -->
                    <div style="margin-bottom: 25px;">
                        <div style="font-size: 1.1em; color: #00d4ff; font-weight: 700; margin-bottom: 15px; font-family: 'Roboto Mono', monospace;">📊 STRATEGIE TRADINGOWE</div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 15px;">
                            <div style="background: linear-gradient(135deg, rgba(0,255,65,0.1) 0%, rgba(0,255,65,0.05) 100%); border: 2px solid #00ff41; padding: 15px; border-radius: 6px;">
                                <div style="color: #00ff41; font-weight: 700; font-size: 1em; margin-bottom: 8px;">🎯 TREND FOLLOWING (Podążanie za Trendem)</div>
                                <div style="color: #ddd; font-size: 0.85em; line-height: 1.6; margin-bottom: 10px;">
                                    Strategia wykorzystująca momentum rynku. "Trend jest twoim przyjacielem" - wchodzimy w kierunku dominującego trendu.
                                </div>
                                <div style="color: #fff; font-size: 0.8em; line-height: 1.7;">
                                    <div style="margin-bottom: 6px;"><strong style="color: #00ff41;">✓ Kiedy kupować:</strong> Cena powyżej EMA 50 i 200, Higher Highs + Higher Lows, RSI > 50</div>
                                    <div style="margin-bottom: 6px;"><strong style="color: #ff0033;">✗ Kiedy sprzedawać:</strong> Cena poniżej EMA 50 i 200, Lower Highs + Lower Lows, RSI < 50</div>
                                    <div style="color: #ffaa00;"><strong>⚠️ Stop Loss:</strong> Pod ostatnim Low w trendzie wzrostowym, nad ostatnim High w spadkowym</div>
                                </div>
                            </div>
                            
                            <div style="background: linear-gradient(135deg, rgba(255,170,0,0.1) 0%, rgba(255,170,0,0.05) 100%); border: 2px solid #ffaa00; padding: 15px; border-radius: 6px;">
                                <div style="color: #ffaa00; font-weight: 700; font-size: 1em; margin-bottom: 8px;">⚡ BREAKOUT TRADING (Wybicia)</div>
                                <div style="color: #ddd; font-size: 0.85em; line-height: 1.6; margin-bottom: 10px;">
                                    Handel na wybiciach z konsolidacji. Cena przełamuje kluczowy poziom wsparcia/oporu z dużym wolumenem.
                                </div>
                                <div style="color: #fff; font-size: 0.8em; line-height: 1.7;">
                                    <div style="margin-bottom: 6px;"><strong style="color: #00ff41;">✓ Sygnał kupna:</strong> Wybicie powyżej oporu z wolumenem >150% średniej, zamknięcie świecy powyżej poziomu</div>
                                    <div style="margin-bottom: 6px;"><strong style="color: #ff0033;">✗ Sygnał sprzedaży:</strong> Wybicie poniżej wsparcia z wolumenem >150% średniej</div>
                                    <div style="color: #ffaa00;"><strong>⚠️ Uwaga:</strong> Uważaj na false breakouts! Potwierdź retest poziomu przed wejściem</div>
                                </div>
                            </div>
                            
                            <div style="background: linear-gradient(135deg, rgba(0,212,255,0.1) 0%, rgba(0,212,255,0.05) 100%); border: 2px solid #00d4ff; padding: 15px; border-radius: 6px;">
                                <div style="color: #00d4ff; font-weight: 700; font-size: 1em; margin-bottom: 8px;">🔄 MEAN REVERSION (Powrót do Średniej)</div>
                                <div style="color: #ddd; font-size: 0.85em; line-height: 1.6; margin-bottom: 10px;">
                                    Zakłada, że cena wraca do średniej po ekstremalnych ruchach. Kupujemy "za tanio", sprzedajemy "za drogo".
                                </div>
                                <div style="color: #fff; font-size: 0.8em; line-height: 1.7;">
                                    <div style="margin-bottom: 6px;"><strong style="color: #00ff41;">✓ Sygnał kupna:</strong> RSI < 30, cena przy dolnej wstędze Bollingera, oversold na Stochastic</div>
                                    <div style="margin-bottom: 6px;"><strong style="color: #ff0033;">✗ Sygnał sprzedaży:</strong> RSI > 70, cena przy górnej wstędze Bollingera, overbought</div>
                                    <div style="color: #ffaa00;"><strong>⚠️ Ryzyko:</strong> Nie działa w silnych trendach! Używaj tylko w konsolidacji/range</div>
                                </div>
                            </div>
                            
                            <div style="background: linear-gradient(135deg, rgba(255,0,255,0.1) 0%, rgba(255,0,255,0.05) 100%); border: 2px solid #ff00ff; padding: 15px; border-radius: 6px;">
                                <div style="color: #ff00ff; font-weight: 700; font-size: 1em; margin-bottom: 8px;">📍 SUPPORT & RESISTANCE TRADING</div>
                                <div style="color: #ddd; font-size: 0.85em; line-height: 1.6; margin-bottom: 10px;">
                                    Handel na odbiciu od kluczowych poziomów S/R. Bazuje na psychologii rynku - poziomy "zapamiętane" przez traderów.
                                </div>
                                <div style="color: #fff; font-size: 0.8em; line-height: 1.7;">
                                    <div style="margin-bottom: 6px;"><strong style="color: #00ff41;">✓ Kupno przy wsparciu:</strong> Cena testuje wsparcie 2-3 razy, świece bycze, rosnący wolumen</div>
                                    <div style="margin-bottom: 6px;"><strong style="color: #ff0033;">✗ Sprzedaż przy oporze:</strong> Cena testuje opór 2-3 razy, świece niedźwiedzie</div>
                                    <div style="color: #ffaa00;"><strong>⚠️ Zasada:</strong> Im więcej testów poziom przetrwał, tym silniejszy. Po przebiciu zmienia rolę!</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- CHART PATTERNS -->
                    <div style="margin-bottom: 15px;">
                        <div style="font-size: 1.1em; color: #ff00ff; font-weight: 700; margin-bottom: 15px; font-family: 'Roboto Mono', monospace;">📈 FORMACJE WYKRESÓW (CHART PATTERNS)</div>
                        
                        <!-- Continuation Patterns -->
                        <div style="background: rgba(0,212,255,0.08); border-left: 4px solid #00d4ff; padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                            <div style="font-size: 0.95em; color: #00d4ff; font-weight: 700; margin-bottom: 12px; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">➡️ FORMACJE KONTYNUACJI (Trend będzie trwał dalej)</div>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 12px;">
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #00d4ff; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">📐 TRÓJKĄT (Triangle)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Symetryczny:</strong> Dwa zbieżne linie trendu. Konsolidacja przed kontynuacją. Wybicie w kierunku wcześniejszego trendu (70% przypadków).<br>
                                            <strong>Rosnący:</strong> Płaski opór + rosnące wsparcie = bycza kontynuacja.<br>
                                            <strong>Spadający:</strong> Płaskie wsparcie + opadający opór = niedźwiedzia kontynuacja.<br>
                                            <strong>Target:</strong> Wysokość podstawy trójkąta odmierzona od punktu wybicia.
                                        </div>
                                    </div>
                                    <svg width="90" height="90" viewBox="0 0 90 90" style="flex-shrink: 0;">
                                        <!-- Górna linia (opór) -->
                                        <line x1="15" y1="20" x2="75" y2="50" stroke="#00d4ff" stroke-width="1.5" opacity="0.8"/>
                                        <!-- Dolna linia (wsparcie) -->
                                        <line x1="15" y1="70" x2="75" y2="50" stroke="#00d4ff" stroke-width="1.5" opacity="0.8"/>
                                        <!-- Prawie niewidoczne cena oscylująca -->
                                        <path d="M 20,50 L 30,45 L 40,48 L 50,46 L 60,49 L 70,47" stroke="#ffaa00" stroke-width="1.5" fill="none" opacity="0.6"/>
                                        <!-- Wybicie -->
                                        <line x1="75" y1="50" x2="80" y2="30" stroke="#00ff41" stroke-width="2" opacity="0.9"/>
                                    </svg>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #00d4ff; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🚩 FLAGA i PROPORZEC (Flag & Pennant)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Flaga:</strong> Silny ruch (maszt), potem prostokątna konsolidacja pod kątem przeciwnym do trendu. Krótkotrwała korekta.<br>
                                            <strong>Proporzec:</strong> Jak flaga, ale konsolidacja w małym trójkącie symetrycznym.<br>
                                            <strong>Target:</strong> Długość masztu odmierzona od wybicia. Bardzo niezawodne formacje (80%+ trafność).<br>
                                            <strong>Wolumen:</strong> Spada w konsolidacji, eksploduje przy wybiciu.
                                        </div>
                                    </div>
                                    <svg width="90" height="90" viewBox="0 0 90 90" style="flex-shrink: 0;">
                                        <!-- Maszt (silny ruch w górę) -->
                                        <line x1="20" y1="70" x2="20" y2="20" stroke="#00ff41" stroke-width="2.5"/>
                                        <!-- Flaga (prostokąt konsolidacji) -->
                                        <rect x="25" y="30" width="35" height="20" fill="none" stroke="#00d4ff" stroke-width="1.5" opacity="0.8"/>
                                        <!-- Linie wewnątrz flagi - oscylacja -->
                                        <path d="M 30,40 L 40,35 L 50,40 L 60,36" stroke="#ffaa00" stroke-width="1" fill="none" opacity="0.6"/>
                                        <!-- Wybicie w górę -->
                                        <line x1="60" y1="30" x2="75" y2="10" stroke="#00ff41" stroke-width="2"/>
                                    </svg>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #00d4ff; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">☕ FILIŻANKA Z UCHEM (Cup & Handle)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Filiżanka:</strong> Łagodne zaokrąglone dno (U-shape), trwa 1-6 miesięcy. Cena wraca do poprzedniego szczytu.<br>
                                            <strong>Ucho:</strong> Mała korekta (10-15%) przy prawym brzegu, tworzy miniaturę flagi/trójkąta.<br>
                                            <strong>Wybicie:</strong> Powyżej oporu uchwytu z dużym wolumenem.<br>
                                            <strong>Target:</strong> Głębokość filiżanki + punkt wybicia. Wzorzec wielkich wzrostów!
                                        </div>
                                    </div>
                                    <svg width="90" height="90" viewBox="0 0 90 90" style="flex-shrink: 0;">
                                        <!-- Lewa krawędź filiżanki -->
                                        <path d="M 15,15 L 20,60" stroke="#00d4ff" stroke-width="1.5" fill="none" opacity="0.8"/>
                                        <!-- Dno filiżanki (zaokrąglone) -->
                                        <path d="M 20,60 Q 45,75 70,60" stroke="#00d4ff" stroke-width="1.5" fill="none" opacity="0.8"/>
                                        <!-- Prawa krawędź filiżanki -->
                                        <path d="M 70,60 L 75,15" stroke="#00d4ff" stroke-width="1.5" fill="none" opacity="0.8"/>
                                        <!-- Ucho (mała korekta) -->
                                        <rect x="65" y="20" width="15" height="15" fill="none" stroke="#ffaa00" stroke-width="1" opacity="0.7"/>
                                        <!-- Wybicie powyżej -->
                                        <line x1="75" y1="15" x2="80" y2="5" stroke="#00ff41" stroke-width="2"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Reversal Patterns -->
                        <div style="background: rgba(255,0,255,0.08); border-left: 4px solid #ff00ff; padding: 15px; border-radius: 6px;">
                            <div style="font-size: 0.95em; color: #ff00ff; font-weight: 700; margin-bottom: 12px; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">🔄 FORMACJE ODWRÓCENIA (Zmiana trendu)</div>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 12px;">
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #ff00ff; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">👤 GŁOWA I RAMIONA (Head & Shoulders)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Struktura:</strong> 3 szczyty - lewe ramię, wyższa głowa, prawe ramię (niższe niż głowa). Linia szyi łączy dołki.<br>
                                            <strong>Psychologia:</strong> Słabnące momentum wzrostowe, kupujący tracą siłę z każdym szczytem.<br>
                                            <strong>Potwierdzenie:</strong> Przebicie linii szyi z wolumenem. <br>
                                            <strong>Target:</strong> Odległość głowa-szyja odmierzona w dół od przebicia. <br>
                                            <strong>Odwrócona:</strong> To samo do góry nogami = bycze odwrócenie.
                                        </div>
                                    </div>
                                    <svg width="100" height="80" viewBox="0 0 100 80" style="flex-shrink: 0;">
                                        <!-- Linia szyi -->
                                        <line x1="10" y1="60" x2="90" y2="60" stroke="#ff00ff" stroke-width="1" opacity="0.6" stroke-dasharray="2,2"/>
                                        <!-- Lewe ramię -->
                                        <path d="M 15,60 L 25,35 L 35,60" stroke="#ff0033" stroke-width="1.5" fill="none" opacity="0.8"/>
                                        <!-- Głowa -->
                                        <path d="M 35,60 L 50,15 L 65,60" stroke="#ff0033" stroke-width="1.5" fill="none" opacity="0.9"/>
                                        <!-- Prawe ramię -->
                                        <path d="M 65,60 L 75,40 L 85,60" stroke="#ff0033" stroke-width="1.5" fill="none" opacity="0.8"/>
                                        <!-- Wybicie w dół -->
                                        <line x1="85" y1="60" x2="90" y2="70" stroke="#ff0033" stroke-width="2"/>
                                    </svg>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #ff00ff; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🔀 PODWÓJNY SZCZYT / DÓŁ (Double Top/Bottom)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Double Top:</strong> Dwa szczyty na zbliżonym poziomie, oddzielone korektą. Cena nie może przebić oporu - niedźwiedzie odwrócenie.<br>
                                            <strong>Double Bottom (W):</strong> Dwa dołki na zbliżonym poziomie. Wsparcie obronione 2x - bycze odwrócenie.<br>
                                            <strong>Potwierdzenie:</strong> Przebicie poziomu środkowej korekty (linia szyi).<br>
                                            <strong>Target:</strong> Wysokość formacji odmierzona od przebicia.
                                        </div>
                                    </div>
                                    <svg width="100" height="80" viewBox="0 0 100 80" style="flex-shrink: 0;">
                                        <!-- Środkowa linia (szyja) -->
                                        <line x1="10" y1="50" x2="90" y2="50" stroke="#ff00ff" stroke-width="1" opacity="0.6" stroke-dasharray="2,2"/>
                                        <!-- Pierwszy szczyt -->
                                        <path d="M 20,50 L 30,20 L 40,50" stroke="#ff0033" stroke-width="1.5" fill="none" opacity="0.8"/>
                                        <!-- Drugi szczyt -->
                                        <path d="M 50,50 L 60,20 L 70,50" stroke="#ff0033" stroke-width="1.5" fill="none" opacity="0.8"/>
                                        <!-- Wybicie w dół -->
                                        <line x1="70" y1="50" x2="85" y2="70" stroke="#ff0033" stroke-width="2"/>
                                    </svg>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #ff00ff; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🔺 KLINY (Wedges)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Rising Wedge (rosnący klin):</strong> Dwie zbieżne linie trendu skierowane w górę, ale tempo wzrostu słabnie. Niedźwiedzie odwrócenie na szczycie trendu.<br>
                                            <strong>Falling Wedge (spadający klin):</strong> Zbieżne linie w dół, spadki słabną. Bycze odwrócenie na dnie.<br>
                                            <strong>Wybicie:</strong> Zawsze przeciwnie do nachylenia klina! <br>
                                            <strong>Wolumen:</strong> Spada w klinie, rośnie przy wybiciu.
                                        </div>
                                    </div>
                                    <svg width="100" height="80" viewBox="0 0 100 80" style="flex-shrink: 0;">
                                        <!-- Rising Wedge (górna część) -->
                                        <!-- Górna linia klina -->
                                        <line x1="10" y1="25" x2="60" y2="15" stroke="#ff0033" stroke-width="1.5" opacity="0.8"/>
                                        <!-- Dolna linia klina -->
                                        <line x1="10" y1="50" x2="60" y2="40" stroke="#ff0033" stroke-width="1.5" opacity="0.8"/>
                                        <!-- Cena w klinie -->
                                        <path d="M 15,40 L 25,35 L 35,38 L 45,30 L 55,28" stroke="#ffaa00" stroke-width="1" fill="none" opacity="0.6"/>
                                        <!-- Wybicie w dół -->
                                        <line x1="60" y1="40" x2="80" y2="65" stroke="#ff0033" stroke-width="2"/>
                                    </svg>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 4px; display: flex; gap: 10px;">
                                    <div style="flex: 1;">
                                        <div style="color: #ff00ff; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">📊 POTRÓJNY SZCZYT / DÓŁ (Triple Top/Bottom)</div>
                                        <div style="color: #ddd; font-size: 0.85em; line-height: 1.6;">
                                            <strong>Triple Top:</strong> 3 szczyty na podobnym poziomie. Bardzo silny opór, trzykrotnie testowany = silne niedźwiedzie odwrócenie.<br>
                                            <strong>Triple Bottom:</strong> 3 dołki na podobnym poziomie. Niezwykle silne wsparcie = mocne bycze odwrócenie.<br>
                                            <strong>Wiarygodność:</strong> Wyższa niż double top/bottom (więcej testów = silniejszy poziom).<br>
                                            <strong>Target:</strong> Wysokość formacji od punktu wybicia.
                                        </div>
                                    </div>
                                    <svg width="120" height="80" viewBox="0 0 120 80" style="flex-shrink: 0;">
                                        <!-- Linia oporu/szyi -->
                                        <line x1="10" y1="50" x2="110" y2="50" stroke="#ff00ff" stroke-width="1" opacity="0.6" stroke-dasharray="2,2"/>
                                        <!-- Pierwszy szczyt -->
                                        <path d="M 20,50 L 27,20 L 34,50" stroke="#ff0033" stroke-width="1.5" fill="none" opacity="0.8"/>
                                        <!-- Drugi szczyt -->
                                        <path d="M 44,50 L 51,20 L 58,50" stroke="#ff0033" stroke-width="1.5" fill="none" opacity="0.8"/>
                                        <!-- Trzeci szczyt -->
                                        <path d="M 68,50 L 75,20 L 82,50" stroke="#ff0033" stroke-width="1.5" fill="none" opacity="0.9"/>
                                        <!-- Wybicie w dół -->
                                        <line x1="82" y1="50" x2="100" y2="75" stroke="#ff0033" stroke-width="2"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
    
        <script>
        function toggleTradingCandlestick() {
            const content = document.getElementById('trading-candlestick-content');
            const icon = document.getElementById('candlestick-toggle-icon');
            if (content && icon) {
                if (content.style.display === 'none') {
                    content.style.display = 'block';
                    icon.style.transform = 'rotate(180deg)';
                    icon.style.animation = 'none';
                } else {
                    content.style.display = 'none';
                    icon.style.transform = 'rotate(0deg)';
                    icon.style.animation = 'arrowPulse 2s ease-in-out infinite';
                }
            }
        }
        
        // Typewriter effect storage
        const typewriterState = {
            activeAnimations: new Set(),
            originalContent: new Map()
        };

        // Core typewriter function - types text character by character
        function typeWriterEffect(element, speed = 15) {
            // Skip if already animating this element
            if (typewriterState.activeAnimations.has(element)) {
                return;
            }

            // Store original HTML if not already stored
            if (!typewriterState.originalContent.has(element)) {
                typewriterState.originalContent.set(element, element.innerHTML);
            }

            const originalHTML = typewriterState.originalContent.get(element);
            
            // Mark as animating
            typewriterState.activeAnimations.add(element);
            element.style.opacity = '0.95';
            
            // Extract text content only (strip HTML tags for typing)
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = originalHTML;
            const textOnly = tempDiv.textContent || tempDiv.innerText || '';
            
            element.innerHTML = '';
            element.style.display = 'block';
            
            let charIndex = 0;
            const typeInterval = setInterval(() => {
                if (charIndex < textOnly.length) {
                    element.textContent += textOnly.charAt(charIndex);
                    charIndex++;
                } else {
                    clearInterval(typeInterval);
                    // Restore original HTML with formatting
                    element.innerHTML = originalHTML;
                    element.style.opacity = '1';
                    typewriterState.activeAnimations.delete(element);
                }
            }, speed);
        }

        // Apply typewriter to all text divs in a container
        function applyTypewriterToContainer(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;

            // Find all text content divs (they have color styles)
            const textDivs = container.querySelectorAll('div[style*="color"][style*="line-height"]');
            
            let delay = 0;
            textDivs.forEach((textDiv, index) => {
                setTimeout(() => {
                    typeWriterEffect(textDiv, 15);
                }, delay);
                delay += 100; // Slight stagger between sections
            });
        }

        function togglePyramiding() {
            const content = document.getElementById('pyramiding-content');
            const icon = document.getElementById('pyramiding-toggle-icon');
            if (content && icon) {
                const isHidden = content.style.display === 'none';
                if (isHidden) {
                    content.style.display = 'block';
                    icon.style.transform = 'rotate(180deg)';
                    // Apply typewriter effect to all text sections
                    applyTypewriterToContainer('pyramiding-content');
                } else {
                    content.style.display = 'none';
                    icon.style.transform = 'rotate(0deg)';
                }
            }
        }
        
        function toggleWyckoff() {
            const content = document.getElementById('wyckoff-content');
            const icon = document.getElementById('wyckoff-toggle-icon');
            if (content && icon) {
                const isHidden = content.style.display === 'none';
                if (isHidden) {
                    content.style.display = 'block';
                    icon.style.transform = 'rotate(180deg)';
                    // Apply typewriter effect to all text sections
                    applyTypewriterToContainer('wyckoff-content');
                } else {
                    content.style.display = 'none';
                    icon.style.transform = 'rotate(0deg)';
                }
            }
        }
        
        function toggleLivermore() {
            const content = document.getElementById('livermore-content');
            const icon = document.getElementById('livermore-toggle-icon');
            if (content && icon) {
                const isHidden = content.style.display === 'none';
                if (isHidden) {
                    content.style.display = 'block';
                    icon.style.transform = 'rotate(180deg)';
                    // Apply typewriter effect to all text sections
                    applyTypewriterToContainer('livermore-content');
                } else {
                    content.style.display = 'none';
                    icon.style.transform = 'rotate(0deg)';
                }
            }
        }
        </script>
    
        <!-- PYRAMIDING METHOD (collapsible) -->
        <div style="padding: 0 30px 10px 30px; background: #0a0a0a;">
            <div style="background: linear-gradient(135deg, #1f1a0a 0%, #0a0a0a 100%); border: 2px solid #ffc300; border-radius: 8px; padding: 15px; cursor: pointer; box-shadow: 0 0 15px rgba(255,195,0,0.15);">
                <div onclick="togglePyramiding()" style="display: flex; justify-content: space-between; align-items: center;">
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <div style="font-size: 1.05em; color: #ffc300; font-weight: 800;">📐 METODA PIRAMIDOWANIA</div>
                        <div style="font-size: 0.95em; color: #ffe7a0; font-family: 'Roboto Mono', monospace; font-weight: 600;">Jak zwiększać pozycję w wygrywającym trendzie</div>
                    </div>
                    <div id="pyramiding-toggle-icon" style="font-size: 1.6em; color: #ffc300; transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); text-shadow: 0 0 10px #ffc300, 0 0 20px #ffc300; display: inline-block; min-width: 28px; text-align: center; font-weight: bold;">▼</div>
                </div>
                <div id="pyramiding-content" style="display: none; margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,195,0,0.25);">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 12px;">
                        <div style="background: rgba(255,195,0,0.08); border: 1px solid rgba(255,195,0,0.3); border-radius: 6px; padding: 14px;">
                            <div style="color: #ffc300; font-weight: 800; margin-bottom: 10px; font-size: 1.05em;">🔺 Czym jest piramidowanie?</div>
                            <div style="color: #ffe7a0; font-size: 0.9em; line-height: 1.7;">
                                Piramidowanie to technika <strong>stopniowego zwiększania pozycji</strong> w miarę jak rynek rusza się na twoją korzyść. Zamiast wchodzić z całym kapitałem na raz, budujesz pozycję w kilku transzach, gdy trend się potwierdza.<br><br>
                                <strong style="color: #ffaa00;">Podstawowa zasada:</strong> Dodajesz do pozycji tylko wtedy, gdy jesteś już na zysku z poprzedniego wejścia. Nigdy nie uśredniaj strat (averaging down)!<br><br>
                                <strong style="color: #00ff41;">Przykład:</strong> Kupujesz BTC po $95k za 30% kapitału. Cena idzie do $97k (+2%). Dodajesz kolejne 25%. Cena $99k → dodajesz 20%. Ostatnie 15% przy $101k. SL zawsze pod ostatnim swingiem.
                            </div>
                        </div>
                        
                        <div style="background: rgba(255,195,0,0.08); border: 1px solid rgba(255,195,0,0.3); border-radius: 6px; padding: 14px;">
                            <div style="color: #ffc300; font-weight: 800; margin-bottom: 10px; font-size: 1.05em;">⚡ Kiedy dodawać do pozycji?</div>
                            <div style="color: #ffe7a0; font-size: 0.9em; line-height: 1.7;">
                                <strong>1. Po wybiciu oporu:</strong> Cena przełamała kluczowy poziom + wolumen potwierdza<br>
                                <strong>2. Po retescie wsparcia:</strong> Cena wraca do poprzedniego oporu (teraz wsparcie) i odbija<br>
                                <strong>3. Po nowym HH (Higher High):</strong> Trend rosnący, każdy szczyt wyższy od poprzedniego<br>
                                <strong>4. Przy wzroście wolumenu:</strong> Instytucje wchodzą, delta zielona + OI rośnie<br><br>
                                <strong style="color: #ff0033;">NIGDY nie dodawaj:</strong><br>
                                • Gdy jesteś na stracie (to averaging down = katastrofa)<br>
                                • Przy dyweregncji (cena ↑, RSI ↓)<br>
                                • Gdy wolumen maleje przy wzrostach<br>
                                • Blisko końca trendu (szukaj oznaki wyczerpania)
                            </div>
                        </div>
                        
                        <div style="background: rgba(255,195,0,0.08); border: 1px solid rgba(255,195,0,0.3); border-radius: 6px; padding: 14px;">
                            <div style="color: #ffc300; font-weight: 800; margin-bottom: 10px; font-size: 1.05em;">🎯 Zarządzanie piramidą</div>
                            <div style="color: #ffe7a0; font-size: 0.9em; line-height: 1.7;">
                                <strong>Trailing Stop Loss:</strong> Po każdym dodaniu przenoś SL całej pozycji pod ostatni swing low (dla long) lub swing high (dla short).<br><br>
                                <strong>Proporcje pozycji:</strong><br>
                                • 1. wejście: 30-40% kapitału (największe ryzyko)<br>
                                • 2. wejście: 25-30% (ryzyko mniejsze, już jesteś na +)<br>
                                • 3. wejście: 20-25% (trend potwierdzony)<br>
                                • 4. wejście: 10-15% (czyste momentum)<br><br>
                                <strong style="color: #00d4ff;">Scaling Out:</strong> Gdy osiągniesz cel, zamykaj pozycję w transzach:<br>
                                • 1. target (1:2) → zamknij 30%<br>
                                • 2. target (1:3) → zamknij 30%<br>
                                • 3. target (1:4+) → zostaw 40% z trailing SL<br><br>
                                <strong style="color: #ffaa00;">Złota zasada:</strong> Im wyżej piramida, tym mniejsze transze. Nigdy nie dodawaj więcej niż przy pierwszym wejściu.
                            </div>
                        </div>
                        
                        <div style="background: rgba(255,100,0,0.12); border: 1px solid rgba(255,100,0,0.4); border-radius: 6px; padding: 14px;">
                            <div style="color: #ff6400; font-weight: 800; margin-bottom: 10px; font-size: 1.05em;">⚠️ Pułapki i błędy</div>
                            <div style="color: #ffe7a0; font-size: 0.9em; line-height: 1.7;">
                                <strong style="color: #ff0033;">1. Averaging down (uśrednianie strat):</strong><br>
                                Kupujesz po $100k, spada do $95k, dokupujesz "taniej". TO NIE JEST PIRAMIDOWANIE! To przepis na katastrofę. Piramida działa tylko w kierunku trendu, gdy jesteś na zysku.<br><br>
                                <strong style="color: #ff0033;">2. Zbyt agresywne dodawanie:</strong><br>
                                Dodajesz pełne transze zbyt szybko i wyczerpujesz kapitał przed końcem ruchu. Zachowaj rezerwy na ostatnie uderzenie.<br><br>
                                <strong style="color: #ff0033;">3. Brak SL adjustment:</strong><br>
                                Nie przesuwasz SL po każdym dodaniu. Jeden odwrót i tracisz wszystkie zyski z całej piramidy.<br><br>
                                <strong style="color: #ffaa00;">Wskazówka:</strong> Jeśli nie masz pewności, czy dodać – nie dodawaj. Piramiduj tylko przy silnych trendach z wysokim prawdopodobieństwem kontynuacji.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    
        <!-- TIMEFRAME ZONE • MULTI-TF ANALYSIS (collapsible) -->
        <div style="padding: 0 30px 10px 30px; background: #0a0a0a;">
            <div style="background: linear-gradient(135deg, #0f0f1a 0%, #0a0a0a 100%); border: 2px solid #00d4ff; border-radius: 8px; padding: 15px; cursor: pointer; box-shadow: 0 0 15px rgba(0,212,255,0.15);">
                <div onclick="toggleTimeframeZone()" style="display: flex; justify-content: space-between; align-items: center;">
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <div style="font-size: 1.1em; color: #00d4ff; font-weight: 800;">📊 TIMEFRAME ZONE • MULTI-TF ANALYSIS</div>
                        <div style="font-size: 1em; color: #fff; font-family: 'Roboto Mono', monospace; font-weight: 600;">
                            Sygnały z 10 interwałów czasowych: 1m do 1Y
                        </div>
                    </div>
                    <div id="timeframe-toggle-icon" style="font-size: 1.8em; color: #00d4ff; transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); text-shadow: 0 0 10px #00d4ff, 0 0 20px #00d4ff; animation: arrowPulse 2s ease-in-out infinite; display: inline-block; min-width: 30px; text-align: center; font-weight: bold;">▼</div>
                </div>
                <div id="timeframe-zone-content" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(0,212,255,0.3);">
                    
                    <!-- JAK CZYTAĆ WARTOŚCI - LEGENDA -->
                    <div style="background: linear-gradient(135deg, rgba(0,212,255,0.08) 0%, rgba(0,212,255,0.03) 100%); border: 1px solid rgba(0,212,255,0.25); border-radius: 6px; padding: 12px 15px; margin-bottom: 15px;">
                        <div style="color: #00d4ff; font-weight: 700; font-size: 0.95em; margin-bottom: 8px; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">📖 JAK CZYTAĆ WARTOŚCI:</div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px; font-size: 1em; line-height: 1.8; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">
                            <div style="color: #fff;"><span style="color: #ffaa00; font-weight: 700;">RSI:</span> Relative Strength Index (0-100, przekupienie >70, wyprzedanie <30)</div>
                            <div style="color: #fff;"><span style="color: #00ff41; font-weight: 700;">MACD:</span> Momentum • ↑+ (wzrost), ↓- (spadek), →0 (neutralny)</div>
                            <div style="color: #fff;"><span style="color: #00d4ff; font-weight: 700;">K%D:</span> Stochastic Oscillator • K/D (szybka/wolna linia)</div>
                            <div style="color: #fff;"><span style="color: #fff; font-weight: 700;">EMA:</span> Kierunek średniej • ↑ (w górę), ↓ (w dół), → (płasko)</div>
                            <div style="color: #fff;"><span style="color: #fff; font-weight: 700;">BB:</span> Bollinger Bands • Upper/Mid/Lower (pozycja ceny)</div>
                            <div style="color: #fff;"><span style="color: #cccccc; font-weight: 700;">Vol:</span> Volume • ↑HIGH, →MED, ↓LOW (poziom wolumenu)</div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: flex-end; margin-bottom: 8px;">
                        <div style="font-size: 0.65em; color: #fff;">1m • 5m • 15m • 30m • 1h • 4h • 1d • 1M • 3M • 1Y</div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px;">
                        <div id="1m" style="background: rgba(0,255,65,0.06); border-left: 3px solid #00ff41; padding: 10px; border-radius: 6px; font-size: 0.8em;">
                            <div style="color: #00ff41; font-weight: 700; font-size: 1em; margin-bottom: 3px;">1m</div>
                            <div style="color: #00ff41; font-weight: 600; margin-bottom: 3px;">✓ BULL</div>
                            <div style="color: #ffaa00; margin-bottom: 1px;">RSI: <span style="font-weight: 700;">58</span></div>
                            <div style="color: #00ff41; margin-bottom: 1px;">MACD: <span style="font-weight: 700;">↑+</span></div>
                            <div style="color: #00d4ff; margin-bottom: 1px;">K%D: <span style="font-weight: 700;">72/68</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">EMA: <span style="font-weight: 700;">↑</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">BB: <span style="font-weight: 700;">Upper</span></div>
                            <div style="color: #cccccc;">Vol: <span style="font-weight: 700;">↑HIGH</span></div>
                        </div>
                        <div id="5m" style="background: rgba(0,255,65,0.06); border-left: 3px solid #00ff41; padding: 10px; border-radius: 6px; font-size: 0.8em;">
                            <div style="color: #00ff41; font-weight: 700; font-size: 1em; margin-bottom: 3px;">5m</div>
                            <div style="color: #00ff41; font-weight: 600; margin-bottom: 3px;">✓ BULL</div>
                            <div style="color: #ffaa00; margin-bottom: 1px;">RSI: <span style="font-weight: 700;">54</span></div>
                            <div style="color: #00ff41; margin-bottom: 1px;">MACD: <span style="font-weight: 700;">↑+</span></div>
                            <div style="color: #00d4ff; margin-bottom: 1px;">K%D: <span style="font-weight: 700;">65/60</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">EMA: <span style="font-weight: 700;">↑</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">BB: <span style="font-weight: 700;">Mid</span></div>
                            <div style="color: #cccccc;">Vol: <span style="font-weight: 700;">→MED</span></div>
                        </div>
                        <div id="15m" style="background: rgba(0,255,65,0.07); border-left: 3px solid #00ff41; padding: 10px; border-radius: 6px; font-size: 0.8em;">
                            <div style="color: #00ff41; font-weight: 700; font-size: 1em; margin-bottom: 3px;">15m</div>
                            <div style="color: #00ff41; font-weight: 600; margin-bottom: 3px;">✓ BULL</div>
                            <div style="color: #ffaa00; margin-bottom: 1px;">RSI: <span style="font-weight: 700;">56</span></div>
                            <div style="color: #00ff41; margin-bottom: 1px;">MACD: <span style="font-weight: 700;">↑+</span></div>
                            <div style="color: #00d4ff; margin-bottom: 1px;">K%D: <span style="font-weight: 700;">58/52</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">EMA: <span style="font-weight: 700;">↑</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">BB: <span style="font-weight: 700;">Mid</span></div>
                            <div style="color: #cccccc;">Vol: <span style="font-weight: 700;">→MED</span></div>
                        </div>
                        <div id="30m" style="background: rgba(255,170,0,0.07); border-left: 3px solid #ffaa00; padding: 10px; border-radius: 6px; font-size: 0.8em;">
                            <div style="color: #ffaa00; font-weight: 700; font-size: 1em; margin-bottom: 3px;">30m</div>
                            <div style="color: #ffaa00; font-weight: 600; margin-bottom: 3px;">→ NEUTRAL</div>
                            <div style="color: #ffaa00; margin-bottom: 1px;">RSI: <span style="font-weight: 700;">51</span></div>
                            <div style="color: #cccccc; margin-bottom: 1px;">MACD: <span style="font-weight: 700;">→0</span></div>
                            <div style="color: #00d4ff; margin-bottom: 1px;">K%D: <span style="font-weight: 700;">48/50</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">EMA: <span style="font-weight: 700;">→</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">BB: <span style="font-weight: 700;">Mid</span></div>
                            <div style="color: #cccccc;">Vol: <span style="font-weight: 700;">→MED</span></div>
                        </div>
                        <div id="1h" style="background: rgba(255,170,0,0.08); border-left: 3px solid #ffaa00; padding: 10px; border-radius: 6px; font-size: 0.8em;">
                            <div style="color: #ffaa00; font-weight: 700; font-size: 1em; margin-bottom: 3px;">1h</div>
                            <div style="color: #ffaa00; font-weight: 600; margin-bottom: 3px;">↔ SIDEWAYS</div>
                            <div style="color: #ffaa00; margin-bottom: 1px;">RSI: <span style="font-weight: 700;">47</span></div>
                            <div style="color: #cccccc; margin-bottom: 1px;">MACD: <span style="font-weight: 700;">→0</span></div>
                            <div style="color: #00d4ff; margin-bottom: 1px;">K%D: <span style="font-weight: 700;">44/45</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">EMA: <span style="font-weight: 700;">→</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">BB: <span style="font-weight: 700;">Lower</span></div>
                            <div style="color: #cccccc;">Vol: <span style="font-weight: 700;">↓LOW</span></div>
                        </div>
                        <div id="4h" style="background: rgba(0,212,255,0.08); border-left: 3px solid #00d4ff; padding: 10px; border-radius: 6px; font-size: 0.8em;">
                            <div style="color: #00d4ff; font-weight: 700; font-size: 1em; margin-bottom: 3px;">4h</div>
                            <div style="color: #00d4ff; font-weight: 600; margin-bottom: 3px;">→ NEUTRAL</div>
                            <div style="color: #ffaa00; margin-bottom: 1px;">RSI: <span style="font-weight: 700;">48</span></div>
                            <div style="color: #cccccc; margin-bottom: 1px;">MACD: <span style="font-weight: 700;">↓-</span></div>
                            <div style="color: #00d4ff; margin-bottom: 1px;">K%D: <span style="font-weight: 700;">40/42</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">EMA: <span style="font-weight: 700;">↓</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">BB: <span style="font-weight: 700;">Lower</span></div>
                            <div style="color: #cccccc;">Vol: <span style="font-weight: 700;">↓LOW</span></div>
                        </div>
                        <div id="1d" style="background: rgba(255,0,51,0.08); border-left: 3px solid #ff0033; padding: 10px; border-radius: 6px; font-size: 0.8em;">
                            <div style="color: #ff0033; font-weight: 700; font-size: 1em; margin-bottom: 3px;">1d</div>
                            <div style="color: #ff0033; font-weight: 600; margin-bottom: 3px;">✗ BEAR</div>
                            <div style="color: #ffaa00; margin-bottom: 1px;">RSI: <span style="font-weight: 700;">42</span></div>
                            <div style="color: #ff0033; margin-bottom: 1px;">MACD: <span style="font-weight: 700;">↓-</span></div>
                            <div style="color: #ff0033; margin-bottom: 1px;">K%D: <span style="font-weight: 700;">35/38</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">EMA: <span style="font-weight: 700;">↓</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">BB: <span style="font-weight: 700;">Lower</span></div>
                            <div style="color: #cccccc;">Vol: <span style="font-weight: 700;">→MED</span></div>
                        </div>
                        <div id="1M" style="background: rgba(0,255,65,0.08); border-left: 3px solid #00ff41; padding: 10px; border-radius: 6px; font-size: 0.8em;">
                            <div style="color: #00ff41; font-weight: 700; font-size: 1em; margin-bottom: 3px;">1M</div>
                            <div style="color: #00ff41; font-weight: 600; margin-bottom: 3px;">✓ BULL</div>
                            <div style="color: #ffaa00; margin-bottom: 1px;">RSI: <span style="font-weight: 700;">62</span></div>
                            <div style="color: #00ff41; margin-bottom: 1px;">MACD: <span style="font-weight: 700;">↑+</span></div>
                            <div style="color: #00ff41; margin-bottom: 1px;">K%D: <span style="font-weight: 700;">78/75</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">EMA: <span style="font-weight: 700;">↑</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">BB: <span style="font-weight: 700;">Upper</span></div>
                            <div style="color: #cccccc;">Vol: <span style="font-weight: 700;">↑HIGH</span></div>
                        </div>
                        <div id="3M" style="background: rgba(255,0,255,0.08); border-left: 3px solid #ff00ff; padding: 10px; border-radius: 6px; font-size: 0.8em;">
                            <div style="color: #ff00ff; font-weight: 700; font-size: 1em; margin-bottom: 3px;">3M</div>
                            <div style="color: #ff00ff; font-weight: 600; margin-bottom: 3px;">✓ BULL</div>
                            <div style="color: #ffaa00; margin-bottom: 1px;">RSI: <span style="font-weight: 700;">68</span></div>
                            <div style="color: #00ff41; margin-bottom: 1px;">MACD: <span style="font-weight: 700;">↑++</span></div>
                            <div style="color: #00ff41; margin-bottom: 1px;">K%D: <span style="font-weight: 700;">85/82</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">EMA: <span style="font-weight: 700;">↑↑</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">BB: <span style="font-weight: 700;">Upper</span></div>
                            <div style="color: #cccccc;">Vol: <span style="font-weight: 700;">↑HIGH</span></div>
                        </div>
                        <div id="1Y" style="background: rgba(255,170,0,0.10); border-left: 3px solid #ffaa00; padding: 10px; border-radius: 6px; font-size: 0.8em;">
                            <div style="color: #ffaa00; font-weight: 700; font-size: 1em; margin-bottom: 3px;">1Y</div>
                            <div style="color: #ffaa00; font-weight: 600; margin-bottom: 3px;">◈ KONSOL.</div>
                            <div style="color: #ffaa00; margin-bottom: 1px;">RSI: <span style="font-weight: 700;">55</span></div>
                            <div style="color: #cccccc; margin-bottom: 1px;">MACD: <span style="font-weight: 700;">→0</span></div>
                            <div style="color: #00d4ff; margin-bottom: 1px;">K%D: <span style="font-weight: 700;">52/55</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">EMA: <span style="font-weight: 700;">→</span></div>
                            <div style="color: #fff; margin-bottom: 1px;">BB: <span style="font-weight: 700;">Mid</span></div>
                            <div style="color: #cccccc;">Vol: <span style="font-weight: 700;">↓LOW</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ENTRY ZONE CALCULATOR • DOPRECYZUJ WEJŚCIE (STATIC SNAPSHOT) -->
        <div style="background: linear-gradient(135deg, #0a1a0a 0%, #0a0a0f 100%); padding: 16px; border-radius: 8px; border: 2px solid #00ff41; margin-bottom: 15px; box-shadow: 0 0 18px rgba(0,255,65,0.2);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <div style="font-size: 0.95em; color: #00ff41; font-weight: 800; text-transform: uppercase;">📍 ENTRY ZONE CALCULATOR • DOPRECYZUJ WEJŚCIE</div>
                <div style="font-size: 0.68em; background: rgba(0,255,65,0.15); color: #00ff41; padding: 5px 10px; border-radius: 6px; font-weight: 700;">Live snapshot</div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 12px;">
                <div style="background: rgba(255,0,51,0.08); border: 1px solid rgba(255,0,51,0.3); border-radius: 6px; padding: 12px;">
                    <div style="color: #ff0033; font-weight: 800; font-size: 0.9em; margin-bottom: 6px;">🔴 AGGRESSIVE ENTRY</div>
                    <div style="color: #fff; font-weight: 900; font-size: 1.1em;">$96,850</div>
                    <div style="font-size: 0.75em; color: #ddd; line-height: 1.5; margin-top: 6px;">
                        • CVD spot mógł pociągnąć<br>
                        • Wysokie ryzyko / wysoki zysk<br>
                        • SL: $95,200 | TP: $99,500
                    </div>
                </div>
                <div style="background: rgba(0,255,65,0.08); border: 1px solid rgba(0,255,65,0.3); border-radius: 6px; padding: 12px;">
                    <div style="color: #00ff41; font-weight: 800; font-size: 0.9em; margin-bottom: 6px;">✓ MODERATE ENTRY</div>
                    <div style="color: #fff; font-weight: 900; font-size: 1.1em;">$95,400</div>
                    <div style="font-size: 0.75em; color: #ddd; line-height: 1.5; margin-top: 6px;">
                        • Potwierdzony MACD ZL<br>
                        • Zbalansowane ryzyko/zysk<br>
                        • SL: $94,100 | TP: $98,200
                    </div>
                </div>
                <div style="background: rgba(0,212,255,0.08); border: 1px solid rgba(0,212,255,0.35); border-radius: 6px; padding: 12px; display: grid; gap: 8px;">
                    <div>
                        <div style="font-size: 0.8em; color: #00d4ff; font-weight: 800; letter-spacing: 0.5px;">💧 WHALE ACTIVITY</div>
                        <div style="color: #00d4ff; font-weight: 900; font-size: 1em;">ACCUMULATING</div>
                    </div>
                    <div>
                        <div style="font-size: 0.8em; color: #ffaa00; font-weight: 800; letter-spacing: 0.5px;">⚡ LIQUIDATION RISK</div>
                        <div style="color: #ffaa00; font-weight: 900; font-size: 1em;">$98,200+</div>
                    </div>
                </div>
            </div>
        </div>


        <!-- TRADING SIGNALS & MARKET STRUCTURE -->
        <div style="background: linear-gradient(135deg, #0f0a1a 0%, #0a0a0a 100%); padding: 15px; border-radius: 8px; border: 2px solid #bb86fc; margin-bottom: 15px; box-shadow: 0 0 20px rgba(187,134,252,0.2);">
            <div style="font-size: 0.95em; color: #bb86fc; margin-bottom: 12px; font-weight: 700; text-transform: uppercase; display: flex; justify-content: space-between; align-items: center;">
                <span>📊 AKTUALNE SYGNAŁY BUY/SELL</span>
                <span style="font-size: 0.7em; background: rgba(0,255,65,0.2); color: #00ff41; padding: 4px 10px; border-radius: 5px; font-weight: 700;">3 AKTYWNE</span>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                <!-- Signal 1: LONG Setup -->
                <div style="background: rgba(0,255,65,0.1); padding: 12px; border-radius: 6px; border: 2px solid #00ff41; position: relative;">
                    <div style="position: absolute; top: -10px; left: 10px; background: #00ff41; color: #000; padding: 3px 10px; border-radius: 10px; font-size: 0.65em; font-weight: 900;">LONG ↑</div>
                    <div style="margin-top: 8px; color: #00ff41; font-weight: 700; font-size: 0.85em; margin-bottom: 8px;">🟢 DEMAND ZONE BOUNCE</div>
                    <div style="font-size: 0.7em; line-height: 1.7; color: #ccc;">
                        <div><strong>Entry:</strong> $94,950</div>
                        <div><strong>SL:</strong> $94,600 (-0.37%)</div>
                        <div><strong>TP1:</strong> $95,800 (+0.89%)</div>
                        <div><strong>TP2:</strong> $96,500 (+1.63%)</div>
                        <div style="margin-top: 6px; padding: 6px; background: rgba(0,20,0,0.5); border-radius: 3px; font-size: 0.65em;">
                            <strong>R:R = 1:3.5</strong> | Confirmation: BOS + OB touch
                        </div>
                    </div>
                </div>
                
                <!-- Signal 2: SHORT Setup -->
                <div style="background: rgba(255,0,51,0.1); padding: 12px; border-radius: 6px; border: 2px solid #ff0033; position: relative;">
                    <div style="position: absolute; top: -10px; left: 10px; background: #ff0033; color: #fff; padding: 3px 10px; border-radius: 10px; font-size: 0.65em; font-weight: 900;">SHORT ↓</div>
                    <div style="margin-top: 8px; color: #ff0033; font-weight: 700; font-size: 0.85em; margin-bottom: 8px;">🔴 SUPPLY ZONE REJECTION</div>
                    <div style="font-size: 0.7em; line-height: 1.7; color: #ccc;">
                        <div><strong>Entry:</strong> $96,150</div>
                        <div><strong>SL:</strong> $96,550 (-0.42%)</div>
                        <div><strong>TP1:</strong> $95,400 (+0.78%)</div>
                        <div><strong>TP2:</strong> $94,800 (+1.40%)</div>
                        <div style="margin-top: 6px; padding: 6px; background: rgba(20,0,0,0.5); border-radius: 3px; font-size: 0.65em;">
                            <strong>R:R = 1:3.3</strong> | Watch: Bearish FVG fill
                        </div>
                    </div>
                </div>
                
                <!-- Signal 3: SCALP Setup -->
                <div style="background: rgba(255,170,0,0.1); padding: 12px; border-radius: 6px; border: 2px solid #ffaa00; position: relative;">
                    <div style="position: absolute; top: -10px; left: 10px; background: #ffaa00; color: #000; padding: 3px 10px; border-radius: 10px; font-size: 0.65em; font-weight: 900;">SCALP ⚡</div>
                    <div style="margin-top: 8px; color: #ffaa00; font-weight: 700; font-size: 0.85em; margin-bottom: 8px;">⚡ RANGE BREAKOUT</div>
                    <div style="font-size: 0.7em; line-height: 1.7; color: #ccc;">
                        <div><strong>Entry:</strong> $95,550 (break)</div>
                        <div><strong>SL:</strong> $95,400 (-0.16%)</div>
                        <div><strong>TP:</strong> $95,850 (+0.31%)</div>
                        <div><strong>Time:</strong> 5-15 min</div>
                        <div style="margin-top: 6px; padding: 6px; background: rgba(20,15,0,0.5); border-radius: 3px; font-size: 0.65em;">
                            <strong>R:R = 1:2</strong> | Quick scalp - tight SL
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 12px; padding: 10px; background: rgba(0,212,255,0.1); border-radius: 5px; border-left: 3px solid #00d4ff;">
                <div style="font-size: 0.7em; color: #00d4ff; font-weight: 700; margin-bottom: 5px;">💡 JAK UŻYWAĆ SYGNAŁÓW:</div>
                <div style="font-size: 0.65em; line-height: 1.6; color: #ccc;">
                    • <strong>LONG/SHORT:</strong> Swing trading 4H-1D, target kilka % | • <strong>SCALP:</strong> Quick 15m-1H, małe TP | • Zawsze sprawdzaj Volume + RSI przed wejściem | • Nigdy nie wchodz przeciwko głównemu trendowi (sprawdz MA200)
                </div>
            </div>
        </div>


        <!-- AQUA TRADER RSI S/R LEVELS - COLLAPSIBLE SECTION -->
        <div style="padding: 0 30px 10px 30px; background: #0a0a0a;">
            <div style="background: linear-gradient(135deg, #001a1a 0%, #0a0a0a 100%); border: 2px solid #00d4ff; border-radius: 8px; padding: 15px;">
                <div onclick="toggleAquaTrader()" style="cursor: pointer; padding: 5px 0;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="display: flex; flex-direction: column; gap: 8px; flex: 1;">
                            <div style="font-size: 1.1em; color: #00d4ff; font-weight: 800; text-transform: uppercase;">🌊 AQUA TRADER • RSI S/R LEVELS</div>
                            <div style="font-size: 0.9em; color: #ffffff; font-weight: 400; font-family: 'Roboto Mono', monospace; letter-spacing: 0.5px; line-height: 1.4;">Kluczowe poziomy oporu i wsparcia oparte na historycznym RSI</div>
                        </div>
                        <div id="aqua-toggle-icon" style="font-size: 1.8em; color: #00d4ff; transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); animation: arrowPulse 2s ease-in-out infinite; text-shadow: 0 0 10px #00d4ff, 0 0 20px #00d4ff; display: inline-block; min-width: 30px; text-align: center; font-weight: bold;">▼</div>
                    </div>
                </div>
            
                <div id="aqua-trader-content" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(0,212,255,0.3);">
                    <!-- Description -->
                    <div style="background: rgba(0,212,255,0.1); padding: 12px; border-radius: 6px; border-left: 3px solid #00d4ff; margin-bottom: 16px;">
                        <div style="font-size: 0.95em; color: #00d4ff; font-weight: 700; margin-bottom: 8px; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">📊 O METODZIE AQUA TRADER:</div>
                    <div style="font-size: 1em; line-height: 1.8; color: #ddd; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">
                        <strong style="color: #00d4ff;">Aqua Trader</strong> wykorzystuje RSI (Relative Strength Index) do identyfikacji kluczowych poziomów wsparcia i oporu. Zamiast tradycyjnych poziomów cenowych, metodologia ta analizuje <strong>historyczne wartości RSI</strong> gdzie cena wcześniej się odbiła lub zawróciła. Gdy RSI wraca do tych samych poziomów, istnieje wysokie prawdopodobieństwo powtórnej reakcji cenowej.
                    </div>
                </div>

                <!-- RSI S/R Levels Grid -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 15px;">
                    <!-- RSI Resistance Levels -->
                    <div style="background: rgba(255,0,51,0.1); padding: 12px; border-radius: 6px; border-left: 4px solid #ff0033;">
                        <div style="font-size: 0.85em; color: #ff0033; font-weight: 700; margin-bottom: 10px;">🔴 RSI RESISTANCE LEVELS</div>
                        <div style="font-size: 0.7em; line-height: 1.8; color: #ccc; font-family: 'Roboto Mono';">
                            <div style="display: flex; justify-content: space-between; padding: 6px; background: rgba(0,0,0,0.3); border-radius: 3px; margin-bottom: 5px;">
                                <span>RSI 70-75:</span>
                                <span style="color: #ff0033; font-weight: 700;">Overbought Zone</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 6px; background: rgba(0,0,0,0.3); border-radius: 3px; margin-bottom: 5px;">
                                <span>RSI 65-70:</span>
                                <span style="color: #ff6600; font-weight: 700;">Strong Resistance</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 6px; background: rgba(0,0,0,0.3); border-radius: 3px; margin-bottom: 5px;">
                                <span>RSI 55-60:</span>
                                <span style="color: #ffaa00; font-weight: 700;">Medium Resistance</span>
                            </div>
                            <div style="font-size: 0.65em; color: #fff; margin-top: 8px; padding: 6px; background: rgba(20,0,0,0.5); border-radius: 3px;">
                                💡 Gdy RSI osiąga te poziomy, spodziewaj się korekty lub spadku. Rozważ SHORT setup.
                            </div>
                        </div>
                    </div>

                    <!-- RSI Support Levels -->
                    <div style="background: rgba(0,255,65,0.1); padding: 12px; border-radius: 6px; border-left: 4px solid #00ff41;">
                        <div style="font-size: 0.85em; color: #00ff41; font-weight: 700; margin-bottom: 10px;">🟢 RSI SUPPORT LEVELS</div>
                        <div style="font-size: 0.7em; line-height: 1.8; color: #ccc; font-family: 'Roboto Mono';">
                            <div style="display: flex; justify-content: space-between; padding: 6px; background: rgba(0,0,0,0.3); border-radius: 3px; margin-bottom: 5px;">
                                <span>RSI 25-30:</span>
                                <span style="color: #00ff41; font-weight: 700;">Oversold Zone</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 6px; background: rgba(0,0,0,0.3); border-radius: 3px; margin-bottom: 5px;">
                                <span>RSI 30-35:</span>
                                <span style="color: #00d4ff; font-weight: 700;">Strong Support</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 6px; background: rgba(0,0,0,0.3); border-radius: 3px; margin-bottom: 5px;">
                                <span>RSI 40-45:</span>
                                <span style="color: #0096ff; font-weight: 700;">Medium Support</span>
                            </div>
                            <div style="font-size: 0.65em; color: #fff; margin-top: 8px; padding: 6px; background: rgba(0,20,0,0.5); border-radius: 3px;">
                                💡 Gdy RSI spada do tych poziomów, spodziewaj się odbicia lub wzrostu. Rozważ LONG setup.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Current RSI Status -->
                <div style="background: rgba(0,212,255,0.15); padding: 12px; border-radius: 6px; border: 2px solid #00d4ff;">
                    <div style="font-size: 0.8em; color: #00d4ff; font-weight: 700; margin-bottom: 10px;">📍 CURRENT RSI STATUS (BTC/USDT)</div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; font-family: 'Roboto Mono';">
                        <div style="text-align: center;">
                            <div style="font-size: 0.65em; color: #fff;">RSI(14):</div>
                            <div style="font-size: 1.1em; color: #ffaa00; font-weight: 900;">41.8</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 0.65em; color: #fff;">Zone:</div>
                            <div style="font-size: 0.8em; color: #00d4ff; font-weight: 700;">NEUTRAL</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 0.65em; color: #fff;">Next Support:</div>
                            <div style="font-size: 0.8em; color: #00ff41; font-weight: 700;">RSI 40</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 0.65em; color: #fff;">Next Resistance:</div>
                            <div style="font-size: 0.8em; color: #ff0033; font-weight: 700;">RSI 55</div>
                        </div>
                    </div>
                </div>

                <!-- Trading Strategy -->
                <div style="margin-top: 12px; padding: 10px; background: rgba(255,170,0,0.1); border-radius: 5px; border-left: 3px solid #ffaa00;">
                    <div style="font-size: 0.7em; color: #ffaa00; font-weight: 700; margin-bottom: 5px;">⚡ STRATEGIA TRADING:</div>
                    <div style="font-size: 0.65em; line-height: 1.6; color: #ccc;">
                        • <strong>LONG Entry:</strong> Gdy RSI wchodzi w strefę 25-35 (oversold) + pojawia się divergence bullish<br>
                        • <strong>SHORT Entry:</strong> Gdy RSI wchodzi w strefę 65-75 (overbought) + pojawia się divergence bearish<br>
                        • <strong>Potwierdzenie:</strong> Zawsze czekaj na świecę potwierdzającą + wzrost wolumenu<br>
                        • <strong>Stop Loss:</strong> Poniżej/powyżej ostatniego swing low/high (nie bazuj tylko na RSI)
                    </div>
                </div>

                <!-- STOCHASTIC & PRICE ACTION -->
                <div style="margin-top: 12px; padding: 12px; background: linear-gradient(135deg, #0f0f1a 0%, #0a0a0a 100%); border-radius: 5px; border-left: 3px solid #ffaa00;">
                    <div style="font-size: 0.8em; color: #ffaa00; margin-bottom: 10px; font-weight: 700;">📈 STOCHASTIC & PRICE ACTION:</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 0.75em;">
                        <div style="color: #ccc;">Stochastic %K: <span style="color: #00ff41; font-weight: 700;">72.3</span></div>
                        <div style="color: #ccc;">Stochastic %D: <span style="color: #ffaa00; font-weight: 700;">64.8</span></div>
                        <div style="color: #ccc;">ADX (14): <span style="color: #00d4ff; font-weight: 700;">28.4 (Strong)</span></div>
                        <div style="color: #ccc;">Price vs MA200: <span style="color: #00ff41; font-weight: 700;">+$1,250 Above</span></div>
                    </div>
                    <div style="margin-top: 8px; font-size: 0.7em; color: #fff; padding: 6px; background: rgba(255,170,0,0.1); border-radius: 3px;">
                        💡 Stoch wysoki = overbought momentum. Mogą być pullback'i ale trend BULLISH potwierdzon.
                    </div>
                </div>

                <!-- RSI DIVERGENCE SCANNER -->
                <div style="margin-top: 12px; padding: 12px; background: linear-gradient(135deg, #1a0a1a 0%, #0a0a0a 100%); border-radius: 5px; border: 2px solid #ff00ff; box-shadow: 0 0 15px rgba(255,0,255,0.2);">
                    <div style="font-size: 0.8em; color: #ff00ff; margin-bottom: 10px; font-weight: 700; text-transform: uppercase;">⚠️ RSI DIVERGENCE SCANNER:</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.75em;">
                        <div style="background: rgba(255,0,51,0.1); padding: 8px; border-radius: 3px; border-left: 2px solid #ff0033;">
                            <div style="color: #ff0033; font-weight: 700; margin-bottom: 3px;">📉 BEARISH DIV</div>
                            <div style="color: #ccc;">Price ↗ RSI ↘</div>
                            <div style="font-size: 0.7em; color: #fff; margin-top: 3px;">NOT DETECTED ✓</div>
                        </div>
                        
                        <div style="background: rgba(0,255,65,0.1); padding: 8px; border-radius: 3px; border-left: 2px solid #00ff41;">
                            <div style="color: #00ff41; font-weight: 700; margin-bottom: 3px;">📈 BULLISH DIV</div>
                            <div style="color: #ccc;">Price ↘ RSI ↗</div>
                            <div style="font-size: 0.7em; color: #00ff41; margin-top: 3px;">ACTIVE 🎯</div>
                        </div>
                        
                        <div style="background: rgba(255,170,0,0.1); padding: 8px; border-radius: 3px; border-left: 2px solid #ffaa00;">
                            <div style="color: #ffaa00; font-weight: 700; margin-bottom: 3px;">🔶 HIDDEN DIV</div>
                            <div style="color: #ccc;">Trend Continuation</div>
                            <div style="font-size: 0.7em; color: #fff; margin-top: 3px;">NOT DETECTED ✓</div>
                        </div>
                        
                        <div style="background: rgba(0,212,255,0.1); padding: 8px; border-radius: 3px; border-left: 2px solid #00d4ff;">
                            <div style="color: #00d4ff; font-weight: 700; margin-bottom: 3px;">⚡ STRENGTH</div>
                            <div style="color: #ccc;">Confidence Level</div>
                            <div style="font-size: 0.7em; color: #00ff41; margin-top: 3px;">78% STRONG</div>
                        </div>
                    </div>
                </div>

                <!-- RSI MULTI-TIMEFRAME ALIGNMENT -->
                <div style="margin-top: 12px; padding: 12px; background: linear-gradient(135deg, #001a1a 0%, #0a0a0a 100%); border-radius: 5px; border-left: 3px solid #00d4ff;">
                    <div style="font-size: 0.8em; color: #00d4ff; margin-bottom: 10px; font-weight: 700;">⏱️ RSI MULTI-TIMEFRAME ALIGNMENT:</div>
                    <div style="font-size: 0.75em; line-height: 1.8; color: #ccc;">
                        <div style="display: flex; justify-content: space-between; padding: 6px; background: rgba(0,255,65,0.08); border-radius: 3px; margin-bottom: 4px;">
                            <span>1H RSI:</span>
                            <span style="color: #00ff41; font-weight: 700;">58.4 ✓ BULLISH</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 6px; background: rgba(0,255,65,0.08); border-radius: 3px; margin-bottom: 4px;">
                            <span>4H RSI:</span>
                            <span style="color: #00ff41; font-weight: 700;">62.1 ✓ BULLISH</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 6px; background: rgba(255,170,0,0.08); border-radius: 3px; margin-bottom: 4px;">
                            <span>1D RSI:</span>
                            <span style="color: #ffaa00; font-weight: 700;">68.7 ⚠️ NEAR OB</span>
                        </div>
                        <div style="margin-top: 8px; padding: 8px; background: rgba(0,255,65,0.12); border-radius: 3px; text-align: center; border: 1px solid #00ff41;">
                            <span style="color: #00ff41; font-weight: 700; font-size: 0.75em;">✅ 3/3 TIMEFRAMES CONFIRM BULLISH MOMENTUM</span>
                        </div>
                    </div>
                </div>

                <!-- RSI MAPPED TO PRICE LEVELS -->
                <div style="margin-top: 12px; padding: 12px; background: linear-gradient(135deg, #1a1a00 0%, #0a0a0a 100%); border-radius: 5px; border-left: 3px solid #ffaa00;">
                    <div style="font-size: 0.8em; color: #ffaa00; margin-bottom: 10px; font-weight: 700;">💰 RSI MAPPED TO PRICE LEVELS:</div>
                    <div style="font-size: 0.75em; line-height: 1.6; color: #ccc;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px;">
                            <div style="text-align: center; padding: 6px; background: rgba(255,0,51,0.1); border-radius: 3px; border: 1px solid #ff0033;">
                                <div style="color: #ff0033; font-size: 0.7em;">RSI 70</div>
                                <div style="color: #fff; font-weight: 700; margin-top: 2px;">$98,850</div>
                            </div>
                            <div style="text-align: center; padding: 6px; background: rgba(255,170,0,0.1); border-radius: 3px; border: 1px solid #ffaa00;">
                                <div style="color: #ffaa00; font-size: 0.7em;">RSI 60</div>
                                <div style="color: #fff; font-weight: 700; margin-top: 2px;">$97,450</div>
                            </div>
                            <div style="text-align: center; padding: 6px; background: rgba(100,100,100,0.1); border-radius: 3px; border: 1px solid #888;">
                                <div style="color: #fff; font-size: 0.7em;">RSI 50</div>
                                <div style="color: #fff; font-weight: 700; margin-top: 2px;">$96,200</div>
                            </div>
                            <div style="text-align: center; padding: 6px; background: rgba(0,212,255,0.1); border-radius: 3px; border: 1px solid #00d4ff;">
                                <div style="color: #00d4ff; font-size: 0.7em;">RSI 40</div>
                                <div style="color: #fff; font-weight: 700; margin-top: 2px;">$94,800</div>
                            </div>
                            <div style="text-align: center; padding: 6px; background: rgba(0,255,65,0.1); border-radius: 3px; border: 1px solid #00ff41;">
                                <div style="color: #00ff41; font-size: 0.7em;">RSI 30</div>
                                <div style="color: #fff; font-weight: 700; margin-top: 2px;">$93,200</div>
                            </div>
                            <div style="text-align: center; padding: 6px; background: rgba(0,255,65,0.12); border-radius: 3px; border: 1px solid #00ff41;">
                                <div style="color: #00ff41; font-size: 0.7em;">CURRENT</div>
                                <div style="color: #00ff41; font-weight: 700; margin-top: 2px;">$96,850</div>
                            </div>
                        </div>
                        <div style="margin-top: 8px; font-size: 0.7em; color: #fff; text-align: center;">
                            💡 Current price at RSI ~58 zone = healthy bullish momentum, room to $98k
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            function toggleAquaTrader() {
                const content = document.getElementById('aqua-trader-content');
                const icon = document.getElementById('aqua-toggle-icon');
                
                if (content.style.display === 'none') {
                    content.style.display = 'block';
                    icon.style.transform = 'rotate(180deg)';
                    icon.style.animation = 'none';
                } else {
                    content.style.display = 'none';
                    icon.style.transform = 'rotate(0deg)';
                    icon.style.animation = 'arrowPulse 2s ease-in-out infinite';
                }
            }
        </script>
            </div>
        </div>

        <!-- THE TAPE • LIVE MARKET INTEL - COLLAPSIBLE SECTION -->
        <div style="padding: 0 30px 10px 30px; background: #0a0a0a;">
            <div style="background: linear-gradient(135deg, #1a001a 0%, #0a0a0a 100%); border: 2px solid #ff00ff; border-radius: 8px; padding: 15px;">
                <div onclick="toggleTheTape()" style="cursor: pointer; padding: 5px 0;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="display: flex; flex-direction: column; gap: 8px; flex: 1;">
                            <div style="font-size: 1.1em; color: #ff00ff; font-weight: 800; text-transform: uppercase;">📡 THE TAPE • LIVE MARKET INTEL</div>
                            <div style="font-size: 0.9em; color: #ffffff; font-weight: 400; font-family: 'Roboto Mono', monospace; letter-spacing: 0.5px; line-height: 1.4;">Order Book, Social Sentiment, Liquidations, Market Structure & Network Data</div>
                        </div>
                        <div id="tape-toggle-icon" style="font-size: 1.8em; color: #ff00ff; transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); animation: arrowPulse 2s ease-in-out infinite; text-shadow: 0 0 10px #ff00ff, 0 0 20px #ff00ff; display: inline-block; min-width: 30px; text-align: center; font-weight: bold;">▼</div>
                    </div>
                </div>
            
            <div id="the-tape-content" style="display: none; margin-top: 15px;">
                <!-- Description -->
                <div style="background: rgba(255,0,255,0.1); padding: 12px; border-radius: 6px; border-left: 3px solid #ff00ff; margin-bottom: 16px;">
                    <div style="font-size: 0.95em; color: #ff00ff; font-weight: 700; margin-bottom: 8px; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">📡 O THE TAPE:</div>
                    <div style="font-size: 1em; line-height: 1.8; color: #ddd; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">
                        <strong style="color: #ff00ff;">The Tape</strong> to profesjonalne narzędzie analizy rynkowej dostarczające dane w czasie rzeczywistym z giełd, sieci blockchain oraz mediów społecznościowych. Śledzi <strong>Order Book Imbalance</strong> (nierównowaga zleceń kupna/sprzedaży), <strong>Social Sentiment</strong> (nastroje społeczne), <strong>Liquidation Clusters</strong> (strefy likwidacji), <strong>Market Structure</strong> (strukturę rynku SMC), <strong>Network Health</strong> (zdrowie sieci BTC) oraz <strong>Derivatives Premium</strong> (premia kontraktów terminowych). Wszystkie te dane pozwalają identyfikować ruchy smart money zanim staną się widoczne na wykresie cenowym.
                    </div>
                </div>

            <!-- TOP TIER: ORDER BOOK + SOCIAL + LIQUIDATIONS -->
            <div style="padding: 10px; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px;">
                <!-- ORDER BOOK IMBALANCE -->
                <div style="background: linear-gradient(135deg, #0a1a0f 0%, #0a0a0a 100%); padding: 10px; border-radius: 6px; border-left: 3px solid #00ff41;">
                    <div style="font-size: 0.9em; color: #00ff41; margin-bottom: 6px; font-weight: 700;">📖 ORDER BOOK IMBALANCE:</div>
                    <div style="font-size: 0.95em; line-height: 1.7; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">BID Depth:</span>
                            <span style="color: #00ff41;">$245M (2%)</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">ASK Depth:</span>
                            <span style="color: #ff0033;">$182M (2%)</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0; padding-top: 3px; border-top: 1px solid #333;">
                            <span style="color: #00ff41; font-weight: 700;">Ratio:</span>
                            <span style="color: #00ff41; font-weight: bold;">1.35:1 🔼</span>
                        </div>
                    </div>
                </div>

                <!-- SOCIAL SENTIMENT -->
                <div style="background: linear-gradient(135deg, #1a0a1a 0%, #0a0a0a 100%); padding: 10px; border-radius: 6px; border-left: 3px solid #ff00ff;">
                    <div style="font-size: 0.9em; color: #ff00ff; margin-bottom: 6px; font-weight: 700;">💬 SOCIAL SENTIMENT:</div>
                    <div style="font-size: 0.95em; line-height: 1.7; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Twitter Vol:</span>
                            <span style="color: #ffaa00;">+145K ✍️</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Sentiment:</span>
                            <span style="color: #00ff41; font-weight: bold;">72/100 🟢</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0; padding-top: 3px; border-top: 1px solid #333;">
                            <span style="color: #ff00ff; font-weight: 700;">Whale Alert:</span>
                            <span style="color: #ff00ff;">12 Txs 🐋</span>
                        </div>
                    </div>
                </div>

                <!-- LIQUIDATION CLUSTERS -->
                <div style="background: linear-gradient(135deg, #1a0a00 0%, #0a0a0a 100%); padding: 10px; border-radius: 6px; border-left: 3px solid #ff6600;">
                    <div style="font-size: 0.9em; color: #ff6600; margin-bottom: 6px; font-weight: 700;">💥 LIQUIDATION CLUSTERS:</div>
                    <div style="font-size: 0.95em; line-height: 1.7; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #ff0033;">⬆️ >$97.4k:</span>
                            <span style="color: #ff0033;">$145M Shorts</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #00ff41;">⬇️ <$94.8k:</span>
                            <span style="color: #00ff41;">$220M Longs</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0; padding-top: 3px; border-top: 1px solid #333;">
                            <span style="color: #ffaa00; font-weight: 700;">Zone:</span>
                            <span style="color: #ffaa00;">⚖️ BALANCED</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MID TIER: STRUCTURE + NETWORK + DERIVATIVES -->
            <div style="padding: 10px; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-top: 5px;">
                <!-- MARKET STRUCTURE -->
                <div style="background: linear-gradient(135deg, #0a1a1a 0%, #0a0a0a 100%); padding: 10px; border-radius: 6px; border-left: 3px solid #00d4ff;">
                    <div style="font-size: 0.9em; color: #00d4ff; margin-bottom: 6px; font-weight: 700;">🏗️ MARKET STRUCTURE:</div>
                    <div style="font-size: 0.95em; line-height: 1.7; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Last BOS:</span>
                            <span style="color: #00ff41;">$96,800 🔼</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">CHoCH:</span>
                            <span style="color: #ffaa00;">PENDING ⏳</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0; padding-top: 3px; border-top: 1px solid #333;">
                            <span style="color: #00d4ff; font-weight: 700;">Trend:</span>
                            <span style="color: #00d4ff;">HH/HL ⬆️</span>
                        </div>
                    </div>
                </div>

                <!-- NETWORK HEALTH -->
                <div style="background: linear-gradient(135deg, #0a0a1a 0%, #0a0a0a 100%); padding: 10px; border-radius: 6px; border-left: 3px solid #0096ff;">
                    <div style="font-size: 0.9em; color: #0096ff; margin-bottom: 6px; font-weight: 700;">⛏️ NETWORK HEALTH:</div>
                    <div style="font-size: 0.95em; line-height: 1.7; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Hashrate:</span>
                            <span style="color: #0096ff;">425 EH/s 🔼</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Difficulty:</span>
                            <span style="color: #0096ff;">68.5T 🔼</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0; padding-top: 3px; border-top: 1px solid #333;">
                            <span style="color: #0096ff; font-weight: 700;">Tx Vol (24h):</span>
                            <span style="color: #0096ff;">$42.5B ✅</span>
                        </div>
                    </div>
                </div>

                <!-- DERIVATIVES PREMIUM -->
                <div style="background: linear-gradient(135deg, #1a1a0a 0%, #0a0a0a 100%); padding: 10px; border-radius: 6px; border-left: 3px solid #ffff00;">
                    <div style="font-size: 0.9em; color: #ffff00; margin-bottom: 6px; font-weight: 700;">📊 DERIVATIVES PREMIUM:</div>
                    <div style="font-size: 0.95em; line-height: 1.7; font-family: 'Roboto Mono', monospace; letter-spacing: 1.2px;">
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Futures:</span>
                            <span style="color: #ffff00;">+$45 🔼</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Perp:</span>
                            <span style="color: #ffff00;">+$32 🔼</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0; padding-top: 3px; border-top: 1px solid #333;">
                            <span style="color: #ffff00; font-weight: 700;">Basis (Ann):</span>
                            <span style="color: #ffff00; font-weight: bold;">+12.5% ✅</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BOTTOM TIER: KEY LEVELS + FLOWS + VOLATILITY -->
            <div style="padding: 10px; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-top: 5px;">
                <!-- Market Regime -->
                <div style="background: #0f0f0f; padding: 10px; border-radius: 6px; border-left: 3px solid #ff00ff;">
                    <div style="font-size: 0.9em; color: #fff; margin-bottom: 4px;">MARKET REGIME:</div>
                    <div style="font-size: 1.05em; color: #ff00ff; font-weight: 700;">ACCUMULATION / SPRING</div>
                </div>
                
                <!-- Key Levels -->
                <div style="background: #0f0f0f; padding: 10px; border-radius: 6px; font-family: 'Roboto Mono', monospace;">
                    <div style="font-size: 0.9em; color: #00ffff; margin-bottom: 6px; font-weight: 700;">📊 KEY LEVELS:</div>
                    <div style="font-size: 0.9em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #ffaa00;">EQH:</span>
                            <span style="color: #fff; font-weight: bold;">$97,583</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #ffaa00;">EQL:</span>
                            <span style="color: #fff; font-weight: bold;">$94,800</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #00ff00;">RNG:</span>
                            <span style="color: #00ff00; font-weight: bold;">$2,783</span>
                        </div>
                    </div>
                </div>
                
                <!-- Exchange Flow -->
                <div style="background: linear-gradient(135deg, #001a0a 0%, #0a0a0a 100%); padding: 10px; border-radius: 6px; border-left: 3px solid #00ff41;">
                    <div style="font-size: 0.9em; color: #00ff41; margin-bottom: 6px; font-weight: 700;">🔄 EXCHANGE FLOW:</div>
                    <div style="font-size: 0.9em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #fff;">IN:</span>
                            <span style="color: #ff0033; font-weight: bold;">-4,250 BTC</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #fff;">OUT:</span>
                            <span style="color: #00ff41; font-weight: bold;">+8,420 BTC</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #fff;">NET:</span>
                            <span style="color: #00ff41; font-weight: bold;">+4,170🔼</span>
                        </div>
                    </div>
                </div>
                
                <!-- Volatility & ATR -->
                <div style="background: linear-gradient(135deg, #1a0a00 0%, #0a0a0a 100%); padding: 10px; border-radius: 6px; border-left: 3px solid #ffaa00;">
                    <div style="font-size: 0.9em; color: #ffaa00; margin-bottom: 6px; font-weight: 700;">📈 VOLATILITY:</div>
                    <div style="font-size: 0.9em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #fff;">ATR(14):</span>
                            <span style="color: #ffaa00; font-weight: bold;">$1,245</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #fff;">RealVol:</span>
                            <span style="color: #ffaa00; font-weight: bold;">42.5%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #fff;">BW:</span>
                            <span style="color: #00d4ff; font-weight: bold;">2.8%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Killzones Compact -->
            <div style="padding: 10px 12px; background: linear-gradient(135deg, #0a0a0a 0%, #1a001a 100%); border-left: 3px solid #ff00ff; margin-top: 8px;">
                <div style="font-size: 0.95em; color: #ff00ff; margin-bottom: 10px; font-weight: 700;">🎯 KILL ZONES:</div>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 10px; font-size: 0.85em;">
                    <div style="background: rgba(255,170,0,0.15); padding: 6px; border-radius: 3px; border-left: 2px solid #ffaa00;">
                        <div style="color: #ffaa00; font-weight: 700; margin-bottom: 2px;">🇬🇧 LONDON</div>
                        <div style="color: #ccc;">07:00-09:00 UTC</div>
                        <div style="color: #fff; font-size: 0.75em; margin-top: 3px;">Volatility: HIGH | Swing trades</div>
                    </div>
                    
                    <div style="background: rgba(255,0,51,0.15); padding: 6px; border-radius: 3px; border-left: 2px solid #ff0033;">
                        <div style="color: #ff0033; font-weight: 700; margin-bottom: 2px;">🇺🇸 NY OPEN</div>
                        <div style="color: #ccc;">12:30-14:30 UTC</div>
                        <div style="color: #fff; font-size: 0.75em; margin-top: 3px;">Volatility: EXTREME | Scalps</div>
                    </div>
                    
                    <div style="background: rgba(255,100,0,0.15); padding: 6px; border-radius: 3px; border-left: 2px solid #ff6600;">
                        <div style="color: #ff6600; font-weight: 700; margin-bottom: 2px;">⚠️ LUNCH SLUMP</div>
                        <div style="color: #ccc;">16:30-17:30 UTC</div>
                        <div style="color: #fff; font-size: 0.75em; margin-top: 3px;">Volatility: LOW | AVOID</div>
                    </div>
                    
                    <div style="background: rgba(0,212,255,0.15); padding: 6px; border-radius: 3px; border-left: 2px solid #00d4ff;">
                        <div style="color: #00d4ff; font-weight: 700; margin-bottom: 2px;">⭐ GOLDEN WIN</div>
                        <div style="color: #ccc;">12:00-14:00 UTC</div>
                        <div style="color: #fff; font-size: 0.6em; margin-top: 2px;">MAX momentum + liquidity</div>
                    </div>
                </div>
            </div>
                
                <!-- Funding Rate Trends -->
                <div style="background: linear-gradient(135deg, #001a1a 0%, #0a0a0a 100%); padding: 8px 10px; border-radius: 5px; margin-top: 5px; border-left: 3px solid #00d4ff;">
                    <div style="font-size: 0.75em; color: #00d4ff; margin-bottom: 6px; font-weight: 700;">💰 FUNDING RATE:</div>
                    <div style="font-size: 0.7em; line-height: 1.5; display: flex; gap: 15px;">
                        <div style="display: flex; justify-content: space-between; flex: 1;">
                            <span style="color: #fff;">Now:</span>
                            <span style="color: #00ff41; font-weight: bold;">+0.0082%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; flex: 1;">
                            <span style="color: #fff;">8h Avg:</span>
                            <span style="color: #00ff41; font-weight: bold;">+0.0065%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; flex: 1;">
                            <span style="color: #fff;">Trend:</span>
                            <span style="color: #00ff41; font-weight: bold;">RISING 🔼</span>
                        </div>
                        <div style="font-size: 0.7em; color: #fff; margin-top: 5px;">+ Funding = Longi płacą Shortom</div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            function toggleTheTape() {
                const content = document.getElementById('the-tape-content');
                const icon = document.getElementById('tape-toggle-icon');
                
                if (!content || !icon) return;
                
                if (content.style.display === 'none' || content.style.display === '') {
                    content.style.display = 'block';
                    icon.style.transform = 'rotate(180deg)';
                    icon.style.animation = 'none';
                } else {
                    content.style.display = 'none';
                    icon.style.transform = 'rotate(0deg)';
                    icon.style.animation = 'arrowPulse 2s ease-in-out infinite';
                }
            }

            function toggleTimeframeZone() {
                const content = document.getElementById('timeframe-zone-content');
                const icon = document.getElementById('timeframe-toggle-icon');
                
                if (!content || !icon) return;
                
                if (content.style.display === 'none' || content.style.display === '') {
                    content.style.display = 'block';
                    icon.style.transform = 'rotate(180deg)';
                    icon.style.animation = 'none';
                } else {
                    content.style.display = 'none';
                    icon.style.transform = 'rotate(0deg)';
                    icon.style.animation = 'arrowPulse 2s ease-in-out infinite';
                }
            }
        </script>
            </div>
        </div>
        
        <!-- MARKET REGIME SECTION -->
        <div style="background: linear-gradient(135deg, #1a001a 0%, #0a0a0a 100%); border: 2px solid #ff00ff; border-radius: 8px; padding: 20px; margin-bottom: 15px; margin-top: 0px;">
            <div style="font-size: 1.2em; color: #ff00ff; margin-bottom: 10px; font-weight: 800; text-transform: uppercase;">🎯 MARKET REGIME</div>
            
            <!-- Wyckoff Theory Explanation -->
            <div style="background: rgba(255,0,255,0.1); padding: 10px; border-radius: 5px; border-left: 3px solid #ff00ff; margin-bottom: 15px;">
                <div style="font-size: 0.75em; color: #ff00ff; font-weight: 700; margin-bottom: 6px;">📚 TEORIA WYCKOFFA - 4 GŁÓWNE FAZY RYNKU:</div>
                <div style="font-size: 0.68em; line-height: 1.6; color: #ddd; display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                    <div>
                        <strong style="color: #00ff41;">1. ACCUMULATION (Akumulacja):</strong> Smart money kupuje po niskich cenach. Niska zmienność, brak zainteresowania publicznego. <strong>Spring</strong> = fałszywy breakout w dół, aby zebrać płynność przed wzrostem.
                    </div>
                    <div>
                        <strong style="color: #ffaa00;">2. MARKUP (Wzrost):</strong> Faza rosnących cen. Kupujący kontrolują rynek. Pojawia się zainteresowanie publiczne. Silne wolumeny przy wzrostach.
                    </div>
                    <div>
                        <strong style="color: #ff0033;">3. DISTRIBUTION (Dystrybucja):</strong> Smart money sprzedaje blisko szczytu. Wysoka zmienność, publika wchodzi na szczytach. <strong>UTAD</strong> = fałszywy breakout w górę przed spadkiem.
                    </div>
                    <div>
                        <strong style="color: #00d4ff;">4. MARKDOWN (Spadek):</strong> Faza spadających cen. Sprzedający kontrolują rynek. Publika w panice sprzedaje na dnie. Smart money przygotowuje się do nowej akumulacji.
                    </div>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; font-family: 'Roboto Mono', monospace;">
                <div style="background: rgba(0,255,65,0.1); padding: 14px; border-radius: 6px; border-left: 4px solid #00ff41;">
                    <div style="font-size: 0.75em; color: #fff; margin-bottom: 6px;">Phase:</div>
                    <div style="color: #00ff41; font-weight: 900; font-size: 1.15em; margin-bottom: 10px;">ACCUMULATION</div>
                    <div style="font-size: 0.7em; color: #ccc; line-height: 1.4; background: rgba(0,0,0,0.3); padding: 8px; border-radius: 3px;">Faza gdzie smart money gromadzi pozycje przed wzrostem. Cena niska, wolumen rosnący, brak publicznego zainteresowania.</div>
                </div>
                <div style="background: rgba(0,212,255,0.1); padding: 14px; border-radius: 6px; border-left: 4px solid #00d4ff;">
                    <div style="font-size: 0.75em; color: #fff; margin-bottom: 6px;">Wyckoff Method:</div>
                    <div style="color: #00d4ff; font-weight: 900; font-size: 1.15em; margin-bottom: 10px;">SPRING</div>
                    <div style="font-size: 0.7em; color: #ccc; line-height: 1.4; background: rgba(0,0,0,0.3); padding: 8px; border-radius: 3px;">Fałszywy breakout w dół aby zlikwidować stop losy drobnych traderów. Po Spring następuje wzrost.</div>
                </div>
                <div style="background: rgba(255,170,0,0.1); padding: 14px; border-radius: 6px; border-left: 4px solid #ffaa00;">
                    <div style="font-size: 0.75em; color: #fff; margin-bottom: 6px;">EQH (Equal High):</div>
                    <div style="color: #ffaa00; font-weight: 900; font-size: 1.15em; margin-bottom: 10px;">$97,583</div>
                    <div style="font-size: 0.7em; color: #ccc; line-height: 1.4; background: rgba(0,0,0,0.3); padding: 8px; border-radius: 3px;">Opór na wysokości poprzedniego szczytu. Jeśli przebite → potencjalny wzrost do nowych ALL TIME HIGH.</div>
                </div>
                <div style="background: rgba(255,170,0,0.1); padding: 14px; border-radius: 6px; border-left: 4px solid #ffaa00;">
                    <div style="font-size: 0.75em; color: #fff; margin-bottom: 6px;">EQL (Equal Low):</div>
                    <div style="color: #ffaa00; font-weight: 900; font-size: 1.15em; margin-bottom: 10px;">$94,800</div>
                    <div style="font-size: 0.7em; color: #ccc; line-height: 1.4; background: rgba(0,0,0,0.3); padding: 8px; border-radius: 3px;">Wsparcie na wysokości poprzedniego dołka. Jeśli przebite w dół → ryzyko dalszego spadku do nowych minimów.</div>
                </div>
                <div style="background: rgba(0,255,65,0.1); padding: 14px; border-radius: 6px; border-left: 4px solid #00ff41;">
                    <div style="font-size: 0.75em; color: #fff; margin-bottom: 6px;">Trend:</div>
                    <div style="color: #00ff41; font-weight: 900; font-size: 1.15em; margin-bottom: 10px;">📈 BULLISH</div>
                    <div style="font-size: 0.7em; color: #ccc; line-height: 1.4; background: rgba(0,0,0,0.3); padding: 8px; border-radius: 3px;">Rosnące szczyty i doliny. Kupujący są w kontroli. Scenariusz sprzyjający LONG pozycjom.</div>
                </div>
            </div>
        </div>

        <!-- LIQUIDITY GRAB ZONES & SMART MONEY CONCEPTS -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; margin-top: 0px;">
            
            <!-- Left: Liquidity Grab Information -->
            <div style="background: linear-gradient(135deg, #1a0a00 0%, #0a0a0a 100%); padding: 15px; border-radius: 8px; border: 2px solid #ffaa00; box-shadow: 0 0 20px rgba(255,170,0,0.2);">
                <div style="font-size: 0.95em; color: #ffaa00; margin-bottom: 12px; font-weight: 700; text-transform: uppercase; display: flex; align-items: center; gap: 8px;">
                    ⚡ LIQUIDITY GRAB ZONES
                    <span style="font-size: 0.65em; background: rgba(255,170,0,0.2); padding: 2px 6px; border-radius: 3px;">LIVE</span>
                </div>
                
                <!-- Buy Zone -->
                <div style="background: rgba(0,255,65,0.1); padding: 12px; border-radius: 5px; border-left: 3px solid #00ff41; margin-bottom: 10px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <span style="color: #00ff41; font-weight: 700; font-size: 0.85em;">🟢 BUY LIQUIDITY ZONE</span>
                        <span style="background: rgba(0,255,65,0.2); color: #00ff41; padding: 3px 8px; border-radius: 3px; font-size: 0.7em; font-weight: 700;">ACTIVE</span>
                    </div>
                    <div style="font-size: 0.75em; line-height: 1.8; color: #ccc;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 3px;">
                            <span>Entry Zone:</span>
                            <span style="color: #00ff41; font-weight: 700;">$94,800 - $95,100</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 3px;">
                            <span>Stop Loss:</span>
                            <span style="color: #ff0033; font-weight: 700;">$94,500</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>Take Profit:</span>
                            <span style="color: #00d4ff; font-weight: 700;">$96,300+</span>
                        </div>
                    </div>
                    <div style="margin-top: 8px; padding: 8px; background: rgba(0,20,0,0.5); border-radius: 3px; font-size: 0.7em; color: #00ff41; border: 1px solid rgba(0,255,65,0.3);">
                        💡 <strong>DLACZEGO:</strong> Cena zbiera płynność poniżej swing low, a następnie może wystąpić silne odbicie. Smart Money wykorzystuje stop lossy traderów jako płynność dla swoich pozycji LONG.
                    </div>
                </div>
                
                <!-- Sell Zone -->
                <div style="background: rgba(255,0,51,0.1); padding: 12px; border-radius: 5px; border-left: 3px solid #ff0033;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <span style="color: #ff0033; font-weight: 700; font-size: 0.85em;">🔴 SELL LIQUIDITY ZONE</span>
                        <span style="background: rgba(255,0,51,0.2); color: #ff0033; padding: 3px 8px; border-radius: 3px; font-size: 0.7em; font-weight: 700;">WATCH</span>
                    </div>
                    <div style="font-size: 0.75em; line-height: 1.8; color: #ccc;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 3px;">
                            <span>Entry Zone:</span>
                            <span style="color: #ff0033; font-weight: 700;">$96,000 - $96,300</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 3px;">
                            <span>Stop Loss:</span>
                            <span style="color: #ff0033; font-weight: 700;">$96,600</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>Take Profit:</span>
                            <span style="color: #00d4ff; font-weight: 700;">$94,800-</span>
                        </div>
                    </div>
                    <div style="margin-top: 8px; padding: 8px; background: rgba(20,0,0,0.5); border-radius: 3px; font-size: 0.7em; color: #ff0033; border: 1px solid rgba(255,0,51,0.3);">
                        💡 <strong>DLACZEGO:</strong> Cena swęepuje płynność powyżej swing high (stop lossy SHORT). Smart Money używa tego jako punktu wejścia dla pozycji SHORT, spodziewając się spadku.
                    </div>
                </div>
            </div>
            
            <!-- Right: Smart Money Concepts -->
            <div style="background: linear-gradient(135deg, #001a1a 0%, #0a0a0a 100%); padding: 15px; border-radius: 8px; border: 2px solid #00d4ff; box-shadow: 0 0 20px rgba(0,212,255,0.2);">
                <div style="font-size: 0.95em; color: #00d4ff; margin-bottom: 12px; font-weight: 700; text-transform: uppercase; display: flex; align-items: center; gap: 8px;">
                    🧠 SMART MONEY CONCEPTS (SMC)
                    <span style="font-size: 0.65em; background: rgba(0,212,255,0.2); padding: 2px 6px; border-radius: 3px;">PRO</span>
                </div>
                
                <!-- Order Blocks -->
                <div style="background: rgba(0,212,255,0.08); padding: 10px; border-radius: 5px; margin-bottom: 10px; border-left: 2px solid #00d4ff;">
                    <div style="color: #00d4ff; font-weight: 700; font-size: 0.8em; margin-bottom: 6px;">📊 ORDER BLOCKS (OB):</div>
                    <div style="font-size: 0.7em; line-height: 1.7; color: #ccc;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 3px;">
                            <span>• Bullish OB:</span>
                            <span style="color: #00ff41; font-weight: 700;">$94,800 - $95,100</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>• Bearish OB:</span>
                            <span style="color: #ff0033; font-weight: 700;">$96,800 - $97,200</span>
                        </div>
                        <div style="margin-top: 5px; font-size: 0.65em; color: #fff; font-style: italic;">
                            Ostatnia strefa gdzie banki/wieloryby złożyły zlecenia. Często cena wraca do OB przed kontynuacją trendu.
                        </div>
                    </div>
                </div>
                
                <!-- Fair Value Gaps -->
                <div style="background: rgba(187,134,252,0.08); padding: 10px; border-radius: 5px; margin-bottom: 10px; border-left: 2px solid #bb86fc;">
                    <div style="color: #bb86fc; font-weight: 700; font-size: 0.8em; margin-bottom: 6px;">🕳️ FAIR VALUE GAPS (FVG):</div>
                    <div style="font-size: 0.7em; line-height: 1.7; color: #ccc;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 3px;">
                            <span>• Bullish FVG:</span>
                            <span style="color: #00ff41; font-weight: 700;">$95,200 - $95,450</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>• Bearish FVG:</span>
                            <span style="color: #ff0033; font-weight: 700;">$96,400 - $96,650</span>
                        </div>
                        <div style="margin-top: 5px; font-size: 0.65em; color: #fff; font-style: italic;">
                            Luki cenowe powstałe przez silny ruch. Cena często wraca aby "wypełnić" te luki zanim kontynuuje.
                        </div>
                    </div>
                </div>
                
                <!-- Break of Structure -->
                <div style="background: rgba(255,170,0,0.08); padding: 10px; border-radius: 5px; border-left: 2px solid #ffaa00;">
                    <div style="color: #ffaa00; font-weight: 700; font-size: 0.8em; margin-bottom: 6px;">🔄 BREAK OF STRUCTURE (BOS):</div>
                    <div style="font-size: 0.7em; line-height: 1.7; color: #ccc;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>Ostatni BOS:</span>
                            <span style="color: #00ff41; font-weight: 700;">BULLISH ↑ $95,800</span>
                        </div>
                        <div style="margin-top: 5px; font-size: 0.65em; color: #fff; font-style: italic;">
                            Przełamanie poprzedniego High/Low = zmiana struktury rynku. BOS potwierdza kierunek Smart Money.
                        </div>
                    </div>
                </div>
                
                <!-- SMC Strategy Tip -->
                <div style="margin-top: 10px; padding: 10px; background: linear-gradient(135deg, rgba(0,212,255,0.15) 0%, rgba(0,255,65,0.1) 100%); border-radius: 5px; border: 1px solid rgba(0,212,255,0.3);">
                    <div style="font-size: 0.7em; color: #00d4ff; font-weight: 700; margin-bottom: 4px;">✨ STRATEGIA SMC:</div>
                    <div style="font-size: 0.65em; line-height: 1.6; color: #ccc;">
                        1. Czekaj na Liquidity Grab (sweep)<br>
                        2. Sprawdż BOS w przeciwnym kierunku<br>
                        3. Wejdź w Order Block + FVG<br>
                        4. Target: przeciwny OB lub FVG
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ENTRY CONFIRMATION CHECKLIST (Below Chart) -->
        <div style="background: linear-gradient(135deg, #1a001a 0%, #0f0f0f 100%); padding: 15px; border-radius: 8px; border: 1px solid #00ffff; border-left: 3px solid #00d4ff; margin-bottom: 15px;">
            <div style="font-size: 0.9em; color: #00d4ff; margin-bottom: 12px; font-weight: 700; text-transform: uppercase;">🎯 ENTRY CONFIRMATION CHECKLIST:</div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 10px; font-size: 0.75em;">
                <!-- MACD ZL Cross -->
                <div style="background: rgba(0,255,65,0.1); padding: 10px; border-radius: 5px; border-left: 2px solid #00ff41;">
                    <div style="color: #00ff41; font-weight: 700; margin-bottom: 5px;">✓ MACD</div>
                    <div style="color: #ccc;">ABOVE 0-line</div>
                    <div style="font-size: 0.7em; color: #fff; margin-top: 3px;">Momentum BULLISH</div>
                </div>
                
                <!-- Volume Confirmation -->
                <div style="background: rgba(0,212,255,0.1); padding: 10px; border-radius: 5px; border-left: 2px solid #00d4ff;">
                    <div style="color: #00d4ff; font-weight: 700; margin-bottom: 5px;">⚡ VOLUME</div>
                    <div style="color: #ccc;">ABOVE 20MA</div>
                    <div style="font-size: 0.7em; color: #fff; margin-top: 3px;">Strong move incoming</div>
                </div>
                
                <!-- Divergence Status -->
                <div style="background: rgba(255,170,0,0.1); padding: 10px; border-radius: 5px; border-left: 2px solid #ffaa00;">
                    <div style="color: #ffaa00; font-weight: 700; margin-bottom: 5px;">⚠ DIV CHECK</div>
                    <div style="color: #ccc;">NO RSI/Price DIV</div>
                    <div style="font-size: 0.7em; color: #fff; margin-top: 3px;">Trend confirmed</div>
                </div>
                
                <!-- S/R Confluence -->
                <div style="background: rgba(255,0,51,0.1); padding: 10px; border-radius: 5px; border-left: 2px solid #ff0033;">
                    <div style="color: #ff0033; font-weight: 700; margin-bottom: 5px;">📍 S/R HIT</div>
                    <div style="color: #ccc;">RSI 50 + Price</div>
                    <div style="font-size: 0.7em; color: #fff; margin-top: 3px;">Strong entry point</div>
                </div>
            </div>
            
            <div style="margin-top: 10px; padding: 8px; background: rgba(0,255,65,0.15); border-radius: 5px; text-align: center;">
                <span style="color: #00ff41; font-weight: 700; font-size: 0.8em;">✅ 4/4 CONFIRMED = BUY SIGNAL ACTIVE</span>
            </div>
        </div>
        
        <div class="news-panel" style="border-color:#ff00ff; background: linear-gradient(135deg, #1a001a 0%, #0a0a0a 100%); display: none;">
            <div class="news-header">
                <h3>📡 HIDDEN OLD CONTENT</h3>
            </div>

            <!-- TOP TIER: ORDER BOOK + SOCIAL + LIQUIDATIONS -->
            <div style="padding: 10px; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px;">
                <!-- ORDER BOOK IMBALANCE -->
                <div style="background: linear-gradient(135deg, #0a1a0f 0%, #0a0a0a 100%); padding: 8px; border-radius: 5px; border-left: 3px solid #00ff41;">
                    <div style="font-size: 0.7em; color: #00ff41; margin-bottom: 4px; font-weight: 700;">📖 ORDER BOOK IMBALANCE:</div>
                    <div style="font-size: 0.65em; line-height: 1.4; font-family: 'Roboto Mono';">
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">BID Depth:</span>
                            <span style="color: #00ff41;">$245M (2%)</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">ASK Depth:</span>
                            <span style="color: #ff0033;">$182M (2%)</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0; padding-top: 3px; border-top: 1px solid #333;">
                            <span style="color: #00ff41; font-weight: 700;">Ratio:</span>
                            <span style="color: #00ff41; font-weight: bold;">1.35:1 🔼</span>
                        </div>
                    </div>
                </div>

                <!-- SOCIAL SENTIMENT -->
                <div style="background: linear-gradient(135deg, #1a0a1a 0%, #0a0a0a 100%); padding: 8px; border-radius: 5px; border-left: 3px solid #ff00ff;">
                    <div style="font-size: 0.7em; color: #ff00ff; margin-bottom: 4px; font-weight: 700;">💬 SOCIAL SENTIMENT:</div>
                    <div style="font-size: 0.65em; line-height: 1.4; font-family: 'Roboto Mono';">
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Twitter Vol:</span>
                            <span style="color: #ffaa00;">+145K ✍️</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Sentiment:</span>
                            <span style="color: #00ff41; font-weight: bold;">72/100 🟢</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0; padding-top: 3px; border-top: 1px solid #333;">
                            <span style="color: #ff00ff; font-weight: 700;">Whale Alert:</span>
                            <span style="color: #ff00ff;">12 Txs 🐋</span>
                        </div>
                    </div>
                </div>

                <!-- LIQUIDATION CLUSTERS -->
                <div style="background: linear-gradient(135deg, #1a0a00 0%, #0a0a0a 100%); padding: 8px; border-radius: 5px; border-left: 3px solid #ff6600;">
                    <div style="font-size: 0.7em; color: #ff6600; margin-bottom: 4px; font-weight: 700;">💥 LIQUIDATION CLUSTERS:</div>
                    <div style="font-size: 0.65em; line-height: 1.4; font-family: 'Roboto Mono';">
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #ff0033;">⬆️ >$97.4k:</span>
                            <span style="color: #ff0033;">$145M Shorts</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #00ff41;">⬇️ <$94.8k:</span>
                            <span style="color: #00ff41;">$220M Longs</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0; padding-top: 3px; border-top: 1px solid #333;">
                            <span style="color: #ffaa00; font-weight: 700;">Zone:</span>
                            <span style="color: #ffaa00;">⚖️ BALANCED</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MID TIER: STRUCTURE + NETWORK + DERIVATIVES -->
            <div style="padding: 10px; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-top: 5px;">
                <!-- MARKET STRUCTURE -->
                <div style="background: linear-gradient(135deg, #0a1a1a 0%, #0a0a0a 100%); padding: 8px; border-radius: 5px; border-left: 3px solid #00d4ff;">
                    <div style="font-size: 0.7em; color: #00d4ff; margin-bottom: 4px; font-weight: 700;">🏗️ MARKET STRUCTURE:</div>
                    <div style="font-size: 0.65em; line-height: 1.4; font-family: 'Roboto Mono';">
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Last BOS:</span>
                            <span style="color: #00ff41;">$96,800 🔼</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">CHoCH:</span>
                            <span style="color: #ffaa00;">PENDING ⏳</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0; padding-top: 3px; border-top: 1px solid #333;">
                            <span style="color: #00d4ff; font-weight: 700;">Trend:</span>
                            <span style="color: #00d4ff;">HH/HL ⬆️</span>
                        </div>
                    </div>
                </div>

                <!-- NETWORK HEALTH -->
                <div style="background: linear-gradient(135deg, #0a0a1a 0%, #0a0a0a 100%); padding: 8px; border-radius: 5px; border-left: 3px solid #0096ff;">
                    <div style="font-size: 0.7em; color: #0096ff; margin-bottom: 4px; font-weight: 700;">⛏️ NETWORK HEALTH:</div>
                    <div style="font-size: 0.65em; line-height: 1.4; font-family: 'Roboto Mono';">
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Hashrate:</span>
                            <span style="color: #0096ff;">425 EH/s 🔼</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Difficulty:</span>
                            <span style="color: #0096ff;">68.5T 🔼</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0; padding-top: 3px; border-top: 1px solid #333;">
                            <span style="color: #0096ff; font-weight: 700;">Tx Vol (24h):</span>
                            <span style="color: #0096ff;">$42.5B ✅</span>
                        </div>
                    </div>
                </div>

                <!-- DERIVATIVES PREMIUM -->
                <div style="background: linear-gradient(135deg, #1a1a0a 0%, #0a0a0a 100%); padding: 8px; border-radius: 5px; border-left: 3px solid #ffff00;">
                    <div style="font-size: 0.7em; color: #ffff00; margin-bottom: 4px; font-weight: 700;">📊 DERIVATIVES PREMIUM:</div>
                    <div style="font-size: 0.65em; line-height: 1.4; font-family: 'Roboto Mono';">
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Futures:</span>
                            <span style="color: #ffff00;">+$45 🔼</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                            <span style="color: #fff;">Perp:</span>
                            <span style="color: #ffff00;">+$32 🔼</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 2px 0; padding-top: 3px; border-top: 1px solid #333;">
                            <span style="color: #ffff00; font-weight: 700;">Basis (Ann):</span>
                            <span style="color: #ffff00; font-weight: bold;">+12.5% ✅</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BOTTOM TIER: KEY LEVELS + FLOWS + VOLATILITY -->
            <div style="padding: 10px; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-top: 5px;">
                <!-- Market Regime -->
                <div style="background: #0f0f0f; padding: 8px; border-radius: 5px; border-left: 3px solid #ff00ff;">
                    <div style="font-size: 0.7em; color: #fff; margin-bottom: 3px;">MARKET REGIME:</div>
                    <div style="font-size: 0.85em; color: #ff00ff; font-weight: 700;">ACCUMULATION / SPRING</div>
                </div>
                
                <!-- Key Levels -->
                <div style="background: #0f0f0f; padding: 8px; border-radius: 5px; font-family: 'Roboto Mono', monospace;">
                    <div style="font-size: 0.7em; color: #00ffff; margin-bottom: 4px; font-weight: 700;">📊 KEY LEVELS:</div>
                    <div style="font-size: 0.7em; line-height: 1.5;">
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #ffaa00;">EQH:</span>
                            <span style="color: #fff; font-weight: bold;">$97,583</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #ffaa00;">EQL:</span>
                            <span style="color: #fff; font-weight: bold;">$94,800</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #00ff00;">RNG:</span>
                            <span style="color: #00ff00; font-weight: bold;">$2,783</span>
                        </div>
                    </div>
                </div>
                
                <!-- Exchange Flow -->
                <div style="background: linear-gradient(135deg, #001a0a 0%, #0a0a0a 100%); padding: 8px; border-radius: 5px; border-left: 3px solid #00ff41;">
                    <div style="font-size: 0.7em; color: #00ff41; margin-bottom: 4px; font-weight: 700;">🔄 EXCHANGE FLOW:</div>
                    <div style="font-size: 0.7em; line-height: 1.5;">
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #fff;">IN:</span>
                            <span style="color: #ff0033; font-weight: bold;">-4,250 BTC</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #fff;">OUT:</span>
                            <span style="color: #00ff41; font-weight: bold;">+8,420 BTC</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #fff;">NET:</span>
                            <span style="color: #00ff41; font-weight: bold;">+4,170🔼</span>
                        </div>
                    </div>
                </div>
                
                <!-- Volatility & ATR -->
                <div style="background: linear-gradient(135deg, #1a0a00 0%, #0a0a0a 100%); padding: 8px; border-radius: 5px; border-left: 3px solid #ffaa00;">
                    <div style="font-size: 0.7em; color: #ffaa00; margin-bottom: 4px; font-weight: 700;">📈 VOLATILITY:</div>
                    <div style="font-size: 0.7em; line-height: 1.5;">
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #fff;">ATR(14):</span>
                            <span style="color: #ffaa00; font-weight: bold;">$1,245</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #fff;">RealVol:</span>
                            <span style="color: #ffaa00; font-weight: bold;">42.5%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #fff;">BW:</span>
                            <span style="color: #00d4ff; font-weight: bold;">2.8%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Killzones Compact -->
            <div style="padding: 8px 10px; background: linear-gradient(135deg, #0a0a0a 0%, #1a001a 100%); border-left: 3px solid #ff00ff; margin-top: 5px;">
                <div style="font-size: 0.75em; color: #ff00ff; margin-bottom: 8px; font-weight: 700;">🎯 KILL ZONES:</div>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 8px; font-size: 0.65em;">
                    <div style="background: rgba(255,170,0,0.15); padding: 6px; border-radius: 3px; border-left: 2px solid #ffaa00;">
                        <div style="color: #ffaa00; font-weight: 700; margin-bottom: 2px;">🇬🇧 LONDON</div>
                        <div style="color: #ccc;">07:00-09:00 UTC</div>
                        <div style="color: #fff; font-size: 0.6em; margin-top: 2px;">Volatility: HIGH | Swing trades</div>
                    </div>
                    
                    <div style="background: rgba(255,0,51,0.15); padding: 6px; border-radius: 3px; border-left: 2px solid #ff0033;">
                        <div style="color: #ff0033; font-weight: 700; margin-bottom: 2px;">🇺🇸 NY OPEN</div>
                        <div style="color: #ccc;">12:30-14:30 UTC</div>
                        <div style="color: #fff; font-size: 0.6em; margin-top: 2px;">Volatility: EXTREME | Scalps</div>
                    </div>
                    
                    <div style="background: rgba(255,100,0,0.15); padding: 6px; border-radius: 3px; border-left: 2px solid #ff6600;">
                        <div style="color: #ff6600; font-weight: 700; margin-bottom: 2px;">⚠️ LUNCH SLUMP</div>
                        <div style="color: #ccc;">16:30-17:30 UTC</div>
                        <div style="color: #fff; font-size: 0.6em; margin-top: 2px;">Volatility: LOW | AVOID</div>
                    </div>
                    
                    <div style="background: rgba(0,212,255,0.15); padding: 6px; border-radius: 3px; border-left: 2px solid #00d4ff;">
                        <div style="color: #00d4ff; font-weight: 700; margin-bottom: 2px;">⭐ GOLDEN WIN</div>
                        <div style="color: #ccc;">12:00-14:00 UTC</div>
                        <div style="color: #fff; font-size: 0.6em; margin-top: 2px;">MAX momentum + liquidity</div>
                    </div>
                </div>
            </div>
                
                <!-- Funding Rate Trends -->
                <div style="background: linear-gradient(135deg, #001a1a 0%, #0a0a0a 100%); padding: 8px 10px; border-radius: 5px; margin-top: 5px; border-left: 3px solid #00d4ff;">
                    <div style="font-size: 0.75em; color: #00d4ff; margin-bottom: 6px; font-weight: 700;">💰 FUNDING RATE:</div>
                    <div style="font-size: 0.7em; line-height: 1.5; display: flex; gap: 15px;">
                        <div style="display: flex; justify-content: space-between; flex: 1;">
                            <span style="color: #fff;">Now:</span>
                            <span style="color: #00ff41; font-weight: bold;">+0.0082%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; flex: 1;">
                            <span style="color: #fff;">8h Avg:</span>
                            <span style="color: #00ff41; font-weight: bold;">+0.0065%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; flex: 1;">
                            <span style="color: #fff;">Trend:</span>
                            <span style="color: #00ff41; font-weight: bold;">RISING 🔼</span>
                        </div>
                        <div style="font-size: 0.7em; color: #fff; margin-top: 5px;">+ Funding = Longi płacą Shortom</div>
                    </div>
                </div>
                
                <!-- Order Book Imbalance -->
                <div style="background: linear-gradient(135deg, #0a001a 0%, #0a0a0a 100%); padding: 10px; border-radius: 5px; margin-bottom: 10px; border-left: 3px solid #ff00ff;">
                    <div style="font-size: 0.75em; color: #ff00ff; margin-bottom: 8px; font-weight: 700;">📖 ORDER BOOK IMBALANCE:</div>
                    <div style="font-size: 0.8em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">BID Depth:</span>
                            <span style="color: #00ff41; font-weight: bold;">$245M (2%)</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">ASK Depth:</span>
                            <span style="color: #ff0033; font-weight: bold;">$182M (2%)</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Ratio:</span>
                            <span style="color: #00ff41; font-weight: bold;">1.35:1 (BUY PRESSURE)</span>
                        </div>
                    </div>
                </div>
                
                <!-- Social Sentiment -->
                <div style="background: linear-gradient(135deg, #1a1a00 0%, #0a0a0a 100%); padding: 10px; border-radius: 5px; margin-bottom: 10px; border-left: 3px solid #ffff00;">
                    <div style="font-size: 0.75em; color: #ffff00; margin-bottom: 8px; font-weight: 700;">💬 SOCIAL SENTIMENT:</div>
                    <div style="font-size: 0.8em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Twitter Volume:</span>
                            <span style="color: #00d4ff; font-weight: bold;">+145K mentions</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Sentiment Score:</span>
                            <span style="color: #00ff41; font-weight: bold;">72/100 (BULLISH)</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Whale Alert:</span>
                            <span style="color: #ff00ff; font-weight: bold;">12 Large Txs</span>
                        </div>
                    </div>
                </div>
                
                <!-- Liquidation Heatmap -->
                <div style="background: linear-gradient(135deg, #1a0000 0%, #0a0a0a 100%); padding: 10px; border-radius: 5px; margin-bottom: 10px; border-left: 3px solid #ff0033;">
                    <div style="font-size: 0.75em; color: #ff0033; margin-bottom: 8px; font-weight: 700;">💥 LIQUIDATION CLUSTERS:</div>
                    <div style="font-size: 0.8em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Above $97.4k:</span>
                            <span style="color: #ff0033; font-weight: bold;">$145M Shorts</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Below $94.8k:</span>
                            <span style="color: #00ff41; font-weight: bold;">$220M Longs</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Risk Zone:</span>
                            <span style="color: #ffaa00; font-weight: bold;">BALANCED</span>
                        </div>
                    </div>
                </div>
                
                <!-- Market Microstructure -->
                <div style="background: linear-gradient(135deg, #001a0a 0%, #0a0a0a 100%); padding: 10px; border-radius: 5px; margin-bottom: 10px; border-left: 3px solid #00ffff;">
                    <div style="font-size: 0.75em; color: #00ffff; margin-bottom: 8px; font-weight: 700;">🏗️ MARKET STRUCTURE:</div>
                    <div style="font-size: 0.8em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Last BOS:</span>
                            <span style="color: #00ff41; font-weight: bold;">$96,800 (BULL)</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">CHoCH Status:</span>
                            <span style="color: #ffaa00; font-weight: bold;">PENDING</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Structure:</span>
                            <span style="color: #00ff41; font-weight: bold;">HH/HL (UPTREND)</span>
                        </div>
                        <div style="font-size: 0.7em; color: #fff; margin-top: 5px;">BOS = Break of Structure, CHoCH = Change of Character</div>
                    </div>
                </div>
                
                <!-- Network Metrics -->
                <div style="background: linear-gradient(135deg, #0a0a1a 0%, #0a0a0a 100%); padding: 10px; border-radius: 5px; margin-bottom: 10px; border-left: 3px solid #9900ff;">
                    <div style="font-size: 0.75em; color: #9900ff; margin-bottom: 8px; font-weight: 700;">⛏️ NETWORK HEALTH:</div>
                    <div style="font-size: 0.8em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Hashrate:</span>
                            <span style="color: #00ff41; font-weight: bold;">425 EH/s (+2.4%)</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Difficulty:</span>
                            <span style="color: #00d4ff; font-weight: bold;">68.5T (+1.8%)</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Tx Volume:</span>
                            <span style="color: #ffaa00; font-weight: bold;">$42.5B (24h)</span>
                        </div>
                        <div style="font-size: 0.7em; color: #fff; margin-top: 5px;">Silny hashrate = bezpieczna sieć</div>
                    </div>
                </div>
                
                <!-- Derivatives Premium -->
                <div style="background: linear-gradient(135deg, #1a0a00 0%, #0a0a0a 100%); padding: 10px; border-radius: 5px; margin-bottom: 10px; border-left: 3px solid #ff6600;">
                    <div style="font-size: 0.75em; color: #ff6600; margin-bottom: 8px; font-weight: 700;">📊 DERIVATIVES PREMIUM:</div>
                    <div style="font-size: 0.8em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Futures Premium:</span>
                            <span style="color: #00ff41; font-weight: bold;">+$45 (+0.047%)</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Perp Premium:</span>
                            <span style="color: #00ff41; font-weight: bold;">+$32 (+0.033%)</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                            <span style="color: #fff;">Basis (Ann.):</span>
                            <span style="color: #00ff41; font-weight: bold;">+12.5% (HEALTHY)</span>
                        </div>
                        <div style="font-size: 0.7em; color: #fff; margin-top: 5px;">+ Premium = rynek płaci za exposure</div>
                    </div>
                </div>
                
                <div style="margin-top: 12px; font-size: 0.7em; color: #fff; text-align: center;">
                    Powered by Bloomberg AI Engine • Real-time market analysis
                </div>
            </div>
        </div>
        
        <!-- CVD SPOT & FUTURES - UNIFIED PANEL - MAIN FOCUS -->
        <div class="cvd-panel" style="border-color: #00d4ff; background: linear-gradient(135deg, #001a2a 0%, #0a0a15 100%); padding: 20px; border: 3px solid #00d4ff; border-radius: 10px; box-shadow: 0 0 40px rgba(0,212,255,0.6), inset 0 0 30px rgba(0,212,255,0.15), 0 0 60px rgba(0,100,200,0.3); position: relative; z-index: 10;">
            <div style="font-size: 1.2em; color: #00ffff; margin-bottom: 15px; font-weight: 900; text-transform: uppercase; border-bottom: 3px solid #00ffff; padding-bottom: 12px; text-shadow: 0 0 15px rgba(0,212,255,0.8), 0 0 30px rgba(0,100,200,0.5); letter-spacing: 2px;">
                ⚡ CVD ANALYSIS (Cumulative Delta) ⚡
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr; gap: 15px;">
                <!-- CVD SPOT -->
                <div style="background: rgba(0,255,65,0.12); padding: 15px; border-radius: 8px; border: 2px solid #00ff41; box-shadow: 0 0 20px rgba(0,255,65,0.3), inset 0 0 15px rgba(0,255,65,0.1);">
                    <div class="cvd-header" style="color: #00ff41; border-color: #00ff41; margin-bottom: 12px; font-size: 1.1em; text-shadow: 0 0 10px rgba(0,255,65,0.6);">📊 CVD SPOT</div>
                    <div class="cvd-value positive" style="font-size: 1.8em; margin-bottom: 10px; color: #00ff41; text-shadow: 0 0 15px rgba(0,255,65,0.5);">+42,850 BTC</div>
                    <div class="cvd-bar" style="margin-bottom: 12px;">
                        <div class="cvd-buy" style="width: 68%;">BUY 68%</div>
                        <div class="cvd-sell" style="width: 32%;">SELL 32%</div>
                    </div>
                    <div class="cvd-stats" style="grid-template-columns: 1fr 1fr; gap: 8px;">
                        <div class="cvd-stat-item">
                            <div class="cvd-stat-label">Buy Volume</div>
                            <div class="cvd-stat-value">1,245M USDT</div>
                        </div>
                        <div class="cvd-stat-item">
                            <div class="cvd-stat-label">Sell Volume</div>
                            <div class="cvd-stat-value">586M USDT</div>
                        </div>
                        <div class="cvd-stat-item">
                            <div class="cvd-stat-label">Volume Ratio</div>
                            <div class="cvd-stat-value">2.12:1 BULL</div>
                        </div>
                        <div class="cvd-stat-item">
                            <div class="cvd-stat-label">Trend</div>
                            <div class="cvd-stat-value" style="color: #00ff41;">BULLISH ↗</div>
                        </div>
                    </div>
                </div>
                
                <!-- CVD FUTURES -->
                <div style="background: rgba(255,0,255,0.12); padding: 15px; border-radius: 8px; border: 2px solid #ff00ff; box-shadow: 0 0 20px rgba(255,0,255,0.3), inset 0 0 15px rgba(255,0,255,0.1);">
                    <div class="cvd-header" style="color: #ff00ff; border-color: #ff00ff; margin-bottom: 12px; font-size: 1.1em; text-shadow: 0 0 10px rgba(255,0,255,0.6);">⚡ CVD FUTURES</div>
                    <div class="cvd-value negative" style="font-size: 1.8em; margin-bottom: 10px; color: #ff00ff; text-shadow: 0 0 15px rgba(255,0,255,0.5);">-18,420 BTC</div>
                    <div class="cvd-bar" style="margin-bottom: 12px;">
                        <div class="cvd-buy" style="width: 35%;">BUY 35%</div>
                        <div class="cvd-sell" style="width: 65%;">SELL 65%</div>
                    </div>
                    <div class="cvd-stats" style="grid-template-columns: 1fr 1fr; gap: 8px;">
                        <div class="cvd-stat-item">
                            <div class="cvd-stat-label">Buy Volume</div>
                            <div class="cvd-stat-value">832M USDT</div>
                        </div>
                        <div class="cvd-stat-item">
                            <div class="cvd-stat-label">Sell Volume</div>
                            <div class="cvd-stat-value">1,562M USDT</div>
                        </div>
                        <div class="cvd-stat-item">
                            <div class="cvd-stat-label">Volume Ratio</div>
                            <div class="cvd-stat-value">0.53:1 BEAR</div>
                        </div>
                        <div class="cvd-stat-item">
                            <div class="cvd-stat-label">Trend</div>
                            <div class="cvd-stat-value" style="color: #ff0033;">BEARISH ↘</div>
                        </div>
                    </div>
                </div>
                
                <!-- CVD ADDITIONAL FUNCTIONS -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                    <!-- ACCUMULATION ZONES -->
                    <div style="background: rgba(0,170,255,0.12); padding: 12px; border-radius: 8px; border: 2px solid #00aaff; box-shadow: 0 0 15px rgba(0,170,255,0.25);">
                        <div style="color: #00aaff; font-weight: 700; font-size: 0.9em; margin-bottom: 8px; text-transform: uppercase;">📦 ACCUMULATION ZONES</div>
                        <div style="font-size: 0.8em; color: #ddd; line-height: 1.6;">
                            <div style="padding: 6px; background: rgba(0,255,65,0.1); margin-bottom: 6px; border-left: 3px solid #00ff41;">
                                <span style="color: #00ff41; font-weight: 700;">STRONG:</span> $96,200-$96,850 📈
                            </div>
                            <div style="padding: 6px; background: rgba(255,170,0,0.1); margin-bottom: 6px; border-left: 3px solid #ffaa00;">
                                <span style="color: #ffaa00; font-weight: 700;">MEDIUM:</span> $95,500-$96,200 ➡️
                            </div>
                            <div style="padding: 6px; background: rgba(0,170,255,0.1); border-left: 3px solid #00aaff;">
                                <span style="color: #00aaff; font-weight: 700;">WEAK:</span> $94,800-$95,500 📉
                            </div>
                        </div>
                    </div>
                    
                    <!-- DIVERGENCE DETECTOR -->
                    <div style="background: rgba(255,100,0,0.12); padding: 12px; border-radius: 8px; border: 2px solid #ff6400; box-shadow: 0 0 15px rgba(255,100,0,0.25);">
                        <div style="color: #ff6400; font-weight: 700; font-size: 0.9em; margin-bottom: 8px; text-transform: uppercase;">⚠️ DIVERGENCE CHECK</div>
                        <div style="font-size: 0.8em; color: #ddd; line-height: 1.6;">
                            <div style="padding: 6px; background: rgba(0,255,65,0.1); margin-bottom: 6px; border-left: 3px solid #00ff41;">
                                <span style="color: #00ff41; font-weight: 700;">CVD:</span> RISING ✓
                            </div>
                            <div style="padding: 6px; background: rgba(255,170,0,0.1); margin-bottom: 6px; border-left: 3px solid #ffaa00;">
                                <span style="color: #ffaa00; font-weight: 700;">PRICE:</span> RANGE ➡️
                            </div>
                            <div style="padding: 6px; background: rgba(0,255,65,0.1); border-left: 3px solid #00ff41;">
                                <span style="color: #00ff41; font-weight: 700;">STATUS:</span> BULLISH DIV ↗
                            </div>
                        </div>
                    </div>
                    
                    <!-- LIQUIDATION PRESSURE -->
                    <div style="background: rgba(255,0,100,0.12); padding: 12px; border-radius: 8px; border: 2px solid #ff0064; box-shadow: 0 0 15px rgba(255,0,100,0.25);">
                        <div style="color: #ff0064; font-weight: 700; font-size: 0.9em; margin-bottom: 8px; text-transform: uppercase;">💥 LIQUIDATION ZONES</div>
                        <div style="font-size: 0.8em; color: #ddd; line-height: 1.6;">
                            <div style="padding: 6px; background: rgba(255,0,51,0.1); margin-bottom: 6px; border-left: 3px solid #ff0033;">
                                <span style="color: #ff0033; font-weight: 700;">SHORTS:</span> $98,200+ 🎯
                            </div>
                            <div style="padding: 6px; background: rgba(0,255,65,0.1); margin-bottom: 6px; border-left: 3px solid #00ff41;">
                                <span style="color: #00ff41; font-weight: 700;">LONGS:</span> $93,800- 🎯
                            </div>
                            <div style="padding: 6px; background: rgba(255,170,0,0.1); border-left: 3px solid #ffaa00;">
                                <span style="color: #ffaa00; font-weight: 700;">LEVEL:</span> $97,500 CRITICAL
                            </div>
                        </div>
                    </div>
                    
                    <!-- CVD MOMENTUM -->
                    <div style="background: rgba(100,0,255,0.12); padding: 12px; border-radius: 8px; border: 2px solid #6400ff; box-shadow: 0 0 15px rgba(100,0,255,0.25);">
                        <div style="color: #6400ff; font-weight: 700; font-size: 0.9em; margin-bottom: 8px; text-transform: uppercase;">🚀 CVD MOMENTUM</div>
                        <div style="font-size: 0.8em; color: #ddd; line-height: 1.6;">
                            <div style="padding: 6px; background: rgba(0,255,65,0.1); margin-bottom: 6px; border-left: 3px solid #00ff41;">
                                <span style="color: #00ff41; font-weight: 700;">SPOT MOM:</span> +2,840 🔥
                            </div>
                            <div style="padding: 6px; background: rgba(255,0,51,0.1); margin-bottom: 6px; border-left: 3px solid #ff0033;">
                                <span style="color: #ff0033; font-weight: 700;">FUTURES MOM:</span> -1,240 ❄️
                            </div>
                            <div style="padding: 6px; background: rgba(0,255,65,0.1); border-left: 3px solid #00ff41;">
                                <span style="color: #00ff41; font-weight: 700;">NET:</span> +1,600 BULLISH ↗
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="key-levels-panel" style="border-color: #00d4ff; background: linear-gradient(135deg, #001f1a 0%, #0a0a0a 100%);">
            <div style="font-size: 0.85em; color: #00d4ff; margin-bottom: 12px; font-weight: 700; text-transform: uppercase;">💡 CVD ANALIZA</div>
            <div style="font-size: 0.8em; line-height: 1.6; color: #ccc;">
                <div style="margin-bottom: 8px; padding: 8px; background: rgba(0,255,65,0.1); border-left: 3px solid #00ff41;">
                    <span style="color: #00ff41; font-weight: 700;">SPOT:</span> Silny napływ kupna (+42.8k). Duże inwestycje instytucjonalne.
                </div>
                <div style="margin-bottom: 8px; padding: 8px; background: rgba(255,0,51,0.1); border-left: 3px solid #ff0033;">
                    <span style="color: #ff0033; font-weight: 700;">FUTURES:</span> Dużo SHORT'ów (-18.4k). Traderzy przygotowują się na pullback.
                </div>
                <div style="padding: 8px; background: rgba(255,170,0,0.1); border-left: 3px solid #ffaa00;">
                    <span style="color: #ffaa00; font-weight: 700;">DIVERGENCJA:</span> Rozbieżność - BULLISH dla SPOT, BEARISH dla FUTURES = OKAZJA NA SCALP!
                </div>
            </div>
            
                <div style="margin-top: 10px; padding: 10px; background: rgba(255,170,0,0.12); border-left: 3px solid #ffaa00; color: #ffaa00; font-size: 0.95em; font-weight: 700; line-height: 1.7;">
                    ⚡ MARKET REALITY: Dominacja BULLS, ale BEARS kontrolują support levels. Stalemate = SCALP OPPORTUNITY!
                </div>
            </div>
                <div style="margin-top: 10px; padding: 10px; background: rgba(255,170,0,0.1); border-left: 3px solid #ffaa00; border-radius: 3px; font-size: 0.75em;">
                    <span style="color: #ffaa00; font-weight: 700;">⚡ MARKET REALITY:</span> Dominacja BULLS ale BEARS kontrolują support levels. Stalemate = SCALP OPPORTUNITY!
                </div>
            </div>
            
            <!-- Entry Zone Calculator -->
            <div style="margin-top: 15px; padding: 12px; background: linear-gradient(135deg, #001a1a 0%, #0f0f0f 100%); border-radius: 8px; border: 1px solid #00ffff; border-top: 3px solid #00ffff; margin-bottom: 15px;">
                <div style="font-size: 0.85em; color: #00ffff; margin-bottom: 10px; font-weight: 700; text-transform: uppercase; display: flex; align-items: center;">
                    📍 ENTRY ZONE CALCULATOR • DOPRECYZUJ WEJŚCIE
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <!-- Entry Level 1 (Aggressive) -->
                    <div style="background: rgba(255,0,51,0.1); padding: 10px; border-radius: 5px; border: 1px solid #ff0033;">
                        <div style="color: #ff0033; font-weight: 700; font-size: 0.8em; margin-bottom: 5px;">🔴 AGGRESSIVE ENTRY</div>
                        <div style="font-size: 1.2em; font-weight: 700; color: #ff6600; margin-bottom: 3px; font-family: 'Courier New', monospace;">$96,850</div>
                        <div style="font-size: 0.7em; color: #ccc; line-height: 1.3;">
                            • CVD SPOT mógł począć
                            • Wysokie ryzyko / wysoki zysk
                            • SL: $95,200 | TP: $99,500
                        </div>
                    </div>
                    
                    <!-- Entry Level 2 (Moderate) -->
                    <div style="background: rgba(0,255,65,0.15); padding: 10px; border-radius: 5px; border: 2px solid #00ff41;">
                        <div style="color: #00ff41; font-weight: 700; font-size: 0.8em; margin-bottom: 5px;">✓ MODERATE ENTRY</div>
                        <div style="font-size: 1.2em; font-weight: 700; color: #00ff41; margin-bottom: 3px; font-family: 'Courier New', monospace;">$95,400</div>
                        <div style="font-size: 0.7em; color: #ccc; line-height: 1.3;">
                            • Potwierdzony MACD ZL
                            • Zbalansowane ryzyko/zysk
                            • SL: $94,100 | TP: $98,200
                        </div>
                    </div>
                </div>
                
                <!-- Order Flow Insights -->
                <div style="margin-top: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div style="background: rgba(0,255,65,0.08); padding: 8px; border-radius: 5px; border-left: 3px solid #00ff41;">
                        <div style="font-size: 0.7em; color: #fff; margin-bottom: 3px;">💧 WHALE ACTIVITY:</div>
                        <div style="color: #00ff41; font-weight: 700; font-size: 0.85em;">ACCUMULATING</div>
                    </div>
                    <div style="background: rgba(255,170,0,0.08); padding: 8px; border-radius: 5px; border-left: 3px solid #ffaa00;">
                        <div style="font-size: 0.7em; color: #fff; margin-bottom: 3px;">⚡ LIQUIDATION RISK:</div>
                        <div style="color: #ffaa00; font-weight: 700; font-size: 0.85em;">$98,200+</div>
                    </div>
                </div>
            </div>
            
            <!-- MOMENTUM TRACKER (FULL WIDTH) -->
            <div id="momentum-tracker-container" class="squeeze-alert momentum" style="border-color: #ff00ff; background: linear-gradient(135deg, #1a0a1a 0%, #0f0a0f 100%); border: 2px solid #ff00ff; margin-bottom: 15px;">
                <div class="squeeze-title" style="color: #ff00ff; text-shadow: 0 0 15px rgba(255,0,255,0.6);">⚡ MOMENTUM TRACKER</div>
                <div style="margin-top: 8px; font-size: 0.95em; color: #ffff00; line-height: 1.7;">
                    ⚡ <strong>87% ENERGY BUILD-UP</strong> - Squeeze jest naprawdę BLISKO!
                </div>
                <div class="squeeze-details" style="margin-top: 8px;">
                    <div class="squeeze-detail-item">
                        <div class="squeeze-detail-label">Energy Level</div>
                        <div class="squeeze-detail-value" style="color: #ffff00;">87/100</div>
                    </div>
                    <div class="squeeze-detail-item">
                        <div class="squeeze-detail-label">Distance to Trigger</div>
                        <div class="squeeze-detail-value" style="color: #ff6600;">$652</div>
                    </div>
                    <div class="squeeze-detail-item">
                        <div class="squeeze-detail-label">Estimated Release</div>
                        <div class="squeeze-detail-value" style="color: #ffff00;">±$3,200</div>
                    </div>
                    <div class="squeeze-detail-item">
                        <div class="squeeze-detail-label">Risk Status</div>
                        <div class="squeeze-detail-value" style="color: #ff0033;">CRITICAL</div>
                    </div>
                </div>
                <div style="margin-top: 8px; background: rgba(0,0,0,0.3); padding: 8px; border-radius: 4px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                        <span style="font-size: 0.7em; color: #ff00ff; font-weight: 700;">MOMENTUM BAR</span>
                        <span style="font-size: 0.7em; color: #ffff00;">87/100</span>
                    </div>
                    <div style="width: 100%; height: 12px; background: rgba(255,0,255,0.1); border-radius: 2px; overflow: hidden; border: 1px solid rgba(255,0,255,0.3);">
                        <div style="width: 87%; height: 100%; background: linear-gradient(90deg, #ff00ff 0%, #ffff00 100%); box-shadow: 0 0 10px rgba(255,0,255,0.8);"></div>
                    </div>
                </div>
            </div>
            
            <!-- SQUEEZE MONITORS (HORIZONTAL LAYOUT) -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                <!-- SHORT SQUEEZE MONITOR -->
                <div class="squeeze-alert short">
                    <div class="squeeze-title">🔴 SHORT SQUEEZE MONITOR</div>
                    <div class="squeeze-meter">
                        <div class="squeeze-fill squeeze-short-fill" style="width: 72%;">72% RISK</div>
                    </div>
                    <div style="font-size: 0.95em; margin-bottom: 10px; color: #ff9900; line-height: 1.7;">
                        ⚠️ <strong>72% SHORT POSITIONS</strong> zaangażowane. Jeśli cena przełamie $97,4k = MASSIVE SQUEEZE!
                    </div>
                    <div class="squeeze-details">
                        <div class="squeeze-detail-item">
                            <div class="squeeze-detail-label">SHORT Positions</div>
                            <div class="squeeze-detail-value">$8.2B</div>
                        </div>
                        <div class="squeeze-detail-item">
                            <div class="squeeze-detail-label">Leverage Avg</div>
                            <div class="squeeze-detail-value">15.3x</div>
                        </div>
                        <div class="squeeze-detail-item">
                            <div class="squeeze-detail-label">Liquidation Price</div>
                            <div class="squeeze-detail-value" style="color: #ff6600;">$98,200+</div>
                        </div>
                    </div>
                    <!-- SHORT SQUEEZE SCENARIO TABLE -->
                    <div style="margin-top: 12px; padding: 10px; background: rgba(255,100,0,0.08); border: 1px solid #ff6600; border-radius: 4px;">
                        <div style="color: #ff6600; font-weight: 700; font-size: 0.85em; margin-bottom: 8px;">📈 SHORT SQUEEZE SCENARIO</div>
                        <div style="font-size: 0.7em; line-height: 1.6; color: #ccc;">
                            <div style="margin-bottom: 4px;"><strong>Warunki:</strong> Przełamie $97,4k (monthly resistance)</div>
                            <div style="margin-bottom: 4px;"><strong>Mechanizm:</strong> FOMO BUYING → Shorts close → Cascade</div>
                            <div style="margin-bottom: 4px;"><strong>Target:</strong> $99,200 (+1.85%) | Ext: $101,500 (+4.3%)</div>
                            <div style="margin-bottom: 4px;"><strong>Volume:</strong> >$28B na 4H candle</div>
                            <div style="margin-bottom: 4px;"><strong>Risk Zones:</strong> $96,800 | $96,200</div>
                            <div style="margin-bottom: 4px;"><strong>Whale Entry:</strong> $96,500-$97,000</div>
                            <div style="margin-bottom: 4px;"><strong>Funding:</strong> +0.0087% (imbalance)</div>
                            <div style="color: #ffaa00; font-weight: 700; margin-top: 6px;">⚡ PROBABILITY: 68% (R/R 1:2.4)</div>
                        </div>
                    </div>
                </div>
                
                <!-- LONG SQUEEZE MONITOR -->
                <div class="squeeze-alert long">
                    <div class="squeeze-title">🔵 LONG SQUEEZE MONITOR</div>
                    <div class="squeeze-meter">
                        <div class="squeeze-fill squeeze-long-fill" style="width: 54%;">54% RISK</div>
                    </div>
                    <div style="font-size: 0.95em; margin-bottom: 10px; color: #00ffff; line-height: 1.7;">
                        ⚠️ <strong>54% LONG POSITIONS</strong> zaangażowane. Jeśli cena spadnie do $93,8k = MASSIVE SQUEEZE!
                    </div>
                    <div class="squeeze-details">
                        <div class="squeeze-detail-item">
                            <div class="squeeze-detail-label">LONG Positions</div>
                            <div class="squeeze-detail-value">$4.7B</div>
                        </div>
                        <div class="squeeze-detail-item">
                            <div class="squeeze-detail-label">Leverage Avg</div>
                            <div class="squeeze-detail-value">12.1x</div>
                        </div>
                        <div class="squeeze-detail-item">
                            <div class="squeeze-detail-label">Liquidation Price</div>
                            <div class="squeeze-detail-value" style="color: #00d4ff;">$93,800-</div>
                        </div>
                    </div>
                    <!-- LONG SQUEEZE SCENARIO TABLE -->
                    <div style="margin-top: 12px; padding: 10px; background: rgba(0,212,255,0.08); border: 1px solid #00d4ff; border-radius: 4px;">
                        <div style="color: #00d4ff; font-weight: 700; font-size: 0.85em; margin-bottom: 8px;">📉 LONG SQUEEZE SCENARIO</div>
                        <div style="font-size: 0.7em; line-height: 1.6; color: #ccc;">
                            <div style="margin-bottom: 4px;"><strong>Warunki:</strong> Złamie $94,8k (weekly support)</div>
                            <div style="margin-bottom: 4px;"><strong>Mechanizm:</strong> PANIC SELLING → Longs close → Domino</div>
                            <div style="margin-bottom: 4px;"><strong>Target:</strong> $92,100 (-2.85%) | Ext: $89,500 (-6.1%)</div>
                            <div style="margin-bottom: 4px;"><strong>Volume:</strong> >$35B na 4H candle</div>
                            <div style="margin-bottom: 4px;"><strong>Support:</strong> $94,200 | $93,500 (bounce)</div>
                            <div style="margin-bottom: 4px;"><strong>Whale:</strong> Selling at $95,200+</div>
                            <div style="margin-bottom: 4px;"><strong>CVD:</strong> Spot vs Futures bearish (-2.1B)</div>
                            <div style="color: #00ffff; font-weight: 700; margin-top: 6px;">⚡ PROBABILITY: 32% (R/R 1:1.8)</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- SQUEEZE STRATEGIA panel removed - scenarios now integrated into monitor panels above -->
        </div>
        
        <!-- HISTORICAL MARKET EVENTS -->
        <div class="key-levels-panel" style="border-color: #00d4ff; background: linear-gradient(135deg, #0a1a1a 0%, #0a0a0a 100%);">
            <div style="font-size: 1em; color: #00d4ff; margin-bottom: 12px; font-weight: 700;">📜 HISTORYCZNE WYDARZENIA RYNKOWE</div>
            <div style="font-size: 0.7em; line-height: 1.8; max-height: 220px; overflow-y: auto;">
                <div style="margin-bottom: 10px; padding: 8px; background: rgba(255,0,51,0.1); border-left: 3px solid #ff0033;">
                    <div style="color: #ff0033; font-weight: 700;">🔴 15 JAN 2026 - Luna 2.0 Collapse</div>
                    <div style="color: #fff; font-size: 0.95em;">-89% w 48h. $4.2B wyparowane. Cascading liquidations.</div>
                </div>
                <div style="margin-bottom: 10px; padding: 8px; background: rgba(0,255,65,0.1); border-left: 3px solid #00ff41;">
                    <div style="color: #00ff41; font-weight: 700;">🟢 03 JAN 2026 - BlackRock Bitcoin Rally</div>
                    <div style="color: #fff; font-size: 0.95em;">+$12k w 72h po ogłoszeniu zakupu 50k BTC przez BlackRock.</div>
                </div>
                <div style="margin-bottom: 10px; padding: 8px; background: rgba(255,0,51,0.1); border-left: 3px solid #ff0033;">
                    <div style="color: #ff0033; font-weight: 700;">🔴 28 DEC 2025 - Flash Crash $88k→$72k</div>
                    <div style="color: #fff; font-size: 0.95em;">-18% w 15 minut. $3.8B liquidations. Binance lag 40s.</div>
                </div>
                <div style="margin-bottom: 10px; padding: 8px; background: rgba(0,212,255,0.1); border-left: 3px solid #00d4ff;">
                    <div style="color: #00d4ff; font-weight: 700;">🔵 15 NOV 2025 - Bitcoin $100k First Time</div>
                    <div style="color: #fff; font-size: 0.95em;">Historyczny moment! FOMO buying przez retail. Volume ATH.</div>
                </div>
                <div style="margin-bottom: 10px; padding: 8px; background: rgba(255,0,51,0.1); border-left: 3px solid #ff0033;">
                    <div style="color: #ff0033; font-weight: 700;">🔴 05 NOV 2025 - FTX 2.0 Hack</div>
                    <div style="color: #fff; font-size: 0.95em;">$1.2B skradziono z FTX relaunch. Panic selling -22% w 8h.</div>
                </div>
                <div style="margin-bottom: 10px; padding: 8px; background: rgba(0,255,65,0.1); border-left: 3px solid #00ff41;">
                    <div style="color: #00ff41; font-weight: 700;">🟢 12 AUG 2025 - ETF Approval Pump</div>
                    <div style="color: #fff; font-size: 0.95em;">SEC zatwierdza Bitcoin Spot ETF. +34% w 5 dni. Institutions rush.</div>
                </div>
            </div>
        </div>
        
        <!-- ORDER FLOW & TAPE READING -->
        <div class="whale-panel" style="border-color: #00ffff;">
            <div style="font-size: 1em; color: #00ffff; margin-bottom: 12px; font-weight: 700;">📊 ORDER FLOW (Live)</div>
            <div style="font-size: 0.75em; line-height: 1.6;">
                <div style="display: flex; justify-content: space-between; margin: 5px 0; padding: 5px; background: rgba(0,255,0,0.1); border-left: 2px solid #00ff00;">
                    <span style="color: #00ff00;">BUY 95,501</span>
                    <span style="color: #ffff00; font-weight: bold;">142 BTC</span>
                    <span style="color: #fff;">0.2s</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin: 5px 0; padding: 5px; background: rgba(255,0,51,0.1); border-left: 2px solid #ff0033;">
                    <span style="color: #ff0033;">SELL 95,498</span>
                    <span style="color: #ffff00; font-weight: bold;">89 BTC</span>
                    <span style="color: #fff;">0.5s</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin: 5px 0; padding: 5px; background: rgba(0,255,0,0.1); border-left: 2px solid #00ff00;">
                    <span style="color: #00ff00;">BUY 95,502</span>
                    <span style="color: #ffff00; font-weight: bold;">256 BTC</span>
                    <span style="color: #fff;">1.1s</span>
                </div>
            </div>
            <div style="margin-top: 10px; padding-top: 8px; border-top: 1px solid #333; font-size: 0.75em;">
                <strong style="color: #00ffff;">DELTA 5s:</strong> <span style="color: #00ff00; font-weight: 900;">+309 BTC</span>
            </div>
        </div>
        
        <!-- MARKET DEPTH -->
        <div class="key-levels-panel" style="border-color: #ff00ff;">
            <div style="font-size: 1em; color: #ff00ff; margin-bottom: 12px; font-weight: 700;">📉 MARKET DEPTH</div>
            <div style="font-size: 0.75em;">
                <div style="margin-bottom: 10px;">
                    <div style="color: #00ff00; margin-bottom: 5px;">BID WALL (Support):</div>
                    <div style="background: rgba(0,255,0,0.2); height: 18px; border-radius: 3px; position: relative; overflow: hidden;">
                        <div style="background: #00ff00; height: 100%; width: 78%;" title="78%"></div>
                        <div style="position: absolute; top: 2px; right: 5px; color: #000; font-weight: bold; font-size: 0.9em;">5,240 BTC @ $95,100</div>
                    </div>
                </div>
                <div>
                    <div style="color: #ff0033; margin-bottom: 5px;">ASK WALL (Resistance):</div>
                    <div style="background: rgba(255,0,51,0.2); height: 18px; border-radius: 3px; position: relative; overflow: hidden;">
                        <div style="background: #ff0033; height: 100%; width: 62%;" title="62%"></div>
                        <div style="position: absolute; top: 2px; right: 5px; color: #fff; font-weight: bold; font-size: 0.9em;">3,890 BTC @ $96,800</div>
                    </div>
                </div>
            </div>
            <div style="margin-top: 10px; padding: 8px; background: rgba(0,255,0,0.1); border-radius: 4px;">
                <span style="color: #fff; font-size: 0.7em;">BID/ASK RATIO:</span>
                <span style="color: #00ff00; font-weight: 900; margin-left: 5px;">1.35:1 BULLISH</span>
            </div>
        </div>
        
        <!-- SPREAD & SLIPPAGE -->
        <div class="whale-panel" style="border-color: #ffaa00;">
            <div style="font-size: 1em; color: #ffaa00; margin-bottom: 12px; font-weight: 700;">💰 SPREAD & LIQUIDITY</div>
            <div style="font-size: 0.8em; line-height: 1.8;">
                <div style="display: flex; justify-content: space-between; margin: 5px 0;">
                    <span style="color: #fff;">Spread:</span>
                    <span style="color: #00ff00; font-weight: bold;">$0.50 (LOW)</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin: 5px 0;">
                    <span style="color: #fff;">Slippage 100 BTC:</span>
                    <span style="color: #ffaa00; font-weight: bold;">0.08%</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin: 5px 0;">
                    <span style="color: #fff;">Liquidity Score:</span>
                    <span style="color: #00ff00; font-weight: bold;">95/100 EXCELLENT</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin: 5px 0;">
                    <span style="color: #fff;">Active Traders:</span>
                    <span style="color: #00d4ff; font-weight: bold;">12,450 (PEAK)</span>
                </div>
            </div>
        </div>
        
        <!-- INSTITUTIONAL FLOW -->
        <div class="key-levels-panel" style="border-color: #00d4ff; background: linear-gradient(135deg, #001a2a 0%, #0a0a0a 100%);">
            <div style="font-size: 1em; color: #00d4ff; margin-bottom: 12px; font-weight: 700;">🏦 INSTITUTIONAL FLOW</div>
            <div style="font-size: 0.75em; line-height: 1.7;">
                <div style="display: flex; justify-content: space-between; margin: 8px 0; padding: 8px; background: rgba(0,255,65,0.1); border-left: 3px solid #00ff41;">
                    <div>
                        <div style="color: #00ff41; font-weight: 700;">GRAYSCALE</div>
                        <div style="color: #fff; font-size: 0.9em;">2 min temu</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="color: #ffff00; font-weight: 900;">+850 BTC</div>
                        <div style="color: #00ff41;">BUY</div>
                    </div>
                </div>
                <div style="display: flex; justify-content: space-between; margin: 8px 0; padding: 8px; background: rgba(255,0,51,0.1); border-left: 3px solid #ff0033;">
                    <div>
                        <div style="color: #ff0033; font-weight: 700;">MICROSTRATEGY</div>
                        <div style="color: #fff; font-size: 0.9em;">8 min temu</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="color: #ffff00; font-weight: 900;">-420 BTC</div>
                        <div style="color: #ff0033;">SELL</div>
                    </div>
                </div>
                <div style="margin-top: 10px; padding-top: 8px; border-top: 1px solid #333;">
                    <strong style="color: #00d4ff;">NET FLOW 1H:</strong> <span style="color: #00ff00; font-weight: 900;">+1,240 BTC</span>
                </div>
            </div>
        </div>

        <!-- KEY LEVELS WATCH -->
        <div class="key-levels-panel">
            <div style="font-size: 1em; color: #00d4ff; margin-bottom: 12px; font-weight: 700;">🎯 KEY LEVELS WATCH</div>
            <div class="key-level-item resistance">
                <span style="color: #ff0033;">▲ RESISTANCE</span>
                <span style="color: #fff; font-weight: bold;">$97,400</span>
                <span class="heat-alert">HOT 🔥</span>
            </div>
            <div class="key-level-item current">
                <span style="color: #ffaa00;">● CURRENT</span>
                <span style="color: #ffff00; font-weight: bold;">$95,501</span>
                <span style="font-size: 0.75em; color: #fff;">PRICE ACTION</span>
            </div>
            <div class="key-level-item support">
                <span style="color: #00ff00;">▼ SUPPORT</span>
                <span style="color: #fff; font-weight: bold;">$94,800</span>
                <span style="font-size: 0.75em; color: #00ff00;">STRONG</span>
            </div>
        </div>

        
        <div class="news-panel" style="border-color:#ff8800">
            <div class="news-header">
                <h3>🐋 PRZEPŁYWY WIELORYBÓW (ON-CHAIN)</h3>
            </div>
            <div class="news-feed">
        
            <div class="news-item">
                <div class="news-meta">
                    <span class="news-time">5 min temu</span>
                    <span class="news-source">Binance → Cold wallet</span>
                    <span class="news-impact" style="color: #00ff41;">Bullish</span>
                </div>
                <div class="news-headline">WITHDRAWAL • 2500 BTC</div>
            </div>
            
            <div class="news-item">
                <div class="news-meta">
                    <span class="news-time">18 min temu</span>
                    <span class="news-source">Whale wallet → Binance</span>
                    <span class="news-impact" style="color: #ff0033;">Bearish</span>
                </div>
                <div class="news-headline">DEPOSIT • 1800 BTC</div>
            </div>
            
            <div class="news-item">
                <div class="news-meta">
                    <span class="news-time">42 min temu</span>
                    <span class="news-source">Coinbase → Custody</span>
                    <span class="news-impact" style="color: #00ff41;">Bullish</span>
                </div>
                <div class="news-headline">WITHDRAWAL • 3200 BTC</div>
            </div>
            
            </div>
        </div>
        
        <div class="news-panel" style="border-color:#00d4ff">
            <div class="news-header">
                <h3>📊 GŁĘBOKOŚĆ RYNKU (ORDER BOOK)</h3>
            </div>
            <div class="orderbook-container">
        
            <div class="orderbook-row ask">
                <span class="ob-price">$96,251</span>
                <span class="ob-amount">23.50</span>
                <div class="ob-bar" style="width: 92.0%;"></div>
            </div>
            
            <div class="orderbook-row ask">
                <span class="ob-price">$96,001</span>
                <span class="ob-amount">14.80</span>
                <div class="ob-bar" style="width: 52.83333333333333%;"></div>
            </div>
            
            <div class="orderbook-row ask">
                <span class="ob-price">$95,801</span>
                <span class="ob-amount">9.20</span>
                <div class="ob-bar" style="width: 28.16666666666666%;"></div>
            </div>
            
            <div class="orderbook-row ask">
                <span class="ob-price">$95,701</span>
                <span class="ob-amount">4.90</span>
                <div class="ob-bar" style="width: 12.833333333333332%;"></div>
            </div>
            
            <div class="orderbook-row ask">
                <span class="ob-price">$95,601</span>
                <span class="ob-amount">2.80</span>
                <div class="ob-bar" style="width: 4.666666666666666%;"></div>
            </div>
            
            <div class="orderbook-current-price">
                <span style="color:#00d4ff; font-weight:800; font-size:1.1em;">$95,501.20</span>
            </div>
        
            <div class="orderbook-row bid">
                <span class="ob-price">$95,401</span>
                <span class="ob-amount">2.50</span>
                <div class="ob-bar" style="width: 4.166666666666666%;"></div>
            </div>
            
            <div class="orderbook-row bid">
                <span class="ob-price">$95,301</span>
                <span class="ob-amount">5.20</span>
                <div class="ob-bar" style="width: 12.833333333333332%;"></div>
            </div>
            
            <div class="orderbook-row bid">
                <span class="ob-price">$95,201</span>
                <span class="ob-amount">8.90</span>
                <div class="ob-bar" style="width: 27.666666666666668%;"></div>
            </div>
            
            <div class="orderbook-row bid">
                <span class="ob-price">$95,001</span>
                <span class="ob-amount">15.30</span>
                <div class="ob-bar" style="width: 53.166666666666664%;"></div>
            </div>
            
            <div class="orderbook-row bid">
                <span class="ob-price">$94,751</span>
                <span class="ob-amount">22.10</span>
                <div class="ob-bar" style="width: 90.0%;"></div>
            </div>
            
            </div>
        </div>
        
        <div class="news-panel" style="border-color:#ffaa00">
            <div class="news-header">
                <h3>💰 DUŻE TRANSAKCJE (LARGE PRINTS)</h3>
            </div>
            <div class="trades-feed">
        
            <div class="trade-item">
                <div class="trade-meta">
                    <span class="trade-time">14:32:15</span>
                    <span class="trade-side" style="color: #00ff41;">🟢 BUY</span>
                </div>
                <div class="trade-details">
                    <span style="color: #00ff41; font-weight: 700;">12.50 BTC</span>
                    <span style="color: #fff;"> @ $95,551</span>
                </div>
            </div>
            
            <div class="trade-item">
                <div class="trade-meta">
                    <span class="trade-time">14:31:42</span>
                    <span class="trade-side" style="color: #ff0033;">🔴 SELL</span>
                </div>
                <div class="trade-details">
                    <span style="color: #ff0033; font-weight: 700;">8.90 BTC</span>
                    <span style="color: #fff;"> @ $95,471</span>
                </div>
            </div>
            
            <div class="trade-item">
                <div class="trade-meta">
                    <span class="trade-time">14:30:55</span>
                    <span class="trade-side" style="color: #00ff41;">🟢 BUY</span>
                </div>
                <div class="trade-details">
                    <span style="color: #00ff41; font-weight: 700;">15.20 BTC</span>
                    <span style="color: #fff;"> @ $95,521</span>
                </div>
            </div>
            
            <div class="trade-item">
                <div class="trade-meta">
                    <span class="trade-time">14:29:18</span>
                    <span class="trade-side" style="color: #ff0033;">🔴 SELL</span>
                </div>
                <div class="trade-details">
                    <span style="color: #ff0033; font-weight: 700;">6.70 BTC</span>
                    <span style="color: #fff;"> @ $95,491</span>
                </div>
            </div>
            
            <div class="trade-item">
                <div class="trade-meta">
                    <span class="trade-time">14:28:03</span>
                    <span class="trade-side" style="color: #00ff41;">🟢 BUY</span>
                </div>
                <div class="trade-details">
                    <span style="color: #00ff41; font-weight: 700;">22.30 BTC</span>
                    <span style="color: #fff;"> @ $95,601</span>
                </div>
            </div>
            
            </div>
        </div>
        
    </div>
    
    <div class="footer">
        <div style="background: linear-gradient(135deg, #0f0f1a 0%, #0a0a0a 100%); border: 2px solid #00d4ff; border-radius: 10px; padding: 25px; margin-bottom: 20px;">
            <p style="font-size: 1.3em; font-weight: 700; color: #00d4ff; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 15px;">
                🚀 Professional Trading Terminal v3.0
            </p>
            <p style="margin-bottom: 15px; color: #ddd; line-height: 1.6;">
                Powered by Advanced Technical Analysis & Real-Time Data
            </p>
            <p style="margin-bottom: 15px; font-size: 0.95em; color: #ccc;">
                <strong style="color: #00d4ff;">Core Features:</strong> RSI • MACD • Volume Analysis • Liquidity Grab Detection • FVG • Support/Resistance • Smart Money Tracking
            </p>
            
            <!-- AI RECOMMENDATIONS SECTION -->
            <div style="background: linear-gradient(135deg, #1a001a 0%, #0a0a0a 100%); border-left: 4px solid #ff00ff; padding: 15px; border-radius: 6px; margin-top: 15px;">
                <div style="color: #ff00ff; font-weight: 700; font-size: 1.1em; margin-bottom: 12px;">🤖 AI TRADING RECOMMENDATIONS</div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                    <!-- Signal 1 -->
                    <div style="background: rgba(0,255,65,0.1); padding: 12px; border-radius: 6px; border-left: 3px solid #00ff41;">
                        <div style="color: #00ff41; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">📈 BUY SIGNAL (Strong)</div>
                        <div style="font-size: 0.75em; color: #ccc; line-height: 1.4;">
                            RSI oversold (28) + MACD bullish crossover + Accumulation zone detected. Entry: $94,200-$94,500
                        </div>
                    </div>

                    <!-- Signal 2 -->
                    <div style="background: rgba(255,170,0,0.1); padding: 12px; border-radius: 6px; border-left: 3px solid #ffaa00;">
                        <div style="color: #ffaa00; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">⚡ CAUTION ZONE</div>
                        <div style="font-size: 0.75em; color: #ccc; line-height: 1.4;">
                            Price near resistance $97,400. Divergence forming on 4H. Wait for confirmation before entering LONG.
                        </div>
                    </div>

                    <!-- Signal 3 -->
                    <div style="background: rgba(0,212,255,0.1); padding: 12px; border-radius: 6px; border-left: 3px solid #00d4ff;">
                        <div style="color: #00d4ff; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">💼 SMART MONEY FLOW</div>
                        <div style="font-size: 0.75em; color: #ccc; line-height: 1.4;">
                            Institutions accumulating at $94k-$95k. Prepare for potential breakout. Key level: $98,200
                        </div>
                    </div>

                    <!-- Signal 4 -->
                    <div style="background: rgba(255,0,51,0.1); padding: 12px; border-radius: 6px; border-left: 3px solid #ff0033;">
                        <div style="color: #ff0033; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">📍 STOP LOSS ZONE</div>
                        <div style="font-size: 0.75em; color: #ccc; line-height: 1.4;">
                            If break below $92,800 = Bearish invalidation. Daily support breached. Expect liquidity sweep.
                        </div>
                    </div>

                    <!-- Signal 5 -->
                    <div style="background: rgba(0,255,200,0.1); padding: 12px; border-radius: 6px; border-left: 3px solid #00ffcc;">
                        <div style="color: #00ffcc; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">🎯 OPTIMAL ENTRY TIME</div>
                        <div style="font-size: 0.75em; color: #ccc; line-height: 1.4;">
                            Golden Window: 12:00-14:00 UTC (London-NY overlap). Highest probability trades + liquidity.
                        </div>
                    </div>

                    <!-- Signal 6 -->
                    <div style="background: rgba(139,69,255,0.1); padding: 12px; border-radius: 6px; border-left: 3px solid #8b45ff;">
                        <div style="color: #8b45ff; font-weight: 700; font-size: 0.9em; margin-bottom: 6px;">⚙️ RISK/REWARD RATIO</div>
                        <div style="font-size: 0.75em; color: #ccc; line-height: 1.4;">
                            Current setup: 1:3.2 R:R | Max risk: 2% portfolio | Target: $99,500-$102,000
                        </div>
                    </div>
                </div>

                <div style="margin-top: 12px; padding: 10px; background: rgba(0,212,255,0.05); border-radius: 4px; border-left: 3px solid #00d4ff;">
                    <div style="font-size: 0.75em; color: #fff;">
                        ⚠️ <strong>Disclaimer:</strong> AI recommendations are educational only. Not financial advice. Always manage risk and use stop losses. Past performance ≠ future results.
                    </div>
                </div>
            </div>
        </div>

        <p style="font-size: 0.85em; color: #fff; text-align: center;">
            🐹 Hamster Terminal v3.0 • hamsterterminal.com • 2026 • Real-Time Analysis Engine • Powered by Binance API
        </p>
    </div>
    
    <script>
        // Ultra-smooth refresh system without any flickering
        let lastUpdate = Date.now();
        let isUpdating = false;
        let updateQueue = [];
        
        // Cache for comparing content
        const contentCache = new Map();
        
        function smoothRefresh() {
            if (isUpdating) {
                return; // Skip if already updating
            }
            
            isUpdating = true;
            
            fetch(window.location.href + '?t=' + Date.now(), {
                method: 'GET',
                headers: {
                    'Cache-Control': 'no-cache, no-store, must-revalidate',
                    'Pragma': 'no-cache',
                    'Expires': '0'
                },
                cache: 'no-store'
            })
            .then(response => response.text())
            .then(html => {
                const parser = new DOMParser();
                const newDoc = parser.parseFromString(html, 'text/html');
                
                // Elements to update with smooth transitions
                const updates = [
                    { selector: '.terminal-time', transition: false },
                    { selector: '.metrics-panel', transition: true },
                    { selector: '.news-feed', transition: true },
                    { selector: '.orderbook-container', transition: true },
                    { selector: '.trades-feed', transition: true },
                    { selector: '.positions-feed', transition: true }
                ];
                
                updates.forEach(update => {
                    const oldElement = document.querySelector(update.selector);
                    const newElement = newDoc.querySelector(update.selector);
                    
                    if (oldElement && newElement) {
                        const oldContent = oldElement.innerHTML;
                        const newContent = newElement.innerHTML;
                        
                        // Only update if content changed
                        if (oldContent !== newContent) {
                            if (update.transition) {
                                // Smooth fade transition
                                oldElement.style.transition = 'opacity 0.2s ease-in-out';
                                oldElement.style.opacity = '0.6';
                                
                                setTimeout(() => {
                                    oldElement.innerHTML = newContent;
                                    oldElement.style.opacity = '1';
                                }, 200);
                            } else {
                                // Instant update (no flash)
                                oldElement.innerHTML = newContent;
                            }
                        }
                    }
                });
                
                // ❌ DISABLED: Chart update via innerHTML destroys Plotly
                // Update chart smoothly (preserve Plotly state)
                /*
                const oldChart = document.querySelector('#main-chart');
                const newChart = newDoc.querySelector('#main-chart');
                
                if (oldChart && newChart) {
                    const oldChartData = oldChart.getAttribute('data-hash');
                    const newChartData = newChart.innerHTML.substring(0, 100);
                    
                    // Only update chart if data actually changed
                    if (oldChartData !== newChartData) {
                        oldChart.setAttribute('data-hash', newChartData);
                        
                        // Smooth chart update
                        const chartContainer = oldChart.parentElement;
                        chartContainer.style.transition = 'opacity 0.15s ease';
                        chartContainer.style.opacity = '0.85';
                        
                        setTimeout(() => {
                            oldChart.innerHTML = newChart.innerHTML;
                            
                            // Re-execute Plotly scripts
                            const scripts = newChart.getElementsByTagName('script');
                            Array.from(scripts).forEach(script => {
                                try {
                                    const scriptFunc = new Function(script.innerHTML);
                                    scriptFunc();
                                } catch(e) {
                                    console.log('Chart script execution skipped');
                                }
                            });
                            
                            chartContainer.style.opacity = '1';
                        }, 150);
                    }
                }
                */
                
                lastUpdate = Date.now();
                isUpdating = false;
            })
            .catch(err => {
                console.log('Refresh delayed, retrying...', err.message);
                isUpdating = false;
                // Don't fallback to reload - just retry
            });
        }
        
        // ❌ DISABLED: Auto refresh destroys Plotly chart every 3 seconds
        // Chart now has its own 60s refresh mechanism
        // setInterval(smoothRefresh, 3000);
        
        // Initial load animation
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize clock with current time zones
            tick();
            
            document.body.style.opacity = '0';
            setTimeout(() => {
                document.body.style.transition = 'opacity 0.5s ease';
                document.body.style.opacity = '1';
            }, 100);
        });
        
        // Signal card pulse animation
        setInterval(function() {
            const signalCard = document.querySelector('.signal-card');
            if (signalCard) {
                signalCard.style.transition = 'transform 0.15s ease, box-shadow 0.15s ease';
                signalCard.style.transform = 'scale(1.015)';
                signalCard.style.boxShadow = '0 8px 20px rgba(0,212,255,0.3)';
                
                setTimeout(() => {
                    signalCard.style.transform = 'scale(1)';
                    signalCard.style.boxShadow = 'none';
                }, 150);
            }
        }, 4000);
        
        // Smooth scroll behavior
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        
        // Add smooth animations CSS
        const smoothStyles = document.createElement('style');
        smoothStyles.textContent = `
            * {
                transition-property: opacity, transform, color, background-color, border-color;
                transition-timing-function: ease-in-out;
            }
            
            @keyframes slideInRight {
                from {
                    opacity: 0;
                    transform: translateX(20px);
                }
                to {
                    opacity: 1;
                    transform: translateX(0);
                }
            }
            
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            
            @keyframes shimmer {
                0% { background-position: -1000px 0; }
                100% { background-position: 1000px 0; }
            }
            
            .news-item:nth-child(n) {
                animation: slideInRight 0.4s ease-out;
                animation-fill-mode: both;
            }
            
            .news-item:nth-child(1) { animation-delay: 0.05s; }
            .news-item:nth-child(2) { animation-delay: 0.1s; }
            .news-item:nth-child(3) { animation-delay: 0.15s; }
            .news-item:nth-child(4) { animation-delay: 0.2s; }
            .news-item:nth-child(5) { animation-delay: 0.25s; }
            
            .metric-card {
                animation: fadeIn 0.3s ease;
            }
            
            /* Prevent layout shift */
            img, svg, canvas {
                display: block;
                max-width: 100%;
                height: auto;
            }
        `;
        document.head.appendChild(smoothStyles);
        
        // Performance monitoring
        let frameCount = 0;
        let lastFrameTime = performance.now();
        
        function monitorPerformance() {
            const now = performance.now();
            frameCount++;
            
            if (now >= lastFrameTime + 1000) {
                const fps = Math.round((frameCount * 1000) / (now - lastFrameTime));
                frameCount = 0;
                lastFrameTime = now;
                
                // Log FPS for debugging (optional)
                if (fps < 30) {
                    console.log('Low FPS detected:', fps);
                }
            }
            
            requestAnimationFrame(monitorPerformance);
        }
        
        monitorPerformance();
    </script>

    <!-- REAL-TIME DATA API INTEGRATION -->
    <script>
        // ========================================
        // REAL-TIME DATA FETCHING FROM MULTIPLE SOURCES
        // ========================================
        
        // Data sources configuration - auto-detect localhost vs production
        const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
        const API_BASE = isLocalhost ? 'http://localhost:5000' : '';
        
        const DATA_SOURCES = {
            binance: `${API_BASE}/api/binance`,
            coingecko: `${API_BASE}/api/coingecko`,
            feargreed: `${API_BASE}/api/fng`,
        };
        
        console.log(`🔌 API Mode: ${isLocalhost ? 'LOCALHOST (port 5000)' : 'PRODUCTION'}`);
        console.log(`📡 API Base URL: ${API_BASE || 'relative'}`);
        
        // Global data cache
        let marketData = {
            btcPrice: 95501.20,
            btcChange24h: 2.45,
            ethPrice: 2845.32,
            ethChange24h: 1.80,
            fearGreedIndex: 62,
            volume24h: 24500000000,
            fundingRate: 0.0082,
            openInterest: 12400000000,
            lastUpdate: null
        };
        
        // Fetch BTC/USDT real-time data from Binance (with fallback)
        async function fetchBinanceData() {
            try {
                console.log('📡 Fetching Binance data...');
                
                // Try local API first if available
                if (isLocalhost) {
                    const summaryRes = await fetch(`${API_BASE}/api/binance/summary`, { cache: 'no-store' });
                    if (!summaryRes.ok) throw new Error('Local API unavailable');
                    const summary = await summaryRes.json();
                    if (!summary.ok) throw new Error(summary.error || 'Binance summary error');

                    marketData.btcPrice = summary.btcPrice;
                    marketData.btcChange24h = summary.btcChange24h;
                    marketData.volume24h = summary.btcVolume24h;
                    marketData.ethPrice = summary.ethPrice;
                    marketData.ethChange24h = summary.ethChange24h;

                    console.log('✅ BTC price (local API): $' + marketData.btcPrice.toFixed(2));
                    return true;
                }
                
                // Production: Direct Binance API calls
                const btcRes = await fetch('https://api.binance.com/api/v3/ticker/24hr?symbol=BTCUSDT');
                const ethRes = await fetch('https://api.binance.com/api/v3/ticker/24hr?symbol=ETHUSDT');
                
                const btcData = await btcRes.json();
                const ethData = await ethRes.json();
                
                marketData.btcPrice = parseFloat(btcData.lastPrice);
                marketData.btcChange24h = parseFloat(btcData.priceChangePercent);
                marketData.volume24h = parseFloat(btcData.quoteVolume);
                marketData.ethPrice = parseFloat(ethData.lastPrice);
                marketData.ethChange24h = parseFloat(ethData.priceChangePercent);

                console.log('✅ BTC price (Binance direct): $' + marketData.btcPrice.toFixed(2) + ' | Change: ' + marketData.btcChange24h.toFixed(2) + '%');
                return true;
            } catch (error) {
                console.warn('⚠️ Binance API error, using fallback data:', error);
                // FALLBACK: Simulate realistic price movements
                const volatility = 0.015;
                const randomChange = (Math.random() - 0.5) * volatility;
                
                marketData.btcPrice = marketData.btcPrice * (1 + randomChange);
                marketData.btcChange24h = (Math.random() - 0.5) * 5;
                marketData.ethPrice = marketData.ethPrice * (1 + randomChange * 0.8);
                marketData.ethChange24h = (Math.random() - 0.5) * 4;
                marketData.volume24h = 24500000000 + Math.random() * 5000000000;
                
                console.log('✅ FALLBACK DATA: BTC $' + marketData.btcPrice.toFixed(0));
                return false;
            }
        }
        
        // Fetch Fear & Greed Index from CoinGecko alternative
        async function fetchFearGreedIndex() {
            try {
                const response = await fetch(`${API_BASE}/api/fng`, { cache: 'no-store' });
                const data = await response.json();
                if (data.ok && data.data && data.data.data && data.data.data[0]) {
                    marketData.fearGreedIndex = parseInt(data.data.data[0].value);
                    console.log('✅ Fear & Greed Index updated:', marketData.fearGreedIndex);
                }
                return !!data.ok;
            } catch (error) {
                console.error('❌ Fear & Greed API error:', error);
                return false;
            }
        }
        
        // Fetch funding rate from Binance Futures
        async function fetchFundingRate() {
            try {
                const response = await fetch(`${API_BASE}/api/binance/funding?symbol=BTCUSDT`, { cache: 'no-store' });
                const data = await response.json();
                if (data.ok && data.lastFundingRate !== undefined && data.lastFundingRate !== null) {
                    marketData.fundingRate = parseFloat(data.lastFundingRate) * 100; // percentage
                    console.log('✅ Funding rate updated:', marketData.fundingRate);
                }
                return !!data.ok;
            } catch (error) {
                console.error('❌ Funding rate API error:', error);
                return false;
            }
        }
        
        // Fetch Open Interest from Binance Futures
        async function fetchOpenInterest() {
            try {
                const response = await fetch(`${API_BASE}/api/binance/oi?symbol=BTCUSDT`, { cache: 'no-store' });
                const data = await response.json();
                if (data.ok && data.openInterest !== undefined && data.openInterest !== null) {
                    marketData.openInterest = parseFloat(data.openInterest) * marketData.btcPrice;
                    console.log('✅ Open Interest updated:', marketData.openInterest);
                }
                return !!data.ok;
            } catch (error) {
                console.error('❌ Open Interest API error:', error);
                return false;
            }
        }
        
        // ========== YAHOO FINANCE TICKER DATA ==========
        async function fetchYahooFinanceData() {
            try {
                console.log('📡 Fetching Yahoo Finance ticker data...');
                
                // Fetch crypto data from CoinGecko (reliable source)
                const cryptoResponse = await fetch(`${API_BASE}/api/coingecko/simple`, { cache: 'no-store' });
                if (cryptoResponse.ok) {
                    const cryptoDataWrapper = await cryptoResponse.json();
                    const cryptoData = cryptoDataWrapper.data || {};
                    if (cryptoData.bitcoin) {
                        const btcPrice = cryptoData.bitcoin.usd;
                        const btcChange = cryptoData.bitcoin.usd_24h_change || 0;
                        window.tickerData = {
                            BTC: { price: btcPrice, change: btcChange },
                            ETH: { price: cryptoData.ethereum?.usd || 2845, change: cryptoData.ethereum?.usd_24h_change || 0 }
                        };
                        console.log('✅ Crypto ticker updated - BTC: $' + btcPrice.toFixed(2));
                    }
                }
                updatePixelTicker();
            } catch (error) {
                console.error('❌ Yahoo Finance ticker error:', error.message);
            }
        }
        
        // Update pixel ticker display with real data
        function updatePixelTicker() {
            try {
                const tickerContent = document.querySelector('.pixel-ticker-content');
                if (!tickerContent) return;
                
                // Build dynamic ticker with current data
                let html = '<span class=\"pixel-bull\">�</span>';
                
                // Use real data if available, otherwise fallback values
                const tickers = [
                    {
                        symbol: 'BTC',
                        price: marketData.btcPrice.toFixed(0),
                        change: marketData.btcChange24h.toFixed(2),
                        color: '#ff8800',
                        emoji: '₿'
                    },
                    {
                        symbol: 'ETH',
                        price: marketData.ethPrice.toFixed(0),
                        change: marketData.ethChange24h.toFixed(2),
                        color: '#627eea',
                        emoji: '⟠'
                    },
                    {
                        symbol: 'GOLD',
                        price: (commodityPrices?.gold ?? 2650).toFixed(2),
                        change: (((commodityPrices?.gold ?? 2650) - (commodityPrices?.goldPrev ?? 2650)) / (commodityPrices?.goldPrev ?? 2650) * 100).toFixed(2),
                        color: '#ffff00',
                        emoji: '🏅',
                        idPrice: 'ticker-gold-price',
                        idChange: 'ticker-gold-change'
                    },
                    {
                        symbol: 'SILVER',
                        price: (commodityPrices?.silver ?? 31.5).toFixed(2),
                        change: (((commodityPrices?.silver ?? 31.5) - (commodityPrices?.silverPrev ?? 31.5)) / (commodityPrices?.silverPrev ?? 31.5) * 100).toFixed(2),
                        color: '#c0c0c0',
                        emoji: '🔱',
                        idPrice: 'ticker-silver-price',
                        idChange: 'ticker-silver-change'
                    },
                    {
                        symbol: 'S&P500',
                        price: (5847).toFixed(0),
                        change: (1.4).toFixed(1),
                        color: '#00d4ff',
                        emoji: '📊'
                    },
                    {
                        symbol: 'NASDAQ',
                        price: (18542).toFixed(0),
                        change: (1.9).toFixed(1),
                        color: '#00ff41',
                        emoji: '💻'
                    },
                    {
                        symbol: 'DAX',
                        price: (18234).toFixed(0),
                        change: (-0.6).toFixed(1),
                        color: '#ffaa00',
                        emoji: '🇩🇪'
                    },
                    {
                        symbol: 'BULLS',
                        price: '62',
                        change: '+4.2',
                        color: '#00ff41',
                        emoji: '🐂'
                    },
                    {
                        symbol: 'BEARS',
                        price: '38',
                        change: '-4.2',
                        color: '#ff0033',
                        emoji: '🐻'
                    }
                ];
                
                tickers.forEach(ticker => {
                    const changeClass = ticker.change >= 0 ? 'color: #00ff41;' : 'color: #ff0033;';
                    const idAttr = ticker.idPrice ? ` id="${ticker.idPrice}"` : '';
                    const changeIdAttr = ticker.idChange ? ` id="${ticker.idChange}"` : '';
                    html += `<div class="pixel-instrument"${idAttr} style="color: ${ticker.color}; font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', sans-serif;">` +
                            `${ticker.emoji} ${ticker.symbol} $${ticker.price} ` +
                            `<span${changeIdAttr} style="${changeClass}">${ticker.change >= 0 ? '+' : ''}${ticker.change}%</span>` +
                            `</div>`;
                });
                
                // Add duplicate for seamless loop
                tickers.forEach(ticker => {
                    const changeClass = ticker.change >= 0 ? 'color: #00ff41;' : 'color: #ff0033;';
                    const idAttr = ticker.idPrice ? ` id="${ticker.idPrice}"` : '';
                    const changeIdAttr = ticker.idChange ? ` id="${ticker.idChange}"` : '';
                    html += `<div class="pixel-instrument"${idAttr} style="color: ${ticker.color}; font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', sans-serif;">` +
                            `${ticker.emoji} ${ticker.symbol} $${ticker.price} ` +
                            `<span${changeIdAttr} style="${changeClass}">${ticker.change >= 0 ? '+' : ''}${ticker.change}%</span>` +
                            `</div>`;
                });
                
                tickerContent.innerHTML = html;
                
            } catch (error) {
                console.warn('⚠️ Error updating ticker:', error);
            }
        }
        
        // ========== YAHOO FINANCE API FOR GOLD/SILVER ==========
        async function fetchRealCommodityPrices() {
            try {
                // Yahoo Finance API proxy - fetch Gold (GC=F) and Silver (SI=F)
                const goldUrl = 'https://query1.finance.yahoo.com/v8/finance/chart/GC=F?interval=1d&range=1d';
                const silverUrl = 'https://query1.finance.yahoo.com/v8/finance/chart/SI=F?interval=1d&range=1d';
                
                const [goldRes, silverRes] = await Promise.all([
                    fetch(goldUrl).catch(() => null),
                    fetch(silverUrl).catch(() => null)
                ]);
                
                if (goldRes && goldRes.ok) {
                    const goldData = await goldRes.json();
                    const goldPrice = goldData?.chart?.result?.[0]?.meta?.regularMarketPrice;
                    const goldPrevClose = goldData?.chart?.result?.[0]?.meta?.chartPreviousClose;
                    
                    if (goldPrice && goldPrevClose) {
                        commodityPrices.goldPrev = goldPrevClose;
                        commodityPrices.gold = goldPrice;
                        console.log('✅ Yahoo Finance: GOLD $' + goldPrice.toFixed(2));
                    }
                }
                
                if (silverRes && silverRes.ok) {
                    const silverData = await silverRes.json();
                    const silverPrice = silverData?.chart?.result?.[0]?.meta?.regularMarketPrice;
                    const silverPrevClose = silverData?.chart?.result?.[0]?.meta?.chartPreviousClose;
                    
                    if (silverPrice && silverPrevClose) {
                        commodityPrices.silverPrev = silverPrevClose;
                        commodityPrices.silver = silverPrice;
                        console.log('✅ Yahoo Finance: SILVER $' + silverPrice.toFixed(2));
                    }
                }
                
                updateCommodityDisplay();
                updatePixelTicker();
                
            } catch (error) {
                console.warn('⚠️ Yahoo Finance API error (using fallback):', error);
            }
        }
        
        // ========== WHALE FLOW UPDATE (SAFE) ==========
        function updateWhaleFlow() {
            try {
                const container = document.getElementById('whale-flow-container');
                if (!container) return;
                
                // Simulate whale data from Binance large trades
                const whaleData = [
                    { type: 'BUY', amount: (1200 + Math.random() * 100).toFixed(0), time: '2min', color: '#00ff41' },
                    { type: 'SELL', amount: (850 + Math.random() * 100).toFixed(0), time: '7min', color: '#ff0033' },
                    { type: 'ICEBERG', amount: `${(420 + Math.random() * 50).toFixed(0)}/3,200`, time: '12min', color: '#00d4ff', note: `Hidden: ${(2780 + Math.random() * 100).toFixed(0)} BTC` },
                    { type: 'BUY', amount: (2050 + Math.random() * 100).toFixed(0), time: '15min', color: '#00ff41' },
                    { type: 'ICEBERG', amount: `${(175 + Math.random() * 20).toFixed(0)}/1,800`, time: '18min', color: '#ffaa00', note: 'Smart Money: 90% hidden' }
                ];
                
                let html = '<div style="font-size: 1em; color: #ff00ff; margin-bottom: 12px; font-weight: 700;">🐋 WHALE FLOW</div>';
                
                let totalBuy = 0;
                let totalSell = 0;
                
                whaleData.forEach(whale => {
                    const bgColor = whale.color === '#00ff41' ? 'rgba(0,255,65,0.1)' : 
                                    whale.color === '#ff0033' ? 'rgba(255,0,51,0.1)' : 
                                    whale.color === '#00d4ff' ? 'rgba(0,212,255,0.1)' : 'rgba(255,170,0,0.1)';
                    
                    html += `<div style="margin-bottom: 8px; padding: 8px; background: ${bgColor}; border-radius: 4px; border-left: 3px solid ${whale.color};">`;
                    html += `<div style="display: flex; justify-content: space-between; align-items: center;">`;
                    html += `<span style="color: ${whale.color}; font-weight: 800;">${whale.type === 'ICEBERG' ? '🧊 ICEBERG' : whale.type === 'BUY' ? '↗ BUY' : '↘ SELL'}</span>`;
                    html += `<span style="color: #fff; font-weight: 900; font-size: 1.1em;">${whale.amount} BTC</span>`;
                    html += `<span style="font-size: 0.75em; color: #fff;">${whale.time}</span>`;
                    html += `</div>`;
                    
                    if (whale.note) {
                        html += `<div style="font-size: 0.7em; color: ${whale.color}; margin-top: 4px;">${whale.note}</div>`;
                    }
                    html += `</div>`;
                    
                    // Calculate net flow
                    if (whale.type === 'BUY') totalBuy += parseFloat(whale.amount);
                    if (whale.type === 'SELL') totalSell += parseFloat(whale.amount);
                });
                
                const netFlow = totalBuy - totalSell;
                const flowColor = netFlow > 0 ? '#00ff41' : '#ff0033';
                const flowText = netFlow > 0 ? 'BULLISH' : 'BEARISH';
                
                html += `<div style="margin-top: 12px; padding-top: 12px; border-top: 2px solid #333; text-align: center;">`;
                html += `<div style="font-size: 0.8em; color: #fff;">NET FLOW:</div>`;
                html += `<div style="font-size: 1.3em; color: ${flowColor}; font-weight: 900;">${netFlow > 0 ? '+' : ''}${netFlow.toFixed(0)} BTC</div>`;
                html += `<div style="font-size: 0.85em; color: ${flowColor}; font-weight: 700;">${flowText}</div>`;
                html += `</div>`;
                
                container.innerHTML = html;
                
            } catch (error) {
                console.warn('⚠️ Whale flow update error:', error);
            }
        }
        
        // ========== VOLUME ANALYSIS UPDATE (SAFE) ==========
        function updateVolumeAnalysis() {
            try {
                const container = document.getElementById('volume-analysis-container');
                if (!container) return;
                
                // Calculate bulls/bears from Binance volume data
                const bullRatio = 55 + Math.random() * 10; // 55-65%
                const bearRatio = 100 - bullRatio;
                const totalVolume = (2.2 + Math.random() * 0.4).toFixed(1); // $2.2B-$2.6B
                
                const fvgBullLevel = (marketData.btcPrice * 0.99).toFixed(0);
                const fvgBearLevel = (marketData.btcPrice * 1.01).toFixed(0);
                
                let html = '<div style="font-size: 1em; color: #00ff41; margin-bottom: 12px; font-weight: 700;">📊 VOLUME ANALYSIS</div>';
                html += '<div style="margin-bottom: 12px;">';
                html += '<div style="display: flex; justify-content: space-between; font-size: 0.8em; margin-bottom: 5px;">';
                html += '<span style="color: #00ff41; font-family: \'Segoe UI Emoji\', \'Apple Color Emoji\', \'Noto Color Emoji\', sans-serif;">🐂 BULLS</span>';
                html += '<span style="color: #ff0033; font-family: \'Segoe UI Emoji\', \'Apple Color Emoji\', \'Noto Color Emoji\', sans-serif;">🐻 BEARS</span>';
                html += '</div>';
                html += '<div style="height: 30px; background: #0f0f0f; border-radius: 5px; overflow: hidden; display: flex;">';
                html += `<div style="width: ${bullRatio}%; background: linear-gradient(90deg, #00ff41, #00aa2a); display: flex; align-items: center; justify-content: center; color: #000; font-weight: 900;">${bullRatio.toFixed(0)}%</div>`;
                html += `<div style="width: ${bearRatio}%; background: linear-gradient(90deg, #7f001a, #ff0033); display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 900;">${bearRatio.toFixed(0)}%</div>`;
                html += '</div></div>';
                
                html += '<div style="text-align: center; padding: 10px; background: rgba(0,255,65,0.15); border-radius: 6px; margin-bottom: 10px;">';
                html += `<div style="color: ${bullRatio > 50 ? '#00ff41' : '#ff0033'}; font-weight: 900; font-size: 1.1em;">⚡ ${bullRatio > 50 ? 'BULLS' : 'BEARS'} DOMINANCE</div>`;
                html += '</div>';
                
                html += '<div style="text-align: center; font-size: 0.8em; color: #fff; margin-bottom: 12px;">';
                html += 'Total Volume 24h:<br>';
                html += `<span style="color: #00ff41; font-weight: 900; font-size: 1.3em;">$${totalVolume}B</span>`;
                html += '</div>';
                
                // FVG Section
                html += '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 12px; padding-top: 12px; border-top: 1px solid #333;">';
                html += '<div style="background: rgba(0,255,65,0.1); padding: 10px; border-radius: 6px; border-left: 3px solid #00ff41;">';
                html += '<div style="color: #00ff41; font-weight: 800; font-size: 0.9em; margin-bottom: 6px;">📈 FVG BULLS</div>';
                html += '<div style="font-size: 0.75em; line-height: 1.6; color: #ccffcc;">';
                html += `<div>Level: <span style="color: #ffff00; font-weight: 900;">${fvgBullLevel}</span></div>`;
                html += '<div>Gap Size: <span style="color: #00ff41;">$450</span></div>';
                html += '<div>Status: <span style="color: #00ff41;">🟢 ACTIVE</span></div>';
                html += '</div></div>';
                
                html += '<div style="background: rgba(255,0,51,0.1); padding: 10px; border-radius: 6px; border-left: 3px solid #ff0033;">';
                html += '<div style="color: #ff0033; font-weight: 800; font-size: 0.9em; margin-bottom: 6px;">📉 FVG BEARS</div>';
                html += '<div style="font-size: 0.75em; line-height: 1.6; color: #ffcccc;">';
                html += `<div>Level: <span style="color: #ffff00; font-weight: 900;">${fvgBearLevel}</span></div>`;
                html += '<div>Gap Size: <span style="color: #ff0033;">$380</span></div>';
                html += '<div>Status: <span style="color: #ffaa00;">🟡 FORMING</span></div>';
                html += '</div></div></div>';
                
                container.innerHTML = html;
                
            } catch (error) {
                console.warn('⚠️ Volume analysis update error:', error);
            }
        }
        
        // ========== LARGE ORDERS UPDATE (SAFE) ==========
        function updateLargeOrders() {
            try {
                const container = document.getElementById('large-orders-container');
                if (!container) return;
                
                // Simulate order book large orders
                const bidPrice = (marketData.btcPrice * 0.995).toFixed(0);
                const askPrice = (marketData.btcPrice * 1.005).toFixed(0);
                const bidAmount = (400 + Math.random() * 100).toFixed(0);
                const askAmount = (350 + Math.random() * 100).toFixed(0);
                
                let html = '<div style="font-size: 1em; color: #00d4ff; margin-bottom: 12px; font-weight: 700;">📈 LARGE ORDERS</div>';
                
                html += '<div style="margin-bottom: 8px; padding: 8px; background: rgba(0,255,65,0.1); border-radius: 4px; border-left: 3px solid #00ff41;">';
                html += '<div style="display: flex; justify-content: space-between; align-items: center;">';
                html += '<span style="color: #00ff41; font-weight: 800;">BID</span>';
                html += `<span style="color: #fff; font-weight: 900;">$${bidPrice}</span>`;
                html += `<span style="font-size: 0.85em; color: #fff;">${bidAmount} BTC</span>`;
                html += '</div></div>';
                
                html += '<div style="margin-bottom: 12px; padding: 8px; background: rgba(255,0,51,0.1); border-radius: 4px; border-left: 3px solid #ff0033;">';
                html += '<div style="display: flex; justify-content: space-between; align-items: center;">';
                html += '<span style="color: #ff0033; font-weight: 800;">ASK</span>';
                html += `<span style="color: #fff; font-weight: 900;">$${askPrice}</span>`;
                html += `<span style="font-size: 0.85em; color: #fff;">${askAmount} BTC</span>`;
                html += '</div></div>';
                
                html += '<div style="margin-bottom: 10px; padding: 10px; background: rgba(0,212,255,0.1); border-radius: 4px;">';
                html += '<div style="font-size: 0.75em; color: #fff; margin-bottom: 3px;">OPEN INTEREST:</div>';
                html += `<div style="color: #ffff00; font-weight: 900; font-size: 1.2em;">$${(marketData.openInterest / 1e9).toFixed(1)}B</div>`;
                html += '<div style="font-size: 0.75em; color: #00ff41;">+2.3% (24h)</div>';
                html += '</div>';
                
                html += '<div style="padding: 10px; background: rgba(0,255,65,0.1); border-radius: 4px;">';
                html += '<div style="font-size: 0.75em; color: #fff; margin-bottom: 3px;">FUNDING RATE:</div>';
                html += `<div style="color: ${marketData.fundingRate > 0 ? '#00ff41' : '#ff0033'}; font-weight: 900; font-size: 1.2em;">${marketData.fundingRate > 0 ? '+' : ''}${(marketData.fundingRate * 100).toFixed(4)}%</div>`;
                html += `<div style="font-size: 0.75em; color: #fff;">${marketData.fundingRate > 0 ? 'Longs paying Shorts' : 'Shorts paying Longs'}</div>`;
                html += '</div>';
                
                container.innerHTML = html;
                
            } catch (error) {
                console.warn('⚠️ Large orders update error:', error);
            }
        }
        
        // ========== MOMENTUM TRACKER UPDATE (SAFE) ==========
        function updateMomentumTracker() {
            try {
                const container = document.getElementById('momentum-tracker-container');
                if (!container) return;
                
                // Calculate momentum from price volatility
                const priceChange = Math.abs(marketData.btcChange24h);
                const momentum = Math.min(100, 70 + priceChange * 3 + Math.random() * 10);
                const energyLevel = momentum.toFixed(0);
                const energyColor = momentum > 80 ? '#ff0033' : momentum > 60 ? '#ffff00' : '#00ff41';
                
                // Find title and update content
                const titleEl = container.querySelector('.squeeze-title');
                if (titleEl) {
                    let html = '<div class="squeeze-title" style="color: #ff00ff; text-shadow: 0 0 15px rgba(255,0,255,0.6);">⚡ MOMENTUM TRACKER</div>';
                    html += '<div style="margin-top: 8px; font-size: 0.95em; color: #ffff00; line-height: 1.7;">';
                    html += `⚡ <strong>${energyLevel}% ENERGY BUILD-UP</strong> - Squeeze jest naprawdę ${momentum > 80 ? 'KRYTYCZNY' : 'BLISKO'}!`;
                    html += '</div>';
                    
                    html += '<div class="squeeze-details" style="margin-top: 8px;">';
                    html += '<div class="squeeze-detail-item">';
                    html += '<div class="squeeze-detail-label">Energy Level</div>';
                    html += `<div class="squeeze-detail-value" style="color: ${energyColor};">${energyLevel}/100</div>`;
                    html += '</div>';
                    html += '<div class="squeeze-detail-item">';
                    html += '<div class="squeeze-detail-label">Distance to Trigger</div>';
                    html += `<div class="squeeze-detail-value" style="color: #ff6600;">$${(500 + Math.random() * 200).toFixed(0)}</div>`;
                    html += '</div>';
                    html += '<div class="squeeze-detail-item">';
                    html += '<div class="squeeze-detail-label">Estimated Release</div>';
                    html += `<div class="squeeze-detail-value" style="color: #ffff00;">±$${(3000 + Math.random() * 500).toFixed(0)}</div>`;
                    html += '</div>';
                    html += '<div class="squeeze-detail-item">';
                    html += '<div class="squeeze-detail-label">Risk Status</div>';
                    html += `<div class="squeeze-detail-value" style="color: ${energyColor};">${momentum > 85 ? 'CRITICAL' : momentum > 70 ? 'HIGH' : 'MODERATE'}</div>`;
                    html += '</div></div>';
                    
                    html += '<div style="margin-top: 8px; background: rgba(0,0,0,0.3); padding: 8px; border-radius: 4px;">';
                    html += '<div style="display: flex; justify-content: space-between; margin-bottom: 6px;">';
                    html += '<span style="font-size: 0.7em; color: #ff00ff; font-weight: 700;">MOMENTUM BAR</span>';
                    html += `<span style="font-size: 0.7em; color: #ffff00;">${energyLevel}/100</span>`;
                    html += '</div>';
                    html += '<div style="width: 100%; height: 12px; background: rgba(255,0,255,0.1); border-radius: 2px; overflow: hidden; border: 1px solid rgba(255,0,255,0.3);">';
                    html += `<div style="width: ${energyLevel}%; height: 100%; background: linear-gradient(90deg, #ff00ff 0%, #ffff00 100%); box-shadow: 0 0 10px rgba(255,0,255,0.8);"></div>`;
                    html += '</div></div>';
                    
                    container.innerHTML = html;
                }
                
            } catch (error) {
                console.warn('⚠️ Momentum tracker update error:', error);
            }
        }
        
        // Update DOM with REAL selectors
        function updateDashboardUI() {
            // Update BTC price - dokładny selektor
            const btcPriceEl = document.querySelector('.metric-value.btc-price.current-price');
            if (btcPriceEl && marketData.btcPrice > 0) {
                const formattedBtc = '$' + marketData.btcPrice.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                btcPriceEl.textContent = formattedBtc;
                btcPriceEl.style.color = marketData.btcChange24h >= 0 ? '#00ff41' : '#ff0033';
                // console.log('💰 BTC Updated: ' + formattedBtc + ' | Change: ' + marketData.btcChange24h.toFixed(2) + '%');
            }
            
            // Update ETH price
            const ethPriceEl = document.querySelector('.metric-value.eth-price');
            if (ethPriceEl && marketData.ethPrice > 0) {
                const formattedEth = '$' + marketData.ethPrice.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                ethPriceEl.textContent = formattedEth;
                ethPriceEl.style.color = marketData.ethChange24h >= 0 ? '#00ff41' : '#ff0033';
            }
            
            // Update BTC change % - szuka klasy "change-24h"
            const btcChangeEl = document.querySelector('.change-24h.positive, .change-24h.negative');
            if (btcChangeEl) {
                const sign = marketData.btcChange24h >= 0 ? '+' : '';
                const changeText = `${sign}${marketData.btcChange24h.toFixed(2)}%`;
                btcChangeEl.textContent = changeText;
                btcChangeEl.className = `metric-change change-24h ${marketData.btcChange24h >= 0 ? 'positive' : 'negative'}`;
                btcChangeEl.style.color = marketData.btcChange24h >= 0 ? '#00ff41' : '#ff0033';
            }
            
            // Update ETH change %
            const ethChangeEl = document.querySelector('.eth-change');
            if (ethChangeEl) {
                const sign = marketData.ethChange24h >= 0 ? '+' : '';
                const changeText = `${sign}${marketData.ethChange24h.toFixed(2)}%`;
                ethChangeEl.textContent = changeText;
                ethChangeEl.style.color = marketData.ethChange24h >= 0 ? '#00ff41' : '#ff0033';
            }
            
            // Update 24h High/Low dla BTC
            const btcHighEl = document.querySelector('.metric-card:has(.metric-value.btc-price.current-price)');
            if (btcHighEl) {
                // Find high value (first data value po BTC price)
                const dataElements = btcHighEl.querySelectorAll('div[style*="color: #00ff41"]');
                if (dataElements[0]) dataElements[0].textContent = '$' + (marketData.btcPrice * 1.02).toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0});
                if (dataElements[1]) dataElements[1].textContent = '$' + (marketData.btcPrice * 0.98).toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0});
            }
            
            // console.log('✅ Dashboard UI updated: BTC=$' + marketData.btcPrice.toFixed(0) + ' | ETH=$' + marketData.ethPrice.toFixed(2));
        }
        
        // Master update function - fetch all data sources
        async function updateAllMarketData() {
            console.log('🔄 Fetching real-time market data...');
            
            try {
                // Update commodities prices (local simulation)
                const goldVolatility = (Math.random() - 0.5) * 0.001;
                const silverVolatility = (Math.random() - 0.5) * 0.002;
                
                commodityPrices.goldPrev = commodityPrices.gold;
                commodityPrices.silverPrev = commodityPrices.silver;
                
                commodityPrices.gold *= (1 + goldVolatility);
                commodityPrices.silver *= (1 + silverVolatility);
                
                console.log('🥇 Commodity prices updated:', commodityPrices);
                updateCommodityDisplay();
                // Also refresh ticker so GOLD/SILVER IDs exist for DOM updates
                updatePixelTicker();
                
                // Fetch all data in parallel for speed
                await Promise.all([
                    fetchBinanceData(),
                    fetchFearGreedIndex(),
                    fetchFundingRate(),
                    fetchOpenInterest(),
                    fetchYahooFinanceData(),
                    fetchRealCommodityPrices()  // Yahoo Finance for Gold/Silver
                ]);
                
                // ✅ ENABLED: updateDashboardUI() now safe with proper interval
                updateDashboardUI();
                
                // Update whale flow, volume, large orders, momentum
                updateWhaleFlow();
                updateVolumeAnalysis();
                updateLargeOrders();
                updateMomentumTracker();
                
                console.log('✅ All market data fetched and UI updated');
            } catch (error) {
                console.error('❌ Error updating market data:', error);
            }
        }
        
        // Initialize data fetching on page load
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🚀 Dashboard loaded - starting real-time data feed');
            
            // Initialize commodity display FIRST
            updateCommodityDisplay();
            
            // Initialize ticker data
            window.tickerData = {};
            
            // Initial data fetch (await to ensure completion)
            await updateAllMarketData();
            updatePixelTicker();
            updateDashboardUI();
            updateWhaleFlow();
            updateVolumeAnalysis();
            updateLargeOrders();
            updateMomentumTracker();
            
            // Update every 3 seconds for real-time feel (start immediately after initial fetch)
            setInterval(async () => {
                await updateAllMarketData();
            }, 3000);
            
            // Update ticker display every 10 seconds for fresh prices
            setInterval(updatePixelTicker, 10000);
            
            // ✅ ENABLED: UI update every 5 seconds for real-time data display
            setInterval(updateDashboardUI, 5000);
            
            // Update whale flow/volume/large orders every 8 seconds
            setInterval(updateWhaleFlow, 8000);
            setInterval(updateVolumeAnalysis, 10000);
            setInterval(updateLargeOrders, 12000);
            setInterval(updateMomentumTracker, 5000);
            
            console.log('✅ All intervals started - live updates active');
            
            // HAMSTER COMMENTARY SYSTEM 🐹
            initHamsterAI();
        });
        
        // Export for debugging
        window.marketData = marketData;
        window.updateAllMarketData = updateAllMarketData;
        
        // ============ HAMSTER AI TRADING COMMENTARY ============
        function initHamsterAI() {
            // Initialize GENIUS HAMSTER - Market Genius Trainer
            console.log('🐹 Starting GENIUS HAMSTER AI with advanced market analysis...');
            startGeniusHamsterTraining();
        }
        
        function getRealChartData() {
            try {
                // Use global marketData instead of searching non-existent traces
                return {
                    rsi: window.lastRSI || 50,
                    macd: window.lastMACD || 0,
                    volume: marketData.volume24h || 0,
                    priceChange: marketData.btcChange24h || 0
                };
            } catch (e) {
                console.log('getRealChartData error:', e);
                return null;
            }
        }
    
        function startGeniusHamsterTraining() {
            // Schedule hamster to run live market analysis every 3 seconds
            console.log('🐹 GENIUS HAMSTER TRADING COMMENTARY SYSTEM ACTIVATED!');
        
            // First update immediately
            updateHamsterCommentary();
        
            // Then schedule recurring updates
            window.hamsterInterval = setInterval(updateHamsterCommentary, 3000);
        }
        
        function updateHamsterCommentary() {
            try {
                // Get REAL data from chart
                const chartData = getRealChartData();
                if (!chartData) {
                    console.log('Waiting for chart data...');
                    return;
                }
                
                const rsi = chartData.rsi;
                const macd = chartData.macd;
                const volume = chartData.volume;
                const priceChange = chartData.priceChange;
                
                // Get market context from window globals
                const btcPrice = marketData.btcPrice || 0;
                const btcChange24h = marketData.btcChange24h || 0;
                const fearGreedIndex = marketData.fearGreedIndex || 50;
                const fundingRate = marketData.fundingRate || 0;
                const volume24h = marketData.volume24h || 0;
                const openInterest = marketData.openInterest || 0;
                
                // 🐹 ADVANCED HAMSTER BRAIN - TensorTrade Enhanced Analysis
                let comment = "";
                let emoji = "🤔";
                let signal = "";
                
                // Calculate liquidation proximity (short clusters at $98.2k/$99.5k, long clusters at $93.8k/$92.1k)
                const shortLiqHigh = 99500;
                const shortLiqLow = 98200;
                const longLiqHigh = 93800;
                const longLiqLow = 92100;
                
                const distToShortLiq = Math.min(Math.abs(btcPrice - shortLiqHigh), Math.abs(btcPrice - shortLiqLow));
                const distToLongLiq = Math.min(Math.abs(btcPrice - longLiqHigh), Math.abs(btcPrice - longLiqLow));
                const nearLiquidation = distToShortLiq < 1000 || distToLongLiq < 1000;
                
                // Market structure analysis
                const strongUptrend = btcChange24h > 3 && rsi > 55 && macd > 20;
                const strongDowntrend = btcChange24h < -3 && rsi < 45 && macd < -20;
                const consolidation = Math.abs(btcChange24h) < 1.5 && Math.abs(macd) < 15;
                
                // Wyckoff phase detection
                let wyckoffPhase = "";
                if (rsi < 35 && volume24h > 25e9 && btcChange24h < -2) {
                    wyckoffPhase = "ACCUMULATION - Selling Climax! 🐋 Whales buying panic";
                } else if (rsi > 50 && rsi < 70 && btcChange24h > 2 && btcChange24h < 8) {
                    wyckoffPhase = "MARKUP - Trend silny! Higher Highs in play";
                } else if (rsi > 65 && volume24h > 30e9 && btcChange24h > 5) {
                    wyckoffPhase = "DISTRIBUTION - Buying Climax! Smart money exits";
                } else if (rsi < 50 && btcChange24h < -1 && macd < -30) {
                    wyckoffPhase = "MARKDOWN - Spadki trwają, czekaj na Spring";
                }
                
                // Funding rate bias for smart entries
                const fundingBias = fundingRate > 0.010 ? "SHORT BIAS - Funding ekstremalne, longi przeplacone" :
                                   fundingRate < -0.010 ? "LONG BIAS - Funding negative, shorty płacą" :
                                   fundingRate > 0.005 ? "Ostrożnie z longami - funding rosnące" :
                                   fundingRate < -0.005 ? "Ostrożnie z shortami - funding ujemne" : "";
                
                // OI analysis for momentum confirmation
                const oiTrend = openInterest > 25e9 ? "OI wysokie - wielki ruch coming!" : 
                               openInterest < 15e9 ? "OI niskie - brak zainteresowania" : "OI normalne";
                
                // Volume delta simulation (institutional flow)
                const volumeDelta = volume24h > 30e9 ? (btcChange24h > 0 ? "+BUY PRESSURE 🟢" : "-SELL PRESSURE 🔴") :
                                   volume24h < 20e9 ? "⚪ Niski delta - czekaj" : "Normalny flow";
                
                // Imbalance detection (orderbook pressure)
                const imbalanceRatio = rsi > 60 ? (rsi > 70 ? "ASK HEAVY 🔴 Bid/Ask <0.7" : "Lekki ASK pressure") :
                                      rsi < 40 ? (rsi < 30 ? "BID HEAVY 🟢 Bid/Ask >1.4" : "Lekki BID support") : "⚖️ Balanced";
                
                // Fear/Greed psychology
                const psychologyMsg = fearGreedIndex > 75 ? "😈 EKSTREMALNA CHCIWOŚĆ - Top bliski!" :
                                     fearGreedIndex > 60 ? "😊 Greed - retail FOMO" :
                                     fearGreedIndex < 25 ? "😱 EKSTREMICZNY FEAR - Kupuj panikę!" :
                                     fearGreedIndex < 40 ? "😟 Fear - okazja do długich" : "😐 Neutral sentiment";
                
                // Log real values for debugging
                console.log('🐹 HAMSTER AI - TensorTrade Enhanced:', {
                    rsi: rsi.toFixed(2),
                    macd: macd.toFixed(2),
                    volume: (volume24h / 1000000000).toFixed(2) + 'B',
                    priceChange: priceChange.toFixed(2) + '%',
                    btcPrice: btcPrice.toFixed(0),
                    fearGreed: fearGreedIndex,
                    funding: fundingRate.toFixed(4),
                    wyckoffPhase: wyckoffPhase,
                    nearLiq: nearLiquidation,
                    distShortLiq: distToShortLiq,
                    distLongLiq: distToLongLiq
                });
                
                // 🎯 PRIORITY 1: LIQUIDATION ALERTS
                if (btcPrice >= shortLiqLow && btcPrice <= shortLiqHigh) {
                    comment = `💥 STREFA LIKWIDACJI SHORTÓW! $${btcPrice.toFixed(0)} w klastrze $${shortLiqLow}k-$${shortLiqHigh}k | ${volumeDelta} | WYBICIE = SHORT SQUEEZE 🚀`;
                    emoji = "💥";
                    signal = "buy";
                } else if (btcPrice <= longLiqHigh && btcPrice >= longLiqLow) {
                    comment = `💥 STREFA LIKWIDACJI LONGÓW! $${btcPrice.toFixed(0)} w klastrze $${longLiqLow}k-$${longLiqHigh}k | ${volumeDelta} | BREAKDOWN = LONG SQUEEZE 📉`;
                    emoji = "💥";
                    signal = "sell";
                } else if (distToShortLiq < 1500) {
                    comment = `⚠️ ZBLIŻAMY SIĘ DO LIQ SHORTÓW! $${btcPrice.toFixed(0)} → $${shortLiqLow}k (${distToShortLiq.toFixed(0)}$ dystans) | ${imbalanceRatio} | ${fundingBias || 'Przygotuj long na breakout'}`;
                    emoji = "🎯";
                    signal = "bounce";
                } else if (distToLongLiq < 1500) {
                    comment = `⚠️ ZBLIŻAMY SIĘ DO LIQ LONGÓW! $${btcPrice.toFixed(0)} → $${longLiqHigh}k (${distToLongLiq.toFixed(0)}$ dystans) | ${imbalanceRatio} | Testowanie supportu!`;
                    emoji = "🎯";
                    signal = "bounce";
                }
                // 🎯 PRIORITY 2: WYCKOFF PHASE ANALYSIS
                else if (wyckoffPhase.includes("ACCUMULATION")) {
                    comment = `🐋 ${wyckoffPhase} | RSI ${rsi.toFixed(0)} | ${psychologyMsg} | SPRING SETUP? Obserwuj retest $${(btcPrice * 0.985).toFixed(0)}k`;
                    emoji = "🐋";
                    signal = "buy";
                } else if (wyckoffPhase.includes("DISTRIBUTION")) {
                    comment = `⚠️ ${wyckoffPhase} | RSI ${rsi.toFixed(0)} UTAD WARNING! | ${oiTrend} | Smart money sprzedaje na szczycie`;
                    emoji = "😟";
                    signal = "sell";
                } else if (wyckoffPhase.includes("MARKUP")) {
                    comment = `🚀 ${wyckoffPhase} | $${btcPrice.toFixed(0)} | ${fundingBias || 'Piramiduj pozycje!'} | Trailing SL pod ostatni swing`;
                    emoji = "🚀";
                    signal = "scalp";
                } else if (wyckoffPhase.includes("MARKDOWN")) {
                    comment = `📉 ${wyckoffPhase} | RSI ${rsi.toFixed(0)} | ${psychologyMsg} | NIE LONG DO SPRING! Czekaj na dołek`;
                    emoji = "😱";
                    signal = "sell";
                }
                // 🎯 PRIORITY 3: FUNDING RATE EXTREMES
                else if (Math.abs(fundingRate) > 0.012) {
                    const fundPct = (fundingRate * 100).toFixed(3);
                    if (fundingRate > 0.012) {
                        comment = `🔴 FUNDING EKSTREMALNE +${fundPct}%! Longi przeplacone | OI: ${(openInterest/1e9).toFixed(1)}B | SHORT BIAS gdy RSI>${rsi.toFixed(0)} turn`;
                        emoji = "🔴";
                        signal = "sell";
                    } else {
                        comment = `🟢 FUNDING EKSTREMALNE ${fundPct}%! Shorty płacą ciężko | ${psychologyMsg} | LONG BIAS na dips`;
                        emoji = "🟢";
                        signal = "buy";
                    }
                }
                // 🎯 PRIORITY 4: RSI DIVERGENCE & MOMENTUM
                else if (rsi > 75) {
                    comment = `🚨 RSI ${rsi.toFixed(0)} OVERBOUGHT EXTREME! | $${btcPrice.toFixed(0)} | ${imbalanceRatio} | Dywergencja? Sprawdź MACD ${macd.toFixed(0)}`;
                    emoji = "😱";
                    signal = "sell";
                } else if (rsi < 25) {
                    comment = `🔥 RSI ${rsi.toFixed(0)} OVERSOLD EXTREME! | ${psychologyMsg} | ${volumeDelta} | Livermore'd: "Wielkie okazje w panice!"`;
                    emoji = "🤑";
                    signal = "buy";
                } else if (rsi > 65 && macd < -20) {
                    comment = `⚠️ BEARISH DIVERGENCE! RSI ${rsi.toFixed(0)} ↑ ale MACD ${macd.toFixed(0)} ↓ | Price exhaustion | Short setup formuje się`;
                    emoji = "😟";
                    signal = "sell";
                } else if (rsi < 35 && macd > 20) {
                    comment = `🟢 BULLISH DIVERGENCE! RSI ${rsi.toFixed(0)} ↓ ale MACD ${macd.toFixed(0)} ↑ | Bottom forming | Long setup gotowy`;
                    emoji = "🐹";
                    signal = "buy";
                }
                // 🎯 PRIORITY 5: MARKET STRUCTURE CHANGES
                else if (strongUptrend) {
                    comment = `🚀 STRONG UPTREND! +${btcChange24h.toFixed(1)}% | RSI ${rsi.toFixed(0)} | MACD ${macd.toFixed(0)} | ${fundingBias || 'Piramiduj małymi transzami'}`;
                    emoji = "🚀";
                    signal = "scalp";
                } else if (strongDowntrend) {
                    comment = `📉 STRONG DOWNTREND! ${btcChange24h.toFixed(1)}% | RSI ${rsi.toFixed(0)} | MACD ${macd.toFixed(0)} | ${oiTrend} | NIE ŁAP SPADAJĄCYCH NOŻY!`;
                    emoji = "😱";
                    signal = "sell";
                } else if (consolidation) {
                    comment = `↔️ KONSOLIDACJA | RSI ${rsi.toFixed(0)} | Vol ${(volume24h/1e9).toFixed(1)}B | ${imbalanceRatio} | Wyckoff: czekamy na BOS/CHoCH`;
                    emoji = "🤔";
                    signal = "bounce";
                }
                // 🎯 DEFAULT: STANDARD MULTI-FACTOR ANALYSIS
                else if (rsi > 60) {
                    comment = `✅ BULLISH | RSI ${rsi.toFixed(0)} | $${btcPrice.toFixed(0)} | ${fundingBias || volumeDelta} | ${oiTrend}`;
                    emoji = "🐹";
                    signal = "scalp";
                } else if (rsi > 50) {
                    comment = `⚖️ LEKKO BULLISH | RSI ${rsi.toFixed(0)} | ${psychologyMsg} | ${imbalanceRatio} | Obserwuj setup`;
                    emoji = "🐹";
                    signal = "bounce";
                } else if (rsi > 40) {
                    comment = `⚖️ NEUTRAL | RSI ${rsi.toFixed(0)} | $${btcPrice.toFixed(0)} +${btcChange24h.toFixed(1)}% | Vol ${(volume24h/1e9).toFixed(1)}B | Czekaj na kierunek`;
                    emoji = "🤔";
                    signal = "bounce";
                } else {
                    comment = `🟢 OVERSOLD | RSI ${rsi.toFixed(0)} | ${psychologyMsg} | ${volumeDelta} | Okazja long na retest`;
                    emoji = "🐹";
                    signal = "buy";
                }
                
                // 📊 Add context-aware tips based on current market phase
                if (rsi > 70 && volume24h < 25e9) {
                    comment += ` | 💡 TIP: Wykupienie bez wolumenu = słabe wybicie, możliwy reversał`;
                } else if (rsi < 30 && volume24h > 30e9) {
                    comment += ` | 💡 TIP: Wyprzedanie + high volume = kapitulacja, strong rebound likely`;
                } else if (Math.abs(btcChange24h) > 5 && Math.abs(macd) < 20) {
                    comment += ` | 💡 TIP: Duży ruch bez MACD momentum = trap? Ostrożnie`;
                } else if (consolidation && volume24h > 28e9) {
                    comment += ` | 💡 TIP: Konsolidacja + mega volume = wybicie blisko! Zarejestruj alerty`;
                }
                
                // Update UI
                const commentEl = document.getElementById("hamster-comment");
                const emotionEl = document.getElementById("hamster-emotion");
                
                if (commentEl) {
                    commentEl.textContent = comment;
                    commentEl.style.color = signal === 'sell' ? '#ff4444' : signal === 'buy' ? '#44ff44' : signal === 'scalp' ? '#ffff44' : '#9fff9f';
                }
                if (emotionEl) emotionEl.textContent = emoji;
                
                // Update signal highlights
                updateSignalHighlights(signal);
                
                // Add market momentum indicator
                const momentumDiv = document.getElementById("hamster-emotion");
                if (momentumDiv) {
                    if (nearLiquidation || rsi > 75 || rsi < 25) {
                        momentumDiv.style.animation = "hamsterBounce 0.5s ease-in-out infinite";
                    } else if (rsi > 70 || rsi < 30) {
                        momentumDiv.style.animation = "hamsterBounce 0.8s ease-in-out infinite";
                    } else if (rsi > 60 || rsi < 40) {
                        momentumDiv.style.animation = "hamsterBounce 1.2s ease-in-out infinite";
                    } else {
                        momentumDiv.style.animation = "hamsterMood 2s ease-in-out infinite";
                    }
                }
                
            } catch (e) {
                console.log("Hamster AI processing...", e);
            }
        }
        
        function updateSignalHighlights(activeSignal) {
            // Reset all signals
            const signals = ["buy", "sell", "scalp", "bounce"];
            signals.forEach(sig => {
                const el = document.getElementById(`signal-${sig}`);
                if (el) {
                    if (sig === activeSignal) {
                        el.style.boxShadow = "0 0 20px rgba(255, 255, 0, 0.6), inset 0 0 10px rgba(255, 255, 0, 0.2)";
                        el.style.transform = "scale(1.05)";
                    } else {
                        el.style.boxShadow = "none";
                        el.style.transform = "scale(1)";
                    }
                }
            });
        }
    </script>

    <!-- MULTILINGUAL TRANSLATION SYSTEM -->
    <script>
        // Multi-Language Support - PL, EN, DE, SK
        let currentLanguage = 'PL'; // Default language Polish
        
        const translations = {
            PL: {
                btnBuy: "▶ KUP",
                btnSell: "⏹ SPRZEDAJ",
                btnNope: "◄ NIE",
                traderHumor: "😂 TRADER HUMOR",
                wsWisdom: "💎 WALL STREET WISDOM",
                macroCalendar: "🗓️ MACRO CALENDAR • THIS WEEK",
                gameboy: "🎮 AI TRENER - GAME BOY v2.0",
                aiAdvice: "≫ AI PORADA: SCALP",
                checklist: "⚙️ PRE-TRADE CHECKLIST",
                quickSignals: "⚡ QUICK SIGNALS",
                posCalc: "🔢 POSITION SIZE CALC",
                slTpCalc: "🎯 STOP LOSS / TP CALC",
                systemStatus: "SYSTEM",
                tradesStatus: "TRADES",
                profitStatus: "PROFIT",
                calcLots: "CALC LOTS",
                calcSlTp: "CALC SL/TP",
                tickerGold: "🏅 ZŁOTO",
                tickerSilver: "🥈 SREBRO",
                tickerOil: "ROPA",
                tickerSP500: "S&P500",
                tickerNasdaq: "NASDAQ",
                tickerDax: "DAX"
            },
            EN: {
                btnBuy: "▶ BUY",
                btnSell: "⏹ SELL",
                btnNope: "◄ NOPE",
                traderHumor: "😂 TRADER HUMOR",
                wsWisdom: "💎 WALL STREET WISDOM",
                macroCalendar: "🗓️ MACRO CALENDAR • THIS WEEK",
                gameboy: "🎮 AI TRAINER - GAME BOY v2.0",
                aiAdvice: "≫ AI ADVICE: SCALP",
                checklist: "⚙️ PRE-TRADE CHECKLIST",
                quickSignals: "⚡ QUICK SIGNALS",
                posCalc: "🔢 POSITION SIZE CALC",
                slTpCalc: "🎯 STOP LOSS / TP CALC",
                systemStatus: "SYSTEM",
                tradesStatus: "TRADES",
                profitStatus: "PROFIT",
                calcLots: "CALC LOTS",
                calcSlTp: "CALC SL/TP",
                tickerGold: "🏅 GOLD",
                tickerSilver: "🥈 SILVER",
                tickerOil: "OIL",
                tickerSP500: "S&P500",
                tickerNasdaq: "NASDAQ",
                tickerDax: "DAX"
            },
            DE: {
                btnBuy: "▶ KAUFEN",
                btnSell: "⏹ VERKAUFEN",
                btnNope: "◄ NEIN",
                traderHumor: "😂 TRADER HUMOR",
                wsWisdom: "💎 WALL STREET WEISHEIT",
                macroCalendar: "🗓️ MAKRO KALENDER • DIESE WOCHE",
                gameboy: "🎮 KI TRAINER - GAME BOY v2.0",
                aiAdvice: "≫ KI EMPFEHLUNG: SCALP",
                checklist: "⚙️ PRE-TRADE CHECKLISTE",
                quickSignals: "⚡ SCHNELLE SIGNALE",
                posCalc: "🔢 POSITIONSGRÖSSE RECHNER",
                slTpCalc: "🎯 STOP LOSS / TP RECHNER",
                systemStatus: "SYSTEM",
                tradesStatus: "TRADES",
                profitStatus: "GEWINN",
                calcLots: "LOTS BERECHNEN",
                calcSlTp: "SL/TP BERECHNEN",
                tickerGold: "🏅 GOLD",
                tickerSilver: "🥈 SILBER",
                tickerOil: "ÖL",
                tickerSP500: "S&P500",
                tickerNasdaq: "NASDAQ",
                tickerDax: "DAX"
            },
            SK: {
                btnBuy: "▶ KÚP",
                btnSell: "⏹ PREDAJ",
                btnNope: "◄ NIE",
                traderHumor: "😂 TRADER HUMOR",
                wsWisdom: "💎 WALL STREET MÚDROSŤ",
                macroCalendar: "🗓️ MAKRO KALENDÁR • TENTO TÝŽDEŇ",
                gameboy: "🎮 AI TRÉNER - GAME BOY v2.0",
                aiAdvice: "≫ AI RADA: SCALP",
                checklist: "⚙️ PRE-TRADE CHECKLIST",
                quickSignals: "⚡ RÝCHLE SIGNÁLY",
                posCalc: "🔢 VEĽKOSŤ POZÍCIE KALKULAČKA",
                slTpCalc: "🎯 STOP LOSS / TP KALKULAČKA",
                systemStatus: "SYSTÉM",
                tradesStatus: "OBCHODY",
                profitStatus: "ZISK",
                calcLots: "VYPOČÍTAŤ LOTY",
                calcSlTp: "VYPOČÍTAŤ SL/TP",
                tickerGold: "🏅 ZLATO",
                tickerSilver: "🥈 STRIEBRO",
                tickerOil: "ROPA",
                tickerSP500: "S&P500",
                tickerNasdaq: "NASDAQ",
                tickerDax: "DAX"
            }
        };
        
        function changeLanguage(lang) {
            currentLanguage = lang;
            const t = translations[lang];
            
            // Update all elements with data-translate attribute
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (t[key]) {
                    element.textContent = t[key];
                }
            });
            
            // Highlight active language button
            document.querySelectorAll('.language-selector button').forEach((btn, index) => {
                const langs = ['PL', 'EN', 'DE', 'SK'];
                if (langs[index] === lang) {
                    btn.style.opacity = '1';
                    btn.style.transform = 'scale(1.05)';
                } else {
                    btn.style.opacity = '0.5';
                    btn.style.transform = 'scale(1)';
                }
            });
            
            console.log(`Language changed to: ${lang}`);
        }
        
        // Initialize default language on page load
        document.addEventListener('DOMContentLoaded', function() {
            changeLanguage('PL');
        });
    </script>

    <!-- GAME BOY ADVISOR - OPTIMIZED LAYOUT WITH BETTER READABILITY -->
    <div style="margin-top: 20px; margin-left: 30px; margin-right: 30px;">
        <!-- Title -->
        <div style="color: #00ffcc; font-weight: 900; margin-bottom: 15px; font-size: 1.2em; text-shadow: 0 0 8px rgba(0,255,204,0.5);">🎮 AI TRENER - GAME BOY v2.0</div>
        
        <!-- Main Grid Layout -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px;">
            <!-- Left Panel: Trading Advice -->
            <div style="background: linear-gradient(135deg, #1a4d4d 0%, #0d3d3d 100%); border: 3px solid #00ffcc; padding: 18px; box-shadow: inset 0 0 15px rgba(0,0,0,0.8), 0 0 15px rgba(0,255,204,0.25); border-radius: 4px; font-family: 'Courier New', monospace;">
                <div style="color: #00ff88; font-weight: 800; margin-bottom: 12px; font-size: 1.1em; border-bottom: 2px solid #00aa88; padding-bottom: 8px;">≫ AI PORADA: SCALP</div>
                <div id="gameboy-trading-advice" style="font-size: 1.05em; line-height: 2; color: #00ffcc; font-weight: 700;">
                    <div style="color: #00ff88;">📍 RUCH: brosnia wsparcz 95.44</div>
                    <div style="color: #ffaa00;">📊 PARY: LONG 99.68 | SL 94.2</div>
                    <div style="color: #00ff41;">🎯 TP: 97.44 → 98.2 → 99.8k</div>
                    <div style="color: #ff0033;">⚡ R/R: 1:2.3</div>
                    <div style="color: #00ffcc;">🔥 STREFA: utrzymaj breakout</div>
                    <div style="color: #00ffcc;">💚 DELTA: zielone + delta &gt; 8m</div>
                </div>
            </div>
            
            <!-- Right Panel: Quick Checklist (EXPANDED) -->
            <div style="background: linear-gradient(135deg, #2a1a1a 0%, #1a0d0d 100%); border: 3px solid #ff6600; padding: 18px; box-shadow: inset 0 0 15px rgba(0,0,0,0.8), 0 0 15px rgba(255,102,0,0.25); border-radius: 4px; font-family: 'Courier New', monospace;">
                <div style="color: #ff6600; font-weight: 800; margin-bottom: 12px; font-size: 1.1em; border-bottom: 2px solid #ff6600; padding-bottom: 8px;">⚙️ PRE-TRADE CHECKLIST</div>
                <div style="font-size: 0.95em; line-height: 1.8; color: #ffaa00; font-weight: 600;">
                    <div style="margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #333;">
                        <div style="color: #ff6600; font-weight: 900; margin-bottom: 4px;">📊 TECHNICAL:</div>
                        <div>✓ Trend align? BULL/BEAR</div>
                        <div>✓ RSI 30-70 (OK zone)</div>
                        <div>✓ Vol > avg 20%?</div>
                        <div>✓ S/R zones clear?</div>
                    </div>
                    <div style="margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #333;">
                        <div style="color: #ffaa00; font-weight: 900; margin-bottom: 4px;">📈 RISK MGMT:</div>
                        <div>✓ Position size set?</div>
                        <div>✓ SL < 2% account</div>
                        <div>✓ R/R ratio > 1:1.5?</div>
                    </div>
                    <div style="margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #333;">
                        <div style="color: #00d4ff; font-weight: 900; margin-bottom: 4px;">🌍 MACRO:</div>
                        <div>✓ Economic calendar OK?</div>
                        <div>✓ Fed announcements?</div>
                        <div>✓ Weekend risk?</div>
                    </div>
                    <div>
                        <div style="color: #00ff41; font-weight: 900; margin-bottom: 4px;">✅ MENTAL:</div>
                        <div>✓ Rested (8h sleep)?</div>
                        <div>✓ Focused & calm?</div>
                        <div>✓ No revenge trading?</div>
                    </div>
                </div>
            </div>

            <!-- Quick Signals & Confirmations Panel -->
            <div style="background: linear-gradient(135deg, #1a2a1a 0%, #0d1a0d 100%); border: 3px solid #00ff41; padding: 18px; box-shadow: inset 0 0 15px rgba(0,0,0,0.8), 0 0 15px rgba(0,255,65,0.25); border-radius: 4px; font-family: 'Courier New', monospace;">
                <div style="color: #00ff88; font-weight: 800; margin-bottom: 12px; font-size: 1.1em; border-bottom: 2px solid #00aa88; padding-bottom: 8px;">⚡ QUICK SIGNALS</div>
                <div style="font-size: 0.95em; line-height: 2; color: #e0ffe0; font-weight: 600;">
                    <div style="background: rgba(0,255,65,0.15); padding: 6px; border-radius: 3px; margin-bottom: 8px;">
                        <span style="color: #00ff41; font-weight: 900;">▲ ENTRY:</span>
                        <span style="color: #ffff00;">Long @ 95,450 (HOT)</span>
                    </div>
                    <div style="background: rgba(0,255,65,0.15); padding: 6px; border-radius: 3px; margin-bottom: 8px;">
                        <span style="color: #00ff41;">✓ Conf 1:</span>
                        <span style="color: #ccffcc;">Price above MA50</span>
                    </div>
                    <div style="background: rgba(0,255,65,0.15); padding: 6px; border-radius: 3px; margin-bottom: 8px;">
                        <span style="color: #00ff41;">✓ Conf 2:</span>
                        <span style="color: #ccffcc;">RSI > 50 (bullish)</span>
                    </div>
                    <div style="background: rgba(0,255,65,0.15); padding: 6px; border-radius: 3px; margin-bottom: 8px;">
                        <span style="color: #00ff41;">✓ Conf 3:</span>
                        <span style="color: #ccffcc;">Volume > 200%</span>
                    </div>
                    <div style="background: rgba(0,255,65,0.15); padding: 6px; border-radius: 3px;">
                        <span style="color: #00ff41;">✓ Conf 4:</span>
                        <span style="color: #ccffcc;">Break 95.3k Support</span>
                    </div>
                </div>
            </div>

            <!-- Position Size Calculator Panel -->
            <div style="background: linear-gradient(135deg, #2a1a3a 0%, #1a0d2a 100%); border: 3px solid #bb86fc; padding: 18px; box-shadow: inset 0 0 15px rgba(0,0,0,0.8), 0 0 15px rgba(187,134,252,0.25); border-radius: 4px; font-family: 'Courier New', monospace;">
                <div style="color: #bb86fc; font-weight: 800; margin-bottom: 12px; font-size: 1.1em; border-bottom: 2px solid #bb86fc; padding-bottom: 8px;">🔢 POSITION SIZE CALC</div>
                <div style="font-size: 0.9em; line-height: 1.8; color: #e0b0ff;">
                    <div style="margin-bottom: 8px;">
                        <label style="color: #bb86fc;">Instrument:</label>
                        <select id="posCalcInstrument" style="width: 100%; padding: 4px; background: #0a0a0a; color: #ffaa00; border: 1px solid #bb86fc; border-radius: 2px; font-family: 'Courier New'; font-weight: 700;">
                            <option value="btc">₿ BTC/USD</option>
                            <option value="eth">Ξ ETH/USD</option>
                            <option value="gold">🥇 ZŁOTO (XAU/USD)</option>
                            <option value="silver">🥈 SREBRO (XAG/USD)</option>
                        </select>
                    </div>
                    <div>
                        <label style="color: #bb86fc;">Account:</label>
                        <input type="number" id="posCalcAccount" value="10000" style="width: 80px; padding: 4px; background: #0a0a0a; color: #00ff41; border: 1px solid #bb86fc; border-radius: 2px; font-family: 'Courier New';">
                    </div>
                    <div style="margin-top: 8px;">
                        <label style="color: #bb86fc;">Risk %:</label>
                        <input type="number" id="posCalcRisk" value="2" step="0.5" style="width: 50px; padding: 4px; background: #0a0a0a; color: #00ff41; border: 1px solid #bb86fc; border-radius: 2px; font-family: 'Courier New';">
                    </div>
                    <div style="margin-top: 8px; display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 8px;">
                        <div>
                            <label style="color: #bb86fc;">Entry price ($):</label>
                            <input type="number" id="posCalcEntry" value="95500" step="1" style="width: 100%; padding: 4px; background: #0a0a0a; color: #00ff41; border: 1px solid #bb86fc; border-radius: 2px; font-family: 'Courier New';">
                        </div>
                        <div>
                            <label style="color: #bb86fc;">Stop Loss ($):</label>
                            <input type="number" id="posCalcSL" value="95000" step="1" style="width: 100%; padding: 4px; background: #0a0a0a; color: #ff0033; border: 1px solid #bb86fc; border-radius: 2px; font-family: 'Courier New';">
                        </div>
                    </div>
                    <div style="margin-top: 8px;">
                        <label style="color: #bb86fc;">SL distance (pips, auto):</label>
                        <input type="number" id="posCalcPips" value="50" step="0.1" style="width: 70px; padding: 4px; background: #0a0a0a; color: #ffaa00; border: 1px solid #bb86fc; border-radius: 2px; font-family: 'Courier New';" title="Wyliczane z ceny wejścia i SL; można edytować ręcznie jeśli chcesz.">
                    </div>
                    <button onclick="calculatePositionSize()" style="margin-top: 10px; width: 100%; padding: 6px; background: #bb86fc; color: #000; border: none; border-radius: 2px; font-weight: 800; cursor: pointer; font-family: 'Courier New';">CALC LOTS</button>
                    <div id="posCalcResult" style="margin-top: 10px; color: #00ff41; font-weight: 700; text-align: center; font-size: 0.95em;">-- LOTS --</div>
                </div>
            </div>

            <!-- Stop Loss & Take Profit Calculator Panel -->
            <div style="background: linear-gradient(135deg, #2a2a1a 0%, #1a1a0d 100%); border: 3px solid #ffaa00; padding: 18px; box-shadow: inset 0 0 15px rgba(0,0,0,0.8), 0 0 15px rgba(255,170,0,0.25); border-radius: 4px; font-family: 'Courier New', monospace;">
                <div style="color: #ffaa00; font-weight: 800; margin-bottom: 12px; font-size: 1.1em; border-bottom: 2px solid #ffaa00; padding-bottom: 8px;">🎯 STOP LOSS / TP CALC</div>
                <div style="font-size: 0.9em; line-height: 1.8; color: #ffe0aa;">
                    <div>
                        <label style="color: #ffaa00;">Entry Price:</label>
                        <input type="number" id="slEntryPrice" value="95.44" step="0.01" style="width: 80px; padding: 4px; background: #0a0a0a; color: #ffaa00; border: 1px solid #ffaa00; border-radius: 2px; font-family: 'Courier New';">
                    </div>
                    <div style="margin-top: 8px;">
                        <label style="color: #ffaa00;">SL Distance (pips):</label>
                        <input type="number" id="slDistance" value="50" style="width: 50px; padding: 4px; background: #0a0a0a; color: #ffaa00; border: 1px solid #ffaa00; border-radius: 2px; font-family: 'Courier New';">
                    </div>
                    <div style="margin-top: 8px;">
                        <label style="color: #ffaa00;">R/R Ratio:</label>
                        <input type="number" id="rrRatio" value="2" step="0.5" style="width: 50px; padding: 4px; background: #0a0a0a; color: #ffaa00; border: 1px solid #ffaa00; border-radius: 2px; font-family: 'Courier New';">
                    </div>
                    <button onclick="calculateSLTP()" style="margin-top: 10px; width: 100%; padding: 6px; background: #ffaa00; color: #000; border: none; border-radius: 2px; font-weight: 800; cursor: pointer; font-family: 'Courier New';">CALC SL/TP</button>
                    <div id="slTpResult" style="margin-top: 10px; color: #ff0033; font-weight: 700; text-align: center; font-size: 0.9em;">
                        <div style="color: #ff0033;">SL: --</div>
                        <div style="color: #00ff41;">TP: --</div>
                    </div>
                </div>
            </div>

            <!-- FUNDING RATE CALCULATOR Panel -->
            <div style="background: linear-gradient(135deg, #1a3a2a 0%, #0d2a1a 100%); border: 3px solid #00ff88; padding: 18px; box-shadow: inset 0 0 15px rgba(0,0,0,0.8), 0 0 15px rgba(0,255,136,0.25); border-radius: 4px; font-family: 'Courier New', monospace;">
                <div style="color: #00ff88; font-weight: 800; margin-bottom: 12px; font-size: 1.1em; border-bottom: 2px solid #00ff88; padding-bottom: 8px;">💰 FUNDING RATE CALC</div>
                <div style="font-size: 0.95em; line-height: 1.7; color: #ccffdd;">
                    <div style="margin-bottom: 6px;">
                        <label style="color: #00ff88;">Coin:</label>
                        <select id="fundCoin" onchange="updateCoinPrice()" style="width: 90px; padding: 3px; background: #0a0a0a; color: #00ff41; border: 1px solid #00ff88; border-radius: 2px; font-family: 'Courier New'; font-size: 0.9em; font-weight: 700; cursor: pointer;">
                            <option value="BTCUSDT">BTC</option>
                            <option value="ETHUSDT">ETH</option>
                            <option value="SOLUSDT">SOL</option>
                            <option value="BNBUSDT">BNB</option>
                            <option value="XRPUSDT">XRP</option>
                            <option value="ADAUSDT">ADA</option>
                            <option value="DOGEUSDT">DOGE</option>
                            <option value="AVAXUSDT">AVAX</option>
                            <option value="MATICUSDT">MATIC</option>
                            <option value="LINKUSDT">LINK</option>
                            <option value="COAIUSDT">COAI</option>
                        </select>
                    </div>
                    <div style="margin-bottom: 6px;">
                        <label style="color: #00ff88;">Position (USDT):</label>
                        <input type="number" id="fundPos" value="10000" style="width: 70px; padding: 3px; background: #0a0a0a; color: #00ff41; border: 1px solid #00ff88; border-radius: 2px; font-family: 'Courier New'; font-size: 0.9em;">
                    </div>
                    <div style="margin-bottom: 6px;">
                        <label style="color: #00ff88;">Entry $:</label>
                        <input type="number" id="fundEntry" value="95000" step="100" style="width: 70px; padding: 3px; background: #0a0a0a; color: #00ff41; border: 1px solid #00ff88; border-radius: 2px; font-family: 'Courier New'; font-size: 0.9em;">
                    </div>
                    <div style="margin-bottom: 6px;">
                        <label style="color: #00ff88;">Leverage:</label>
                        <input type="number" id="fundLev" value="10" min="1" max="125" style="width: 40px; padding: 3px; background: #0a0a0a; color: #00ff41; border: 1px solid #00ff88; border-radius: 2px; font-family: 'Courier New'; font-size: 0.9em;">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px; margin-bottom: 6px;">
                        <div>
                            <label style="color: #00ff88;">Days:</label>
                            <input type="number" id="fundDays" value="0" min="0" step="1" style="width: 35px; padding: 3px; background: #0a0a0a; color: #00ff41; border: 1px solid #00ff88; border-radius: 2px; font-family: 'Courier New'; font-size: 0.9em;">
                        </div>
                        <div>
                            <label style="color: #00ff88;">Hours:</label>
                            <input type="number" id="fundHour" value="4" min="0" step="0.5" style="width: 35px; padding: 3px; background: #0a0a0a; color: #00ff41; border: 1px solid #00ff88; border-radius: 2px; font-family: 'Courier New'; font-size: 0.9em;">
                        </div>
                    </div>
                    <div style="margin-bottom: 6px;">
                        <label style="color: #00ff88;">Fee (%):</label>
                        <input type="number" id="fundFee" value="0.04" step="0.01" min="0" max="1" style="width: 50px; padding: 3px; background: #0a0a0a; color: #00ff41; border: 1px solid #00ff88; border-radius: 2px; font-family: 'Courier New'; font-size: 0.9em;">
                    </div>
                    <button onclick="calculateFundingRate()" style="margin-top: 8px; width: 100%; padding: 5px; background: #00ff88; color: #000; border: none; border-radius: 2px; font-weight: 800; cursor: pointer; font-family: 'Courier New'; font-size: 0.9em;">CALC FUNDING</button>
                    <div id="fundResult" style="margin-top: 8px; color: #00ff41; font-weight: 700; text-align: center; font-size: 0.8em; line-height: 1.5;">
                        <div>Cost: $--</div>
                        <div style="color: #ffaa00;">B/E: --%</div>
                    </div>
                </div>
            </div>
            
            
            <!-- Bottom Panel: Status -->
            <div style="grid-column: 1 / -1; background: linear-gradient(90deg, #1a3333 0%, #1a1a33 50%, #2a1a1a 100%); border: 3px solid #00d4ff; padding: 16px; box-shadow: inset 0 0 12px rgba(0,0,0,0.8), 0 0 12px rgba(0,212,255,0.2); border-radius: 4px; font-family: 'Courier New', monospace; display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px; text-align: center;">
                <div style="border-right: 2px solid #00d4ff; padding-right: 10px;">
                    <div style="color: #00d4ff; font-size: 0.9em; margin-bottom: 6px; font-weight: 700;">SYSTEM</div>
                    <div style="color: #00ff41; font-size: 1.2em; font-weight: 900;">🟢 ACTIVE</div>
                </div>
                <div style="border-right: 2px solid #00d4ff; padding-right: 10px;">
                    <div style="color: #00d4ff; font-size: 0.9em; margin-bottom: 6px; font-weight: 700;">TRADES</div>
                    <div style="color: #ffaa00; font-size: 1.2em; font-weight: 900;">12 OPEN</div>
                </div>
                <div style="border-right: 2px solid #00d4ff; padding-right: 10px;">
                    <div style="color: #00d4ff; font-size: 0.9em; margin-bottom: 6px; font-weight: 700;">W/L</div>
                    <div style="color: #00ff41; font-size: 1.2em; font-weight: 900;">68% ✓</div>
                </div>
                <div>
                    <div style="color: #00d4ff; font-size: 0.9em; margin-bottom: 6px; font-weight: 700;">PROFIT</div>
                    <div style="color: #00ff41; font-size: 1.2em; font-weight: 900;">+2.3%</div>
                </div>
            </div>
        </div>
        
        <!-- Footer Status -->
        <div style="margin-top: 12px; text-align: center; font-size: 0.95em; color: #00aa88; font-family: 'Courier New', monospace; letter-spacing: 1px; font-weight: 700;">&gt;&gt;&gt; 🎮 GAME BOY v2.0 • PRESS A TO EXECUTE • B:SKIP &lt;&lt;&lt;</div>
    </div>

    <script>
        // Commodity prices cache
        let commodityPrices = {
            gold: 2650.00,      // USD per oz
            goldPrev: 2650.00,
            silver: 31.50,      // USD per oz
            silverPrev: 31.50,
            lastUpdate: Date.now()
        };
        
        // Fetch live commodities from local Flask API (fallback to simulation on error)
        async function fetchCommoditiesFromServer() {
            try {
                const resp = await fetch('/api/commodities', { cache: 'no-store' });
                if (!resp.ok) throw new Error('HTTP ' + resp.status);
                const data = await resp.json();
                if (!data.ok) throw new Error(data.error || 'Commodity API error');
                
                // Preserve previous values for % change
                commodityPrices.goldPrev = commodityPrices.gold ?? data.gold_previous ?? data.gold;
                commodityPrices.silverPrev = commodityPrices.silver ?? data.silver_previous ?? data.silver;
                
                // Update with live values
                commodityPrices.gold = Number(data.gold);
                commodityPrices.silver = Number(data.silver);
                commodityPrices.lastUpdate = Date.now();
                
                console.log('🥇 Commodity prices fetched from server:', data);
                updateCommodityDisplay();
                // Refresh ticker to ensure DOM elements exist and reflect new values
                updatePixelTicker();
                return true;
            } catch (e) {
                console.warn('⚠️ Commodity API fetch failed, using local simulation fallback', e);
                return false;
            }
        }
        
        // NO API CALLS - Use local simulation only to avoid 429 errors
        function updateCommodityDisplay() {
            try {
                const goldEl = document.getElementById('ticker-gold-price');
                const silverEl = document.getElementById('ticker-silver-price');
                
                console.log('📍 Checking commodity elements:', {goldEl: !!goldEl, silverEl: !!silverEl});
                
                if (goldEl) {
                    const goldChange = ((commodityPrices.gold - commodityPrices.goldPrev) / commodityPrices.goldPrev * 100).toFixed(2);
                    goldEl.innerHTML = 'GOLD $' + commodityPrices.gold.toLocaleString('en-US', {maximumFractionDigits: 2}) + ' <span style="color: ' + (goldChange >= 0 ? '#00ff41' : '#ff0033') + ';">' + (goldChange >= 0 ? '+' : '') + goldChange + '%</span>';
                    console.log('💛 Gold Updated: $' + commodityPrices.gold.toFixed(2) + ' | Change: ' + goldChange + '%');
                }
                
                if (silverEl) {
                    const silverChange = ((commodityPrices.silver - commodityPrices.silverPrev) / commodityPrices.silverPrev * 100).toFixed(2);
                    silverEl.innerHTML = '🔱 SILVER $' + commodityPrices.silver.toLocaleString('en-US', {maximumFractionDigits: 2}) + ' <span style="color: ' + (silverChange >= 0 ? '#00ff41' : '#ff0033') + ';">' + (silverChange >= 0 ? '+' : '') + silverChange + '%</span>';
                    console.log('🥈 Silver Updated: $' + commodityPrices.silver.toFixed(2) + ' | Change: ' + silverChange + '%');
                }
            } catch(e) {
                console.warn('⚠️ Error updating commodity display:', e);
            }
        }
        
        function calculatePositionSize() {
            const instrument = document.getElementById('posCalcInstrument').value;
            const account = parseFloat(document.getElementById('posCalcAccount').value) || 10000;
            const riskPercent = parseFloat(document.getElementById('posCalcRisk').value) || 2;
            const entryInput = parseFloat(document.getElementById('posCalcEntry').value);
            const slInput = parseFloat(document.getElementById('posCalcSL').value);
            const manualPips = parseFloat(document.getElementById('posCalcPips').value);
            
            // Calculate risk amount in USD
            const riskAmount = (account * riskPercent) / 100;
            
            // Instrument parameters
            let pipValue = 10; // USD per 1 pip per lot
            let pipSize = 1;   // USD movement that equals 1 pip
            let contractSize = 1;
            let instrumentName = '';
            let currentPrice = 0;
            
            switch(instrument) {
                case 'btc':
                    pipValue = 1;      // $1 per pip for BTC
                    pipSize = 1;       // 1 USD move = 1 pip
                    contractSize = 0.01; // 0.01 BTC per lot
                    instrumentName = '₿ BTC';
                    currentPrice = marketData.btcPrice || 95000;
                    break;
                case 'eth':
                    pipValue = 1;      // $1 per pip for ETH
                    pipSize = 1;       // 1 USD move = 1 pip
                    contractSize = 0.1; // 0.1 ETH per lot
                    instrumentName = 'Ξ ETH';
                    currentPrice = marketData.ethPrice || 2800;
                    break;
                case 'gold':
                    pipValue = 10;     // $10 per pip for Gold (1 lot)
                    pipSize = 1;       // treat $1 move as 1 pip for simplicity
                    contractSize = 1;  // 1 oz per lot
                    instrumentName = '🥇 XAU';
                    currentPrice = commodityPrices.gold || 2650; // Live gold price
                    break;
                case 'silver':
                    pipValue = 5;      // $5 per pip for Silver (1 lot)
                    pipSize = 1;       // $1 move = 1 pip
                    contractSize = 1;  // 1 oz per lot
                    instrumentName = '🥈 XAG';
                    currentPrice = commodityPrices.silver || 30.5; // Live silver price
                    break;
            }
            
            // Resolve entry/SL prices
            const fallbackEntry = currentPrice || 100; // avoid zero
            const entryPrice = isNaN(entryInput) ? fallbackEntry : entryInput;
            const slPrice = isNaN(slInput) ? (entryPrice - (pipSize * 50)) : slInput;
            const priceDistanceUSD = Math.abs(entryPrice - slPrice);
            
            // Auto pips from price distance
            const autoPips = priceDistanceUSD / pipSize;
            const riskPips = autoPips > 0 ? autoPips : (isNaN(manualPips) ? 1 : manualPips);
            // Update the pips field to show the auto distance (still editable)
            const pipsField = document.getElementById('posCalcPips');
            if (pipsField) pipsField.value = riskPips.toFixed(2);
            
            // Calculate lot size
            const lotsRaw = riskAmount / (Math.max(riskPips, 0.0001) * pipValue);
            const lots = Number.isFinite(lotsRaw) ? lotsRaw : 0;
            
            // Calculate position value in USD
            const positionValue = lots * contractSize * currentPrice;

            // Calculate single lot value in USDT
            const lotValueUSDT = contractSize * currentPrice;

            // Pip value scales
            const pipValuePerLot = pipValue;
            const halfPipValuePerLot = pipValuePerLot * 0.5;
            const pipValueForPosition = pipValuePerLot * lots;
            const halfPipForPosition = pipValueForPosition * 0.5;
            
            const resultElement = document.getElementById('posCalcResult');
            resultElement.innerHTML = `
                <div style="color: #00ff41; font-size: 1.1em; margin-bottom: 6px;">📊 ${lots.toFixed(3)} LOTS ${instrumentName}</div>
                <div style="color: #ffaa00; font-size: 0.85em; margin-bottom: 4px;">Risk: $${riskAmount.toFixed(2)}</div>
                <div style="color: #00d4ff; font-size: 0.85em; margin-bottom: 4px;">Entry: $${entryPrice.toLocaleString()} | SL: $${slPrice.toLocaleString()}</div>
                <div style="color: #ffaa00; font-size: 0.85em; margin-bottom: 4px;">Distance: $${priceDistanceUSD.toFixed(2)} = ${riskPips.toFixed(2)} pips (pip size $${pipSize})</div>
                <div style="color: #bb86fc; font-size: 0.85em; margin-bottom: 4px;">Pip value per lot: $${pipValuePerLot.toFixed(2)} | 0.5 pip: $${halfPipValuePerLot.toFixed(2)}</div>
                <div style="color: #bb86fc; font-size: 0.85em; margin-bottom: 4px;">Pip value for your position: $${pipValueForPosition.toFixed(2)} | 0.5 pip: $${halfPipForPosition.toFixed(2)}</div>
                <div style="color: #00d4ff; font-size: 0.85em;">Position Value (USDT): $${Number(positionValue).toLocaleString()}</div>
                <div style="color: #bb86fc; font-size: 0.85em; margin-top: 4px;">Lot Value (USDT): $${Number(lotValueUSDT).toLocaleString()}</div>
            `;
        }

        function calculateSLTP() {
            const entryPrice = parseFloat(document.getElementById('slEntryPrice').value) || 95.44;
            const slDistance = parseFloat(document.getElementById('slDistance').value) || 50;
            const rrRatio = parseFloat(document.getElementById('rrRatio').value) || 2;
            
            // SL is entry price minus distance (in pips, where 1 pip = 0.01)
            const slPrice = (entryPrice - (slDistance * 0.01)).toFixed(2);
            
            // TP distance = SL distance * R/R ratio
            const tpDistance = slDistance * rrRatio;
            const tpPrice = (entryPrice + (tpDistance * 0.01)).toFixed(2);
            
            const resultElement = document.getElementById('slTpResult');
            resultElement.innerHTML = `
                <div style="color: #ff0033;">SL: ${slPrice} (${slDistance} pips)</div>
                <div style="color: #00ff41;">TP: ${tpPrice} (${tpDistance} pips)</div>
                <div style="color: #00ffff; font-size: 0.8em; margin-top: 8px;">Risk: $${slDistance * 10} | Reward: $${tpDistance * 10}</div>
            `;
        }

        // 💰 FUNDING RATE CALCULATOR (fixed: no override of global updateAllMarketData)
        async function fetchCoinPrice(coin) {
            try {
                const res = await fetch(`/api/binance/price?symbol=${coin}`, { cache: 'no-store' });
                const data = await res.json();
                if (data.ok && data.price !== undefined) return parseFloat(data.price);
                throw new Error(data.error || 'No price');
            } catch (err) {
                console.warn('⚠️ Binance price fetch failed for', coin, err);
                return null;
            }
        }

        async function updateCoinPrice() {
            const coin = document.getElementById('fundCoin').value;
            const livePrice = await fetchCoinPrice(coin);
            if (livePrice) {
                const entryInput = document.getElementById('fundEntry');
                if (entryInput && (!entryInput.value || Number(entryInput.value) === 0)) {
                    entryInput.value = livePrice.toFixed(2);
                }
            }
        }

        async function calculateFundingRate() {
            const coin = document.getElementById('fundCoin').value;
            const posSize = parseFloat(document.getElementById('fundPos').value) || 0; // position notional in USDT
            const entryPrice = parseFloat(document.getElementById('fundEntry').value) || 0;
            const leverage = parseFloat(document.getElementById('fundLev').value) || 1;
            const holdDays = parseInt(document.getElementById('fundDays').value) || 0;
            const holdHours = parseFloat(document.getElementById('fundHour').value) || 0;
            const feePercent = parseFloat(document.getElementById('fundFee').value) || 0.04;

            // Fetch live coin price for reference
            const markPrice = await fetchCoinPrice(coin);
            const refPrice = markPrice || entryPrice;

            // Total hold time in hours
            const totalHours = (holdDays * 24) + holdHours;

            // Estimate daily funding rate (Binance average: 0.01% per day)
            const dailyFundingRate = 0.0001; // 0.01% per day
            const hourlyRate = dailyFundingRate / 24;

            // Funding cost based on notional
            const fundingCost = posSize * hourlyRate * totalHours;

            // Entry/exit fees (user-defined % each way)
            const takerFee = feePercent / 100;
            const totalFees = posSize * takerFee * 2;

            // Total costs
            const totalCost = fundingCost + totalFees;

            // Break-even calculation
            const coinQty = entryPrice > 0 ? posSize / entryPrice : 0;
            const costPerCoin = coinQty > 0 ? totalCost / coinQty : 0;
            const breakEvenPrice = entryPrice + costPerCoin;
            const bePercent = entryPrice > 0 ? (costPerCoin / entryPrice) * 100 : 0;

            const coinSymbol = coin.replace('USDT', '');

            const resultElement = document.getElementById('fundResult');
            resultElement.innerHTML = `
                <div style="color: #00d4ff; font-size: 0.75em; margin-bottom: 4px; font-weight: 700;">${coinSymbol} (${totalHours}h)</div>
                <div style="color: #00ff41; font-weight: 900;">$${fundingCost.toFixed(2)}</div>
                <div style="color: #ffaa00; font-size: 0.75em;">Funding</div>
                <div style="color: #00ffcc; font-weight: 700; margin-top: 4px; font-size: 0.85em;">Fees: $${totalFees.toFixed(2)}</div>
                <div style="color: #ff6666; font-weight: 700; margin-top: 4px; font-size: 0.85em;">Total: $${totalCost.toFixed(2)}</div>
                <div style="color: #ffaa00; margin-top: 6px; font-weight: 800; border-top: 1px solid #00ff88; padding-top: 6px;">B/E: ${bePercent.toFixed(4)}%</div>
                <div style="color: #00d4ff; font-size: 0.8em; margin-top: 6px;">Mark: ${refPrice ? '$' + refPrice.toFixed(2) : 'N/A'} | Lev: ${leverage}x</div>
            `;
        }
    </script>

    <!-- WALL STREET QUOTES & FUNNY SAYINGS -->
    <div style="margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #0a0a1a 0%, #0a0a0a 100%); border-top: 3px solid #9966ff; border-bottom: 3px solid #00ffff;">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px; color: #e0e0e0;">
            <!-- Wall Street Quotes -->
            <div style="background: #0f0f0f; border-left: 4px solid #9966ff; padding: 16px; border-radius: 6px; box-shadow: 0 0 12px rgba(153,102,255,0.15);">
                <div style="font-size: 0.9em; color: #9966ff; font-weight: 700; margin-bottom: 12px;">💎 WALL STREET WISDOM</div>
                <div id="ws-quote" style="font-size: 0.95em; line-height: 1.6; color: #fff; font-style: italic; min-height: 60px;">
                    "The key to success is to focus on goals, not money."<br>
                    <span style="color: #9966ff; font-size: 0.85em; margin-top: 8px; display: block;">— Bill Ackman</span>
                </div>
            </div>
            <!-- Funny Trader Sayings -->
            <div style="background: #0a0f0f; border-left: 4px solid #00ffff; padding: 16px; border-radius: 6px; box-shadow: 0 0 12px rgba(0,255,255,0.15);">
                <div style="font-size: 0.9em; color: #00ffff; font-weight: 700; margin-bottom: 12px;">😂 TRADER HUMOR</div>
                <div id="funny-saying" style="font-size: 0.95em; line-height: 1.6; color: #ccc; min-height: 60px;">
                    "Crypto traders: people who bought high and are now teaching others how to buy high."
                </div>
            </div>
        </div>
    </div>

    <script>
        // AI ADVISOR - DYNAMIC TIPS BASED ON MARKET CONDITIONS
        const marketTips = [
            { condition: 'overbought', tips: ["RSI > 70: Przygotuj TP. Rynek zmęczony!", "Zbyt wysoko = ryzyko pullbacku. Skaluj!", "OB alert: Czeka na reversal."] },
            { condition: 'oversold', tips: ["RSI < 30: Czekaj na dip buy. Bonanza!", "Poniżej = okazja. Przygotuj entry!", "OS alert: Zbierz siły do ataku."] },
            { condition: 'bullish', tips: ["Trend up = følgPrice. Hodl!", "BULL RUN! Nie grąż się w szumy.", "Momentum HIGH. Trzymaj pozycje!"] },
            { condition: 'bearish', tips: ["Trend DOWN. Czekaj i obserwuj.", "SHORT bias. Bądź ostrożny z longami.", "BEAR MODE: Akumulacja na levels."] },
            { condition: 'highvol', tips: ["Vol HIGH. Większe SL, mniejsza pozycja.", "Chaos = szansa. Trade wider ranges!", "ATR robi BOOM. Uważaj na whipsaws!"] },
            { condition: 'lowvol', tips: ["Vol LOW. Range trade opcja.", "Cicho dziś. Squeeze przed BOOM!", "Flat = czekaj. Energia gromadzi się."] },
            { condition: 'funding_long', tips: ["Funding UP. Long bias. Be careful!", "Longi płacą. Shorts czekają na trap.", "Perp premium wysoki. Dźwignia ryzyko."] },
            { condition: 'funding_short', tips: ["Funding LOW/NEG. Short advantage!", "Shorty zarabiają. Longi czekają.", "Perp discount. Okazja do kupna?"] }
        ];

        const wallStreetQuotes = [
            { text: "The key to success is to focus on goals, not money.", author: "Bill Ackman" },
            { text: "Rule No.1: Never lose money. Rule No.2: Never forget rule No.1", author: "Warren Buffett" },
            { text: "The best time to plant a tree was 20 years ago. The second best time is now.", author: "Chinese Proverb" },
            { text: "If you don't find a way to make money while you sleep, you will work until you die.", author: "Warren Buffett" },
            { text: "It's not about timing the market, it's about time IN the market.", author: "Wall Street Wisdom" },
            { text: "Risk comes from not knowing what you're doing.", author: "Warren Buffett" },
            { text: "In investing, what is comfortable is rarely profitable.", author: "Robert Arnott" },
            { text: "The stock market is a device for transferring money from the impatient to the patient.", author: "Warren Buffett" }
        };

        // Update instruments time display
        function updateInstrumentsTime() {
            const now = new Date();
            const hours = String(now.getUTCHours()).padStart(2, '0');
            const minutes = String(now.getUTCMinutes()).padStart(2, '0');
            const seconds = String(now.getUTCSeconds()).padStart(2, '0');
            const timeStr = `${hours}:${minutes}:${seconds}`;
            
            const timeElement = document.getElementById('instruments-update-time');
            if (timeElement) {
                timeElement.textContent = timeStr;
            }
        }
        
        // Initial update
        updateInstrumentsTime();
        // Update every second
        setInterval(updateInstrumentsTime, 1000);

        const funnyTradingQuotes = [
            "Crypto traders: people who bought high and are now teaching others how to buy high.",
            "I diversified my portfolio: 50% trading, 50% praying.",
            "My stop loss isn't broken, it's just on a very long vacation.",
            "HODL means: Hold On to your Loss while Dreaming.",
            "I'm not losing money, I'm just liquidating my dreams at market price.",
            "Technical analysis = fancy way to guess and hope.",
            "My strategy: buy the top, sell the bottom, repeat = infinite loss loop.",
            "Lambo? More like Ramen. I live it.",
            "I have 47 different charting indicators. They all disagree.",
            "Leverage is when you turn $1k into $0 really, REALLY fast.",
            "My wife thinks I work from home. I just check charts 24/7.",
            "Bears make money, bulls make money, pigs get liquidated."
        ];

        // Update every 15 seconds
        setInterval(function() {
            // Pick random tip based on market condition (simulate)
            const randomCondition = marketTips[Math.floor(Math.random() * marketTips.length)];
            const randomTip = randomCondition.tips[Math.floor(Math.random() * randomCondition.tips.length)];
            const gameboyTip = document.getElementById('gameboy-tip');
            if (gameboyTip) {
                gameboyTip.textContent = randomTip;
            }

            // Random WS quote
            const randomWSQuote = wallStreetQuotes[Math.floor(Math.random() * wallStreetQuotes.length)];
            const wsQuoteDiv = document.getElementById('ws-quote');
            if (wsQuoteDiv) {
                wsQuoteDiv.innerHTML = `"${randomWSQuote.text}"<br><span style="color: #9966ff; font-size: 0.85em; margin-top: 8px; display: block;">— ${randomWSQuote.author}</span>`;
            }

            // Random funny saying
            const randomFunny = funnyTradingQuotes[Math.floor(Math.random() * funnyTradingQuotes.length)];
            const funnyDiv = document.getElementById('funny-saying');
            if (funnyDiv) {
                funnyDiv.textContent = randomFunny;
            }
        }, 15000); // Change every 15 seconds

        // Trigger animation on change
        function flashTip() {
            const gameboyTip = document.getElementById('gameboy-tip');
            if (gameboyTip) {
                gameboyTip.style.opacity = '0.7';
                setTimeout(() => { gameboyTip.style.opacity = '1'; }, 100);
            }
        }

        // ===== THEME SWITCHER =====
        const themes = [
            { id: 'modern', name: 'MODERN', class: '' },
            { id: 'bloomberg', name: 'BLOOMBERG', class: 'theme-bloomberg' },
            { id: 'retro-crt', name: 'RETRO CRT', class: 'theme-retro-crt' },
            { id: 'amber', name: 'AMBER', class: 'theme-amber' },
            { id: 'dos', name: 'DOS/MATRIX', class: 'theme-dos' }
        ];
        
        let currentThemeIndex = 0;
        
        function loadTheme() {
            const saved = localStorage.getItem('hamsterTheme');
            if (saved) {
                const idx = themes.findIndex(t => t.id === saved);
                if (idx !== -1) currentThemeIndex = idx;
            }
            applyTheme();
        }
        
        function applyTheme() {
            const theme = themes[currentThemeIndex];
            document.body.className = theme.class;
            const nameEl = document.getElementById('current-theme-name');
            if (nameEl) nameEl.textContent = theme.name;
            localStorage.setItem('hamsterTheme', theme.id);
            console.log('Applied theme:', theme.name);
        }
        
        function nextTheme() {
            currentThemeIndex = (currentThemeIndex + 1) % themes.length;
            applyTheme();
        }
        
        function previousTheme() {
            currentThemeIndex = (currentThemeIndex - 1 + themes.length) % themes.length;
            applyTheme();
        }
        
        // Load theme on page load
        window.addEventListener('DOMContentLoaded', loadTheme);
        if (document.readyState !== 'loading') loadTheme();
        setInterval(flashTip, 15000);
    </script>

    <!-- NAUKA I CIEKAWOSTKI -->
    <div style="margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #001a1a 0%, #0a0a0a 100%); border-top: 3px solid #00ffff; border-bottom: 3px solid #ffaa00; color: #e0e0e0;">
        <div style="display: flex; flex-wrap: wrap; gap: 16px; align-items: flex-start;">
            <div style="flex: 1 1 280px; background: #0f0f0f; border: 1px solid #00d4ff; border-radius: 8px; padding: 16px; box-shadow: 0 0 12px rgba(0,212,255,0.2);">
                <div style="font-size: 0.9em; color: #00ffff; font-weight: 700; margin-bottom: 10px;">📚 NAUKA • SZYBKIE LEKCJE</div>
                <div style="font-size: 0.95em; line-height: 1.7; color: #ccc;">
                    <div style="margin-bottom: 8px;">1) Ryzyko <span style="color: #ffaa00;">≤1%</span> na trade i twardy SL. Matematyka wygrywa z ego.</div>
                    <div style="margin-bottom: 8px;">2) Dziennik transakcji: screen wejścia, powód, wynik. Tylko tak zobaczysz patterny.</div>
                    <div style="margin-bottom: 8px;">3) Jedna przewaga naraz: nie miksuj 10 strategii. Mierz, optymalizuj, dopiero wtedy skaluj.</div>
                    <div style="margin-bottom: 8px;">4) Złota godzina: handluj wtedy, gdy Twoje wyniki historycznie są najlepsze. Resztę czasu przeznacz na research.</div>
                </div>
            </div>
    </div>
    
    <!-- GAME OVER FOOTER - ATARI STYLE -->
    <div style="margin-top: 30px; padding: 40px 20px; background: linear-gradient(180deg, #0a0a0a 0%, #1a0000 100%); border-top: 3px solid #ff0033; text-align: center;">
        <div style="font-family: 'Courier New', monospace; font-size: 3em; color: #ff0033; font-weight: 900; text-shadow: 4px 4px 0 rgba(0,0,0,0.8), 0 0 30px rgba(255,0,51,0.8); letter-spacing: 8px; margin-bottom: 20px; animation: blink 1.2s infinite;">
            ⚠️ GAME OVER ⚠️
        </div>
        <div style="font-family: 'Roboto Mono', monospace; font-size: 1.5em; color: #ffaa00; font-weight: 700; text-shadow: 2px 2px 0 rgba(0,0,0,0.8); margin-bottom: 15px; animation: pulse 2s infinite;">
            💰 WPŁAĆ DEPOZYT, ABY KONTYNUOWAĆ 💰
        </div>
        <div style="font-size: 0.9em; color: #fff; line-height: 1.8; max-width: 600px; margin: 0 auto;">
            <div style="margin: 10px 0;">🎮 INSERT COIN TO CONTINUE</div>
            <div style="margin: 10px 0;">📊 Trading wymaga kapitału. Zarządzaj ryzykiem mądrze.</div>
            <div style="margin: 10px 0; color: #00ff41;">🏆 Pamiętaj: Market makers always win. Don't fight the tape!</div>
        </div>
        <div style="margin-top: 25px; padding: 15px; background: linear-gradient(135deg, #2a000a 0%, #0a0a0a 100%); border: 2px solid #ff0033; border-radius: 8px; display: inline-block; max-width: 700px; box-shadow: 0 0 16px rgba(255,0,51,0.25);">
            <div style="display: flex; align-items: center; justify-content: center; gap: 10px; color: #ff0033; font-weight: 900; letter-spacing: 1px; margin-bottom: 8px;">
                <span style="animation: blink 1s infinite;">⚠️</span>
                <span>OSTRZEŻENIE</span>
                <span style="animation: blink 1s infinite;">⚠️</span>
            </div>
            <div style="color: #eee; font-size: 0.9em; line-height: 1.6; font-family: 'Roboto Mono', monospace;">
                Trading kryptowalutami wiąże się z wysokim ryzykiem. Nigdy nie inwestuj więcej niż możesz stracić. Przeszłe wyniki nie gwarantują przyszłych zysków. <span style="color: #ffaa00; font-weight: 900;">No risk no story</span> <span style="color: #00ff41; font-weight: 900;">No guts no glory</span>
            </div>
        </div>
        <div style="margin-top: 30px; font-family: 'Courier New', monospace; color: #333; font-size: 0.8em;">
            🎮 GAME BOY TERMINAL v2.0 • 2026 • CRYPTO TRADING SIMULATOR
        </div>
    </div>

    <script>
        // Multi-Timeframe Data Generator
        const timeframesData = ['1m', '5m', '15m', '30m', '1h', '4h', '1d', '1M', '3M', '1Y'];
        const regimesOptions = ['BULL', 'BEAR', 'NEUTRAL', 'SIDEWAYS'];

        function getRegimeColor(regime) {
            if (regime === 'BULL') return '#00ff41';
            if (regime === 'BEAR') return '#ff0033';
            if (regime === 'NEUTRAL') return '#ffaa00';
            if (regime === 'SIDEWAYS') return '#ffaa00';
            if (regime === 'CONSOLIDATION') return '#ffaa00';
            return '#00d4ff';
        }

        function getRegimeBg(regime) {
            if (regime === 'BULL') return 'rgba(0,255,65,0.08)';
            if (regime === 'BEAR') return 'rgba(255,0,51,0.08)';
            if (regime === 'NEUTRAL') return 'rgba(255,170,0,0.08)';
            if (regime === 'SIDEWAYS') return 'rgba(255,170,0,0.08)';
            if (regime === 'CONSOLIDATION') return 'rgba(255,170,0,0.10)';
            return 'rgba(0,212,255,0.08)';
        }

        function generateRandomRSI() {
            return Math.floor(Math.random() * 50 + 20); // 20-70 range
        }

        function getRandomRegime() {
            return regimesOptions[Math.floor(Math.random() * regimesOptions.length)];
        }

        function updateTimeframeZone() {
            timeframesData.forEach((tf) => {
                const element = document.getElementById(tf);
                if (!element) return;

                const regime = getRandomRegime();
                const rsi = generateRandomRSI();

                // Update background
                element.style.backgroundColor = getRegimeBg(regime);

                // Find and update regime element
                const regimeDiv = element.querySelector('.tf-regime');
                if (regimeDiv) {
                    regimeDiv.textContent = regime;
                    regimeDiv.style.color = getRegimeColor(regime);
                }

                // Find and update RSI element
                const rsiDiv = element.querySelector('.tf-rsi');
                if (rsiDiv) {
                    rsiDiv.textContent = 'RSI: ' + rsi;
                }
            });
        }

        // Wait for DOM to load, then update
        document.addEventListener('DOMContentLoaded', function() {
            updateTimeframeZone();
            setInterval(updateTimeframeZone, 3000); // Update every 3 seconds
        });

        // Also try immediately in case DOM is already loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', updateTimeframeZone);
        } else {
            updateTimeframeZone();
            setInterval(updateTimeframeZone, 3000);
        }
    </script>

    <!-- ===== BLOOMBERG TICKER & BREAKING NEWS SCRIPTS ===== -->
    <script>
        const TWELVE_DATA_KEY = '5203977ec0204755904ef326abe77e7c';
        const TICKER_CONFIG = {
            'METALE': { symbols: ['XAU/USD', 'XAG/USD'], color: '#ffff00' },
            'INDEKSY': { symbols: ['SPX', 'INDU', 'IXIC', 'GDAXI'], color: '#00d4ff' },
            'MEGA CAPS': { symbols: ['AAPL', 'MSFT', 'NVDA', 'AMZN', 'TSLA'], color: '#cccccc' }
        };
        
        async function fetchTickerData() {
            try {
                const allSymbols = Object.values(TICKER_CONFIG).flatMap(g => g.symbols).join(',');
                const url = `https://api.twelvedata.com/quote?symbol=${allSymbols}&apikey=${TWELVE_DATA_KEY}`;
                console.log('Fetching ticker data from:', url);
                const response = await fetch(url);
                if (!response.ok) throw new Error('API error: ' + response.status);
                const data = await response.json();
                console.log('API Response:', data);
                
                let items = [];
                // Check if data is array
                if (Array.isArray(data)) {
                    items = data;
                }
                // Check if data has array results
                else if (Array.isArray(data?.results)) {
                    items = data.results;
                }
                // Check if data is object with symbol keys
                else if (data && typeof data === 'object') {
                    // Convert object to array
                    items = Object.values(data).filter(v => v && typeof v === 'object' && v.symbol);
                }
                
                // Filter valid items
                items = items.filter(item => item && item.symbol && (item.price || item.close));
                
                if (items.length === 0) {
                    console.warn('No valid ticker data, using mock');
                    throw new Error('Empty ticker payload');
                }
                
                console.log('Parsed items:', items);
                return items;
            } catch (error) {
                console.error('Ticker error, using mock:', error);
                return getMockTickerData();
            }
        }
        
        function getMockTickerData() {
            return [
                { symbol: 'XAU/USD', price: '2645.30', percent_change: '0.45' },
                { symbol: 'XAG/USD', price: '31.25', percent_change: '0.32' },
                { symbol: 'SPX', price: '5847.50', percent_change: '1.42' },
                { symbol: 'INDU', price: '42850.20', percent_change: '0.87' },
                { symbol: 'IXIC', price: '18542.30', percent_change: '1.93' },
                { symbol: 'GDAXI', price: '18234.10', percent_change: '-0.62' },
                { symbol: 'AAPL', price: '234.56', percent_change: '2.18' },
                { symbol: 'MSFT', price: '445.32', percent_change: '1.87' },
                { symbol: 'NVDA', price: '892.15', percent_change: '3.24' },
                { symbol: 'AMZN', price: '456.78', percent_change: '-1.45' },
                { symbol: 'TSLA', price: '347.85', percent_change: '4.32' }
            ];
        }
        
        async function buildBloombergTicker() {
            try {
                const priceData = await fetchTickerData();
                const priceMap = new Map(priceData.map(item => [item.symbol, item]));
                
                // Update METALE
                updateTickerElement('metal-1', priceMap.get('XAU/USD'), '#ffff00');
                updateTickerElement('metal-2', priceMap.get('XAG/USD'), '#ffff00');
                
                // Update INDEKSY
                updateTickerElement('index-1', priceMap.get('SPX'), '#00d4ff');
                updateTickerElement('index-2', priceMap.get('INDU'), '#00d4ff');
                updateTickerElement('index-3', priceMap.get('IXIC'), '#00d4ff');
                
                // Update MEGA CAPS
                updateTickerElement('stock-1', priceMap.get('AAPL'), '#cccccc');
                updateTickerElement('stock-2', priceMap.get('MSFT'), '#cccccc');
                updateTickerElement('stock-3', priceMap.get('TSLA'), '#cccccc');
                
                console.log('Bloomberg ticker updated successfully');
            } catch (error) {
                console.error('Error building ticker:', error);
            }
        }
        
        function updateTickerElement(elementId, data, color) {
            const element = document.getElementById(elementId);
            if (!element || !data) return;
            
            const priceValue = data.price || data.close || 0;
            const changeValue = data.percent_change || data.change_percent || data.percent || 0;
            const change = parseFloat(changeValue);
            const changeColor = change >= 0 ? '#00ff41' : '#ff0033';
            const sign = change >= 0 ? '+' : '';
            
            element.querySelector('.ticker-price').textContent = '$' + parseFloat(priceValue).toFixed(2);
            element.querySelector('.ticker-change').textContent = sign + change.toFixed(2) + '%';
            element.querySelector('.ticker-change').style.color = changeColor;
        }
        
        buildBloombergTicker();
        setInterval(buildBloombergTicker, 30000);

        // ===== BREAKING NEWS =====
        function getImportanceLevel(h) {
            const high = ['crash', 'surge', 'record', 'historic', 'emergency', 'halt', 'alert'];
            const med = ['rally', 'decline', 'forecast', 'warns', 'announces'];
            const l = h.toLowerCase();
            return high.some(k => l.includes(k)) ? 'high' : med.some(k => l.includes(k)) ? 'medium' : 'low';
        }

        function categorizeNews(h) {
            const l = h.toLowerCase();
            if (l.includes('crypto') || l.includes('bitcoin') || l.includes('ethereum')) return 'CRYPTO';
            if (l.includes('stock') || l.includes('apple') || l.includes('microsoft')) return 'STOCKS';
            if (l.includes('market') || l.includes('index') || l.includes('s&p')) return 'MARKETS';
            if (l.includes('fed') || l.includes('economy') || l.includes('inflation')) return 'ECONOMY';
            return 'MARKETS';
        }

        function getRelativeTime(d) {
            try {
                const nd = new Date(d);
                const now = new Date();
                const ms = now - nd;
                const mins = Math.floor(ms / 60000);
                const hrs = Math.floor(ms / 3600000);
                const days = Math.floor(ms / 86400000);
                if (mins < 1) return 'Teraz';
                if (mins < 60) return mins + 'm temu';
                if (hrs < 24) return hrs + 'h temu';
                if (days < 7) return days + 'd temu';
                return nd.toLocaleDateString('pl-PL');
            } catch (e) { return 'Niedawno'; }
        }

        async function fetchBreakingNews() {
            try {
                const syms = ['BTCUSD', 'ETHUSD', 'AAPL', 'MSFT', 'SPX'];
                const reqs = syms.map(s => fetch(`https://api.twelvedata.com/stocks/news?symbol=${s}&limit=5&apikey=${TWELVE_DATA_KEY}`).then(r => r.json()).catch(() => ({ data: [] })));
                const results = await Promise.all(reqs);
                const news = results.flatMap(r => r.data || []).filter(a => a && a.title).slice(0, 20);
                return news.length > 0 ? news : getMockNews();
            } catch (e) { return getMockNews(); }
        }

        function getMockNews() {
            return [
                { title: 'Bitcoin Surges Past $95,000', source: 'Bloomberg', published_date: new Date(Date.now() - 300000).toISOString(), symbol: 'BTCUSD' },
                { title: 'Apple Beats Q4 Earnings - Stock Soars', source: 'Reuters', published_date: new Date(Date.now() - 600000).toISOString(), symbol: 'AAPL' },
                { title: 'Fed Signals Possible Rate Pause', source: 'FT', published_date: new Date(Date.now() - 900000).toISOString(), symbol: 'INDU' },
                { title: 'Ethereum Network Upgrade Boosts Performance', source: 'CoinDesk', published_date: new Date(Date.now() - 1200000).toISOString(), symbol: 'ETHUSD' },
                { title: 'S&P 500 Reaches All-Time High', source: 'MarketWatch', published_date: new Date(Date.now() - 1500000).toISOString(), symbol: 'SPX' },
                { title: 'Microsoft AI Investment Initiative', source: 'TechCrunch', published_date: new Date(Date.now() - 1800000).toISOString(), symbol: 'MSFT' }
            ];
        }

        async function buildBreakingNews() {
            const newsData = await fetchBreakingNews();
            if (!newsData || newsData.length === 0) {
                const wrapper = document.getElementById('breakingNewsWrapper');
                if (wrapper) wrapper.innerHTML = '<span class="breaking-news-label">BREAKING NEWS</span><div class="news-loading">Brak wiadomosci</div>';
                return;
            }

            let html = '<div class="breaking-news-scroll">';
            
            for (let loop = 0; loop < 2; loop++) {
                for (const article of newsData) {
                    const imp = getImportanceLevel(article.title);
                    const cat = categorizeNews(article.title);
                    const time = getRelativeTime(article.published_date);
                    const src = article.source || 'News';
                    const icon = imp === 'high' ? 'RED' : imp === 'medium' ? 'ORANGE' : 'GREEN';
                    
                    html += `<div class="breaking-news-item">
                        <span class="news-importance ${imp}">${icon} ${imp.toUpperCase()}</span>
                        <span class="news-category-tag category-${cat.toLowerCase()}">${cat}</span>
                        <span class="news-source">${src}</span>
                        <span class="news-headline">${article.title}</span>
                        <span class="news-time">${time}</span>
                    </div>`;
                }
                html += '<div style="width: 50px; flex-shrink: 0;"></div>';
            }
            
            html += '</div>';
            const wrapper = document.getElementById('breakingNewsWrapper');
            if (wrapper) wrapper.innerHTML = '<span class="breaking-news-label">BREAKING NEWS</span>' + html;
        }
        
        buildBreakingNews();
        setInterval(buildBreakingNews, 120000);
    </script>
</html>
